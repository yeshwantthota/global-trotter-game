(window.webpackJsonpBottomSticky=window.webpackJsonpBottomSticky||[]).push([[8],{10:function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return Kq})),n.d(t,"b",(function(){return fK})),n.d(t,"c",(function(){return ot})),n.d(t,"d",(function(){return mt})),n.d(t,"e",(function(){return G_})),n.d(t,"f",(function(){return z})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return HK})),n.d(t,"i",(function(){return ct})),n.d(t,"j",(function(){return at})),n.d(t,"k",(function(){return Nt})),n.d(t,"l",(function(){return Tt})),n.d(t,"m",(function(){return ms}));var i=n(11),a=n.n(i),s=n(15),o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u,c={exports:{}},d={};c.exports=function(){if(u)return d;u=1;var e=a.a,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(e,n,a){var o,l={},u=null,c=null;for(o in void 0!==a&&(u=""+a),void 0!==n.key&&(u=""+n.key),void 0!==n.ref&&(c=n.ref),n)r.call(n,o)&&!s.hasOwnProperty(o)&&(l[o]=n[o]);if(e&&e.defaultProps)for(o in n=e.defaultProps)void 0===l[o]&&(l[o]=n[o]);return{$$typeof:t,type:e,key:u,ref:c,props:l,_owner:i.current}}return d.Fragment=n,d.jsx=o,d.jsxs=o,d}();var h=c.exports,f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function g(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function _(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}function v(e,t){var n,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function E(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;const y="reactions",b="message_search_v3",C="enable_og_tag",N="delivery_receipt";var T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var S=function(){return(S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function w(e,t,n,r){return new(n||(n=Promise))((function(t,i){function a(e){try{o(r.next(e))}catch(e){i(e)}}function s(e){try{o(r.throw(e))}catch(e){i(e)}}function o(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,s)}o((r=r.apply(e,[])).next())}))}function A(e,t){var n,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function M(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return s}function R(e,t,n){if(2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var k,x,D="4.17.2",U=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return D},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}();(x=k||(k={}))[x.NON_AUTHORIZED=400108]="NON_AUTHORIZED",x[x.INVALID_TOKEN=400111]="INVALID_TOKEN",x[x.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",x[x.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",x[x.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",x[x.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",x[x.APPLICATION_NOT_FOUND=400304]="APPLICATION_NOT_FOUND",x[x.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",x[x.SESSION_REVOKED=400310]="SESSION_REVOKED",x[x.INVALID_SESSION_TYPE=400312]="INVALID_SESSION_TYPE",x[x.INVALID_AUTH_FOR_SERVICE=400313]="INVALID_AUTH_FOR_SERVICE",x[x.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",x[x.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE=400940]="NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE",x[x.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",x[x.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",x[x.INVALID_REQUIRED_FORM_VALUE=400105]="INVALID_REQUIRED_FORM_VALUE",x[x.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",x[x.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE=901500]="NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE",x[x.ERR_DUPLICATED_DATA=400202]="ERR_DUPLICATED_DATA",x[x.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",x[x.LOST_INSTANCE=700100]="LOST_INSTANCE",x[x.CONNECTION_RENEW=700102]="CONNECTION_RENEW",x[x.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",x[x.INVALID_COMMAND=700700]="INVALID_COMMAND",x[x.XMLHTTPREQUEST_NOT_SUPPORTED=700800]="XMLHTTPREQUEST_NOT_SUPPORTED",x[x.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",x[x.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",x[x.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",x[x.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",x[x.INVALID_PARAMETER=800110]="INVALID_PARAMETER",x[x.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",x[x.NETWORK_ERROR=800120]="NETWORK_ERROR",x[x.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",x[x.MALFORMED_DATA=800130]="MALFORMED_DATA",x[x.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",x[x.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",x[x.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",x[x.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",x[x.ACK_TIMEOUT=800180]="ACK_TIMEOUT",x[x.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",x[x.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",x[x.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",x[x.REQUEST_FAILED=800220]="REQUEST_FAILED",x[x.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",x[x.REQUEST_CANCELED=800240]="REQUEST_CANCELED",x[x.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",x[x.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",x[x.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED=800270]="ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED",x[x.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",x[x.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",x[x.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",x[x.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",x[x.DATABASE_ERROR=800700]="DATABASE_ERROR",x[x.USER_DEACTIVATED=900021]="USER_DEACTIVATED",x[x.CHANNEL_IS_FROZEN=900050]="CHANNEL_IS_FROZEN",x[x.RECEIVER_USER_DEACTIVATED=900081]="RECEIVER_USER_DEACTIVATED";var L,P,F,B,j,H,G=function(e){return!(e instanceof z&&!e.shouldThrowOutside)},z=function(e){function t(n){var r=n.code,i=void 0===r?0:r,a=n.message,s=void 0===a?"":a,o=e.call(this,s)||this;return o.shouldThrowOutside=!1,o._detail="",o.name="SendbirdError",o.code=i,Object.setPrototypeOf(o,t.prototype),o}return I(t,e),Object.defineProperty(t.prototype,"detail",{get:function(){return this._detail},enumerable:!1,configurable:!0}),t.prototype.setDetail=function(e){this._detail=e},Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===k.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiredError",{get:function(){return this.isSessionTokenExpiredError||this.isSessionKeyExpiredError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===k.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===k.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionInvalidatedError",{get:function(){return this.isSessionRevokedError||this.isUserAuthDeactivedError||this.isUserAuthDeletedOrNotFoundError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionRevokedError",{get:function(){return this.code===k.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===k.USER_AUTH_DEACTIVATED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===k.USER_AUTH_DELETED_OR_NOT_FOUND},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNetworkError",{get:function(){return this.code===k.NETWORK_ERROR||this.code===k.NETWORK_ROUTING_ERROR},enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:k.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:k.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidCommand",{get:function(){return new t({code:k.INVALID_COMMAND,message:"Cannot send invalid command."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"unknown",{get:function(){return new t({code:k.UNKNOWN_ERROR,message:"Unknown error occurred."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:k.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:k.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"xmlHttpRequestNotSupported",{get:function(){return new t({code:k.XMLHTTPREQUEST_NOT_SUPPORTED,message:"Cannot upload file. XMLHttpRequest is not defined in this environment."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:k.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:k.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:k.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:k.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"channelTypeNotSupportedError",{get:function(){return new t({code:k.NOT_SUPPORTED_ERROR,message:"Called method is not supported in the current channel's channel type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:k.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:k.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:k.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:k.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:k.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:k.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:k.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tooManyRequests",{get:function(){return new t({code:k.REQUEST_DUPLICATED,message:"Too many requests."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"alreadyConnectedAsAnotherUser",{get:function(){return new t({code:k.REQUEST_FAILED,message:"Already logged in as a different user. Call disconnect() first."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:k.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:k.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:k.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:k.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:k.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileSizeLimitExceededError",{get:function(){return new t({code:k.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"statLogUploadLimitExceededError",{get:function(){return new t({code:k.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED,message:"The upload request failed due to the retry count being exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"malformedDataError",{get:function(){return new t({code:k.MALFORMED_DATA,message:"Malformed data."})},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},t}(Error),V=[k.CONNECTION_REQUIRED,k.NETWORK_ERROR,k.ACK_TIMEOUT,k.WEBSOCKET_CONNECTION_CLOSED,k.WEBSOCKET_CONNECTION_FAILED,k.FILE_UPLOAD_CANCEL_FAILED,k.REQUEST_CANCELED,k.INTERNAL_SERVER_ERROR,k.RATE_LIMIT_EXCEEDED,k.UNKNOWN_SERVER_ERROR,k.USER_DEACTIVATED,k.CHANNEL_IS_FROZEN,k.RECEIVER_USER_DEACTIVATED],q=[k.WEBSOCKET_CONNECTION_CLOSED,k.WEBSOCKET_CONNECTION_FAILED,k.CONNECTION_REQUIRED,k.CHANNEL_IS_FROZEN],K=function(e,t){if(e!==t){var n=S({},e),r=S({},t);return!(n.hasOwnProperty("messageId")&&r.hasOwnProperty("messageId")&&n.messageId!==r.messageId||n.hasOwnProperty("reqId")&&r.hasOwnProperty("reqId")&&n.reqId!==r.reqId||(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)!==JSON.stringify(r)))}return!0},W=function(e,t,n){return void 0===n&&(n=!1),!(!n||!ee(t))||("string"!=typeof e?"object"==typeof e?Y(e,t):Q(e,t):typeof t===e)},Y=function(e,t,n){return void 0===n&&(n=!1),!(!n||!ee(t))||Object.values(e).includes(t)},Q=function(e,t){return t instanceof e},X=function(e,t,n){return void 0===n&&(n=!1),!(!n||!ee(t))||Array.isArray(t)&&t.every((function(t){return W(e,t)}))},Z=function(e,t){return!!ee(e)||"number"==typeof e&&13===e.toString().length},J=function(e){return e>0&&q.indexOf(e)>=0},$=function(e,t){if(void 0===t&&(t=!1),t&&ee(e))return!0;var n="object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n},ee=function(e){return null==e},te=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=void 0===n||n,i=t.typingIndicatorInvalidateTime,a=void 0===i?1e4:i,s=t.typingIndicatorThrottle,o=void 0===s?1e3:s,l=t.websocketResponseTimeout,u=void 0===l?1e4:l,c=t.websocketPayloadDecompression,d=void 0===c||c,h=t.sessionTokenRefreshTimeout,f=void 0===h?60:h;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=r,this._typingIndicatorInvalidateTime=a,this._typingIndicatorThrottle=o,this._websocketResponseTimeout=u,this._sessionTokenRefreshTimeout=f,this.websocketPayloadDecompression=d}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(e){W("boolean",e)&&(this._useMemberInfoInMessage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(e){W("number",e)&&(this._typingIndicatorInvalidateTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(e){W("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(e){W("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(e){W("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e)},enumerable:!1,configurable:!0}),e}(),ne={encrypt:function(e){return e},decrypt:function(e){return e}},re=function(){function e(e){var t=e.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._store.set({key:this._keysAddress,value:R([],O(this._preference.keys()),!1)})];case 1:return e.sent(),[2]}}))}))},e.prototype.init=function(e,t){var n;return void 0===t&&(t=1),w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d,h,f;return A(this,(function(p){switch(p.label){case 0:return this._version=t,this._keysAddress=e,r="".concat(e,".metadata.version"),[4,this._store.get(r)];case 1:return i=p.sent(),[4,this._store.get(e)];case 2:return a=null!==(n=p.sent())&&void 0!==n?n:[],!i||i.version<this._version?9===this._version?[3,3]:[3,6]:[3,10];case 3:return(s=a.find((function(e){return e.includes("groupchannel/sync.meta")})))?[4,this._store.remove(s)]:[3,5];case 4:p.sent(),p.label=5;case 5:return[3,8];case 6:return[4,this._resetPreferenceData(a)];case 7:p.sent(),p.label=8;case 8:return[4,this._updatePreferenceVersionInfo(r)];case 9:return p.sent(),[3,17];case 10:p.trys.push([10,15,16,17]),o=M(a),l=o.next(),p.label=11;case 11:return l.done?[3,14]:(u=l.value,[4,this._store.get(u)]);case 12:(c=p.sent())&&this._preference.set(u,c),p.label=13;case 13:return l=o.next(),[3,11];case 14:return[3,17];case 15:return d=p.sent(),h={error:d},[3,17];case 16:try{l&&!l.done&&(f=o.return)&&f.call(o)}finally{if(h)throw h.error}return[7];case 17:return[2]}}))}))},e.prototype._updatePreferenceVersionInfo=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._store.set({key:e,value:{version:this._version}})];case 1:return t.sent(),[2]}}))}))},e.prototype._resetPreferenceData=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this._preference=new Map,[4,this._store.removeMany(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.get=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this._preference.get(e)]}))}))},e.prototype.set=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._store.removeMany(R([],O(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}}))}))},e}(),ie=function(){function e(e){var t=e.encryption,n=e.store,r=e.localCacheEnabled,i=e.localCacheConfig;this.store=n,this.preference=new re({store:n}),this.encryption=null!=t?t:ne,this.localCacheEnabled=r,this.localCacheConfig=i}return e.prototype.replaceStore=function(e){this.store=e,this.preference=new re({store:e})},e}();!function(e){e.SUCCESS="success",e.PENDING="pending",e.ERROR="error"}(L||(L={})),function(e){e.DEFAULT="default",e.ALL="all",e.MENTION_ONLY="mention_only",e.OFF="off"}(P||(P={})),function(e){e.FCM="gcm",e.APNS="apns",e.UNKNOWN="unknown"}(F||(F={})),function(e){e.SESSION_TOKEN="session_token",e.ACCESS_TOKEN="access_token"}(B||(B={})),function(e){e.ALTERNATIVE="alternative",e.DEFAULT="default"}(j||(j={})),function(e){e.CUSTOM="custom",e.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(H||(H={}));var ae,se=function(){function e(e){var t=e.channel,n=e.cachedMessageCount;this._cachedMessageCount=0,this._channel=t,this._cachedMessageCount=n}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),e}(),oe=function(){function e(e){var t=void 0===e?{}:e,n=t.maxSize,r=void 0===n?256:n,i=t.clearOrder,a=void 0===i?H.MESSAGE_COLLECTION_ACCESSED_AT:i,s=t.customClearOrderComparator,o=t.enableAutoResend,l=void 0===o||o;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(e,t){return e.channel.messageCollectionLastAccessedAt===t.channel.messageCollectionLastAccessedAt?e.channel.lastMessage&&!t.channel.lastMessage?1:!e.channel.lastMessage&&t.channel.lastMessage?-1:e.channel.lastMessage||t.channel.lastMessage?e.channel.lastMessage.createdAt-t.channel.lastMessage.createdAt:0:e.channel.messageCollectionLastAccessedAt>t.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(r,64),s?(this._clearOrder=a,this._customClearOrderComparator=s):this._clearOrder=H.MESSAGE_COLLECTION_ACCESSED_AT,this._enableAutoResend=l}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var e;return this._clearOrder===H.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:null!==(e=this._customClearOrderComparator)&&void 0!==e?e:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableAutoResend",{get:function(){return this._enableAutoResend},enumerable:!1,configurable:!0}),e}();!function(e){e.FEED="feed",e.CHAT="chat",e.CHAT_API="chat_api"}(ae||(ae={}));var le,ue,ce,de,he,fe,pe,me,ge,_e,ve,Ee,ye,be=function(){function e(){this.isRefreshing=!1}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasChatServicePermission",{get:function(){var e;return!!(null===(e=this.services)||void 0===e?void 0:e.includes(ae.CHAT))},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0,this.services=[]},e}(),Ce=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},Ne=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=Ce()}return e.prototype._register=function(e,t,n){var r;return e in this._container||(this._container[e]=new Map),null===(r=this._container[e])||void 0===r||r.set(this.key,{occurence:t,handler:n}),this},e.prototype.on=function(e,t){return this._register(e,-1,t)},e.prototype.once=function(e,t){return this._register(e,1,t)},e.prototype.close=function(){var e=this;Object.keys(this._container).forEach((function(t){var n;null===(n=e._container[t])||void 0===n||n.delete(e.key)}))},e}(),Te=function(){function e(){this._container={}}return e.prototype.on=function(e,t){return new Ne({container:this._container}).on(e,t)},e.prototype.once=function(e,t){return new Ne({container:this._container}).once(e,t)},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var a=[];try{for(var s=M(i.keys()),o=s.next();!o.done;o=s.next()){var l=o.value,u=i.get(l);u.handler(t),u.occurence>0&&(u.occurence--,0===u.occurence&&a.push(l))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}a.forEach((function(e){return i.delete(e)}))}},e}(),Ie=function(){function e(){this._dispatcher=new Te}return e.prototype.on=function(e){return this._dispatcher.on("event",e)},e.prototype.once=function(e){return this._dispatcher.once("event",e)},e.prototype.dispatch=function(e){this._dispatcher.dispatch("event",e)},e}(),Se=function(){},we=function(e){var t={};return e&&Object.keys(e).forEach((function(n){void 0===e[n]||Number.isNaN(e[n])||null===e[n]||(t[n]=e[n])})),t},Ae=function(e){if(null!=e){if("object"==typeof e){if(Array.isArray(e)){for(var t=R([],O(e),!1),n=0;n<t.length;n++)t[n]=Ae(t[n]);return t}return Object.keys(e).forEach((function(t){null===e[t]&&delete e[t]})),e}return e}};!function(e){e.BASE="base",e.GROUP="group",e.OPEN="open",e.FEED="feed"}(le||(le={})),function(e){e.OPERATOR="operator",e.NONE="none"}(ue||(ue={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted"}(ce||(ce={})),function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin"}(de||(de={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(he||(he={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(fe||(fe={})),function(e){e.USERS="users",e.CHANNEL="channel"}(pe||(pe={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(me||(me={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress"}(ge||(ge={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled"}(_e||(_e={})),function(e){e.INREVIEW="InReview",e.APPROVED="Approved"}(ve||(ve={})),function(e){e.HIGH="high",e.NORMAL="normal",e.LOW="low"}(Ee||(Ee={})),function(e){e.CREATED_AT="created_at",e.UPDATED_AT="updated_at"}(ye||(ye={}));var Me,Oe="v3",Re="/".concat(Oe,"/users"),ke="/".concat(Oe,"/sdk/users"),xe="/".concat(Oe,"/storage/file"),De="/".concat(Oe,"/group_channels"),Ue="/".concat(Oe,"/sdk/group_channels"),Le="/".concat(Oe,"/open_channels"),Pe="/".concat(Oe,"/sdk/open_channels"),Fe="/".concat(Oe,"/search"),Be="/".concat(Oe,"/report"),je="/".concat(Oe,"/emojis"),He="/".concat(Oe,"/emoji_categories"),Ge="/".concat(Oe,"/polls"),ze="/".concat(Oe,"/scheduled_messages"),Ve="/".concat(Oe,"/sdk/ui_kit/configuration"),qe="/".concat(Oe,"/sdk/statistics"),Ke="/".concat(Oe,"/sdk/statistics/notification_statistics"),We="/".concat(Oe,"/message_templates"),Ye="/".concat(Oe,"/sdk/push_delivery"),Qe="/".concat(Oe,"/forms"),Xe="/".concat(Oe,"/report_category"),Ze="/".concat(Oe,"/sdk/applications/settings"),Je=function(e){switch(e){case le.FEED:case le.GROUP:return De;case le.OPEN:return Le;default:return null}},$e=function(e){switch(e){case le.GROUP:return"".concat(Be,"/group_channels");case le.OPEN:return"".concat(Be,"/open_channels");default:return null}},et=function(e,t,n){var r,i;switch(e){case pe.CHANNEL:return!0;case pe.USERS:if(t)try{for(var a=M(t),s=a.next();!s.done;s=a.next())if(s.value===n)return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return!1},tt=function(e,t,n){var r,i,a,s,o=et(null!==(r=e.mentionType)&&void 0!==r?r:null,null!==(i=e.mentionedUserIds)&&void 0!==i?i:[],n),l=et(null!==(a=t.mentionType)&&void 0!==a?a:null,null!==(s=t.mentionedUserIds)&&void 0!==s?s:[],n);return!o&&l?1:o&&!l?-1:0},nt=function(e,t,n){var r,i=t||new FormData;for(var a in e)if(e.hasOwnProperty(a)){var s=e[a],o=n?"".concat(n,"[").concat(a,"]"):a;$(s)?i.append(o,s,null!==(r=s.name)&&void 0!==r?r:"filename"):"object"!=typeof s||null===s||Array.isArray(s)||s instanceof Blob?i.append(o,String(s)):i=nt(s,i,o)}return i};!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(Me||(Me={}));var rt,it=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=Ce(),t}return I(t,e),t.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map((function(e){return t.encodeParams(e)})).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e))},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,t=we(this.params);return"?".concat(Object.keys(t).map((function(n){return"".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]))})).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=we(this.params);return Object.keys(e).some((function(t){return $(e[t])}))?nt(e):JSON.stringify(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSessionKey",{get:function(){return void 0!==this.headers["Session-Key"]},enumerable:!1,configurable:!0}),t}(Se),at=function(e){function t(t,n){var r=e.call(this)||this;return r._iid=t,r._payload=n,r}return I(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return S({},this._payload)},enumerable:!1,configurable:!0}),t.prototype.as=function(e){return new e(this._iid,this.payload)},t}(Se),st=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t,n}return I(t,e),t}(Se),ot=function(e){function t(t){var n=t.expires_in,r=t.reason,i=void 0===r?k.SESSION_KEY_EXPIRED:r,a=t.message,s=void 0===a?"":a,o=e.call(this)||this;switch(o.expiresIn=null!=n?n:0,i){case k.SESSION_KEY_EXPIRED:case k.SESSION_TOKEN_EXPIRED:case k.SESSION_REVOKED:case k.USER_AUTH_DEACTIVATED:case k.USER_AUTH_DELETED_OR_NOT_FOUND:o.error=new z({code:i,message:s})}return o}return I(t,e),Object.defineProperty(t.prototype,"invalidateSessionToken",{get:function(){var e;return!!(null===(e=this.error)||void 0===e?void 0:e.isSessionTokenExpiredError)},enumerable:!1,configurable:!0}),t}(Se),lt=function(e){function t(t,n,r,i){void 0===i&&(i="");var a,s=this;return(s=e.call(this)||this)._iid=t,s.code=n,s.payload=r,s.requestId=null!==(a=r.req_id)&&void 0!==a?a:i,s}return I(t,e),t.createFromRawMessage=function(e,n){var r=n.substring(0,4),i={};try{i=JSON.parse(n.substring(4))}catch(e){r="NOOP"}finally{return new t(e,r,i)}},t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},t}(Se),ut=function(e){function t(t){var n,r=t.code,i=t.ackRequired,a=t.payload,s=void 0===a?{}:a,o=this;return(o=e.call(this)||this).code=r,o.payload=s,o.requestId=null!==(n=o.payload.req_id)&&void 0!==n?n:Ce(),o.ackRequired=i,o.payload.req_id=o.requestId,o}return I(t,e),t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t}(Se),ct=function(e){function t(t){var n=t.userId,r=t.authToken,i=t.services,a=t.expiringSession,s=void 0===a||a,o=e.call(this)||this;return o.path="".concat(Re,"/").concat(n,"/session_key"),o.method=Me.POST,o.params=we({token:r,services:i,expiring_session:!!s}),o.requireAuth=!1,o}return I(t,e),t}(it),dt=function(e){function t(t){var n=t.authToken,r=t.expiringSession,i=void 0===r||r,a=t.requestId,s=void 0===a?void 0:a;return e.call(this,{code:"LOGI",payload:we({token:n,expiring_session:i?1:0,req_id:s}),ackRequired:!0})||this}return I(t,e),t}(ut),ht=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.key,a=n.expires_at,s=n.services;return r.key=i,r.expiresAt=a,r.services=s,r}return I(t,e),t}(at),ft=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t,"LOGI",r)||this).error=null,a.newKey=null,a.newKey=null!==(i=r.new_key)&&void 0!==i?i:null,a.error=r.error?new z(r):null,a}return I(t,e),t}(lt),pt=function(e){function t(t){var n=e.call(this)||this;return n.statLog=t,n}return I(t,e),t}(Se),mt=function(e){function t(t){var n=t.request,r=t.deferred,i=t.error,a=void 0===i?z.requestFailed:i,s=e.call(this)||this;return s.request=n,s.deferred=r,s.error=a,s}return I(t,e),t}(Se);!function(e){e.FEATURE_LOCALCACHE="feature:local_cache",e.FEATURE_LOCALCACHE_EVENT="feature:local_cache_event",e.NOTIFICATION="noti:stats",e.WEBSOCKET_CONNECT="ws:connect",e.API_RESULT="api:result"}(rt||(rt={}));var gt,_t,vt,Et=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n}return e.payloadify=function(e){return we({stat_type:e.type,ts:e.createdAt,data:we(e.data)})},e}(),yt=function(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product},bt=function(){return!("undefined"==typeof navigator||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent))};!function(e){e.CHAT="chat",e.CALLS="calls",e.DESK="desk",e.LIVE="live",e.UIKIT_CHAT="uikit-chat",e.UIKIT_LIVE="uikit-live"}(gt||(gt={})),function(e){e.ANDROID="android",e.IOS="ios",e.JS="js",e.UNREAL="unreal",e.UNITY="unity",e.REACT_NATIVE="react-native",e.FLUTTER="flutter"}(_t||(_t={})),function(e){e.ANDROID="android",e.IOS="ios",e.WEB="web",e.MOBILE_WEB="mobile_web",e.WINDOWS="windows"}(vt||(vt={}));var Ct=function(){function e(){}return e.sendbirdSdkUserAgentWithExtension=function(e){var t=yt()?_t.REACT_NATIVE:_t.JS,n={main_sdk_info:"chat/".concat(t,"/").concat(U.SDK_VERSION),device_os_platform:bt()?"mobile-web":"web",os_version:U.OS_VERSION};if(e){var r=e.sendbirdExtensions,i=e.deviceOS,a=e.customData,s=void 0===a?{}:a;i.version&&(n.os_version=i.version),i.platform&&(n.device_os_platform=i.platform),r.length>0&&(n.extension_sdk_info=r.map((function(e){var t=e.product,n=e.platform,r=e.version;return"".concat(t,"/").concat(n,"/").concat(r)})).join(",")),Object.keys(n).forEach((function(e){return delete s[e]})),Object.keys(s).length>0&&(n=S(S({},n),s))}return Object.entries(n).map((function(e){var t=O(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join("&")},e.userAgentWithExtension=function(e){var t=yt()?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):bt()?"omobile-web":"oweb";return"".concat(t,"/c").concat(U.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},e}(),Nt=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=function(e){n(e)}}))},Tt=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t.requestId,n}return I(t,e),t}(Se),It=function(e){function t(t){var n=e.call(this)||this;return n.method=Me.DELETE,n.path="".concat(Je(t.channelType),"/").concat(t.channelUrl,"/messages/").concat(t.messageId),t.messageToken&&(n.params=we({mesg_token:t.messageToken})),n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var St=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t,"DELM",r)||this).channelUrl=r.channel_url,a.channelType=r.channel_type,a.messageId=Number(r.msg_id),a.silent=r.silent,a.messageCreatedAt=r.message_created_at?Number(r.message_created_at):-1,a.senderId=null!==(i=r.sender_id)&&void 0!==i?i:void 0,a}return I(t,e),t}(lt),wt=function(){function t(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,a=t.logger,s=t.useFetchCompat,o=void 0!==s&&s,l=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=e,this._session=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on((function(e){e instanceof st&&l.cancel(e.requestId)})),this._logger=a,this._shouldImportFetchCompat=o}return t.prototype._createHeader=function(e,t){var n=this._sdkState,r=n.appId,i=n.appVersion,a=n.sendbirdRuntimeEnvironment,s=S(S({},e.headers),{SendBird:"JS,".concat(U.OS_VERSION,",").concat(U.SDK_VERSION,",").concat(r).concat(i?",".concat(i):""),"SB-User-Agent":Ct.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":Ct.sendbirdSdkUserAgentWithExtension(a)});return t||(s["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&!e.hasSessionKey&&this._session.hasSession&&(s["Session-Key"]=this._session.sessionKey),s["App-Id"]=r,this._session&&this._session.authToken&&(s["Access-Token"]=this._session.authToken),s},t.prototype._statLogApiResult=function(e,t,n){e.path.includes("/sdk/statistics")||this._dispatcher.dispatch(new pt(new Et({type:rt.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})))},t.prototype._isBodyRequired=function(e){var t=e.method;return t!==Me.GET&&(t!==Me.DELETE||e instanceof It)},t.prototype.send=function(t){return w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b;return A(this,(function(C){switch(C.label){case 0:r=t.path,i=t.method,a=t.uploadProgressHandler,s=this._isBodyRequired(t),o=this._sdkState.api,l="".concat(o.host).concat(r).concat(s?"":t.query),u=s?t.payload:null,c=this._createHeader(t,u instanceof FormData?u:void 0),d=new AbortController,h=d.signal,this._abortControl.set(t.requestId,d),f=Date.now(),C.label=1;case 1:return C.trys.push([1,13,,14]),a?[4,n.e(11).then(n.bind(null,36))]:[3,6];case 2:p=C.sent().xmlHttpRequest,C.label=3;case 3:return C.trys.push([3,5,,6]),[4,p(this._iid,{requestId:t.requestId,method:t.method,url:l,headers:c,data:null!=u?u:void 0,uploadProgressHandler:a})];case 4:return m=C.sent(),this._logger.debug("receive api response",t.requestId),this._statLogApiResult(t,f),[2,m];case 5:if(!((g=C.sent())instanceof z&&g.code===k.XMLHTTPREQUEST_NOT_SUPPORTED))throw g;return this._logger.debug("XMLHttpRequest is not available in this environment. progressHandler is ignored."),[3,6];case 6:return this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,("undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==e&&e||{fetch:null}).fetch=null),"undefined"!=typeof AbortController?[3,8]:[4,n.e(10).then(n.t.bind(null,37,7))];case 7:C.sent(),C.label=8;case 8:return"function"==typeof fetch?[3,10]:[4,n.e(1).then(n.bind(null,16)).then(e=>e._)];case 9:C.sent(),C.label=10;case 10:return[4,fetch(l,{method:i,body:u,headers:c,signal:h})];case 11:return[4,(_=C.sent()).json()];case 12:if(v=C.sent(),_.ok||_.redirected)return this._logger.debug("receive api response",t.requestId),this._statLogApiResult(t,f),[2,new at(this._iid,v)];if(v){if((E=new z(v)).isSessionExpiredError){if(this._dispatcher.dispatch(new ot({reason:E.code,message:E.message})),!(t instanceof ct))return y=new Nt,this._dispatcher.dispatch(new mt({request:t,deferred:y,error:E})),[2,y.promise];throw E}throw E.isSessionInvalidatedError?(this._dispatcher.dispatch(new ot({reason:E.code,message:E.message})),E):E}throw z.requestFailed;case 13:throw b=C.sent(),this._statLogApiResult(t,f,b),b instanceof z?(this._logger.debug("fail api request",b),b):"AbortError"===(null==b?void 0:b.name)?z.requestCanceled:(this._logger.debug("fail api request",b),z.networkError);case 14:return[2]}}))}))},t.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e)),this._dispatcher.dispatch(new Tt({requestId:e}))},t.prototype.cancelAll=function(){var e,t;try{for(var n=M(this._abortControl.values()),r=n.next();!r.done;r=n.next())r.value.abort()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._abortControl.clear(),this._dispatcher.dispatch(new Tt({}))},t}(),At=function(){};function Mt(e){let t=e.length;for(;--t>=0;)e[t]=0}const Ot=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Rt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),kt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),xt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Dt=new Array(576);Mt(Dt);const Ut=new Array(60);Mt(Ut);const Lt=new Array(512);Mt(Lt);const Pt=new Array(256);Mt(Pt);const Ft=new Array(29);Mt(Ft);const Bt=new Array(30);function jt(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let Ht,Gt,zt;function Vt(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Mt(Bt);const qt=e=>e<256?Lt[e]:Lt[256+(e>>>7)],Kt=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Wt=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Kt(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Yt=(e,t,n)=>{Wt(e,n[2*t],n[2*t+1])},Qt=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Xt=(e,t,n)=>{const r=new Array(16);let i,a,s=0;for(i=1;i<=15;i++)s=s+n[i-1]<<1,r[i]=s;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=Qt(r[t]++,t))}},Zt=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Jt=e=>{e.bi_valid>8?Kt(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},$t=(e,t,n,r)=>{const i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]},en=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&$t(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!$t(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},tn=(e,t,n)=>{let r,i,a,s,o=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+o++],r+=(255&e.pending_buf[e.sym_buf+o++])<<8,i=e.pending_buf[e.sym_buf+o++],0===r?Yt(e,i,t):(a=Pt[i],Yt(e,a+256+1,t),s=Ot[a],0!==s&&(i-=Ft[a],Wt(e,i,s)),r--,a=qt(r),Yt(e,a,n),s=Rt[a],0!==s&&(r-=Bt[a],Wt(e,r,s)))}while(o<e.sym_next);Yt(e,256,t)},nn=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,o,l,u=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<a;s++)0!==n[2*s]?(e.heap[++e.heap_len]=u=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=u<2?++u:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=r[2*l+1]);for(t.max_code=u,s=e.heap_len>>1;s>=1;s--)en(e,n,s);l=a;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],en(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,n[2*l]=n[2*s]+n[2*o],e.depth[l]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,n[2*s+1]=n[2*o+1]=l,e.heap[1]=l++,en(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let u,c,d,h,f,p,m=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<573;u++)c=e.heap[u],h=n[2*n[2*c+1]+1]+1,h>l&&(h=l,m++),n[2*c+1]=h,c>r||(e.bl_count[h]++,f=0,c>=o&&(f=s[c-o]),p=n[2*c],e.opt_len+=p*(h+f),a&&(e.static_len+=p*(i[2*c+1]+f)));if(0!==m){do{for(h=l-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[l]--,m-=2}while(m>0);for(h=l;0!==h;h--)for(c=e.bl_count[h];0!==c;)d=e.heap[--u],d>r||(n[2*d+1]!==h&&(e.opt_len+=(h-n[2*d+1])*n[2*d],n[2*d+1]=h),c--)}})(e,t),Xt(n,u,e.bl_count)},rn=(e,t,n)=>{let r,i,a=-1,s=t[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++o<l&&i===s||(o<u?e.bl_tree[2*i]+=o:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4))},an=(e,t,n)=>{let r,i,a=-1,s=t[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++o<l&&i===s)){if(o<u)do{Yt(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==a&&(Yt(e,i,e.bl_tree),o--),Yt(e,16,e.bl_tree),Wt(e,o-3,2)):o<=10?(Yt(e,17,e.bl_tree),Wt(e,o-3,3)):(Yt(e,18,e.bl_tree),Wt(e,o-11,7));o=0,a=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4)}};let sn=!1;const on=(e,t,n,r)=>{Wt(e,0+(r?1:0),3),Jt(e),Kt(e,n),Kt(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var ln={_tr_init:e=>{sn||((()=>{let e,t,n,r,i;const a=new Array(16);for(n=0,r=0;r<28;r++)for(Ft[r]=n,e=0;e<1<<Ot[r];e++)Pt[n++]=r;for(Pt[n-1]=r,i=0,r=0;r<16;r++)for(Bt[r]=i,e=0;e<1<<Rt[r];e++)Lt[i++]=r;for(i>>=7;r<30;r++)for(Bt[r]=i<<7,e=0;e<1<<Rt[r]-7;e++)Lt[256+i++]=r;for(t=0;t<=15;t++)a[t]=0;for(e=0;e<=143;)Dt[2*e+1]=8,e++,a[8]++;for(;e<=255;)Dt[2*e+1]=9,e++,a[9]++;for(;e<=279;)Dt[2*e+1]=7,e++,a[7]++;for(;e<=287;)Dt[2*e+1]=8,e++,a[8]++;for(Xt(Dt,287,a),e=0;e<30;e++)Ut[2*e+1]=5,Ut[2*e]=Qt(e,5);Ht=new jt(Dt,Ot,257,286,15),Gt=new jt(Ut,Rt,0,30,15),zt=new jt(new Array(0),kt,0,19,7)})(),sn=!0),e.l_desc=new Vt(e.dyn_ltree,Ht),e.d_desc=new Vt(e.dyn_dtree,Gt),e.bl_desc=new Vt(e.bl_tree,zt),e.bi_buf=0,e.bi_valid=0,Zt(e)},_tr_stored_block:on,_tr_flush_block:(e,t,n,r)=>{let i,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),nn(e,e.l_desc),nn(e,e.d_desc),s=(e=>{let t;for(rn(e,e.dyn_ltree,e.l_desc.max_code),rn(e,e.dyn_dtree,e.d_desc.max_code),nn(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*xt[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t?on(e,t,n,r):4===e.strategy||a===i?(Wt(e,2+(r?1:0),3),tn(e,Dt,Ut)):(Wt(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(Wt(e,t-257,5),Wt(e,n-1,5),Wt(e,r-4,4),i=0;i<r;i++)Wt(e,e.bl_tree[2*xt[i]+1],3);an(e,e.dyn_ltree,t-1),an(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),tn(e,e.dyn_ltree,e.dyn_dtree)),Zt(e),r&&Jt(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Pt[n]+256+1)]++,e.dyn_dtree[2*qt(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{var t;Wt(e,2,3),Yt(e,256,Dt),16===(t=e).bi_valid?(Kt(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},un=(e,t,n,r)=>{let i=65535&e,a=e>>>16&65535,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{i=i+t[r++]|0,a=a+i|0}while(--s);i%=65521,a%=65521}return i|a<<16};const cn=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var dn=(e,t,n,r)=>{const i=cn,a=r+n;e^=-1;for(let n=r;n<a;n++)e=e>>>8^i[255&(e^t[n])];return~e},hn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},fn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:pn,_tr_stored_block:mn,_tr_flush_block:gn,_tr_tally:_n,_tr_align:vn}=ln,{Z_NO_FLUSH:En,Z_PARTIAL_FLUSH:yn,Z_FULL_FLUSH:bn,Z_FINISH:Cn,Z_BLOCK:Nn,Z_OK:Tn,Z_STREAM_END:In,Z_STREAM_ERROR:Sn,Z_DATA_ERROR:wn,Z_BUF_ERROR:An,Z_DEFAULT_COMPRESSION:Mn,Z_FILTERED:On,Z_HUFFMAN_ONLY:Rn,Z_RLE:kn,Z_FIXED:xn,Z_DEFAULT_STRATEGY:Dn,Z_UNKNOWN:Un,Z_DEFLATED:Ln}=fn,Pn=(e,t)=>(e.msg=hn[t],t),Fn=e=>2*e-(e>4?9:0),Bn=e=>{let t=e.length;for(;--t>=0;)e[t]=0},jn=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let Hn=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Gn=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},zn=(e,t)=>{gn(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Gn(e.strm)},Vn=(e,t)=>{e.pending_buf[e.pending++]=t},qn=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Kn=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=un(e.adler,t,i,n):2===e.state.wrap&&(e.adler=dn(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},Wn=(e,t)=>{let n,r,i=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,u=e.window,c=e.w_mask,d=e.prev,h=e.strstart+258;let f=u[a+s-1],p=u[a+s];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(n=t,u[n+s]===p&&u[n+s-1]===f&&u[n]===u[a]&&u[++n]===u[a+1]){a+=2,n++;do{}while(u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&a<h);if(r=258-(h-a),a=h-258,r>s){if(e.match_start=t,s=r,r>=o)break;f=u[a+s-1],p=u[a+s]}}}while((t=d[t&c])>l&&0!=--i);return s<=e.lookahead?s:e.lookahead},Yn=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-262)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),jn(e),r+=t),0===e.strm.avail_in)break;if(n=Kn(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Hn(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Hn(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},Qn=(e,t)=>{let n,r,i,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<a&&(0===n&&t!==Cn||t===En||n!==r+e.strm.avail_in))break;s=t===Cn&&n===r+e.strm.avail_in?1:0,mn(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Gn(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(Kn(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==En&&t!==Cn&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Kn(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,a=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=a||(r||t===Cn)&&t!==En&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,s=t===Cn&&0===e.strm.avail_in&&n===r?1:0,mn(e,e.block_start,n,s),e.block_start+=n,Gn(e.strm)),s?3:1)},Xn=(e,t)=>{let n,r;for(;;){if(e.lookahead<262){if(Yn(e),e.lookahead<262&&t===En)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Hn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=Wn(e,n)),e.match_length>=3)if(r=_n(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Hn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Hn(e,e.ins_h,e.window[e.strstart+1]);else r=_n(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(zn(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Cn?(zn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(zn(e,!1),0===e.strm.avail_out)?1:2},Zn=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<262){if(Yn(e),e.lookahead<262&&t===En)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Hn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=Wn(e,n),e.match_length<=5&&(e.strategy===On||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=_n(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Hn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(zn(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=_n(e,0,e.window[e.strstart-1]),r&&zn(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=_n(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Cn?(zn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(zn(e,!1),0===e.strm.avail_out)?1:2};function Jn(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const $n=[new Jn(0,0,0,0,Qn),new Jn(4,4,8,4,Xn),new Jn(4,5,16,8,Xn),new Jn(4,6,32,32,Xn),new Jn(4,4,16,16,Zn),new Jn(8,16,32,32,Zn),new Jn(8,16,128,128,Zn),new Jn(8,32,128,256,Zn),new Jn(32,128,258,1024,Zn),new Jn(32,258,258,4096,Zn)];function er(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ln,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Bn(this.dyn_ltree),Bn(this.dyn_dtree),Bn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Bn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Bn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const tr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||42!==t.status&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&113!==t.status&&666!==t.status?1:0},nr=e=>{if(tr(e))return Pn(e,Sn);e.total_in=e.total_out=0,e.data_type=Un;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=-2,pn(t),Tn},rr=e=>{const t=nr(e);var n;return t===Tn&&((n=e.state).window_size=2*n.w_size,Bn(n.head),n.max_lazy_match=$n[n.level].max_lazy,n.good_match=$n[n.level].good_length,n.nice_match=$n[n.level].nice_length,n.max_chain_length=$n[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},ir=(e,t,n,r,i,a)=>{if(!e)return Sn;let s=1;if(t===Mn&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||n!==Ln||r<8||r>15||t<0||t>9||a<0||a>xn||8===r&&1!==s)return Pn(e,Sn);8===r&&(r=9);const o=new er;return e.state=o,o.strm=e,o.status=42,o.wrap=s,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=a,o.method=n,rr(e)};var ar=ir,sr=(e,t)=>tr(e)||2!==e.state.wrap?Sn:(e.state.gzhead=t,Tn),or=(e,t)=>{if(tr(e)||t>Nn||t<0)return e?Pn(e,Sn):Sn;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===n.status&&t!==Cn)return Pn(e,0===e.avail_out?An:Sn);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Gn(e),0===e.avail_out)return n.last_flush=-1,Tn}else if(0===e.avail_in&&Fn(t)<=Fn(r)&&t!==Cn)return Pn(e,An);if(666===n.status&&0!==e.avail_in)return Pn(e,An);if(42===n.status&&0===n.wrap&&(n.status=113),42===n.status){let t=Ln+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Rn||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,qn(n,t),0!==n.strstart&&(qn(n,e.adler>>>16),qn(n,65535&e.adler)),e.adler=1,n.status=113,Gn(e),0!==n.pending)return n.last_flush=-1,Tn}if(57===n.status)if(e.adler=0,Vn(n,31),Vn(n,139),Vn(n,8),n.gzhead)Vn(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Vn(n,255&n.gzhead.time),Vn(n,n.gzhead.time>>8&255),Vn(n,n.gzhead.time>>16&255),Vn(n,n.gzhead.time>>24&255),Vn(n,9===n.level?2:n.strategy>=Rn||n.level<2?4:0),Vn(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Vn(n,255&n.gzhead.extra.length),Vn(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=dn(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Vn(n,0),Vn(n,0),Vn(n,0),Vn(n,0),Vn(n,0),Vn(n,9===n.level?2:n.strategy>=Rn||n.level<2?4:0),Vn(n,3),n.status=113,Gn(e),0!==n.pending)return n.last_flush=-1,Tn;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=dn(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,Gn(e),0!==n.pending)return n.last_flush=-1,Tn;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=dn(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=dn(e.adler,n.pending_buf,n.pending-r,r)),Gn(e),0!==n.pending)return n.last_flush=-1,Tn;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Vn(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=dn(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=dn(e.adler,n.pending_buf,n.pending-r,r)),Gn(e),0!==n.pending)return n.last_flush=-1,Tn;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Vn(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=dn(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Gn(e),0!==n.pending))return n.last_flush=-1,Tn;Vn(n,255&e.adler),Vn(n,e.adler>>8&255),e.adler=0}if(n.status=113,Gn(e),0!==n.pending)return n.last_flush=-1,Tn}if(0!==e.avail_in||0!==n.lookahead||t!==En&&666!==n.status){let r=0===n.level?Qn(n,t):n.strategy===Rn?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Yn(e),0===e.lookahead)){if(t===En)return 1;break}if(e.match_length=0,n=_n(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(zn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Cn?(zn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(zn(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===kn?((e,t)=>{let n,r,i,a;const s=e.window;for(;;){if(e.lookahead<=258){if(Yn(e),e.lookahead<=258&&t===En)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=s[i],r===s[++i]&&r===s[++i]&&r===s[++i])){a=e.strstart+258;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);e.match_length=258-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=_n(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=_n(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(zn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Cn?(zn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(zn(e,!1),0===e.strm.avail_out)?1:2})(n,t):$n[n.level].func(n,t);if(3!==r&&4!==r||(n.status=666),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Tn;if(2===r&&(t===yn?vn(n):t!==Nn&&(mn(n,0,0,!1),t===bn&&(Bn(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Gn(e),0===e.avail_out))return n.last_flush=-1,Tn}return t!==Cn?Tn:n.wrap<=0?In:(2===n.wrap?(Vn(n,255&e.adler),Vn(n,e.adler>>8&255),Vn(n,e.adler>>16&255),Vn(n,e.adler>>24&255),Vn(n,255&e.total_in),Vn(n,e.total_in>>8&255),Vn(n,e.total_in>>16&255),Vn(n,e.total_in>>24&255)):(qn(n,e.adler>>>16),qn(n,65535&e.adler)),Gn(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Tn:In)},lr=e=>{if(tr(e))return Sn;const t=e.state.status;return e.state=null,113===t?Pn(e,wn):Tn},ur=(e,t)=>{let n=t.length;if(tr(e))return Sn;const r=e.state,i=r.wrap;if(2===i||1===i&&42!==r.status||r.lookahead)return Sn;if(1===i&&(e.adler=un(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(Bn(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const a=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Yn(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Hn(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,Yn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=o,e.avail_in=a,r.wrap=i,Tn};const cr=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var dr=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)cr(n,t)&&(e[t]=n[t])}}return e},hr=e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n};let fr=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(x){fr=!1}const pr=new Uint8Array(256);for(let e=0;e<256;e++)pr[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;pr[254]=pr[254]=1;var mr=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,a,s=e.length,o=0;for(i=0;i<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),a=0,i=0;a<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},gr=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const a=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){a[i++]=t;continue}let s=pr[t];if(s>4)a[i++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<n;)t=t<<6|63&e[r++],s--;s>1?a[i++]=65533:t<65536?a[i++]=t:(t-=65536,a[i++]=55296|t>>10&1023,a[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&fr)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(a,i)},_r=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+pr[e[n]]>t?n:t},vr=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Er=Object.prototype.toString,{Z_NO_FLUSH:yr,Z_SYNC_FLUSH:br,Z_FULL_FLUSH:Cr,Z_FINISH:Nr,Z_OK:Tr,Z_STREAM_END:Ir,Z_DEFAULT_COMPRESSION:Sr,Z_DEFAULT_STRATEGY:wr,Z_DEFLATED:Ar}=fn;function Mr(e){this.options=dr({level:Sr,method:Ar,chunkSize:16384,windowBits:15,memLevel:8,strategy:wr},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vr,this.strm.avail_out=0;let n=ar(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Tr)throw new Error(hn[n]);if(t.header&&sr(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?mr(t.dictionary):"[object ArrayBuffer]"===Er.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=ur(this.strm,e),n!==Tr)throw new Error(hn[n]);this._dict_set=!0}}function Or(e,t){const n=new Mr(t);if(n.push(e,!0),n.err)throw n.msg||hn[n.err];return n.result}Mr.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Nr:yr,"string"==typeof e?n.input=mr(e):"[object ArrayBuffer]"===Er.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===br||a===Cr)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=or(n,a),i===Ir)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=lr(this.strm),this.onEnd(i),this.ended=!0,i===Tr;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Mr.prototype.onData=function(e){this.chunks.push(e)},Mr.prototype.onEnd=function(e){e===Tr&&(this.result=hr(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Rr={Deflate:Mr,deflate:Or,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Or(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Or(e,t)}};var kr=function(e,t){let n,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I;const S=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,I=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),o=S.dmax,l=S.wsize,u=S.whave,c=S.wnext,d=S.window,h=S.hold,f=S.bits,p=S.lencode,m=S.distcode,g=(1<<S.lenbits)-1,_=(1<<S.distbits)-1;e:do{f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),v=p[h&g];t:for(;;){if(E=v>>>24,h>>>=E,f-=E,E=v>>>16&255,0===E)I[i++]=65535&v;else{if(!(16&E)){if(64&E){if(32&E){S.mode=16191;break e}e.msg="invalid literal/length code",S.mode=16209;break e}v=p[(65535&v)+(h&(1<<E)-1)];continue t}for(y=65535&v,E&=15,E&&(f<E&&(h+=T[n++]<<f,f+=8),y+=h&(1<<E)-1,h>>>=E,f-=E),f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),v=m[h&_];;){if(E=v>>>24,h>>>=E,f-=E,E=v>>>16&255,16&E){if(b=65535&v,E&=15,f<E&&(h+=T[n++]<<f,f+=8,f<E&&(h+=T[n++]<<f,f+=8)),b+=h&(1<<E)-1,b>o){e.msg="invalid distance too far back",S.mode=16209;break e}if(h>>>=E,f-=E,E=i-a,b>E){if(E=b-E,E>u&&S.sane){e.msg="invalid distance too far back",S.mode=16209;break e}if(C=0,N=d,0===c){if(C+=l-E,E<y){y-=E;do{I[i++]=d[C++]}while(--E);C=i-b,N=I}}else if(c<E){if(C+=l+c-E,E-=c,E<y){y-=E;do{I[i++]=d[C++]}while(--E);if(C=0,c<y){E=c,y-=E;do{I[i++]=d[C++]}while(--E);C=i-b,N=I}}}else if(C+=c-E,E<y){y-=E;do{I[i++]=d[C++]}while(--E);C=i-b,N=I}for(;y>2;)I[i++]=N[C++],I[i++]=N[C++],I[i++]=N[C++],y-=3;y&&(I[i++]=N[C++],y>1&&(I[i++]=N[C++]))}else{C=i-b;do{I[i++]=I[C++],I[i++]=I[C++],I[i++]=I[C++],y-=3}while(y>2);y&&(I[i++]=I[C++],y>1&&(I[i++]=I[C++]))}break}if(64&E){e.msg="invalid distance code",S.mode=16209;break e}v=m[(65535&v)+(h&(1<<E)-1)]}}break}}while(n<r&&i<s);y=f>>3,n-=y,f-=y<<3,h&=(1<<f)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<s?s-i+257:257-(i-s),S.hold=h,S.bits=f};const xr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Dr=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ur=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Lr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Pr=(e,t,n,r,i,a,s,o)=>{const l=o.bits;let u,c,d,h,f,p,m=0,g=0,_=0,v=0,E=0,y=0,b=0,C=0,N=0,T=0,I=null;const S=new Uint16Array(16),w=new Uint16Array(16);let A,M,O,R=null;for(m=0;m<=15;m++)S[m]=0;for(g=0;g<r;g++)S[t[n+g]]++;for(E=l,v=15;v>=1&&0===S[v];v--);if(E>v&&(E=v),0===v)return i[a++]=20971520,i[a++]=20971520,o.bits=1,0;for(_=1;_<v&&0===S[_];_++);for(E<_&&(E=_),C=1,m=1;m<=15;m++)if(C<<=1,C-=S[m],C<0)return-1;if(C>0&&(0===e||1!==v))return-1;for(w[1]=0,m=1;m<15;m++)w[m+1]=w[m]+S[m];for(g=0;g<r;g++)0!==t[n+g]&&(s[w[t[n+g]]++]=g);if(0===e?(I=R=s,p=20):1===e?(I=xr,R=Dr,p=257):(I=Ur,R=Lr,p=0),T=0,g=0,m=_,f=a,y=E,b=0,d=-1,N=1<<E,h=N-1,1===e&&N>852||2===e&&N>592)return 1;for(;;){A=m-b,s[g]+1<p?(M=0,O=s[g]):s[g]>=p?(M=R[s[g]-p],O=I[s[g]-p]):(M=96,O=0),u=1<<m-b,c=1<<y,_=c;do{c-=u,i[f+(T>>b)+c]=A<<24|M<<16|O}while(0!==c);for(u=1<<m-1;T&u;)u>>=1;if(0!==u?(T&=u-1,T+=u):T=0,g++,0==--S[m]){if(m===v)break;m=t[n+s[g]]}if(m>E&&(T&h)!==d){for(0===b&&(b=E),f+=_,y=m-b,C=1<<y;y+b<v&&(C-=S[y+b],!(C<=0));)y++,C<<=1;if(N+=1<<y,1===e&&N>852||2===e&&N>592)return 1;d=T&h,i[d]=E<<24|y<<16|f-a}}return 0!==T&&(i[f+T]=m-b<<24|64<<16),o.bits=E,0};const{Z_FINISH:Fr,Z_BLOCK:Br,Z_TREES:jr,Z_OK:Hr,Z_STREAM_END:Gr,Z_NEED_DICT:zr,Z_STREAM_ERROR:Vr,Z_DATA_ERROR:qr,Z_MEM_ERROR:Kr,Z_BUF_ERROR:Wr,Z_DEFLATED:Yr}=fn,Qr=16209,Xr=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Zr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Jr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<16180||t.mode>16211?1:0},$r=e=>{if(Jr(e))return Vr;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=16180,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Hr},ei=e=>{if(Jr(e))return Vr;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,$r(e)},ti=(e,t)=>{let n;if(Jr(e))return Vr;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Vr:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,ei(e))},ni=(e,t)=>{if(!e)return Vr;const n=new Zr;e.state=n,n.strm=e,n.window=null,n.mode=16180;const r=ti(e,t);return r!==Hr&&(e.state=null),r};let ri,ii,ai=!0;const si=e=>{if(ai){ri=new Int32Array(512),ii=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Pr(1,e.lens,0,288,ri,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Pr(2,e.lens,0,32,ii,0,e.work,{bits:5}),ai=!1}e.lencode=ri,e.lenbits=9,e.distcode=ii,e.distbits=5},oi=(e,t,n,r)=>{let i;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(n-r,n-r+i),a.wnext),(r-=i)?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var li=ei,ui=ni,ci=(e,t)=>{let n,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T=0;const I=new Uint8Array(4);let S,w;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Jr(e)||!e.output||!e.input&&0!==e.avail_in)return Vr;n=e.state,16191===n.mode&&(n.mode=16192),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,u=n.hold,c=n.bits,d=o,h=l,N=Hr;e:for(;;)switch(n.mode){case 16180:if(0===n.wrap){n.mode=16192;break}for(;c<16;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,I[0]=255&u,I[1]=u>>>8&255,n.check=dn(n.check,I,2,0),u=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=Qr;break}if((15&u)!==Yr){e.msg="unknown compression method",n.mode=Qr;break}if(u>>>=4,c-=4,C=8+(15&u),0===n.wbits&&(n.wbits=C),C>15||C>n.wbits){e.msg="invalid window size",n.mode=Qr;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&u?16189:16191,u=0,c=0;break;case 16181:for(;c<16;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(n.flags=u,(255&n.flags)!==Yr){e.msg="unknown compression method",n.mode=Qr;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Qr;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(I[0]=255&u,I[1]=u>>>8&255,n.check=dn(n.check,I,2,0)),u=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(I[0]=255&u,I[1]=u>>>8&255,I[2]=u>>>16&255,I[3]=u>>>24&255,n.check=dn(n.check,I,4,0)),u=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(I[0]=255&u,I[1]=u>>>8&255,n.check=dn(n.check,I,2,0)),u=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(I[0]=255&u,I[1]=u>>>8&255,n.check=dn(n.check,I,2,0)),u=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>o&&(f=o),f&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),C)),512&n.flags&&4&n.wrap&&(n.check=dn(n.check,r,f,a)),o-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break e;f=0;do{C=r[a+f++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=dn(n.check,r,f,a)),o-=f,a+=f,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break e;f=0;do{C=r[a+f++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=dn(n.check,r,f,a)),o-=f,a+=f,C)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(4&n.wrap&&u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Qr;break}u=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=16191;break;case 16189:for(;c<32;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}e.adler=n.check=Xr(u),u=0,c=0,n.mode=16190;case 16190:if(0===n.havedict)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,n.hold=u,n.bits=c,zr;e.adler=n.check=1,n.mode=16191;case 16191:if(t===Br||t===jr)break e;case 16192:if(n.last){u>>>=7&c,c-=7&c,n.mode=16206;break}for(;c<3;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}switch(n.last=1&u,u>>>=1,c-=1,3&u){case 0:n.mode=16193;break;case 1:if(si(n),n.mode=16199,t===jr){u>>>=2,c-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Qr}u>>>=2,c-=2;break;case 16193:for(u>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Qr;break}if(n.length=65535&u,u=0,c=0,n.mode=16194,t===jr)break e;case 16194:n.mode=16195;case 16195:if(f=n.length,f){if(f>o&&(f=o),f>l&&(f=l),0===f)break e;i.set(r.subarray(a,a+f),s),o-=f,a+=f,l-=f,s+=f,n.length-=f;break}n.mode=16191;break;case 16196:for(;c<14;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(n.nlen=257+(31&u),u>>>=5,c-=5,n.ndist=1+(31&u),u>>>=5,c-=5,n.ncode=4+(15&u),u>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Qr;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}n.lens[A[n.have++]]=7&u,u>>>=3,c-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},N=Pr(0,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,N){e.msg="invalid code lengths set",n.mode=Qr;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;T=n.lencode[u&(1<<n.lenbits)-1],g=T>>>24,_=T>>>16&255,v=65535&T,!(g<=c);){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(v<16)u>>>=g,c-=g,n.lens[n.have++]=v;else{if(16===v){for(w=g+2;c<w;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(u>>>=g,c-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=Qr;break}C=n.lens[n.have-1],f=3+(3&u),u>>>=2,c-=2}else if(17===v){for(w=g+3;c<w;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}u>>>=g,c-=g,C=0,f=3+(7&u),u>>>=3,c-=3}else{for(w=g+7;c<w;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}u>>>=g,c-=g,C=0,f=11+(127&u),u>>>=7,c-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Qr;break}for(;f--;)n.lens[n.have++]=C}}if(n.mode===Qr)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Qr;break}if(n.lenbits=9,S={bits:n.lenbits},N=Pr(1,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,N){e.msg="invalid literal/lengths set",n.mode=Qr;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},N=Pr(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,N){e.msg="invalid distances set",n.mode=Qr;break}if(n.mode=16199,t===jr)break e;case 16199:n.mode=16200;case 16200:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,n.hold=u,n.bits=c,kr(e,h),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,u=n.hold,c=n.bits,16191===n.mode&&(n.back=-1);break}for(n.back=0;T=n.lencode[u&(1<<n.lenbits)-1],g=T>>>24,_=T>>>16&255,v=65535&T,!(g<=c);){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(_&&!(240&_)){for(E=g,y=_,b=v;T=n.lencode[b+((u&(1<<E+y)-1)>>E)],g=T>>>24,_=T>>>16&255,v=65535&T,!(E+g<=c);){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}u>>>=E,c-=E,n.back+=E}if(u>>>=g,c-=g,n.back+=g,n.length=v,0===_){n.mode=16205;break}if(32&_){n.back=-1,n.mode=16191;break}if(64&_){e.msg="invalid literal/length code",n.mode=Qr;break}n.extra=15&_,n.mode=16201;case 16201:if(n.extra){for(w=n.extra;c<w;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;T=n.distcode[u&(1<<n.distbits)-1],g=T>>>24,_=T>>>16&255,v=65535&T,!(g<=c);){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(!(240&_)){for(E=g,y=_,b=v;T=n.distcode[b+((u&(1<<E+y)-1)>>E)],g=T>>>24,_=T>>>16&255,v=65535&T,!(E+g<=c);){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}u>>>=E,c-=E,n.back+=E}if(u>>>=g,c-=g,n.back+=g,64&_){e.msg="invalid distance code",n.mode=Qr;break}n.offset=v,n.extra=15&_,n.mode=16203;case 16203:if(n.extra){for(w=n.extra;c<w;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Qr;break}n.mode=16204;case 16204:if(0===l)break e;if(f=h-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Qr;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),m=n.window}else m=i,p=s-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{i[s++]=m[p++]}while(--f);0===n.length&&(n.mode=16200);break;case 16205:if(0===l)break e;i[s++]=n.length,l--,n.mode=16200;break;case 16206:if(n.wrap){for(;c<32;){if(0===o)break e;o--,u|=r[a++]<<c,c+=8}if(h-=l,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?dn(n.check,i,h,s-h):un(n.check,i,h,s-h)),h=l,4&n.wrap&&(n.flags?u:Xr(u))!==n.check){e.msg="incorrect data check",n.mode=Qr;break}u=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===o)break e;o--,u+=r[a++]<<c,c+=8}if(4&n.wrap&&u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Qr;break}u=0,c=0}n.mode=16208;case 16208:N=Gr;break e;case Qr:N=qr;break e;case 16210:return Kr;default:return Vr}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,n.hold=u,n.bits=c,(n.wsize||h!==e.avail_out&&n.mode<Qr&&(n.mode<16206||t!==Fr))&&oi(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?dn(n.check,i,h,e.next_out-h):un(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(16191===n.mode?128:0)+(16199===n.mode||16194===n.mode?256:0),(0===d&&0===h||t===Fr)&&N===Hr&&(N=Wr),N},di=e=>{if(Jr(e))return Vr;let t=e.state;return t.window&&(t.window=null),e.state=null,Hr},hi=(e,t)=>{if(Jr(e))return Vr;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,Hr):Vr},fi=(e,t)=>{const n=t.length;let r,i,a;return Jr(e)?Vr:(r=e.state,0!==r.wrap&&16190!==r.mode?Vr:16190===r.mode&&(i=1,i=un(i,t,n,0),i!==r.check)?qr:(a=oi(e,t,n,n),a?(r.mode=16210,Kr):(r.havedict=1,Hr)))},pi=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const mi=Object.prototype.toString,{Z_NO_FLUSH:gi,Z_FINISH:_i,Z_OK:vi,Z_STREAM_END:Ei,Z_NEED_DICT:yi,Z_STREAM_ERROR:bi,Z_DATA_ERROR:Ci,Z_MEM_ERROR:Ni}=fn;function Ti(e){this.options=dr({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vr,this.strm.avail_out=0;let n=ui(this.strm,t.windowBits);if(n!==vi)throw new Error(hn[n]);if(this.header=new pi,hi(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=mr(t.dictionary):"[object ArrayBuffer]"===mi.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=fi(this.strm,t.dictionary),n!==vi)))throw new Error(hn[n])}function Ii(e,t){const n=new Ti(t);if(n.push(e),n.err)throw n.msg||hn[n.err];return n.result}Ti.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(s=t===~~t?t:!0===t?_i:gi,"[object ArrayBuffer]"===mi.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=ci(n,s),a===yi&&i&&(a=fi(n,i),a===vi?a=ci(n,s):a===Ci&&(a=yi));n.avail_in>0&&a===Ei&&n.state.wrap>0&&0!==e[n.next_in];)li(n),a=ci(n,s);switch(a){case bi:case Ci:case yi:case Ni:return this.onEnd(a),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||a===Ei))if("string"===this.options.to){let e=_r(n.output,n.next_out),t=n.next_out-e,i=gr(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==vi||0!==o){if(a===Ei)return a=di(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Ti.prototype.onData=function(e){this.chunks.push(e)},Ti.prototype.onEnd=function(e){e===vi&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=hr(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Si={Inflate:Ti,inflate:Ii,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Ii(e,t)},ungzip:Ii};const{Deflate:wi,deflate:Ai,deflateRaw:Mi,gzip:Oi}=Rr,{Inflate:Ri,inflate:ki,inflateRaw:xi,ungzip:Di}=Si;var Ui,Li={Deflate:wi,deflate:Ai,deflateRaw:Mi,gzip:Oi,Inflate:Ri,inflate:ki,inflateRaw:xi,ungzip:Di,constants:fn},Pi=function(e){return w(void 0,0,void 0,(function(){var t;return A(this,(function(n){return t=Li.ungzip(e),[2,String.fromCharCode.apply(null,t)]}))}))},Fi=function(e){return w(void 0,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof z))throw t;return t.throwOutside(),[3,3];case 3:return[2]}}))}))},Bi=function(e){return w(void 0,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}}))}))};!function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED"}(Ui||(Ui={}));var ji,Hi=function(e){function t(t,n){var r=n.sdkState,i=n.dispatcher,a=n.logger,s=e.call(this)||this;return s.lastActive=0,s._iid=t,s._sdkState=r,s._dispatcher=i,s._logger=a,s}return I(t,e),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===Ui.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return Ui.CONNECTING;case 1:return Ui.OPEN}return Ui.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){var e;return null!==(e=this._ws)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach((function(e){if(e){var n=lt.createFromRawMessage(t._iid,e);if(t._logger.debug("receive websocket event",n),"LOGI"===n.code)t.dispatch("message",n);else if("PONG"===n.code)t.dispatch("pong");else if("EXPR"===n.code){if(n.payload){var r=new ot(n.payload);r.expiresIn>=0&&t._dispatcher.dispatch(r)}}else"NOOP"===n.code||t.dispatch("message",n)}}))},t.prototype.connect=function(e,t){return void 0===t&&(t=""),w(this,0,void 0,(function(){var i=this;return A(this,(function(a){switch(a.label){case 0:return"function"==typeof fetch?[3,2]:[4,n.e(1).then(n.bind(null,16)).then(e=>e._)];case 1:a.sent(),a.label=2;case 2:return Bi((function(){return w(i,0,void 0,(function(){return A(this,(function(e){return fetch(this._sdkState.api.host),[2]}))}))})),this._ws=new WebSocket(e,encodeURIComponent(t)),this._ws.onopen=function(){i._logger.debug("websocket open"),i.dispatch("open")},this._ws.onmessage=function(e){return w(i,0,void 0,(function(){var t,n,i,a,s,o,l,u=this;return A(this,(function(c){switch(c.label){case 0:return(null===(l=this._sdkState.websocket)||void 0===l?void 0:l.compression)?e.data instanceof Blob?((t=new FileReader).readAsArrayBuffer(e.data),t.onloadend=function(){return w(u,0,void 0,(function(){var e,n;return A(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Pi(t.result)];case 1:return e=r.sent(),this._handleMessage(e),[3,3];case 2:return n=r.sent(),this.error(n),[3,3];case 3:return[2]}}))}))},[3,12]):[3,1]:[3,13];case 1:if(!(e.data instanceof ArrayBuffer))return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,Pi(new Uint8Array(e.data))];case 3:return s=c.sent(),this._handleMessage(s),[3,5];case 4:return n=c.sent(),this.error(n),[3,5];case 5:return[3,12];case 6:if(!(void 0!==r&&e.data instanceof r))return[3,11];c.label=7;case 7:return c.trys.push([7,9,,10]),i=e.data,a=i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength),[4,Pi(a)];case 8:return s=c.sent(),this._handleMessage(s),[3,10];case 9:return o=c.sent(),this.error(o),[3,10];case 10:return[3,12];case 11:"string"==typeof e.data&&this._handleMessage(e.data),c.label=12;case 12:return[3,14];case 13:this._handleMessage(e.data),c.label=14;case 14:return[2]}}))}))},this._ws.onerror=function(){i._logger.debug("websocket error"),i.dispatch("error",z.networkError)},this._ws.onclose=function(e){i._logger.debug("websocket close",e.code,e.reason),i.cleanUpWebSocket(),i.dispatch("close")},this.lastActive=Date.now(),[2]}}))}))},t.prototype.cleanUpWebSocket=function(){this._ws&&(this._ws.onopen=At,this._ws.onmessage=At,this._ws.onerror=At,this._ws.onclose=At,this.connectionState===Ui.OPEN&&this._ws.close(1e3,"Normal Closure"),this._ws=void 0)},t.prototype.disconnect=function(){var e=this;return new Promise((function(t){if(e._ws){if(e.connectionState===Ui.CLOSED)return e.cleanUpWebSocket(),void t();e._ws.onclose=function(){e.cleanUpWebSocket(),e.dispatch("close"),t()},e._ws.close()}else t()}))},t.prototype.send=function(e){if(!this._ws)throw z.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},t}(Te),Gi=function(e){function t(t){var n=t.all,r=t.feed,i=t.custom_types,a=t.ts,s=e.call(this)||this;return s.all=n,s.feed=r,s.customTypes=i,s.ts=a,s}return I(t,e),t}(Se),zi=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,a=t.logger,s=t.useFetchCompat,o=void 0!==s&&s,l=this;this._ackStateMap=new Map,this._sdkState=r,this._dispatcher=i,this._logger=a,this.apiClient=new wt(e,{session:n,sdkState:r,dispatcher:i,logger:a,useFetchCompat:o}),this.websocketClient=new Hi(e,{sdkState:r,dispatcher:i,logger:a}),this.websocketClient.on("message",(function(e){if(e.payload.unread_cnt&&l._dispatcher.dispatch(new Gi(e.payload.unread_cnt)),e.requestId){if(l._ackStateMap.has(e.requestId)){var t=l._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new z({code:e.payload.code,message:e.payload.message}))}}else l._dispatcher.dispatch(e)})).on("close",(function(){l._ackStateMap.forEach((function(e){e.reject(z.connectionClosed)})),l._ackStateMap.clear()}))}return e.prototype._sendApiRequest=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this.apiClient.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype._sendWebsocketRequest=function(e){return w(this,0,void 0,(function(){var t,n,r,i=this;return A(this,(function(a){if(!this._sdkState.websocket)throw z.connectionRequired;if(t=new Nt,e.ackRequired){r=function(r,a){i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",e.requestId,r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId,e),i._logger.debug("receive websocket ack",a),t.resolve(a)))};try{n=setTimeout((function(){return r(z.noAckTimeout)}),this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(void 0,e)},reject:function(e){return r(e)}}),this.websocketClient.send(e)}catch(e){r(e)}}else try{this.websocketClient.send(e),t.resolve()}catch(e){t.reject(e)}return[2,t.promise]}))}))},e.prototype.send=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return e instanceof it?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return e instanceof ut?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw z.invalidParameters}}))}))},e.prototype.cancel=function(e){this.apiClient.cancel(e)},e.prototype.cancelAll=function(){this.apiClient.cancelAll()},e}();!function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT"}(ji||(ji={}));var Vi,qi,Ki=function(e){function t(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r}return I(t,e),t}(Se),Wi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t}(Se),Yi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t}(Se),Qi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t}(Se),Xi=function(){function e(e){var t,n,r,i;this.isEnabled=null!==(t=e.enabled)&&void 0!==t&&t,this.feedChannels=null!==(n=e.feed_channels)&&void 0!==n?n:{},this.templateListToken=null!==(r=e.template_list_token)&&void 0!==r?r:null,this.settingsUpdatedAt=null!==(i=e.settings_updated_at)&&void 0!==i?i:0}return e.payloadify=function(e){return we(Ae({enabled:e.isEnabled,feed_channels:e.feedChannels,template_list_token:e.templateListToken,settings_updated_at:e.settingsUpdatedAt}))},e}(),Zi=function(e){return"sendbird@".concat(e,"/changelog_include_chat_notifications")},Ji=function(){function e(e){var t;this.lastUpdatedAt=null!==(t=e.last_updated_at)&&void 0!==t?t:0}return e.payloadify=function(e){return we(Ae({last_updated_at:e.lastUpdatedAt}))},e}(),$i=function(){function e(e){var t;this.token=null!==(t=e.template_list_token)&&void 0!==t?t:""}return e.payloadify=function(e){return we(Ae({template_list_token:e.token}))},e}(),ea=function(){function e(e){void 0===e&&(e={min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}),this.minStatCount=e.min_stat_count,this.minInterval=1e3*e.min_interval,this.maxStatCountPerRequest=e.max_stat_count_per_request,this.lowerThreshold=e.lower_threshold,this.requestDelayRange=1e3*e.request_delay_range}return e.payloadify=function(e){return we(Ae({min_stat_count:e.minStatCount,min_interval:e.minInterval/1e3,max_stat_count_per_request:e.maxStatCountPerRequest,lower_threshold:e.lowerThreshold,request_delay_range:e.requestDelayRange/1e3}))},e}(),ta=function(){function e(e){void 0===e&&(e={default:{min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}}),this.default=new ea(e.default),this.realTime=new ea(e.realtime)}return e.payloadify=function(e){return we(Ae({default:ea.payloadify(e.default),realtime:ea.payloadify(e.realTime)}))},e}();!function(e){e[e.NONE=0]="NONE",e[e.INCLUDE_REPLY=1]="INCLUDE_REPLY",e[e.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",e[e.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"}(Vi||(Vi={})),function(e){e[e.NONE=0]="NONE",e[e.INCLUDE_REPLY=1]="INCLUDE_REPLY",e[e.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",e[e.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"}(qi||(qi={}));var na=function(){function e(e){var t,n,r,i,a,s,o,l,u;void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?1048576*e.file_upload_size_limit:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=null!==(t=e.application_attributes)&&void 0!==t?t:[],this.premiumFeatureList=null!==(n=e.premium_feature_list)&&void 0!==n?n:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=null!==(r=e.multiple_file_send_max_size)&&void 0!==r?r:5,this.allowSdkStatsUpload=null===(i=e.allow_sdk_log_ingestion)||void 0===i||i,this.unreadCountThreadingPolicy=null!==(a=e.unread_cnt_threading_policy)&&void 0!==a?a:Vi.NONE,this.lastMessageThreadingPolicy=null!==(s=e.last_msg_threading_policy)&&void 0!==s?s:qi.NONE,this.uikitConfigInfo=new Ji(null!==(o=e.uikit_config)&&void 0!==o?o:{}),this.notificationInfo=e.notifications?new Xi(e.notifications):null,this.messageTemplateInfo=e.message_template?new $i(e.message_template):null,this.statConfigInfo=e.log_publish_config?new ta(e.log_publish_config):new ta,this.disableSuperGroupMack=null!==(l=e.disable_supergroup_mack)&&void 0!==l&&l,this.configSyncNeeded=null!==(u=e.config_sync_needed)&&void 0!==u&&u}return e.payloadify=function(e){return we(Ae({emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/1048576,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction,allow_sdk_log_ingestion:e.allowSdkStatsUpload,unread_cnt_threading_policy:e.unreadCountThreadingPolicy,last_msg_threading_policy:e.lastMessageThreadingPolicy,uikit_config:e.uikitConfigInfo?Ji.payloadify(e.uikitConfigInfo):null,notifications:e.notificationInfo?Xi.payloadify(e.notificationInfo):null,message_template:e.messageTemplateInfo?$i.payloadify(e.messageTemplateInfo):null,log_publish_config:e.statConfigInfo?ta.payloadify(e.statConfigInfo):null,disable_supergroup_mack:e.disableSuperGroupMack,config_sync_needed:e.configSyncNeeded}))},e}(),ra=function(e){return"sendbird@".concat(e,"/app_configs_info")},ia=function(){function e(e){this._iid="",this._iid=e}return e.payloadify=function(e){return{}},e}(),aa=function(e){function t(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=Me.POST,i.path="".concat(Re,"/").concat(n,"/metadata"),i.params={metadata:r},i}return I(t,e),t}(it),sa=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r}return I(t,e),t}(at),oa=function(e){function t(t){var n=t.userId,r=t.metadata,i=t.upsert,a=e.call(this)||this;return a.method=Me.PUT,a.path="".concat(Re,"/").concat(n,"/metadata"),a.params={metadata:r,upsert:i},a}return I(t,e),t}(it),la=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metadata=n,r}return I(t,e),t}(at),ua=function(e){function t(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Re,"/").concat(n,"/metadata/").concat(r),i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var ca=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.DELETE,r.path="".concat(Re,"/").concat(n,"/metadata"),r}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var da,ha=function(e,t){var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n},fa=function(e,t){return JSON.parse(JSON.stringify(e))},pa=function(e){return{do:function(t){e||t()},throw:function(t){if(!e)throw t}}};!function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable"}(da||(da={}));var ma,ga=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g=this;return(g=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",g.nickname=null!==(s=null!==(a=n.nickname)&&void 0!==a?a:n.name)&&void 0!==s?s:"",g.plainProfileUrl=null!==(l=null!==(o=n.profile_url)&&void 0!==o?o:n.image)&&void 0!==l?l:"",g.requireAuth=null!==(u=n.require_auth_for_profile_image)&&void 0!==u&&u,g.metaData=null!==(c=n.metadata)&&void 0!==c?c:{},g.connectionStatus=da.NON_AVAILABLE,Y(da,n.is_online)?g.connectionStatus=n.is_online:W("boolean",n.is_online)&&(g.connectionStatus=n.is_online?da.ONLINE:da.OFFLINE),g.isActive=null===(d=n.is_active)||void 0===d||d,g.lastSeenAt=null!==(h=n.last_seen_at)&&void 0!==h?h:null,g.preferredLanguages=n.preferred_languages?R([],O(n.preferred_languages),!1):null,g.friendDiscoveryKey=null!==(f=n.friend_discovery_key)&&void 0!==f?f:null,g.friendName=null!==(p=n.friend_name)&&void 0!==p?p:null,g._hashValue=g._generateHashValue(),g._updatedAt=null!==(m=n.updatedat)&&void 0!==m?m:0,g}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})))},t._buildUserFromSerializedData=function(e){var n=fa(e);return new t(n._iid,t.payloadify(n))},t.prototype._generateHashValue=function(){for(var e,t=JSON.stringify({userId:this.userId,nickname:this.nickname,plainProfileUrl:this.plainProfileUrl,friendDiscoveryKey:this.friendDiscoveryKey,friendName:this.friendName,metaData:JSON.stringify(this.metaData),performanceLanguages:null===(e=this.preferredLanguages)||void 0===e?void 0:e.toString(),requireAuth:this.requireAuth}),n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n|=0;return n},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=ms.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return ha(this)},t.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return W("string",e)}))},t.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]}))},t.prototype.createMetaData=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(this._isValidMetaData(e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new aa({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return a=o.sent(),s=a.as(sa).metaData,this._applyMetaData(s),[2,this.metaData]}}))}))},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return pa(this._isValidMetaData(e)).throw(z.invalidParameters),n=ms.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new oa({userId:r.userId,metadata:e,upsert:t}),[4,i.send(a)];case 1:return s=l.sent(),o=s.as(la).metadata,this._applyMetaData(o),[2,this.metaData]}}))}))},t.prototype.deleteMetaData=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new ua({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return s.sent(),this._applyMetaData(((a={})[e]=!0,a),!0),[2,this.metaData]}}))}))},t.prototype.deleteAllMetaData=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new ca({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2]}}))}))},t}(ia),_a=function(e){function t(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r}return I(t,e),t}(Se),va=function(){function e(e,t){var n,r,i,a,s,o,l,u,c,d,h,f,p,m;this._iid=e,this.appInfo=new na(t),this.user=new ga(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(s=null===(a=t.reconnect)||void 0===a?void 0:a.interval)&&void 0!==s?s:3e3,this.reconnectMaxInterval=null!==(l=null===(o=t.reconnect)||void 0===o?void 0:o.max_interval)&&void 0!==l?l:6e4,this.reconnectRetryCount=null!==(c=null===(u=t.reconnect)||void 0===u?void 0:u.retry_cnt)&&void 0!==c?c:5,this.reconnectIntervalMultiple=null!==(h=null===(d=t.reconnect)||void 0===d?void 0:d.mul)&&void 0!==h?h:2,this.maxUnreadCountOnSuperGroup=null!==(f=t.max_unread_cnt_on_super_group)&&void 0!==f?f:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(p=t.concurrent_call_limit)&&void 0!==p?p:5,this.backOffDelay=null!==(m=t.back_off_delay)&&void 0!==m?m:100}return e.payloadify=function(e){return we(Ae(S(S(S({},ga.payloadify(e.user)),na.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})))},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=ms.of(this._iid);r.sdkState.websocket&&(r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10}}),r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new _a({userProfile:this}))},e}(),Ea=function(e){function t(t){var n=t.request,r=void 0===n||n,i=t.features,a=void 0===i?{}:i,s=t.options,o=void 0===s?{}:s,l=t.statConfigInfo,u=e.call(this)||this;return u.request=r,u.features=S({localCache:!0,notification:!0},a),u.options=S({ingestion:!0},o),u.statConfigInfo=l,u}return I(t,e),t}(Se),ya=function(e){function t(t){var n=e.call(this)||this;return n.configSyncNeeded=!1,n.configSyncNeeded=t,n}return I(t,e),t}(Se),ba=function(e){function t(t,n,r){var i,a,s,o,l=this;return(l=e.call(this,t,n,r)||this).error=null,l.services=[],l.userProfile=new va(t,r),l.deviceTokenLastDeletedAt=null!==(i=r.device_token_last_deleted_at)&&void 0!==i?i:0,l.key=null!==(a=r.key)&&void 0!==a?a:"",l.ekey=null!==(s=r.ekey)&&void 0!==s?s:"",l.error=r.error?new z(r):null,l.services=null!==(o=r.services)&&void 0!==o?o:[],l}return I(t,e),t.asError=function(e){return new t("","LOGI",S({user_id:"",error:!0},e))},t.prototype.applyTo=function(e){return w(this,0,void 0,(function(){var t,n,r;return A(this,(function(i){switch(i.label){case 0:return this.error?[3,4]:(t=ms.of(e))?(n=t.sessionManager,r=t.dispatcher,[4,n.login(this)]):[3,2];case 1:return i.sent(),this.userProfile.apply(),r.dispatch(new ya(this.userProfile.appInfo.configSyncNeeded)),r.dispatch(new Ea({request:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"),notification:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish")},options:{ingestion:this.userProfile.appInfo.allowSdkStatsUpload},statConfigInfo:this.userProfile.appInfo.statConfigInfo})),[3,3];case 2:throw z.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}}))}))},t}(lt),Ca=function(){function e(){this.type=ji.NONE,this.name="none"}return e.prototype.run=function(e){return w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},e.prototype.onConnect=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,t.cause,w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},e.prototype.onDisconnectWebSocket=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},e.prototype.onLogout=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},e}(),Na=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this)||this).type=ji.LOGOUT,r.name="logout",r._wasPreviouslyConnected=null===(n=t.wasPreviouslyConnected)||void 0===n||n,r}return I(t,e),t.prototype.run=function(e){return w(this,0,void 0,(function(){var t,n,r=this;return A(this,(function(i){switch(i.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return i.sent(),[4,e.changeState(new Ua,t)];case 2:return i.sent(),this._wasPreviouslyConnected&&Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onDisconnected&&e.onDisconnected(n)})),[2]}))}))})),[2]}}))}))},t}(Ca),Ta=function(e){function t(){var t=e.call(this)||this;return t.type=ji.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t}return I(t,e),t.prototype.run=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.disconnect()];case 1:return t.sent(),[2]}}))}))},t.prototype.onConnect=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new ka({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},t.prototype.onReconnect=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ma,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Na,t)];case 1:return n.sent(),[2]}}))}))},t}(Ca),Ia=function(e){function t(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=ji.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r}return I(t,e),t.prototype.run=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new Ma,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onConnect=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new ka({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},t.prototype.onReconnect=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ma,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ta,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Na,t)];case 1:return n.sent(),[2]}}))}))},t}(Ca),Sa=function(e){return w(void 0,0,void 0,(function(){return A(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},wa=function(){function e(){}return e.prototype.calcTimeout=function(){return 0},e}(),Aa=function(e,t,n){return void 0===n&&(n=new wa),w(void 0,0,void 0,(function(){var r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:r=0,i=null,a=function(e){return i=null!=e?e:new Error("Halted")},s=function(){r=0},u.label=1;case 1:if(!(-1===t||r<t))return[3,9];u.label=2;case 2:return u.trys.push([2,4,,8]),[4,e(a,s)];case 3:if(o=u.sent(),i)throw i;return[2,o];case 4:if(l=u.sent(),i)return[3,6];if(++r===t)throw l;return[4,Sa(n.calcTimeout(r))];case 5:return u.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:throw"It should not happen."}}))}))},Ma=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=ji.RECONNECTING,t.name="reconnecting",t._callbacks=[],t}return I(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach((function(t){return t(e)}))},t.prototype.run=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:t=Date.now(),n=new Nt,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),Fi((function(){return w(o,0,void 0,(function(){return A(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectStarted&&e.onReconnectStarted()})),[2]}))}))})),l.label=1;case 1:return l.trys.push([1,4,,9]),r=e.sdkState.websocket,i=r.reconnectMaxRetry,a=r.reconnectRetryStrategy,[4,Aa((function(t,n){return w(o,0,void 0,(function(){var r;return A(this,(function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof z){if(r.code===k.CONNECTION_CANCELED)return t(r),[2];if(r.isSessionExpiredError||r.isSessionInvalidatedError)return t(r),[2]}throw r;case 4:return[2]}}))}))}),i,a)];case 2:return l.sent(),[4,e.changeState(new Oa,t)];case 3:return l.sent(),this._flushCallbacks(),Fi((function(){return w(o,0,void 0,(function(){return A(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectSucceeded&&e.onReconnectSucceeded()})),[2]}))}))})),[3,9];case 4:return s=l.sent(),G(s)?[3,7]:s instanceof z?s.code===k.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new Ia({autoReconnect:!1}),t)]:[3,6];case 5:l.sent(),l.label=6;case 6:return this._flushCallbacks(s),Fi((function(){return w(o,0,void 0,(function(){return A(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectFailed&&e.onReconnectFailed()})),[2]}))}))})),[3,8];case 7:throw s;case 8:return[3,9];case 9:return[2,n.promise]}}))}))},t.prototype.onConnect=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){return n=new Nt,this._halt(z.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push((function(){var r=Date.now();e.changeState(new ka({authToken:t}),r).then((function(){n.resolve()})).catch((function(e){n.reject(e)}))})),[2,n.promise]}))}))},t.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return w(this,0,void 0,(function(){var e;return A(this,(function(t){return e=new Nt,this._resetConnect&&r&&this._resetConnect(),this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},t.prototype.onDisconnect=function(e,t){t._error;var n=t.autoReconnect,r=void 0===n||n;return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(z.connectionCanceled),[4,e.changeState(new Ia({autoReconnect:r}),t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(z.connectionCanceled),[4,e.changeState(new Ta,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(z.connectionCanceled),[4,e.changeState(new Na,t)];case 1:return n.sent(),[2]}}))}))},t}(Ca),Oa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=ji.CONNECTED,t.name="connected",t}return I(t,e),t.prototype.onReconnect=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new Ma,t)];case 2:return n.sent(),[2]}}))}))},t.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return w(this,0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new Ia({autoReconnect:n}),t)];case 1:return r.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ta,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Na,t)];case 1:return n.sent(),[2]}}))}))},t}(Ca);!function(e){e.ExternalSetBackground="ExternalSetBackground",e.ExternalDisconnectWebSocket="ExternalDisconnectWebSocket"}(ma||(ma={}));var Ra=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,a=t.sessionManager,s=t.websocketClient,o=t.dispatcher,l=t.logger,u=t.disableWebSocketCloseEventHandling,c=void 0!==u&&u;this._disableWebSocketCloseEventHandling=!1,this._webSocketClosedCause=null,this._logger=l,this._disableWebSocketCloseEventHandling=c,this._context=new Ba(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:a,websocketClient:s,dispatcher:o,logger:l}),this._sdkState=n,this._sessionManager=a,this._websocketClient=s}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh",(function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),Bi((function(){return w(e,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this.reconnect()];case 1:return e.sent(),[2]}}))}))})))})),this._websocketEventDispatcherContext=this._websocketClient.on("close",(function(){"foreground"!==e._sdkState.appState||e._webSocketClosedCause||Bi((function(){return w(e,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._sessionManager.isSessionKeyRefreshing?[3,2]:(this._logger.debug("try reconnect by websocket connection closed"),[4,this.reconnect()]);case 1:return e.sent(),[3,4];case 2:return[4,this.disconnectWebSocket()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}))})))},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===ji.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===ji.CONNECTING||e.type===ji.RECONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketClient",{get:function(){return this._websocketClient},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onConnect(this._context,e)];case 1:return n.sent(),this._registerEventDispatcher(),[2]}}))}))},e.prototype.reconnect=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=null,[4,e.onReconnect(this._context,{})];case 1:return t.sent(),[2]}}))}))},e.prototype.resetAndReconnect=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=null,[4,e.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.background=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=ma.ExternalSetBackground,[4,e.onDisconnect(this._context,{autoReconnect:!1,cause:this._webSocketClosedCause})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnect=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0,cause:this._webSocketClosedCause})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(e){return void 0===e&&(e=!1),w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,e&&(this._webSocketClosedCause=ma.ExternalDisconnectWebSocket),[4,t.onDisconnectWebSocket(this._context,{cause:this._webSocketClosedCause})];case 1:return n.sent(),[2]}}))}))},e.prototype.logout=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,this._clearEventDispatcher(),[4,t.onLogout(this._context,e)];case 1:return n.sent(),[2]}}))}))},e}(),ka=function(e){function t(t){var n=t.authToken,r=e.call(this)||this;return r.type=ji.CONNECTING,r.name="connecting",r._authToken="",r._callbacks=[],r._authToken=n,r}return I(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._callbacks.forEach((function(t){return t(e)}))},t.prototype.run=function(e){return w(this,0,void 0,(function(){var t,n,r,i=this;return A(this,(function(a){switch(a.label){case 0:t=Date.now(),n=new Nt,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),a.label=1;case 1:return a.trys.push([1,4,,10]),[4,Aa((function(t){return w(i,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof z&&n.code===k.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return[2]}}))}))}),e.sdkState.websocket.connectMaxRetry)];case 2:return a.sent(),[4,e.changeState(new Oa,t)];case 3:return a.sent(),Fi((function(){return w(i,0,void 0,(function(){return A(this,(function(t){return this._flushCallbacks(),e.connectionHandlers.forEach((function(t){t.onConnected&&t.onConnected(e.sdkState.userId)})),[2]}))}))})),[3,10];case 4:return r=a.sent(),G(r)?[3,8]:[4,e.disconnect()];case 5:return a.sent(),r instanceof z?r.code===k.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new Ua,t)]:[3,7];case 6:a.sent(),a.label=7;case 7:return Fi((function(){return w(i,0,void 0,(function(){return A(this,(function(e){return this._flushCallbacks(r),[2]}))}))})),[3,9];case 8:throw r;case 9:return[3,10];case 10:return[2,n.promise]}}))}))},t.prototype.onConnect=function(e){return w(this,0,void 0,(function(){var e;return A(this,(function(t){return e=new Nt,this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},t.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,i=t.autoReconnect,a=void 0!==i&&i,s=t.cause,o=void 0===s?null:s;return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:xa(o)),e.hasSession?[4,e.changeState(new Ia({autoReconnect:a}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new Na,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return this._halt(xa((null==t?void 0:t.cause)||null)),n=Date.now(),e.hasSession?[4,e.changeState(new Ta,n)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.changeState(new Na,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.onLogout=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=Date.now(),this._halt(null!=t?t:z.connectionCanceled),[4,e.changeState(new Na,n)];case 1:return r.sent(),[2]}}))}))},t}(Ca);function xa(e){var t=z.connectionCanceled;if(e){var n=null;switch(e){case ma.ExternalSetBackground:n="Connection has been canceled due to the application having externally moved to background while in ConnectingState.";break;case ma.ExternalDisconnectWebSocket:n="Connection has been canceled because sb.disconnectWebSocket() was called while in ConnectingState."}n&&t.setDetail(n)}return t}var Da,Ua=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=ji.INITIALIZED,t.name="initialized",t}return I(t,e),t.prototype.onConnect=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new ka({authToken:t}),n)];case 1:return r.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Na({wasPreviouslyConnected:!1}),t)];case 1:return n.sent(),[2]}}))}))},t}(Ca),La=function(e){function t(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return I(t,e),t}(ut),Pa=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this.pingDelegate=t,this.sdkState=n,this._logger=r}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this;if(!this.sdkState.websocket)throw z.connectionRequired;var n=new La;try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout((function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error()}),r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()")}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error()}return n},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e.prototype.refreshTimer=function(){var e,t=this;if(!this.sdkState.websocket)throw z.connectionRequired;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval((function(){t.ping()}),n)},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e}(),Fa=["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications","message_template"],Ba=function(e){function t(t,n){var r,i=n.sdkState,a=n.cacheContext,s=n.connectionHandlers,o=n.sessionManager,l=n.websocketClient,u=n.dispatcher,c=n.logger,d=n.entryState,h=void 0===d?new Ua:d,f=this;return(f=e.call(this)||this)._stateUpdatedAt=0,f._connectingAt=0,f._connectedAt=0,f._logiReceivedAt=0,f._connectionRequestQueue=[],f._iid=t,f.sdkState=i,f.cacheContext=a,f.connectionHandlers=s,f._sessionManager=o,f._websocketClient=l,f._dispatcher=u,f._logger=c,f._currentState=h,(null===(r=f.sdkState.websocket)||void 0===r?void 0:r.pingerDisabled)||(f._pinger=new Pa({pingDelegate:{send:function(e){return f._websocketClient.send(e)},error:function(e){return f._websocketClient.error(e)}},sdkState:f.sdkState,logger:c})),f._websocketClient.on("open",(function(){f._connectedAt=Date.now(),f._tryResolveConnectionRequest()})).on("message",(function(e){"LOGI"===e.code&&(f.clearLoginTimer(),f._dispatcher.dispatch(e.as(ba)))})).on("ping-refresh",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.refreshTimer()})).on("pong",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.pong()})).on("error",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.stop()})).on("close",(function(){f._logiProcessingTimer=setTimeout((function(){f._logiProcessingTimer=void 0,f._unresolvedLogi||f._rejectConnectionRequest(z.networkError)}),500)})),f._dispatcher.on((function(e){e instanceof ba&&(f._unresolvedLogi=e,f._tryResolveConnectionRequest())})),f}return I(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:function(){return this._sessionManager.session.hasSession},enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new Ki({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}}))}))},t.prototype._tryResolveConnectionRequest=function(){var e;return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=void 0,this._logiReceivedAt=Date.now(),t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return n.sent(),this._statLogConnection(),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach((function(e){return e.resolve()})),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.session.authToken=void 0,t.error.isSessionExpiredError||t.error.isSessionInvalidatedError?this._dispatcher.dispatch(new ot({reason:t.error.code,message:t.error.message})):this._logger.warn("login failed: ".concat(t.error)),this._rejectConnectionRequest(t.error),n.label=3;case 3:return[2]}}))}))},t.prototype._rejectConnectionRequest=function(e){var t;if(null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var n=this._connectionRequestQueue;this._connectionRequestQueue=[],n.forEach((function(t){return t.reject(e)})),this._statLogConnection(e)}},t.prototype._url=function(e){var t,n=e.configTs,r=this.sdkState,i=r.appId,a=r.appVersion,s=r.userId,o=r.extensions,l=r.sendbirdRuntimeEnvironment,u=this.cacheContext.localCacheEnabled,c=this._sessionManager.session,d=null===(t=this.sdkState.websocket)||void 0===t?void 0:t.compression,h=!!(null!=o?o:{}).sb_uikit,f=Ct.userAgentWithExtension(o);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(U.OS_VERSION),"&sv=").concat(encodeURIComponent(U.SDK_VERSION),"&ai=").concat(i).concat(a?"&av=".concat(a):"").concat(c.hasSession?"":"&user_id=".concat(encodeURIComponent(s)),"&pmce=").concat(d?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(f,"&SB-SDK-User-Agent=").concat(encodeURIComponent(Ct.sendbirdSdkUserAgentWithExtension(l)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(Fa))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(u?1:0,"&include_poll_details=1").concat(h?"&uikit_config=1":"","&config_ts=").concat(n)},t.prototype._statLogConnection=function(e){var t;this._dispatcher.dispatch(new pt(new Et({type:rt.WEBSOCKET_CONNECT,data:{host_url:null===(t=this.sdkState.websocket)||void 0===t?void 0:t.host,success:!e,latency:this._connectedAt>0?this._connectedAt-this._connectingAt:Date.now()-this._connectingAt,logi_latency:this._logiReceivedAt>0?this._logiReceivedAt-this._connectingAt:void 0,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})))},t.prototype.connect=function(e){var t;return void 0===e&&(e=""),w(this,0,void 0,(function(){var n,r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(z.connectionCanceled)),n=new Nt,this._connectionRequestQueue.push(n),1!==this._connectionRequestQueue.length?[3,2]:(this._connectingAt=Date.now(),this._connectedAt=0,this._logiReceivedAt=0,this._loginTimer=setTimeout((function(){o._loginTimer=void 0,o._rejectConnectionRequest(z.loginTimeout)}),null===(t=this.sdkState.websocket)||void 0===t?void 0:t.responseTimeout),r=this._sessionManager.session,e&&(r.authToken=e,r.sessionKey=void 0),i=0,[4,this.cacheContext.preference.get(ra(this.sdkState.appId))]);case 1:(a=l.sent())&&(i=a.configTs),s=this._url({configTs:i}),r.sessionKey||r.authToken?this._websocketClient.connect(s,JSON.stringify(r.hasSession?{auth:r.sessionKey}:{token:r.authToken})):this._websocketClient.connect(s,JSON.stringify({})),l.label=2;case 2:return[2,n.promise]}}))}))},t.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(ba.asError(z.connectionRenew))},t.prototype.disconnect=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}}))}))},t.prototype.logout=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this.disconnect()];case 1:return e.sent(),[4,this._sessionManager.clear()];case 2:return e.sent(),[2]}}))}))},t.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0)},t}(Te),ja=function(e){function t(t){var n=t.appId,r=t.userId,i=t.includeUIKitConfig,a=void 0!==i&&i,s=t.localCacheEnabled,o=void 0===s||s,l=t.expiringSession,u=void 0===l||l,c=t.configTs,d=void 0===c?0:c,h=e.call(this)||this;return h.path="".concat(ke,"/").concat(r,"/authentication"),h.method=Me.POST,h.params=we({expiring_session:!!u,include_logi:!0,include_extra_data:String(Fa),uikit_config:a,use_local_cache:o,app_id:n,config_ts:d}),h.requireAuth=!1,h}return I(t,e),t}(it),Ha=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.logi=new ba(t,"LOGI",n),r}return I(t,e),t}(at);!function(e){e[e.ALL=0]="ALL",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.API=2]="API"}(Da||(Da={}));var Ga,za,Va=[ct,ja],qa=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,a=t.logger,s=t.useFetchCompat,o=void 0!==s&&s,l=this;this._currentConnectionStateType=ji.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new zi(e,{session:n,sdkState:r,dispatcher:i,logger:a,useFetchCompat:o}),this._session=n,this._logger=a,this._dispatcher=i,this._dispatcher.on((function(e){var t,n,r;if(e instanceof Ki){var i=e.stateType;switch(l._currentConnectionStateType=i,i){case ji.CONNECTED:l._resolveLazyCallQueue();break;case ji.INITIALIZED:case ji.INTERNAL_DISCONNECTED:case ji.EXTERNAL_DISCONNECTED:case ji.LOGOUT:l._session.isRefreshing||l._rejectLazyCallQueue((null===(r=l._session)||void 0===r?void 0:r.hasSession)?z.connectionClosed:z.connectionRequired)}}else if(e instanceof Wi)l._session.hasChatServicePermission||l._resolveLazyCallQueue(Da.API);else if(e instanceof Yi||e instanceof Qi)l._rejectLazyCallQueue(z.connectionClosed);else if(e instanceof mt){var a=e.request,s=e.deferred,o=e.error;try{for(var u=M(Va),c=u.next();!c.done;c=u.next())if(a instanceof c.value)return void s.reject(o)}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}l._lazyCallQueue.push({command:a,deferred:s})}}))}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===ji.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===ji.CONNECTING||this._currentConnectionStateType===ji.RECONNECTING||this._session.isRefreshing},enumerable:!1,configurable:!0}),e.prototype._classifyLazyCallQueueByScope=function(e){var t,n=[],r=[];switch(e){case Da.ALL:t=null;break;case Da.WEBSOCKET:t=ut;break;case Da.API:t=it}var i=!1;return this._lazyCallQueue.forEach((function(e){!t||e.command instanceof t||(i=!0),i?r.push(e):n.push(e)})),[n,r]},e.prototype._resolveLazyCallQueue=function(e){var t=this;void 0===e&&(e=Da.ALL);var n=O(this._classifyLazyCallQueueByScope(e),2),r=n[0],i=n[1];this._lazyCallQueue=i,r.forEach((function(e){return w(t,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:t=e.command,n=e.deferred,(r=e.timeout)&&clearTimeout(r),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.send(t)];case 2:return i=s.sent(),n.resolve(i),[3,4];case 3:return a=s.sent(),n.reject(a),[3,4];case 4:return[2]}}))}))}))},e.prototype._rejectLazyCallQueue=function(e,t){var n=this;void 0===t&&(t=Da.ALL);var r=O(this._classifyLazyCallQueueByScope(t),2),i=r[0],a=r[1];this._lazyCallQueue=a,i.forEach((function(t){return w(n,0,void 0,(function(){var n,r;return A(this,(function(i){return n=t.deferred,r=t.timeout,clearTimeout(r),n.reject(e),[2]}))}))}))},e.prototype.send=function(e){return w(this,0,void 0,(function(){var t,n,r=this;return A(this,(function(i){switch(i.label){case 0:return e instanceof ut?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:case 7:return[2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new Nt,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),z.connectionRequired;case 3:case 9:return[3,11];case 4:return e instanceof it?this._session.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,10];case 6:return e.hasSessionKey?(this._logger.debug("send api request with tmp session key",e),[4,this.commandRouter.send(e)]):[3,8];case 8:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new Nt,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw n=z.connectionRequired,this._logger.debug("fail api request",n),n;case 10:throw z.invalidCommand;case 11:return[2]}}))}))},e.prototype.forceSend=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),e instanceof ut||e instanceof it?[4,this.commandRouter.send(e)]:[3,2];case 1:return[2,t.sent()];case 2:throw z.invalidCommand}}))}))},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex((function(t){return t.command.requestId===e}));t>-1&&(this._lazyCallQueue[t].deferred.reject(z.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=function(e){this._logger.debug("cancel api request",e),this.commandRouter.cancel(e)},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},e}(),Ka="sendbird@devicetokens",Wa=function(){function e(e){var t=e.type,n=e.token,r=e.device_os,i=e.device_manufacturer,a=e.system_push_enabled;this.type=t,this.token=n,this.deviceOS=r,this.deviceManufacturer=i,this.systemPushEnabled=a}return e.payloadify=function(e){return we(Ae({type:e.type,token:e.token,device_os:e.deviceOS,device_manufacturer:e.deviceManufacturer,system_push_enabled:e.systemPushEnabled}))},e}(),Ya=new WeakMap,Qa=function(e){function t(t){var n=t._iid,r=t.session,i=t.cacheContext,a=t.sdkState,s=t.dispatcher,o=t.requestQueue,l=t.logger,u=t.pushNotificationAckManager,c=e.call(this)||this;return c._currentConnectionStateType=ji.INITIALIZED,c._isRefreshingAuthToken=!1,c.currentUser=null,c.session=r,c._iid=n,c._cacheContext=i,c._sdkState=a,c._dispatcher=s,c._requestQueue=o,c._logger=l,c._pushNotificationAckManager=u,c._deviceTokens=[],c._dispatcher.on((function(e){var t,n,r;if(e instanceof Ki){var i=e.stateType;c._currentConnectionStateType=i}else if(e instanceof ot&&c.handler&&!c.isSessionKeyRefreshing){if(c._currentConnectionStateType===ji.CONNECTING)return;(null===(t=e.error)||void 0===t?void 0:t.isSessionInvalidatedError)?c.close():((null===(n=e.error)||void 0===n?void 0:n.isSessionTokenExpiredError)&&c.refreshAuthToken().catch((function(e){if(G(e)&&"foreground"===c._sdkState.appState)throw e})),(null===(r=e.error)||void 0===r?void 0:r.isSessionKeyExpiredError)&&(c._logger.debug("session expired"),c.handler.onSessionExpired&&c.handler.onSessionExpired(),c.refreshSessionKey().catch((function(e){if(G(e)&&"foreground"===c._sdkState.appState)throw e}))))}})),c}return I(t,e),Object.defineProperty(t.prototype,"ekey",{get:function(){return Ya.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=function(e,t){return this._deviceTokens.findIndex((function(n){return n.type===e&&n.token===t}))},t.prototype.hasDeviceToken=function(e,t){return this.indexOfDeviceToken(e,t)>=0},t.prototype.createRefreshWebsocketCommand=function(e,t){return new dt({authToken:e,expiringSession:!0,requestId:t})},t.prototype._refreshSessionKeyByWebSocket=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(n=s.sent(),r=n.as(ft),i=r.newKey,a=r.error)throw a;return this.session.sessionKey=null!=i?i:this.session.sessionKey,[2]}}))}))},t.prototype._refreshSessionKeyByApi=function(e){return w(this,0,void 0,(function(){var t,n=this;return A(this,(function(r){switch(r.label){case 0:return t=new ct({userId:this._sdkState.userId,authToken:e,services:this.session.services&&this.session.services.length>0?this.session.services:void 0,expiringSession:!0}),[4,Aa((function(e){return w(n,0,void 0,(function(){var n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=o.sent(),r=n.as(ht),i=r.key,a=r.services,this.session.sessionKey=i,this.session.services=a,[3,3];case 2:if(s=o.sent(),!this._isSessionRelatedError(s))throw s;return e(s),[3,3];case 3:return[2]}}))}))}),3)];case 1:return r.sent(),[2]}}))}))},t.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:if(this._currentConnectionStateType!==ji.CONNECTED)return[3,8];i.label=1;case 1:return i.trys.push([1,3,,8]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return i.sent(),this.complete(),[2];case 3:n=i.sent(),i.label=4;case 4:return i.trys.push([4,6,,7]),[4,this._handleSessionRefreshError(n,t)];case 5:return i.sent(),[2];case 6:return i.sent(),[3,7];case 7:return[3,8];case 8:return i.trys.push([8,10,,12]),[4,this._refreshSessionKeyByApi(e)];case 9:return i.sent(),this.complete(),[3,12];case 10:return r=i.sent(),[4,this._handleSessionRefreshError(r,t)];case 11:return i.sent(),[3,12];case 12:return[2]}}))}))},t.prototype._receiveNewAuthToken=function(){var e,t=this,n=new Nt;if(this._isRefreshingAuthToken=!0,this.session.sessionKey=void 0,this.session.authToken=void 0,null===(e=this.handler)||void 0===e?void 0:e.onSessionTokenRequired){var r=null,i=function(){r&&(clearTimeout(r),r=null)},a=function(e){i(),t._isRefreshingAuthToken&&(t._isRefreshingAuthToken=!1,n.resolve(e))},s=function(e){i(),t._isRefreshingAuthToken&&(t._isRefreshingAuthToken=!1,n.reject(e))};r=setTimeout((function(){return s()}),1e3*this._sdkState.sessionTokenRefreshTimeout),Fi((function(){return w(t,0,void 0,(function(){var e;return A(this,(function(t){return(null===(e=this.handler)||void 0===e?void 0:e.onSessionTokenRequired)&&this.handler.onSessionTokenRequired(a,s),[2]}))}))}))}else n.resolve(null);return n.promise},t.prototype._handleSessionRefreshError=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return e instanceof z&&(e.isSessionTokenExpiredError||e.code===k.APPLICATION_NOT_FOUND)?(this.session.authToken=void 0,t?[4,this._receiveNewAuthToken()]:[3,6]):[3,6];case 1:return(n=r.sent())?(this.session.authToken=n,[4,this._refreshSessionKey(this.session.authToken,!1)]):[3,3];case 2:return r.sent(),[3,5];case 3:return[4,this.clear()];case 4:r.sent(),r.label=5;case 5:return[2];case 6:throw e}}))}))},t.prototype._isSessionRelatedError=function(e){return e instanceof z&&(e.isSessionExpiredError||e.isSessionInvalidatedError)},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this.session.isRefreshing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiring",{get:function(){return!!this.handler},enumerable:!1,configurable:!0}),t.prototype.authenticate=function(e,t){var n;return w(this,0,void 0,(function(){var r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return this.session.authToken=t,r=0,[4,this._cacheContext.preference.get(ra(this._sdkState.appId))];case 1:return(i=l.sent())&&(r=i.configTs),a=new ja({appId:this._sdkState.appId,userId:e,includeUIKitConfig:!!(null!==(n=this._sdkState.extensions)&&void 0!==n?n:{}).sb_uikit,localCacheEnabled:this._cacheContext.localCacheEnabled,expiringSession:this.isSessionExpiring,configTs:r}),[4,this._requestQueue.commandRouter.send(a)];case 2:return s=l.sent(),(o=s.as(Ha).logi).error?[3,5]:this.session.hasChatServicePermission?[3,4]:[4,o.applyTo(this._iid)];case 3:l.sent(),l.label=4;case 4:return[3,6];case 5:throw o.error;case 6:return[2]}}))}))},t.prototype.login=function(e){var t;return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:return n=e.key,r=e.ekey,i=e.services,a=e.userProfile,s=e.deviceTokenLastDeletedAt,o=void 0===s?0:s,this.session.sessionKey=n,this.session.services=i,Ya.set(this,r),this._deviceTokenCacheEnabled=null===(t=null==a?void 0:a.appInfo)||void 0===t?void 0:t.deviceTokenCache,l=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,l.get(Ka)]:[3,5];case 1:return!(u=c.sent())||u.lastDeletedAt<o?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=o,[4,this.saveDeviceToken()]):[3,3];case 2:return c.sent(),[3,4];case 3:this._deviceTokens=u.tokens.map((function(e){return new Wa(Wa.payloadify(e))})),this._deviceTokenLastDeletedAt=u.lastDeletedAt,c.label=4;case 4:return[3,7];case 5:return[4,l.remove(Ka)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),this._dispatcher.dispatch(new Wi),Fi((function(){return w(e,0,void 0,(function(){var e;return A(this,(function(t){return this._logger.debug("session refreshed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionRefreshed)&&this.handler.onSessionRefreshed(),[2]}))}))}))},t.prototype.error=function(e){var t=this;Fi((function(){return w(t,0,void 0,(function(){var t;return A(this,(function(n){return(null===(t=this.handler)||void 0===t?void 0:t.onSessionError)&&this.handler.onSessionError(e),[2]}))}))}))},t.prototype.close=function(){var e=this;this.dispatch("close"),this._dispatcher.dispatch(new Qi),Fi((function(){return w(e,0,void 0,(function(){var e;return A(this,(function(t){return this._logger.debug("session closed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionClosed)&&this.handler.onSessionClosed(),[2]}))}))}))},t.prototype.refreshAuthToken=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:if(e=null,!this.isSessionExpiring||this.session.isRefreshing)return[3,9];this.session.isRefreshing=!0,n.label=1;case 1:return n.trys.push([1,7,8,9]),[4,this._receiveNewAuthToken()];case 2:return(e=n.sent())?(this._logger.debug("session refreshing.."),this.session.authToken=e,[4,this._refreshSessionKey(this.session.authToken)]):[3,4];case 3:return n.sent(),[3,6];case 4:return[4,this.clear()];case 5:n.sent(),n.label=6;case 6:return[3,9];case 7:throw n.sent(),t=e?z.sessionTokenRefreshFailed:z.sessionTokenRequestFailed,this._dispatcher.dispatch(new Yi),this.error(t),this._logger.debug("refresh auth token error = ",t),t;case 8:return this.session.isRefreshing=!1,[7];case 9:return[2]}}))}))},t.prototype.refreshSessionKey=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:if(!this.isSessionExpiring||this.session.isRefreshing)return[3,5];this.session.isRefreshing=!0,t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,this._refreshSessionKey(this.session.authToken)];case 2:return t.sent(),[3,5];case 3:throw t.sent(),e=z.sessionTokenRefreshFailed,this._dispatcher.dispatch(new Yi),this.error(e),e;case 4:return this.session.isRefreshing=!1,[7];case 5:return[2]}}))}))},t.prototype.setDeviceToken=function(e,t,n){if(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,t)<0){var r=new Wa({type:e,token:t,device_os:null==n?void 0:n.deviceOS,device_manufacturer:null==n?void 0:n.deviceManufacturer,system_push_enabled:null==n?void 0:n.systemPushEnabled});return this._deviceTokens.push(r),!0}return!1},t.prototype.unsetDeviceToken=function(e,t){if(this._deviceTokenCacheEnabled){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1)}},t.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter((function(t){return t.type!==e})):[])},t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},t.prototype.saveDeviceToken=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(Ka,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.currentUser=null,this.session.clear(),this.close(),Ya.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),this._pushNotificationAckManager.clear(),[2]}}))}))},t}(Te),Xa=function(e,t){var n,r;if(null!==e&&null!==t){var i=Object.keys(e),a=Object.keys(t),s=R([],O(new Set(R(R([],O(i),!1),O(a),!1))),!1),o={};try{for(var l=M(s),u=l.next();!u.done;u=l.next()){var c=u.value,d=typeof e[c],h=typeof t[c];"undefined"===d?o[c]=t[c]:"undefined"===h?o[c]=e[c]:d!==h?o[c]=t[c]:"object"===d&&e[c]&&t[c]?o[c]=Xa(e[c],t[c]):o[c]=t[c]}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return o}return t};!function(e){e[e.PENDING=0]="PENDING",e[e.COLLECT_ONLY=1]="COLLECT_ONLY",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"}(Ga||(Ga={})),function(e){e.DAILY="daily",e.DEFAULT="default",e.REALTIME="realtime"}(za||(za={}));var Za,Ja=function(){function e(e){var t=e.deviceId,n=e.cacheContext,r=e.requestQueue;this.queue=[],this.flushWaitQueue=[],this.enabledState=Ga.PENDING,this.isFlushing=!1,this._sentLogStats=[],this.deviceId=t,this.cacheContext=n,this.requestQueue=r,this.logInfo={deviceId:t,statLogs:[],generation:1,lastFlushedAt:0},this.limit=100}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this.enabledState===Ga.ENABLED},enumerable:!1,configurable:!0}),e.prototype.init=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.key=e,[4,this.cacheContext.preference.get(this.key)];case 1:return(t=n.sent())&&(this.logInfo=t),[2]}}))}))},e.prototype._mergeQueue=function(){this.flushWaitQueue.length>0&&(this.queue=this.queue.concat(this.flushWaitQueue),this.flushWaitQueue=[])},e.prototype._isDuplicateStat=function(e){var t=this._sentLogStats.find((function(t){var n;return t.channelUrl===e.data.channel_url&&t.messageId===(null!==(n=e.data.notificationId)&&void 0!==n?n:e.data.message_id)&&t.action===e.data.action}));return t||this._sentLogStats.push({channelUrl:e.data.channel_url,messageId:e.data.message_id,action:e.data.action}),!!t},e.prototype._save=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=R(R([],O(this.queue),!1),O(this.flushWaitQueue),!1),[4,this.cacheContext.preference.set(this.key,{deviceId:this.logInfo.deviceId,statLogs:e.map((function(e){return Et.payloadify(e)})),generation:this.logInfo.generation++,lastFlushedAt:this.logInfo.lastFlushedAt})];case 1:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return this.queue=[],this.flushWaitQueue=[],this.logInfo.generation=1,this._save(),[2]}))}))},e}(),$a=function(e){function t(t){var n,r,i,a,s=t.type,o=t.data,l=t.ts,u=void 0===l?Date.now():l,c=e.call(this,{type:s,data:o,ts:u})||this;return c.date=new Date(u),c.key="".concat((n=c.date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),"".concat(r).concat(i).concat(a)),"_").concat(s),c}return I(t,e),t}(Et),es=function(e){function t(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=Me.POST,i.path="".concat(qe),i.params={device_id:n,log_entries:r.map((function(e){return Et.payloadify(e)}))},i}return I(t,e),t}(it),ts=function(e){function t(t){var n=t.deviceId,r=t.cacheContext,i=t.requestQueue;return e.call(this,{deviceId:n,cacheContext:r,requestQueue:i})||this}return I(t,e),Object.defineProperty(t.prototype,"_isSendable",{get:function(){return 0!==this.queue.length&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),t.prototype.init=function(t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.init.call(this,t+".daily")];case 1:return n.sent(),this.queue=this.logInfo.statLogs.map((function(e){return new Et({type:e.stat_type,ts:e.ts,data:e.data})})),[2]}}))}))},t.prototype.setConfig=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this.statConfig=e,this.statConfig.minInterval=864e5,this._mergeQueue(),t.localCacheStat?(this.enabledState=t.enabledStat?Ga.ENABLED:Ga.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=Ga.DISABLED,[4,this.clear()];case 2:s.sent(),s.label=3;case 3:return this.isEnabled&&this._isSendable?[4,this._getUploadStats()]:[3,9];case 4:n=s.sent(),r=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),i=0,s.label=5;case 5:return i<n.length?(a=n.slice(i,1+this.statConfig.maxStatCountPerRequest),[4,Sa(r)]):[3,9];case 6:return s.sent(),[4,this._flush(a)];case 7:s.sent(),s.label=8;case 8:return i+=this.statConfig.maxStatCountPerRequest,[3,5];case 9:return[2]}}))}))},t.prototype.put=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return this.enabledState===Ga.DISABLED?[2,!0]:(t=this.enabledState===Ga.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,n=O(t.filter((function(t){return t instanceof $a&&t.key===e.key})),1),(r=n[0])?r.data=Xa(r.data,e.data):t.push(e),this.enabledState===Ga.PENDING?[3,2]:[4,this._save()]);case 1:a.sent(),a.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable?[4,this._getUploadStats()]:[3,5]):[3,5];case 3:return i=a.sent(),[4,this._flush(i)];case 4:return[2,a.sent()];case 5:return[2,!0]}}))}))},t.prototype._getUploadStats=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,this.queue.filter((function(e){if(e instanceof $a){var t=new Date,n=O([e.date.getFullYear(),t.getFullYear()],2),r=n[0],i=n[1];if(r<i)return!0;if(r===i){var a=O([e.date.getMonth(),t.getMonth()],2),s=a[0],o=a[1];if(s<o)return!0;if(s===o){var l=O([e.date.getDate(),t.getDate()],2);return l[0]<l[1]}}}return!1}))]}))}))},t.prototype._flush=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:if(t=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,a.label=1;case 1:return a.trys.push([1,4,8,9]),n=R([],O(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),r=new es({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)];case 2:return a.sent(),this.queue=R([],O(e),!1).slice(n.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=100,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return a.sent(),[3,9];case 4:return(i=a.sent())instanceof z?i.code!==k.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return a.sent(),this.enabledState=Ga.DISABLED,[3,7];case 6:i.code===k.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=Ga.COLLECT_ONLY),a.label=7;case 7:return this.limit=this.limit+20,t=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,a.label=11;case 11:return[2,t]}}))}))},t}(Ja),ns=function(e){function t(t){var n=t.deviceId,r=t.cacheContext,i=t.requestQueue;return e.call(this,{deviceId:n,cacheContext:r,requestQueue:i})||this}return I(t,e),t.prototype._isSendable=function(e){if(void 0===e&&(e=!1),this.queue.length<this.statConfig.lowerThreshold)return!1;if(e){if(Date.now()-this.logInfo.lastFlushedAt<this.statConfig.minInterval)return!1}else if(this.queue.length<this.statConfig.minStatCount)return!1;return!0},t.prototype._filterQueueByType=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){return[2,t?e.filter((function(e){return e.type!==rt.FEATURE_LOCALCACHE_EVENT})):e.filter((function(e){return e.type===rt.FEATURE_LOCALCACHE_EVENT}))]}))}))},t.prototype.init=function(t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.init.call(this,t+".default")];case 1:return n.sent(),this.queue=this.logInfo.statLogs.map((function(e){return e.data=S({message_init_policy:"",starting_point:0},e.data),new Et({type:e.stat_type,ts:e.ts,data:e.data})})),[2]}}))}))},t.prototype.setConfig=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this.statConfig=e,this._mergeQueue(),t.requestStat||t.localCacheStat?(this.enabledState=t.enabledStat?Ga.ENABLED:Ga.COLLECT_ONLY,n=void 0,t.requestStat||(n=!1),t.localCacheStat||(n=!0),void 0===n?[3,3]:(r=this,[4,this._filterQueueByType(this.queue,n)])):[3,4];case 1:return r.queue=s.sent(),i=this,[4,this._filterQueueByType(this.flushWaitQueue,n)];case 2:i.flushWaitQueue=s.sent(),this._save(),s.label=3;case 3:return[3,6];case 4:return this.enabledState=Ga.DISABLED,[4,this.clear()];case 5:s.sent(),s.label=6;case 6:return this.isEnabled&&this._isSendable(!0)?(a=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,Sa(a)]):[3,9];case 7:return s.sent(),[4,this._flush(this.queue)];case 8:s.sent(),s.label=9;case 9:return[2]}}))}))},t.prototype.put=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.enabledState===Ga.DISABLED?[2,!0]:((t=this.enabledState===Ga.PENDING||this.isFlushing?this.flushWaitQueue:this.queue).push(e),this.enabledState===Ga.PENDING?[3,2]:[4,this._save()]);case 1:n.sent(),n.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable()?[4,this._flush(t)]:[3,4]):[3,4];case 3:return[2,n.sent()];case 4:return[2,!0]}}))}))},t.prototype._flush=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:if(t=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,a.label=1;case 1:return a.trys.push([1,4,8,9]),n=R([],O(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),r=new es({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)];case 2:return a.sent(),this.queue=R([],O(e),!1).slice(n.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=100,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return a.sent(),[3,9];case 4:return(i=a.sent())instanceof z?i.code!==k.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return a.sent(),this.enabledState=Ga.DISABLED,[3,7];case 6:i.code===k.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=Ga.COLLECT_ONLY),a.label=7;case 7:return this.limit=this.limit+20,t=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,a.label=11;case 11:return[2,t]}}))}))},t}(Ja),rs=function(e){function t(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=Me.POST,i.path="".concat(Ke),i.params={device_id:n,log_entries:r.map((function(e){return Et.payloadify(e)}))},i}return I(t,e),t}(it),is=function(e){function t(t){var n=t.deviceId,r=t.cacheContext,i=t.requestQueue;return e.call(this,{deviceId:n,cacheContext:r,requestQueue:i})||this}return I(t,e),Object.defineProperty(t.prototype,"_isSendable",{get:function(){return this.queue.length>=this.statConfig.minStatCount&&this.queue.length>this.statConfig.lowerThreshold||this.logInfo.lastFlushedAt>0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),t.prototype.init=function(t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.init.call(this,t+".realtime")];case 1:return n.sent(),this.queue=this.logInfo.statLogs.map((function(e){var t;return e.data=we(S(S({},e.data),{message_id:null!==(t=e.data.notificationId)&&void 0!==t?t:e.data.message_id,notificationId:void 0})),new Et({type:e.stat_type,ts:e.ts,data:e.data})})),this._sentLogStats=this.queue.map((function(e){var t;return{channelUrl:e.data.channelUrl,messageId:null!==(t=e.data.notificationId)&&void 0!==t?t:e.data.message_id,action:e.data.action}})),[2]}}))}))},t.prototype.setConfig=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return this.statConfig=e,this._mergeQueue(),t.notificationStat?(this.enabledState=t.enabledStat?Ga.ENABLED:Ga.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=Ga.DISABLED,[4,this.clear()];case 2:r.sent(),r.label=3;case 3:return this.isEnabled&&this._isSendable?(n=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,Sa(n)]):[3,6];case 4:return r.sent(),[4,this._flush(this.queue)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))},t.prototype.put=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.enabledState===Ga.DISABLED?[2,!0]:(t=this.enabledState===Ga.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,this._isDuplicateStat(e)?[2,!0]:(t.push(e),this.enabledState===Ga.PENDING?[3,2]:[4,this._save()]));case 1:n.sent(),n.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this.isEnabled&&this._isSendable?[4,this._flush(t)]:[3,4]):[3,4];case 3:return[2,n.sent()];case 4:return[2,!0]}}))}))},t.prototype._flush=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:if(t=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,a.label=1;case 1:return a.trys.push([1,4,8,9]),n=R([],O(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),r=new rs({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)];case 2:return a.sent(),this.queue=R([],O(e),!1).slice(n.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=100,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return a.sent(),[3,9];case 4:return(i=a.sent())instanceof z?i.code!==k.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return a.sent(),this.enabledState=Ga.DISABLED,[3,7];case 6:i.code===k.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=Ga.COLLECT_ONLY),a.label=7;case 7:return this.limit=this.limit+20,t=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,a.label=11;case 11:return[2,t]}}))}))},t}(Ja),as=function(){function e(e){var t=e.cacheContext,n=e.requestQueue,r=e.dispatcher,i=e.logger;this._collectRequestStat=!0,this._collectFeatureLocalCacheStat=!0,this._collectionNotificationStat=!0,this._retryCount=0,this.deviceId=Ce(),this.cacheContext=t,this.requestQueue=n,this.dispatcher=r,this.logger=i,this._dailyStatCollector=new ts({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._defaultStatCollector=new ns({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._notificationStatCollector=new is({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue})}return e.prototype._migration=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return[4,this.cacheContext.preference.get(this.key)];case 1:return(e=i.sent())?(t=[],e.statLogs.forEach((function(e){e.stat_type===rt.FEATURE_LOCALCACHE&&t.push(new Et({type:e.stat_type,ts:e.ts,data:e.data}))})),[4,this.cacheContext.preference.set(this.key+".daily",{deviceId:e.deviceId,statLogs:t.map((function(e){return Et.payloadify(e)})),generation:e.generation,lastFlushedAt:e.lastFlushedAt})]):[3,6];case 2:return i.sent(),n=[],e.statLogs.forEach((function(e){e.stat_type!==rt.FEATURE_LOCALCACHE&&e.stat_type!==rt.NOTIFICATION&&(e.stat_type===rt.FEATURE_LOCALCACHE_EVENT&&(e.data=S({message_init_policy:"",starting_point:0},e.data)),n.push(new Et({type:e.stat_type,ts:e.ts,data:e.data})))})),[4,this.cacheContext.preference.set(this.key+".default",{deviceId:e.deviceId,statLogs:n.map((function(e){return Et.payloadify(e)})),generation:e.generation,lastFlushedAt:e.lastFlushedAt})];case 3:return i.sent(),r=[],e.statLogs.forEach((function(e){var t;e.stat_type===rt.NOTIFICATION&&(e.data=we(S(S({},e.data),{message_id:null!==(t=e.data.notificationId)&&void 0!==t?t:e.data.message_id,notificationId:void 0})),r.push(new Et({type:e.stat_type,ts:e.ts,data:e.data})))})),[4,this.cacheContext.preference.set(this.key+".realtime",{deviceId:e.deviceId,statLogs:r.map((function(e){return Et.payloadify(e)})),generation:e.generation,lastFlushedAt:e.lastFlushedAt})];case 4:return i.sent(),[4,this.cacheContext.preference.remove(this.key)];case 5:i.sent(),i.label=6;case 6:return[2]}}))}))},e.prototype.init=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return this.key=e,[4,this._migration()];case 1:return n.sent(),[4,this._dailyStatCollector.init(this.key)];case 2:return n.sent(),[4,this._defaultStatCollector.init(this.key)];case 3:return n.sent(),[4,this._notificationStatCollector.init(this.key)];case 4:return n.sent(),this.commandEventContext||(this.commandEventContext=this.dispatcher.on((function(e){return w(t,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){return e instanceof pt?(t=e.statLog,this.put(t)):e instanceof Ea&&(n=e.request,r=e.features,i=e.options,a=e.statConfigInfo,this._retryCount=0,this._collectRequestStat=n,this._collectFeatureLocalCacheStat=null==r?void 0:r.localCache,this._collectionNotificationStat=null==r?void 0:r.notification,this._statConfig=a,this._dailyStatCollector.setConfig(this._statConfig.default,{localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:i.ingestion}),this._defaultStatCollector.setConfig(this._statConfig.default,{requestStat:this._collectRequestStat,localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:i.ingestion}),this._notificationStatCollector.setConfig(null!==(s=this._statConfig.realTime)&&void 0!==s?s:this._statConfig.default,{notificationStat:this._collectionNotificationStat,enabledStat:i.ingestion})),[2]}))}))}))),[2]}}))}))},e.prototype.put=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=!0,e instanceof $a?this._collectFeatureLocalCacheStat?[4,this._dailyStatCollector.put(e)]:[3,2]:[3,3];case 1:t=n.sent(),n.label=2;case 2:return[3,13];case 3:switch(e.type){case rt.API_RESULT:case rt.WEBSOCKET_CONNECT:return[3,4];case rt.FEATURE_LOCALCACHE:case rt.FEATURE_LOCALCACHE_EVENT:return[3,7];case rt.NOTIFICATION:return[3,10]}return[3,13];case 4:return this._collectRequestStat?[4,this._defaultStatCollector.put(e)]:[3,6];case 5:t=n.sent(),n.label=6;case 6:return[3,13];case 7:return this._collectFeatureLocalCacheStat?[4,this._defaultStatCollector.put(e)]:[3,9];case 8:t=n.sent(),n.label=9;case 9:return[3,13];case 10:return this._collectionNotificationStat?[4,this._notificationStatCollector.put(e)]:[3,12];case 11:t=n.sent(),n.label=12;case 12:return[3,13];case 13:return t?this._retryCount=0:(this._retryCount++,this._retryCount>20&&(this._dailyStatCollector.enabledState=Ga.COLLECT_ONLY,this._defaultStatCollector.enabledState=Ga.COLLECT_ONLY,this._notificationStatCollector.enabledState=Ga.COLLECT_ONLY,this.logger.debug(z.statLogUploadLimitExceededError))),[2]}}))}))},e.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0)},e}(),ss=function(){function e(e){var t=e.limit,n=void 0===t?5:t;this.workersByKey={},this.limit=n}return e.prototype.run=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return this.workersByKey[e]||(this.workersByKey[e]=[]),this.workersByKey[e].length<this.limit?(this.workersByKey[e].push(t),[4,t()]):[3,2];case 1:return n=r.sent(),this.workersByKey[e].pop(),[2,n];case 2:throw z.tooManyRequests}}))}))},e.prototype.clear=function(e){this.workersByKey[e]=[]},e}();!function(e){e.DELIVERY_RECEIPT="delivery_receipt",e.PUSH_ACKNOWLEDGEMENT="push_acknowledgement"}(Za||(Za={}));var os,ls,us=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pushAckedCache={},t}return I(t,e),t.prototype.isAcked=function(e,t){var n,r="".concat(e,"_").concat(t);return null!==(n=this._pushAckedCache[r])&&void 0!==n&&n},t.prototype.markAsAcked=function(e,t){var n="".concat(e,"_").concat(t);this._pushAckedCache[n]=!0},t.prototype.clear=function(){ms.of(this._iid).logger.debug("clear push acked cache"),this._pushAckedCache={}},t.prototype.parseData=function(e){var t,n,r,i,a=ms.of(this._iid).logger,s=e.sendbird;if("string"==typeof s)try{s=JSON.parse(s)}catch(e){throw a.info("push notification payload does not contain sendbird payload in JSON format."),z.malformedDataError}if(!s||"object"!=typeof s)throw a.info("push notification payload does not contain sendbird payload in JSON format."),z.malformedDataError;var o=null!==(t=s.push_tracking_id)&&void 0!==t?t:"",l=s.notification_message_id,u=s.notification_channel_key,c=s.notification_template_key,d=s.notification_event_deadline,h=null!==(n=s.session_key)&&void 0!==n?n:{},f=null!==(r=null==h?void 0:h.key)&&void 0!==r?r:"",p=null!==(i=null==h?void 0:h.topics)&&void 0!==i?i:[];if("string"!=typeof o||0===o.length)throw a.info("push tracking id is not available"),z.malformedDataError;if("string"!=typeof l||0===l.length)throw a.info("message id is not available"),z.malformedDataError;return{pushTrackingId:o,sessionKey:f,sessionTopics:p,messageId:l,channelKey:u,templateKey:c,notificationEventDeadline:d}},t}(ia),cs=function(e){this.name=e.name,this._custom=e.custom,this._usedByModerationEngine=e.used_by_moderation_engine},ds=function(e){function t(){var t=e.call(this)||this;return t.method=Me.GET,t.path=Xe,t}return I(t,e),t}(it),hs=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reportCategories=n.categories,r}return I(t,e),t}(at),fs=function(e){function t(t){var n=e.call(this,t)||this;return n._categories=[],n}return I(t,e),t.prototype.categories=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return 0!==this._categories.length?[3,2]:[4,this._fetchCategories()];case 1:e.sent(),e.label=2;case 2:return[2,this._categories]}}))}))},t.prototype._fetchCategories=function(){return w(this,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return e=ms.of(this._iid).requestQueue,t=new ds,[4,e.send(t)];case 1:return n=a.sent(),(r=n.as(hs).reportCategories)&&(i=this._categories).push.apply(i,R([],O(r.map((function(e){return new cs(e)}))),!1)),[2]}}))}))},t}(ia),ps={},ms=function(){function e(e,t){var n,r,i,a,s,o,l,u,c;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!ps[e]){ps[e]=this;var d=null!==(n=t.options)&&void 0!==n?n:new te,h=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:void 0,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(a=t.websocketHost)&&void 0!==a?a:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new wa,responseTimeout:d.websocketResponseTimeout},sessionTokenRefreshTimeout:d.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var f=this.logger=t.logger;this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var p=this.cacheContext=new ie({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(s=t.localCacheEnabled)&&void 0!==s&&s,localCacheConfig:null!==(o=t.localCacheConfig)&&void 0!==o?o:new oe});this.debugMode=null!==(l=t.debugMode)&&void 0!==l&&l,this.maxSuperGroupChannelUnreadCount=U.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=d.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=d.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=d.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var m=this.dispatcher=new Ie,g=new be;this.requestQueue=new qa(e,{session:g,sdkState:h,dispatcher:m,logger:f,useFetchCompat:t.useFetchCompat}),this.pushNotificationAckManager=new us(e),this.sessionManager=new Qa({_iid:e,session:g,cacheContext:p,sdkState:h,dispatcher:m,requestQueue:this.requestQueue,logger:f,pushNotificationAckManager:this.pushNotificationAckManager}),this.connectionManager=new Ra(e,{sdkState:h,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:m,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(u=t.disableWebSocketCloseEventHandling)&&void 0!==u&&u,logger:f}),this.statManager=new as({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:this.dispatcher,logger:f}),this.appStateToggleEnabled=null===(c=t.appStateToggleEnabled)||void 0===c||c,this.messageBackgroundSyncThrottleController=new ss({limit:5}),this.reportCategoryManager=new fs(e)}return ps[e]}return e.of=function(e){if(ps[e])return ps[e];throw z.lostInstance},e.clear=function(e){ps[e]&&delete ps[e]},e.prototype.hasExtension=function(e){return this.sdkState.extensions&&this.sdkState.extensions[e]},e}(),gs=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,a=t.requestQueue,s=t.logger;t.onlineDetector;var o=t.cacheContext;this._iid=e,this._cacheContext=o,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=a,this._logger=s},e}();!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",e.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",e.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",e.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",e.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",e.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",e.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",e.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",e.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",e.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",e.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",e.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",e.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",e.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",e.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",e.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",e.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",e.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",e.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",e.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",e.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",e.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",e.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",e.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",e.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",e.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",e.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",e.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",e.REQUEST_CHANNEL="REQUEST_CHANNEL",e.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",e.REFRESH_CHANNEL="REFRESH_CHANNEL",e.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",e.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",e.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_FEEDBACK_ADDED="EVENT_MESSAGE_FEEDBACK_ADDED",e.EVENT_MESSAGE_FEEDBACK_UPDATED="EVENT_MESSAGE_FEEDBACK_UPDATED",e.EVENT_MESSAGE_FEEDBACK_DELETED="EVENT_MESSAGE_FEEDBACK_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_THREAD_INFO_UPDATED="EVENT_THREADINFO_UPDATED",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"}(os||(os={})),S({},os);var _s=function(e){return e.startsWith("EVENT_")||e.startsWith("LOCAL_MESSAGE_")||e===os.SYNC_MESSAGE_FILL||e===os.SYNC_MESSAGE_CHANGELOGS||e===os.SYNC_POLL_CHANGELOGS},vs=function(e){function t(t){var n=t.messages,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.messages=n,s.source=r,s.isWebSocketEventComing=a,s}return I(t,e),t}(Se),Es=function(e){function t(t){var n=t.messageIds,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.messageIds=n,s.source=r,s.isWebSocketEventComing=a,s}return I(t,e),t}(Se),ys=function(e){function t(t){var n=t.messageDeletionTimestamp,r=t.channelUrl,i=t.source,a=e.call(this)||this;return a.messageDeletionTimestamp=n,a.channelUrl=r,a.source=i,a}return I(t,e),t}(Se),bs=function(e){function t(t){var n=t.event,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.event=n,s.source=r,s.isWebSocketEventComing=a,s}return I(t,e),t}(Se),Cs=function(e){function t(t){var n=t.event,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.event=n,s.source=r,s.isWebSocketEventComing=a,s}return I(t,e),t}(Se),Ns=function(e){function t(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i}return I(t,e),t}(Se),Ts=function(e){function t(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i}return I(t,e),t}(Se),Is=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return I(t,e),t}(Se),Ss=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return I(t,e),t}(Se);!function(e){e.OPEN="open",e.CLOSED="closed"}(ls||(ls={}));var ws,As="removed",Ms=function(e){switch(e){case"open":return ls.OPEN;case"closed":return ls.CLOSED;default:return null}},Os=function(e){return!e||!!e.text&&W("string",e.text)},Rs=function(e){function t(t,n){var r,i,a,s,o,l,u,c=this;return(c=e.call(this,t)||this).pollId=0,c.id=0,c.text=null,c.voteCount=0,c.createdBy=null,c.createdAt=0,c.updatedAt=0,c._lastVotedAt=0,c.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,c.id=null!==(i=n.id)&&void 0!==i?i:0,c.text=null!==(a=n.text)&&void 0!==a?a:null,c.voteCount=null!==(s=n.vote_count)&&void 0!==s?s:0,c.createdBy=null!==(o=n.created_by)&&void 0!==o?o:null,c.createdAt=null!==(l=n.created_at)&&void 0!==l?l:0,c.updatedAt=null!==(u=n.updated_at)&&void 0!==u?u:0,c}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})))},t}(ia),ks=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g=this;return(g=e.call(this,t)||this).id=0,g.title=null,g.createdAt=0,g.updatedAt=0,g.closeAt=-1,g.status=ls.CLOSED,g.messageId=0,g.data=null,g.voterCount=-1,g.options=[],g.createdBy=null,g.allowUserSuggestion=!1,g.allowMultipleVotes=!1,g.votedPollOptionIds=[],g.id=null!==(r=n.id)&&void 0!==r?r:0,g.title=null!==(i=n.title)&&void 0!==i?i:null,g.createdAt=null!==(a=n.created_at)&&void 0!==a?a:0,g.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,g.closeAt=null!==(o=n.close_at)&&void 0!==o?o:-1,g.status=null!==(l=Ms(n.status))&&void 0!==l?l:ls.CLOSED,g.messageId=null!==(u=n.message_id)&&void 0!==u?u:0,g.data=null!==(c=n.data)&&void 0!==c?c:null,g.voterCount=null!==(d=n.voter_count)&&void 0!==d?d:-1,g.options=n.options?n.options.map((function(e){return new Rs(g._iid,e)})):[],g.createdBy=null!==(h=n.created_by)&&void 0!==h?h:null,g.allowUserSuggestion=null!==(f=n.allow_user_suggestion)&&void 0!==f&&f,g.allowMultipleVotes=null!==(p=n.allow_multiple_votes)&&void 0!==p&&p,g.votedPollOptionIds=null!==(m=n.voted_option_ids)&&void 0!==m?m:[],g}return I(t,e),t.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,a,s,o,l,u=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=Ms(e.status))&&void 0!==i?i:this.status,this.data=null!==(a=e.data)&&void 0!==a?a:this.data,this.voterCount=null!==(s=e.voter_count)&&void 0!==s?s:this.voterCount,e.options&&(this.options=e.options.map((function(e){return new Rs(u._iid,e)})),this.votedPollOptionIds=e.options.filter((function(e){return e.vote_count>0})).map((function(e){return e.id}))),this.allowUserSuggestion=null!==(o=e.allow_user_suggestion)&&void 0!==o?o:this.allowUserSuggestion,this.allowMultipleVotes=null!==(l=e.allow_multiple_votes)&&void 0!==l?l:this.allowMultipleVotes},t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map((function(e){return Rs.payloadify(e)})),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})))},t.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return!(!t||this.id!==t.id||t.updated_at<this.updatedAt||(this._applyPollUpdatePayload(t),0))},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var t=this.options,n=t.map((function(e){return e.id})),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach((function(e){var r=n.indexOf(e.option_id);if(r>-1){var a=t[r];i>=a._lastVotedAt&&(a.voteCount=e.vote_count,a._lastVotedAt=i)}})),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),"number"==typeof r.voter_count&&(this.voterCount=r.voter_count),!0},t.prototype.serialize=function(){return ha(this)},t}(ia),xs=function(){function e(e,t){var n;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return W("number",this.limit)&&this.limit>0},e}(),Ds=function(e){function t(t,n,r,i){var a=e.call(this,t,i)||this;return a.channelUrl=n,a.channelType=r,a}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("string",this.channelUrl)&&Y(le,this.channelType)},t}(xs),Us=function(e){this.pollId=0,this.messageId=0,this.pollId=e.poll_id,this.messageId=e.message_id,this._payload=e},Ls=function(e){function t(t){var n=t.title,r=t.optionTexts,i=t.data,a=t.allowUserSuggestion,s=t.allowMultipleVotes,o=t.closeAt,l=e.call(this)||this;return l.method=Me.POST,l.path=Ge,l.params={title:n,options:r,data:i,allow_user_suggestion:a,allow_multiple_votes:s,close_at:o},l}return I(t,e),t}(it),Ps=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new ks(t,n),r}return I(t,e),t}(at),Fs=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=e.call(this)||this;return a.method=Me.GET,a.path="".concat(Ge,"/").concat(encodeURIComponent(i)),a.params={channel_url:n,channel_type:r},a}return I(t,e),t}(it),Bs=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new ks(t,n),r}return I(t,e),t}(at),js=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=t.pollOptionId,s=e.call(this)||this;return s.method=Me.GET,s.path="".concat(Ge,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(a)),s.params={channel_url:n,channel_type:r},s}return I(t,e),t}(it),Hs=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pollOption=new Rs(t,n),r}return I(t,e),t}(at),Gs=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,s=e.call(this)||this;return s.method=Me.GET,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/polls/changelogs"),s.params=we({change_ts:i,token:a}),s}return I(t,e),t}(it),zs=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedPolls=n.updated.map((function(e){return new ks(t,e)})),r.deletedPollIds=n.deleted.map((function(e){return e})),r.hasMore=n.has_more,r.nextToken=n.next,r}return I(t,e),t}(at),Vs={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},qs=function(e){return W("string",e.title)&&(t=e.optionTexts,X("string",t)&&t.every((function(e){return""!==e.trim()})))&&Os(e.data)&&W("boolean",e.allowUserSuggestion,!0)&&W("boolean",e.allowMultipleVotes,!0)&&W("number",e.closeAt,!0);var t},Ks={channelUrl:"",channelType:le.BASE,pollId:0,pollOptionId:0},Ws=function(e){return W("string",e.channelUrl)&&""!==e.channelUrl&&Y(le,e.channelType)&&W("number",e.pollId)&&e.pollId>0&&W("number",e.pollOptionId)&&e.pollOptionId>0},Ys={channelUrl:"",channelType:le.BASE,pollId:0},Qs=function(e){return W("string",e.channelUrl)&&""!==e.channelUrl&&Y(le,e.channelType)&&W("number",e.pollId)},Xs={},Zs=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,a=t.requestQueue,s=t.logger;this._iid=e,this._sdkState=n,this._sessionManager=i,this._requestQueue=a,this._dispatcher=r,this._logger=s,Xs[e]=this}return e.of=function(e){return Xs[e]},e.prototype.buildPollFromSerializedData=function(e){var t=fa(e);return new ks(this._iid,ks.payloadify(t))},e.prototype.get=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return pa(Qs(e)).throw(z.invalidParameters),t=new Fs(S({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Bs).poll]}}))}))},e.prototype.create=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return pa(qs(e)).throw(z.invalidParameters),t=new Ls(S({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Ps).poll]}}))}))},e.prototype.getOption=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return pa(Ws(e)).throw(z.invalidParameters),t=new js(S({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Hs).pollOption]}}))}))},e.prototype.getPollChangeLogs=function(e,t,n,r){return void 0===r&&(r=os.SYNC_POLL_CHANGELOGS),w(this,0,void 0,(function(){var i,a,s,o,l,u,c;return A(this,(function(d){switch(d.label){case 0:return i=new Gs(Ae({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null})),[4,this._requestQueue.send(i)];case 1:return a=d.sent(),s=a.as(zs),o=s.updatedPolls,l=s.deletedPollIds,u=s.hasMore,c=s.nextToken,o.length>0&&this._dispatcher.dispatch(new Ts({polls:o,source:r})),[2,{updatedPolls:o,deletedPollIds:l,hasMore:u,token:c}]}}))}))},e}(),Js=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,a=t.limit,s=e.call(this)||this;return s.method=Me.GET,s.path=Ge,s.params={channel_url:n,channel_type:r,token:i,limit:a},s}return I(t,e),t}(it),$s=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).polls=(null!==(r=n.polls)&&void 0!==r?r:[]).map((function(e){return new ks(t,e)})),i.token=n.next,i}return I(t,e),t}(at),eo=function(e){function t(t,n){return e.call(this,t,n.channelUrl,n.channelType,n)||this}return I(t,e),t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Js(S(S({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as($s),i=r.polls,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),to=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=t.pollOptionId,s=t.token,o=t.limit,l=e.call(this)||this;return l.method=Me.GET,l.path="".concat(Ge,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(a),"/voters"),l.params={channel_url:n,channel_type:r,token:s,limit:o},l}return I(t,e),t}(it),no=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).voters=(null!==(r=n.voters)&&void 0!==r?r:[]).map((function(e){return new ga(t,e)})),i.token=n.next,i}return I(t,e),t}(at),ro=function(e){function t(t,n){var r=e.call(this,t,n.channelUrl,n.channelType,n)||this;return r.pollId=n.pollId,r.pollOptionId=n.pollOptionId,r}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("number",this.pollId)&&W("number",this.pollOptionId)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new to(S(S({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(no),i=r.voters,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),io=function(){function e(e,t,n){var r,i;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this._requireAuth=!1,this._iid=e,this.plainUrl=t.url,this.width=t.width,this.height=t.height,this.realWidth=null!==(r=t.real_width)&&void 0!==r?r:t.width,this.realHeight=null!==(i=t.real_height)&&void 0!==i?i:t.height,this._requireAuth=n}return e.payloadify=function(t){return we(Ae(t instanceof e?{url:t.plainUrl,width:t.width,height:t.height,real_width:t.realWidth,real_height:t.realHeight}:{url:"",width:t.maxWidth,height:t.maxHeight,real_width:0,real_height:0}))},Object.defineProperty(e.prototype,"url",{get:function(){var e=ms.of(this._iid).sessionManager;return this._requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),e}(),ao=function(e){function t(t){var n=e.call(this)||this;if(n.method=Me.POST,n.path="".concat(xe),n.params=we({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var r=0;r<t.thumbnailSizes.length;r++){var i=t.thumbnailSizes[r],a=i.maxWidth,s=i.maxHeight;n.params["thumbnail".concat(r+1)]="".concat(a,",").concat(s)}return n.requestId=t.requestId,n}return I(t,e),t}(it),so=function(e){function t(t,n){var r,i,a,s,o=this;return(o=e.call(this,t,n)||this).url=n.url,o.fileSize=null!==(r=n.file_size)&&void 0!==r?r:0,o.thumbnails=null!==(a=null===(i=n.thumbnails)||void 0===i?void 0:i.map((function(e){return new io(t,e,!1)})))&&void 0!==a?a:[],o.requireAuth=null!==(s=n.require_auth)&&void 0!==s&&s,o}return I(t,e),t}(at),oo=function(e){function t(t,n){var r,i,a,s,o,l=this;return(l=e.call(this,t)||this).replyCount=0,l.memberCount=0,l.lastRepliedAt=0,l.updatedAt=0,l.replyCount=null!==(r=n.reply_count)&&void 0!==r?r:0,l.memberCount=null!==(i=n.member_count)&&void 0!==i?i:0,l.mostRepliedUsers=n.most_replies&&X("object",n.most_replies)?n.most_replies.map((function(e){return new ga(l._iid,e)})):[],l.unreadReplyCount=null!==(a=n.unread_message_count)&&void 0!==a?a:0,l.isPushNotificationEnabled="number"==typeof n.push_enabled?n.push_enabled>0:void 0,l.lastRepliedAt=null!==(s=n.last_replied_at)&&void 0!==s?s:0,l.updatedAt=null!==(o=n.updated_at)&&void 0!==o?o:0,l}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{reply_count:t.replyCount,unread_message_count:t.unreadReplyCount,member_count:t.memberCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map((function(e){return ga.payloadify(e)})):[],push_enabled:"boolean"==typeof t.isPushNotificationEnabled?t.isPushNotificationEnabled?1:0:void 0,last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})))},Object.defineProperty(t.prototype,"_isUpdateRequired",{get:function(){return void 0===this.unreadReplyCount||void 0===this.isPushNotificationEnabled},enumerable:!1,configurable:!0}),t.prototype._updateFrom=function(e){var t,n;this.unreadReplyCount=null!==(t=e.unreadReplyCount)&&void 0!==t?t:this.unreadReplyCount,this.isPushNotificationEnabled=null!==(n=e.isPushNotificationEnabled)&&void 0!==n?n:this.isPushNotificationEnabled},t}(ia);!function(e){e.ADD="add",e.DELETE="delete"}(ws||(ws={}));var lo,uo=function(e){var t;this.messageId=0,this.operation=null,this.updatedAt=0;var n=W("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,r=e.user_id,i=e.operation?e.operation.toLowerCase():null,a=e.reaction,s=e.updated_at,o=e.count,l=e.sampled_user_ids,u=null!==(t=e.sampled_user_info)&&void 0!==t?t:{};n&&W("string",r)&&W("string",i)&&Y(ws,i)&&W("string",a)&&a&&W("number",s)&&(this.messageId=n,this.userId=r,this.key=a,this.operation=i,this.updatedAt=s,this._count=o,this._sampledUserIds=l,this._sampledUserInfoList=u)},co=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t)||this).userId=n,a.nickname=r.nickname,a.plainProfileUrl=r.profile_url,a.requireAuth=null!==(i=r.require_auth_for_profile_image)&&void 0!==i&&i,a}return I(t,e),Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=ms.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.payloadify=function(e){return{nickname:e.nickname,profile_url:e.plainProfileUrl,require_auth_for_profile_image:e.requireAuth}},t}(ia),ho=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h=this;(h=e.call(this,t)||this)._sampledUserInfoList=[],h._count=0,h._hasCurrentUserReacted=!1;var f=n.key,p=R([],O(null!==(s=null!==(a=n.sampled_user_ids)&&void 0!==a?a:n.user_ids)&&void 0!==s?s:[]),!1),m=null!==(l=null!==(o=n.last_ts)&&void 0!==o?o:n.updated_at)&&void 0!==l?l:0,g=null!==(u=n.is_self_included)&&void 0!==u?u:p.includes(ms.of(t).sdkState.userId),_=null!==(c=n.sampled_user_info)&&void 0!==c?c:{};W("string",f)&&f&&X("string",p)&&p.length>0&&W("number",m)&&(h.key=f,h._sampledUserIds=p,h._updatedAt=m,h._count=null!==(d=n.count)&&void 0!==d?d:p.length,h._hasCurrentUserReacted=g,Object.keys(_).forEach((function(e){h._sampledUserInfoList.push(new co(t,e,_[e]))})));var v={};try{for(var E=M(h.sampledUserIds),y=E.next();!y.done;y=E.next())v[y.value]=h.updatedAt}catch(e){r={error:e}}finally{try{y&&!y.done&&(i=E.return)&&i.call(E)}finally{if(r)throw r.error}}return h._version=v,h}return I(t,e),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sampledUserIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sampledUserInfoList",{get:function(){return this._sampledUserInfoList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updatedAt",{get:function(){return this._updatedAt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentUserReacted",{get:function(){return this._hasCurrentUserReacted},enumerable:!1,configurable:!0}),t.payloadify=function(e){var t={};return e._sampledUserInfoList.forEach((function(e){t[e.userId]=co.payloadify(e)})),we(Ae({key:e.key,sampled_user_ids:e._sampledUserIds,sampled_user_info:t,count:e._count,is_self_included:e._hasCurrentUserReacted,last_ts:e._updatedAt}))},t.prototype.applyEvent=function(e){var t=this;if(e.key===this.key&&this.updatedAt<=e.updatedAt)if(e._sampledUserIds)this._sampledUserIds=e._sampledUserIds,this._sampledUserInfoList=[],Object.keys(e._sampledUserInfoList).forEach((function(n){t._sampledUserInfoList.push(new co(t._iid,n,e._sampledUserInfoList[n]))})),this._count=e._count,void 0!==e._hasCurrentUserReacted&&(this._hasCurrentUserReacted=e._hasCurrentUserReacted),this._updatedAt=e.updatedAt;else{if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var n=this._sampledUserIds.indexOf(e.userId);switch(e.operation){case ws.ADD:n<0&&this._sampledUserIds.push(e.userId);break;case ws.DELETE:n>=0&&this._sampledUserIds.splice(n,1)}this._count=this._sampledUserIds.length,this._version[e.userId]=e.updatedAt}this._updatedAt=Math.max(this.updatedAt,e.updatedAt)}},t}(ia),fo=function(){function e(e){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.secure_url&&(this.secureUrl=e.secure_url),e.type&&(this.type=e.type),e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.alt&&(this.alt=e.alt)}return e.payloadify=function(e){var t,n;return we(Ae({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}))},e}(),po=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e["og:title"]&&(this.title=e["og:title"]),e["og:url"]&&(this.url=e["og:url"]),e["og:description"]&&(this.description=e["og:description"]),e["og:image"]&&(this.defaultImage=new fo(e["og:image"]))}return e.payloadify=function(e){return we(Ae({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?fo.payloadify(e.defaultImage):null}))},e}(),mo=function(){function e(e){var t,n;this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1}return e.prototype.serialize=function(){return{name:this.name,volume:this.volume}},e.payloadify=function(e){return we(Ae({name:e.name,volume:e.volume}))},e}();!function(e){e.GOOD="good",e.BAD="bad"}(lo||(lo={}));var go=function(){function e(e){this.id=e.id,this.rating=e.rating,this.comment=e.comment}return e._getStatus=function(e){return e?"id"in e?"SUBMITTED":"NO_FEEDBACK":"NOT_APPLICABLE"},e._isSubmitted=function(t){return"SUBMITTED"===e._getStatus(t)},e._getPayloadByStatus=function(e){return"NO_FEEDBACK"===e?{}:null},e.payloadify=function(e){return we(Ae({id:e.id,rating:e.rating,comment:e.comment}))},e}(),_o=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isBlockedByMe=!1,i.role=Y(ue,n.role)?n.role:ue.NONE,i.isBlockedByMe=null!==(r=n.is_blocked_by_me)&&void 0!==r&&r,i}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})))},t}(ga),vo=function(){function e(e){this.key=e.key,this.value=X("string",e.value)?R([],O(e.value),!1):[]}return e.payloadify=function(e){var t;return we(Ae({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}))},e}(),Eo=function(e){switch(e){case de.BASE:return"";case de.USER:return"MESG";case de.FILE:return"FILE";case de.ADMIN:return"ADMM"}},yo=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h=this;(h=e.call(this,t)||this).channelType=le.BASE,h.messageType=de.BASE,h.mentionType=null,h.mentionedUsers=null,h.mentionedUserIds=null,h.metaArrays=[],h.extendedMessage={},h.createdAt=0,h.updatedAt=0,h.channelUrl=n.channel_url,h.channelType=Y(le,n.channel_type)?n.channel_type:le.GROUP,n.channel&&(n.channel.channel_url&&(h.channelUrl=n.channel.channel_url),n.channel.channel_type&&(h.channelType=n.channel.channel_type)),h.data=null!==(r=n.data)&&void 0!==r?r:"",h.customType=null!==(i=n.custom_type)&&void 0!==i?i:"",h.mentionType=Y(pe,n.mention_type)?n.mention_type:null,h.mentionedUsers=n.mentioned_users?n.mentioned_users.map((function(e){return new ga(h._iid,e)})):null,h.mentionedUserIds=null!==(a=n.mentioned_user_ids)&&void 0!==a?a:null,h.mentionedUsers&&!h.mentionedUserIds&&(h.mentionedUserIds=h.mentionedUsers.map((function(e){return e.userId})));var f=null!==(s=n.metaarray)&&void 0!==s?s:{},p=null!==(o=n.metaarray_key_order)&&void 0!==o?o:Object.keys(f).sort((function(e,t){return e.localeCompare(t)}));h.metaArrays=[];for(var m=0;m<p.length;m++){var g=p[m];h.metaArrays.push(new vo({key:g,value:f[g]||[]}))}return n.sorted_metaarray&&(h.metaArrays=n.sorted_metaarray.map((function(e){return new vo(e)}))),h.extendedMessage=null!==(l=n.extended_message)&&void 0!==l?l:{},h.extendedMessagePayload=n.extended_message_payload,h.createdAt=null!==(c=null!==(u=n.created_at)&&void 0!==u?u:n.ts)&&void 0!==c?c:0,h.updatedAt=null!==(d=n.updated_at)&&void 0!==d?d:0,h}return I(t,e),t.payloadify=function(t){var n,r;return we(Ae(S(S({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,type:Eo(t.messageType),data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:null===(n=t.mentionedUsers)||void 0===n?void 0:n.map((function(e){return ga.payloadify(e)})),sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return vo.payloadify(e)})),extended_message:t.extendedMessage,extended_message_payload:t.extendedMessagePayload,created_at:t.createdAt,updated_at:t.updatedAt})))},t.prototype.isIdentical=function(e){return!0},t.prototype.isEqual=function(e){return K(this,e)},t.prototype.isUserMessage=function(){return this.messageType===de.USER},t.prototype.isFileMessage=function(){return this.messageType===de.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isMultipleFilesMessage=function(){return this.messageType===de.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isAdminMessage=function(){return this.messageType===de.ADMIN},t.prototype.serialize=function(){return ha(this)},t.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter((function(t){return e.includes(t.key)}))},t}(ia),bo=function(e){function t(t,n){var r,i,a=this;return(a=e.call(this,t)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",a.channelType=null!==(i=n.channel_type)&&void 0!==i?i:le.GROUP,a.reader=new ga(a._iid,n.user),a.readAt=n.ts,a}return I(t,e),t}(ia),Co=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:n}})||this}return I(t,e),t}(ut);!function(e){function t(t){var n=e.call(this)||this,r=t.channelUrl,i=t.channelType,a=t.userId,s=t.notificationIds;return n.method=Me.PUT,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/messages/mark_as_read"),n.params=we(Ae({user_id:a,message_ids:s})),n}I(t,e)}(it);var No=function(e){function t(t,n,r){var i=e.call(this,t,"READ",r)||this;return i.readStatus=new bo(t,r),i}return I(t,e),t}(lt);!function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.readAt=n.ts,r.unreadMessageCount=n.unread_message_count,r}I(t,e)}(at);var To=function(e){function t(t){var n=t.channelUrl,r=t.messageId;return e.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:n,parent_message_id:r}})||this}return I(t,e),t}(ut),Io=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.pushEnabled,s=e.call(this)||this;return s.method=Me.PUT,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/thread_push"),s.params={push_enabled:a},s}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var So=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.rating,s=t.comment,o=e.call(this)||this;return o.method=Me.POST,o.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/feedbacks"),o.params={rating:a,comment:s},o}return I(t,e),t}(it),wo=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.feedback=new go(n),r}return I(t,e),t}(at),Ao=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.feedbackId,s=t.rating,o=t.comment,l=e.call(this)||this;return l.method=Me.PUT,l.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/feedbacks/").concat(a),l.params={rating:s,comment:o},l}return I(t,e),t}(it),Mo=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.feedback=new go(n),r}return I(t,e),t}(at),Oo=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.feedbackId,s=e.call(this)||this;return s.method=Me.DELETE,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/feedbacks/").concat(a),s}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.feedback=new go(n),r}),e)}(at);var Ro,ko,xo=function(e){function t(t,n){var r,i,a,s,o,l=this;return(l=e.call(this,t)||this).plainUrl="",l.fileName=null,l.mimeType=null,l.fileSize=0,l.thumbnails=[],l._requireAuth=!1,l.plainUrl=null!==(r=n.url)&&void 0!==r?r:"",l.fileName=null!==(i=n.file_name)&&void 0!==i?i:null,l.mimeType=null!==(a=n.file_type)&&void 0!==a?a:null,l.fileSize=null!==(s=n.file_size)&&void 0!==s?s:0,l._requireAuth=null!==(o=n.require_auth)&&void 0!==o&&o,l.thumbnails=n.thumbnails?n.thumbnails.map((function(e){var t;return new io(l._iid,"string"==typeof e?{url:e,width:0,height:0}:S(S({},e),{url:(null!==(t=e.url)&&void 0!==t?t:"").split("auth=")[0]}),l._requireAuth)})):[],l}return I(t,e),t.payloadify=function(e){var t;return we(Ae({url:e.plainUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnails)||void 0===t?void 0:t.map((function(e){var t;return{url:(null!==(t=e.plainUrl)&&void 0!==t?t:"").split("auth=")[0],width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),require_auth:e._requireAuth}))},Object.defineProperty(t.prototype,"url",{get:function(){var e=ms.of(this._iid).sessionManager;return this._requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t}(ia),Do=function(e){var t=e.channelUrl,n=e.channelType,r=e.parentMessage;this.channelUrl=t,this.channelType=n,this.parentMessage=r};!function(e){e.NUMBER="number",e.ENUM="enum",e.TEXT="text",e.REGEX="regex",e.DECIMAL_PLACE="decimal_place"}(Ro||(Ro={})),function(e){e.TEXT="text",e.TEXTAREA="textarea",e.NUMBER="number",e.PHONE="phone",e.EMAIL="email",e.CHIP="chip"}(ko||(ko={}));var Uo,Lo,Po=function(){function e(e,t){var n=t.id,r=t.name,i=t.items,a=t.version,s=t.is_submitted;this.messageId=e,this.id=n,this.name=r,this.items=i.map((function(e){return new Fo(e)})).sort((function(e,t){return e.sortOrder-t.sortOrder})),this.version=null!=a?a:1,this._isSubmitted=s}return Object.defineProperty(e.prototype,"isSubmitted",{get:function(){var e;return null!==(e=this._isSubmitted)&&void 0!==e?e:this.items.some((function(e){return Array.isArray(e.submittedValues)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSubmittable",{get:function(){return this.items.every((function(e){return e.required?!!(Array.isArray(e.draftValues)&&e.draftValues.length>0)&&e.isValid(e.draftValues):!(Array.isArray(e.draftValues)&&e.draftValues.length>0)||e.isValid(e.draftValues)}))},enumerable:!1,configurable:!0}),e.payloadify=function(e){return we(Ae({id:e.id,name:e.name,items:e.items.map((function(e){return Fo.payloadify(e)})),version:e.version,is_submitted:e._isSubmitted}))},e.isMessageFormPayload=function(e){return Boolean(null==e?void 0:e.message_form)},e}(),Fo=function(){function e(e){var t=e.id,n=e.name,r=e.required,i=e.sort_order,a=e.placeholder,s=e.style,o=e.item_type,l=e.validators,u=e.value,c=e.values;this.id=t,this.name=n,this.required=r,this.sortOrder=i,this.placeholder=a,0===Object.keys(s).length?this.style={layout:o}:this.style=we({layout:s.layout,options:s.options,defaultOptions:s.default_options,resultCount:s.result_count}),c?this.submittedValues=c:u&&(this.submittedValues=[u]),this._validators=l}return e.prototype.isValid=function(e){var t=this;return e.every((function(e){var n;return n=e,t._validators.every((function(e){switch(e.key){case Ro.NUMBER:var t=Number(n);return!(isNaN(t)||e.min&&"number"!=typeof e.min||e.max&&"number"!=typeof e.max||"number"==typeof e.min&&t<e.min||"number"==typeof e.max&&t>e.max);case Ro.ENUM:return"string"==typeof n&&(!(e.enums&&Array.isArray(e.enums)&&e.enums.length>0&&!e.enums.includes(n))||e.allow_other);case Ro.TEXT:return!("string"!=typeof n||"number"==typeof e.min_length&&n.length<e.min_length||"number"==typeof e.max_length&&n.length>e.max_length);case Ro.REGEX:if("string"!=typeof n)return!1;if(e.regex){if("string"!=typeof e.regex)return!1;if(!new RegExp(e.regex).test(n))return!1}return!0;case Ro.DECIMAL_PLACE:return 0!==n.length&&(t=Number(n),!(isNaN(t)||(!e.max_decimal_place||"number"==typeof e.max_decimal_place)&&e.max_decimal_place&&(r=t,i=e.max_decimal_place,a=r.toString(),s=a.indexOf("."),!(-1===s||a.slice(s+1).length<=i))));default:return!0}var r,i,a,s}))}))},e.payloadify=function(e){return we(Ae({id:e.id,name:e.name,required:e.required,sort_order:e.sortOrder,placeholder:e.placeholder,style:we({layout:e.style.layout,options:e.style.options,default_options:e.style.defaultOptions,result_count:e.style.resultCount}),item_type:e.style.layout,validators:e._validators,values:e.submittedValues}))},e}(),Bo=function(e){function t(t){var n=e.call(this)||this;return n.method=Me.POST,n.path="".concat(Qe,"/").concat(t.formId,"/submit"),n.params=we({message_id:t.messageId,items:t.items}),n}return I(t,e),t}(it);!function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled"}(Uo||(Uo={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed"}(Lo||(Lo={}));var jo,Ho=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h=this;return(h=e.call(this,t,n)||this).parentMessage=null,h.silent=!1,h.isOperatorMessage=!1,h.threadInfo=null,h.reactions=[],h.appleCriticalAlertOptions=null,h.scheduledInfo=null,h.suggestedReplies=null,h.myFeedback=null,h.myFeedbackStatus="NOT_APPLICABLE",h.messageForm=null,h._isContinuousMessages=!1,h._scheduledStatus=null,h._poll=null,h.messageId=null!==(i=null!==(r=n.msg_id)&&void 0!==r?r:n.message_id)&&void 0!==i?i:0,h.parentMessageId=null!==(a="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==a?a:0,h.threadInfo=n.thread_info?new oo(h._iid,n.thread_info):null,n.reactions_summary?h.reactions=n.reactions_summary.map((function(e){return new ho(t,e)})):n.reactions?h.reactions=n.reactions.map((function(e){return new ho(t,e)})):h.reactions=[],h.ogMetaData=n.og_tag?new po(n.og_tag):null,h.silent=null!==(s=n.silent)&&void 0!==s&&s,h.isOperatorMessage=null!==(o=n.is_op_msg)&&void 0!==o&&o,h.appleCriticalAlertOptions=n.apple_critical_alert_options?new mo(n.apple_critical_alert_options):null,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(h.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},h._scheduledStatus=n.scheduled_status),h._isContinuousMessages=null!==(l=n.is_continuous_messages)&&void 0!==l&&l,h.myFeedback=go._isSubmitted(n.feedback)?new go(n.feedback):null,h.myFeedbackStatus=go._getStatus(n.feedback),h.suggestedReplies=null!==(c=null===(u=n.extended_message_payload)||void 0===u?void 0:u.suggested_replies)&&void 0!==c?c:null,h.messageForm=Po.isMessageFormPayload(n.extended_message_payload)?new Po(h.messageId,n.extended_message_payload.message_form):null,h.message=null!==(d=n.message)&&void 0!==d?d:"",h._poll=n.poll?new ks(h._iid,n.poll):null,h}return I(t,e),t.payloadify=function(t){var n,r;return we(Ae(S(S({},e.payloadify.call(this,t)),{message_id:t.messageId,parent_message_id:t.parentMessageId,thread_info:t.threadInfo?oo.payloadify(t.threadInfo):null,reactions_summary:t.reactions.map((function(e){return ho.payloadify(e)})),og_tag:t.ogMetaData?po.payloadify(t.ogMetaData):null,silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,scheduled_message_id:null===(n=t.scheduledInfo)||void 0===n?void 0:n.scheduledMessageId,scheduled_at:null===(r=t.scheduledInfo)||void 0===r?void 0:r.scheduledAt,scheduled_status:t._scheduledStatus,feedback:t.myFeedback?go.payloadify(t.myFeedback):go._getPayloadByStatus(t.myFeedbackStatus),message:t.message,poll:t._poll?ks.payloadify(t._poll):null})))},t._getParentMessageInfoPayload=function(e){return we(Ae({type:Eo(e.messageType),ts:e.createdAt,user:e.sender?_o.payloadify(e.sender):null,message:e.message,file:{url:e.plainUrl,name:e.name,type:e.type,require_auth:e.requireAuth},files:Array.isArray(e.fileInfoList)?e.fileInfoList.map((function(e){return xo.payloadify(e)})):null}))},t.prototype.isIdentical=function(e){return this.messageId===e.messageId},t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(e.threadInfo._isUpdateRequired&&this.threadInfo&&e.threadInfo._updateFrom(this.threadInfo),this.threadInfo=e.threadInfo,!0)},t.prototype._findReactionIndex=function(e){for(var t=0;t<this.reactions.length;t++)if(this.reactions[t].key===e)return t;return-1},t.prototype.applyReactionEvent=function(e){var t=ms.of(this._iid).sdkState;if(this.messageId===e.messageId)switch(e.operation){case ws.ADD:e.userId===t.userId&&(e._hasCurrentUserReacted=!0),-1!==(n=this._findReactionIndex(e.key))?this.reactions[n].applyEvent(e):e._sampledUserIds?this.reactions.push(new ho(this._iid,{key:e.key,sampled_user_ids:e._sampledUserIds,sampled_user_info:e._sampledUserInfoList,count:e._count,is_self_included:e._hasCurrentUserReacted,last_ts:e.updatedAt})):this.reactions.push(new ho(this._iid,{key:e.key,user_ids:[e.userId],updated_at:e.updatedAt}));break;case ws.DELETE:var n;-1!==(n=this._findReactionIndex(e.key))&&(e._sampledUserIds?0===e._count?this.reactions.splice(n,1):(e.userId===t.userId&&(e._hasCurrentUserReacted=!1),this.reactions[n].applyEvent(e)):(this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1)))}},t.prototype.applyParentMessage=function(e){if(!this.parentMessage)return this.parentMessage=e,!0;if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1},t.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt||(this._poll=e,0))},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),t.prototype._triggerThreadInfoUpdatedEvent=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){return(e=ms.of(this._iid).dispatcher).dispatch(new Do({channelType:le.GROUP,channelUrl:this.channelUrl,parentMessage:this})),e.dispatch(new vs({messages:[this],source:os.EVENT_MESSAGE_THREADINFO_UPDATED})),[2]}))}))},t.prototype.markThreadAsRead=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new To({channelUrl:this.channelUrl,messageId:this.messageId}),[4,e.send(t)];case 1:return n.sent(),this.threadInfo&&0!==this.threadInfo.unreadReplyCount?(this.threadInfo.unreadReplyCount=0,[4,this._triggerThreadInfoUpdatedEvent()]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.setPushNotificationEnabled=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=ms.of(this._iid).requestQueue,n=new Io({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,pushEnabled:e}),[4,t.send(n)];case 1:return r.sent(),this.threadInfo&&this.threadInfo.isPushNotificationEnabled!==e&&(this.threadInfo.isPushNotificationEnabled=e),[2]}}))}))},t.prototype.submitMessageForm=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:if(t=ms.of(this._iid).requestQueue,n=null,r=null,i=this.messageForm,!e&&i){if(!i.isSubmittable)throw new z({code:k.INVALID_PARAMETER,message:"The form is not submittable. Please check all form items are valid before submitting."});if(i.isSubmitted)throw new z({code:k.INVALID_PARAMETER,message:"The form has already been submitted."});n=i.id,r=i.items.reduce((function(e,t){return e.push({form_item_id:t.id,values:Array.isArray(t.draftValues)?t.draftValues:[]}),e}),[])}else e&&(n=e.formId,r=Object.entries(e.answers).reduce((function(e,t){var n=O(t,2),r=n[0],i=n[1],a=Number(r);if(Number.isNaN(a))throw new z({code:k.INVALID_PARAMETER,message:"Keys in answers must be numeric string."});return e.push({form_item_id:a,value:i}),e}),[]));if(!n||!r)throw new z({code:k.INVALID_PARAMETER,message:"Missing one or more required inputs: formId, answers."});return a=new Bo({messageId:this.messageId,formId:n,items:r}),[4,t.send(a)];case 1:return s.sent(),[2]}}))}))},t.prototype.submitFeedback=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return t=ms.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new So({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,rating:e.rating,comment:e.comment}),[4,n.send(i)];case 1:return a=o.sent(),s=a.as(wo),this.myFeedback=s.feedback,this.myFeedbackStatus="SUBMITTED",r.dispatch(new vs({messages:[this],source:os.EVENT_MESSAGE_FEEDBACK_ADDED})),[2]}}))}))},t.prototype.updateFeedback=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return t=ms.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new Ao({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e.id,rating:e.rating,comment:e.comment}),[4,n.send(i)];case 1:return a=o.sent(),s=a.as(Mo),this.myFeedback=s.feedback,this.myFeedbackStatus="SUBMITTED",r.dispatch(new vs({messages:[this],source:os.EVENT_MESSAGE_FEEDBACK_UPDATED})),[2]}}))}))},t.prototype.deleteFeedback=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=ms.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new Oo({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e}),[4,n.send(i)];case 1:return a.sent(),this.myFeedback=null,this.myFeedbackStatus="NO_FEEDBACK",r.dispatch(new vs({messages:[this],source:os.EVENT_MESSAGE_FEEDBACK_DELETED})),[2]}}))}))},t}(yo),Go=function(e){function t(t,n){var r,i,a,s,o=this;if((o=e.call(this,t,n)||this).reqId="",o.replyToChannel=!1,o.errorCode=0,o.sender=n.user?new _o(o._iid,n.user):n.sender_id,o.reqId=null!==(i=null!==(r=n.req_id)&&void 0!==r?r:n.request_id)&&void 0!==i?i:"",o.replyToChannel=null!==(a=n.is_reply_to_channel)&&void 0!==a&&a,n.request_state&&Y(_e,n.request_state)&&(o.sendingStatus=n.request_state),!o.sendingStatus)if(o.messageId>0)o.sendingStatus=_e.SUCCEEDED;else if(o.scheduledInfo)switch(n.scheduled_status&&(o._scheduledStatus=n.scheduled_status),n.scheduled_status){case Lo.SENT:case Lo.IN_QUEUE:o.sendingStatus=_e.SUCCEEDED;break;case Lo.PENDING:o.sendingStatus=_e.SCHEDULED;break;case Lo.FAILED:case Lo.REMOVED:o.sendingStatus=_e.FAILED;break;case Lo.CANCELED:o.sendingStatus=_e.CANCELED}else o.sendingStatus=_e.PENDING;return o.errorCode=null!==(s=n.error_code)&&void 0!==s?s:0,o._messageToken=n.mesg_token,o}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{user:_o.payloadify(t.sender),req_id:t.reqId,is_reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode,mesg_token:t._messageToken})))},Object.defineProperty(t.prototype,"isResendable",{get:function(){return(this.sendingStatus===_e.FAILED||this.sendingStatus===_e.CANCELED)&&function(e){return e>0&&V.indexOf(e)>=0}(this.errorCode)},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},t}(Ho),zo={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:he.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Vo=function(e){return W("number",e.prevResultSize)&&W("number",e.nextResultSize)&&W("boolean",e.isInclusive)&&W("boolean",e.reverse)&&W("string",e.messageTypeFilter)&&Y(he,e.messageTypeFilter)&&X("string",e.customTypesFilter,!0)&&X("string",e.senderUserIdsFilter,!0)&&W("boolean",e.includeMetaArray)&&W("boolean",e.includeReactions)&&W("boolean",e.includeParentMessageInfo)},qo=function(e){function t(t,n){var r,i,a,s=this;if((s=e.call(this,t,n)||this).translations={},s.messageType=de.ADMIN,s.translations=null!==(r=n.translations)&&void 0!==r?r:{},n.parent_message_info){var o=n.parent_message_info;s.parentMessage=$o(t,we(Ae(S(S({},o),{message_id:s.parentMessageId,channel_url:s.channelUrl,channel_type:s.channelType,file:o.file,url:null===(i=o.file)||void 0===i?void 0:i.url,require_auth:null===(a=o.file)||void 0===a?void 0:a.require_auth}))))}return s}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{translations:t.translations,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},zo),t),pa(this.messageId>0&&W("number",e)&&Vo(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(Ho),Ko=function(){function e(e){var t,n;this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.detail&&W("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}return e.payloadify=function(e){return we(Ae({type:e.type,vendor:e.vendor,detail:e.detail}))},e}(),Wo=function(){function e(e){this.status=e.status,e.original_message_info&&(this.originalMessageInfo={createdAt:e.original_message_info.ts,messageId:e.original_message_info.id})}return e.payloadify=function(e){return we({status:e.status,original_message_info:e.originalMessageInfo?{id:e.originalMessageInfo.messageId,ts:e.originalMessageInfo.createdAt}:void 0})},e}(),Yo=function(e){function t(t,n){var r,i,a,s,o,l,u,c=this;if((c=e.call(this,t,n)||this).messageParams=null,c.mentionedMessageTemplate=void 0,c.translations={},c.translationTargetLanguages=[],c.messageSurvivalSeconds=-1,c.plugins=[],c.messageType=de.USER,c.translations=null!==(a=n.translations)&&void 0!==a?a:{},c.translationTargetLanguages=null!==(s=n.target_langs)&&void 0!==s?s:[],0===Object.keys(c.translations).length&&c.translationTargetLanguages.length>0)try{for(var d=M(c.translationTargetLanguages),h=d.next();!h.done;h=d.next()){var f=h.value;c.translations[f]=""}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(c.mentionedMessageTemplate=n.mentioned_message_template,c.messageSurvivalSeconds=null!==(o=n.message_survival_seconds)&&void 0!==o?o:-1,c.plugins=n.plugins?n.plugins.map((function(e){return new Ko(e)})):[],n.parent_message_info){var p=n.parent_message_info;c.parentMessage=$o(t,we(Ae(S(S({},p),{created_at:p.ts,message_id:c.parentMessageId,channel_url:c.channelUrl,channel_type:c.channelType,file:p.file,url:null===(l=p.file)||void 0===l?void 0:l.url,require_auth:null===(u=p.file)||void 0===u?void 0:u.require_auth}))))}return n.review_info&&(c.messageReviewInfo=new Wo(n.review_info)),c}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,mentioned_message_template:t.mentionedMessageTemplate,plugins:t.plugins.map((function(e){return Ko.payloadify(e)})),parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null,review_info:t.messageReviewInfo?Wo.payloadify(t.messageReviewInfo):void 0})))},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},zo),t),pa(this.messageId>0&&W("number",e)&&Vo(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(Go),Qo=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d=this;if((d=e.call(this,t,n)||this).messageParams=null,d.fileInfoList=[],d.messageSurvivalSeconds=-1,d.messageType=de.FILE,d.data=null!==(a=null!==(i=null===(r=n.file)||void 0===r?void 0:r.data)&&void 0!==i?i:n.custom)&&void 0!==a?a:"",d.fileInfoList=null!==(o=null===(s=n.files)||void 0===s?void 0:s.map((function(e){return new xo(t,e)})))&&void 0!==o?o:[],d.messageSurvivalSeconds=null!==(l=n.message_survival_seconds)&&void 0!==l?l:-1,n.parent_message_info){var h=n.parent_message_info;d.parentMessage=$o(t,we(Ae(S(S({},h),{created_at:h.ts,message_id:d.parentMessageId,channel_url:d.channelUrl,channel_type:d.channelType,file:h.file,url:null===(u=h.file)||void 0===u?void 0:u.url,require_auth:null===(c=h.file)||void 0===c?void 0:c.require_auth}))))}return d}return I(t,e),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},zo),t),pa(this.messageId>0&&W("number",e)&&Vo(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t.payloadify=function(t){var n,r,i,a,s,o;return we(Ae(S(S({},e.payloadify.call(this,t)),{file:{name:null!==(r=null===(n=t.fileInfoList[0])||void 0===n?void 0:n.fileName)&&void 0!==r?r:"",size:null!==(a=null===(i=t.fileInfoList[0])||void 0===i?void 0:i.fileSize)&&void 0!==a?a:0,type:null!==(o=null===(s=t.fileInfoList[0])||void 0===s?void 0:s.mimeType)&&void 0!==o?o:"",data:t.data},files:Array.isArray(t.fileInfoList)?t.fileInfoList.map((function(e){return xo.payloadify(e)})):null,message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},t._isMultipleFilesMessagePayload=function(e){var t=e.files;return Array.isArray(t)&&t.length>=2},t._isMultipleFilesMessageSerializedData=function(e){var t=e.fileInfoList;return Array.isArray(t)},t}(Go);!function(e){e.SENT="SENT",e.READ="READ"}(jo||(jo={}));var Xo,Zo=function(e){function t(t,n){var r,i,a=this;if((a=e.call(this,t,n)||this).notificationData=null,a.notificationId=n.notification_message_id,a.messageType=de.ADMIN,a.messageStatus=null!==(r=n.message_status)&&void 0!==r?r:jo.SENT,a.priority=null!==(i=n.priority)&&void 0!==i?i:Ee.NORMAL,a.notificationEventDeadline=n.notification_event_deadline,0===a.extendedMessage.sub_type)try{var s=JSON.parse(a.extendedMessage.sub_data),o=s.label,l=s.tags,u=void 0===l?[]:l,c=s.template_key,d=s.template_variables;a.notificationData={label:o,tags:u,templateKey:c,templateVariables:d}}catch(e){}return a}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{notification_message_id:t.notificationId,message_status:t.messageStatus,priority:t.priority,notification_event_deadline:t.notificationEventDeadline})))},t.prototype.isIdentical=function(e){return this.notificationId===e.notificationId},t}(yo),Jo=function(e){if(e.notificationId)return Zo.payloadify(e);switch(e.messageType){case de.USER:return Yo.payloadify(e);case de.FILE:return e.fileInfoList?Qo.payloadify(e):el.payloadify(e);case de.ADMIN:return qo.payloadify(e);default:throw z.unknown}},$o=function(e,t){if(t.notification_message_id)return new Zo(e,t);switch(t.type){case"MESG":return new Yo(e,t);case"FILE":return Qo._isMultipleFilesMessagePayload(t)?new Qo(e,t):new el(e,t);case"ADMM":case"BRDM":return new qo(e,t);default:return null}},el=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_=this;(_=e.call(this,t,n)||this).messageParams=null,_.plainUrl="",_.requireAuth=!1,_.thumbnails=[],_.messageSurvivalSeconds=-1,_.messageType=de.FILE;var v=n.file;if(_.plainUrl=(null!==(i=null!==(r=null==v?void 0:v.url)&&void 0!==r?r:n.url)&&void 0!==i?i:"").split("?auth=")[0],_.name=null!==(s=null!==(a=null==v?void 0:v.name)&&void 0!==a?a:n.name)&&void 0!==s?s:"File",_.size=null!==(l=null!==(o=null==v?void 0:v.size)&&void 0!==o?o:n.size)&&void 0!==l?l:0,_.data=null!==(c=null!==(u=null==v?void 0:v.data)&&void 0!==u?u:n.custom)&&void 0!==c?c:"",_.type=v?null!==(d=v.type)&&void 0!==d?d:"":null!==(h=n.type)&&void 0!==h?h:"",_.requireAuth=null!==(f=n.require_auth)&&void 0!==f&&f,_.thumbnails=n.thumbnails?n.thumbnails.map((function(e){var t;return new io(_._iid,"string"==typeof e?{url:e,width:0,height:0}:S(S({},e),{url:(null!==(t=e.url)&&void 0!==t?t:"").split("auth=")[0]}),_.requireAuth)})):[],_.messageSurvivalSeconds=null!==(p=n.message_survival_seconds)&&void 0!==p?p:-1,n.parent_message_info){var E=n.parent_message_info;_.parentMessage=$o(t,we(Ae(S(S({},E),{created_at:E.ts,message_id:_.parentMessageId,channel_url:_.channelUrl,channel_type:_.channelType,file:E.file,url:null===(m=E.file)||void 0===m?void 0:m.url,require_auth:null===(g=E.file)||void 0===g?void 0:g.require_auth}))))}return _}return I(t,e),t.payloadify=function(t){var n;return we(Ae(S(S({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:null===(n=t.thumbnails)||void 0===n?void 0:n.map((function(e){return{url:e.plainUrl,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},Object.defineProperty(t.prototype,"url",{get:function(){var e=ms.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},zo),t),pa(this.messageId>0&&W("number",e)&&Vo(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(Go),tl=function(e){function t(t,n){var r=n.file,i=n.fileUrl,a=n.fileName,s=n.fileSize,o=n.mimeType,l=n.thumbnailSizes,u=n._uploadedMetaData,c=n._thumbnails,d=e.call(this,t)||this;return d._plainUrl=i,d.file=r,d.fileName=a,d.fileSize=s,d.mimeType=o,d.thumbnailSizes=l,d._uploadedMetaData=u,d._thumbnails=c,d}return I(t,e),t.getPlainUrl=function(e){return e instanceof t?e._plainUrl:e.fileUrl},Object.defineProperty(t.prototype,"fileUrl",{get:function(){var e,t=ms.of(this._iid).sessionManager;return this._plainUrl&&(null===(e=this._uploadedMetaData)||void 0===e?void 0:e.requireAuth)&&t.ekey?"".concat(this._plainUrl,"?auth=").concat(t.ekey):this._plainUrl},set:function(e){this._plainUrl=e},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{file:this.file,fileUrl:this._plainUrl,fileName:this.fileName,fileSize:this.fileSize,mimeType:this.mimeType,thumbnailSizes:this.thumbnailSizes,_thumbnails:this._thumbnails,_uploadedMetaData:this._uploadedMetaData}},t}(ia),nl=function(e){function t(t){var n,r,i,a,s=[];return t.mentionType===pe.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FILE",ackRequired:!0,payload:we(Ae({channel_url:t.channelUrl,files:t.files?sl(t.files):null,url:t.url,name:null!==(n=t.fileName)&&void 0!==n?n:"",type:null!==(r=t.mimeType)&&void 0!==r?r:"",size:null!==(i=t.fileSize)&&void 0!==i?i:0,custom:t.data,custom_type:t.customType,thumbnails:null===(a=t._thumbnails)||void 0===a?void 0:a.map((function(e){return io.payloadify(e)})),require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:s,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==ge.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage,message:t.message}))})||this}return I(t,e),t}(ut),rl=function(e){function t(t){var n,r,i=this;i=e.call(this)||this;var a=[];return t.mentionType===pe.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map((function(e){return e.userId})))),i.method=Me.POST,i.path="".concat(Je(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),i.params=we(Ae({message_type:de.FILE,user_id:t.userId,files:t.files?sl(t.files):null,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:a,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:null===(n=t._thumbnails)||void 0===n?void 0:n.map((function(e){return io.payloadify(e)})),require_auth:t.requireAuth,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return vo.payloadify(e)})),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId?t.parentMessageId:null,apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,reply_to_channel:t.isReplyToChannel,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage})),i}return I(t,e),t}(it),il=function(e){function t(t,n,r){var i,a,s,o,l=this;(l=e.call(this,t,"FILE",r)||this).message=r.files&&r.files.length>=2?new Qo(t,r):new el(t,r);var u=ms.of(t).sdkState;return l.isMentioned=et(l.message.mentionType,null!==(s=null!==(i=l.message.mentionedUserIds)&&void 0!==i?i:null===(a=l.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==s?s:[],u.userId),l.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,l}return I(t,e),t}(lt),al=function(e){function t(t,n){var r,i,a,s,o=this;(o=e.call(this,t,n)||this).message=n.files&&n.files.length>=2?new Qo(t,n):new el(t,n);var l=ms.of(t).sdkState;return o.isMentioned=et(o.message.mentionType,null!==(a=null!==(r=o.message.mentionedUserIds)&&void 0!==r?r:null===(i=o.message.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})))&&void 0!==a?a:[],l.userId),o.forceUpdateLastMessage=null!==(s=n.force_update_last_message)&&void 0!==s&&s,o}return I(t,e),t}(at);function sl(e){return e.map((function(e){var t,n;return we(Ae({url:tl.getPlainUrl(e),file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e._thumbnails)||void 0===t?void 0:t.map((function(e){return io.payloadify(e)})),require_auth:null===(n=e._uploadedMetaData)||void 0===n?void 0:n.requireAuth}))}))}!function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED"}(Xo||(Xo={}));var ol,ll,ul=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,a=t.onlineDetector,s=t.cacheContext,o=this;this._queueMap=new Map,this._iid=e,this._sdkState=n,this._requestQueue=i,this._cacheContext=s,this._dispatcher=r,this._dispatcher.on((function(e){e instanceof Ki&&(o._connectionState=e.stateType)})),this._onlineDetector=a}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===ji.CONNECTED||this._connectionState===ji.CONNECTING||this._connectionState===ji.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return n=this._createSendFileMessageRequestParams(e,t),this._shouldSendThroughWebSocket?(r=new nl(n),[4,this._requestQueue.send(r)]):[3,2];case 1:return[2,i.sent().as(il).message];case 2:return r=new rl(S(S({},n),{userId:this._sdkState.userId})),[4,this._requestQueue.send(r)];case 3:return[2,i.sent().as(al).message]}}))}))},e.prototype._createSendFileMessageRequestParams=function(e,t){var n=S(S({},t.params),{channelUrl:e.url,channelType:e.channelType,reqId:t.requestId,url:""});if(t.multipleFileUploadInfo){var r=t.params;n.files=r.fileInfoList}else r=t.params,n.url=r.fileUrl,n.requireAuth=r.requireAuth;return n},e.prototype._resolveMessageQueue=function(e){var t;return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f,p;return A(this,(function(m){switch(m.label){case 0:if(!(n=this._queueMap.get(e.url)))return[3,21];if(n.isResolving)return[3,20];n.isResolving=!0,r=[],i=!0,m.label=1;case 1:m.trys.push([1,15,16,17]),a=M(n.messageQueue),s=a.next(),m.label=2;case 2:if(s.done)return[3,14];switch((o=s.value).state){case Xo.PENDING:case Xo.UPLOADING:return[3,3];case Xo.UPLOADED:return[3,4];case Xo.FAILED:return[3,12]}return[3,13];case 3:return i=!1,r.push(o),[3,13];case 4:if(!i)return[3,10];m.label=5;case 5:return m.trys.push([5,8,,9]),o.state=Xo.SENDING,[4,this._sendFileMessage(e,o)];case 6:return l=m.sent(),o.deferred.resolve(l),[4,Sa(100)];case 7:return m.sent(),[3,9];case 8:return u=m.sent(),o.deferred.reject(u),[3,9];case 9:return[3,11];case 10:r.push(o),m.label=11;case 11:return[3,13];case 12:return c=null!==(t=o.error)&&void 0!==t?t:z.unknown,o.deferred.reject(c.code===k.REQUEST_CANCELED?z.fileUploadCanceled:c),[3,13];case 13:return s=a.next(),[3,2];case 14:return[3,17];case 15:return d=m.sent(),f={error:d},[3,17];case 16:try{s&&!s.done&&(p=a.return)&&p.call(a)}finally{if(f)throw f.error}return[7];case 17:return h=n.isResolveRequestPending,n.messageQueue=r,n.isResolving=!1,n.isResolveRequestPending=!1,h?[4,this._resolveMessageQueue(e)]:[3,19];case 18:m.sent(),m.label=19;case 19:return[3,21];case 20:n.isResolveRequestPending=!0,m.label=21;case 21:return[2]}}))}))},e.prototype._uploadNextPendingItem=function(e){var t;return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d;return A(this,(function(h){switch(h.label){case 0:return(n=this._queueMap.get(e.url))&&(r=n.messageQueue.find((function(e){return e.state===Xo.PENDING})))?r.multipleFileUploadInfo?(i=r.multipleFileUploadInfo,a=i.uploadIndex,s=i.uploadCount,o=i.requestHandler,d=r.params,l=d.fileInfoList[a],!$(l.file)||(null===(t=l._uploadedMetaData)||void 0===t?void 0:t.isUploaded)?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]):[3,4]:[3,9];case 1:return h.sent(),[3,3];case 2:r.state=a<s-1?Xo.PENDING:Xo.UPLOADED,h.label=3;case 3:return u=d.fileInfoList[a],c=r.multipleFileUploadInfo.uploadIndex++,r.multipleFileUploadInfo.isCopy||null==o||o._triggerOnFileUploaded(r.requestId,c,u,r.error),[3,7];case 4:return d=r.params,$(d.file)?[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]:[3,6];case 5:return h.sent(),[3,7];case 6:d.thumbnailSizes=[],r.state=Xo.UPLOADED,h.label=7;case 7:return this._uploadNextPendingItem(e),[4,this._resolveMessageQueue(e)];case 8:h.sent(),h.label=9;case 9:return[2]}}))}))},e.prototype._tryUploadNextItemAndUpdateItemState=function(e,t,n){return w(this,0,void 0,(function(){var r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return[4,this._onlineDetector.isOnline()];case 1:if(r=u.sent(),!ms.of(this._iid).sessionManager.currentUser||!r)return n.error=z.connectionRequired,n.state=Xo.FAILED,[2];if(!(t.uploadQueue.length<6))return[3,9];n.state=Xo.UPLOADING,t.uploadQueue.push(n),u.label=2;case 2:return u.trys.push([2,7,,8]),n.multipleFileUploadInfo?(i=n.multipleFileUploadInfo,a=i.uploadIndex,s=i.uploadCount,o=n.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(e,n,o)]):[3,4];case 3:return u.sent(),n.state=a<s-1?Xo.PENDING:Xo.UPLOADED,[3,6];case 4:return o=n.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(e,n,o)];case 5:u.sent(),n.state=Xo.UPLOADED,u.label=6;case 6:return[3,8];case 7:switch((l=u.sent()).code){case k.REQUEST_FAILED:n.error=new z({code:k.NETWORK_ERROR,message:"Failed to upload a file."});break;case k.REQUEST_CANCELED:n.error=z.fileUploadCanceled;break;default:n.error=l}return n.state=Xo.FAILED,[3,8];case 8:this._dequeueUploadItem(t,n),u.label=9;case 9:return[2]}}))}))},e.prototype._dequeueUploadItem=function(e,t){var n=e.uploadQueue.findIndex((function(e){return e.requestId===t.requestId}));n>=0&&e.uploadQueue.splice(n,1)},e.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(e,t,n){var r,i,a;return w(this,0,void 0,(function(){var s,o,l,u,c,d,h,f,p,m;return A(this,(function(g){switch(g.label){case 0:return s=new ao({file:n.file,channelUrl:e.url,thumbnailSizes:n.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(s)];case 1:return o=g.sent(),l=o.as(so),u=l.url,c=l.fileSize,d=void 0===c?n.fileSize:c,h=l.thumbnails,f=void 0===h?[]:h,p=l.requireAuth,m=void 0!==p&&p,n.fileName=null!==(r=n.fileName)&&void 0!==r?r:n.file.name,n.mimeType=null!==(i=n.mimeType)&&void 0!==i?i:n.file.type,n.fileSize=null!==(a=n.fileSize)&&void 0!==a?a:n.file.size,n.fileUrl=u,n.fileSize=d,n.requireAuth=m,n._thumbnails=f,[2]}}))}))},e.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(e,t,n){var r,i,a;return w(this,0,void 0,(function(){var s,o,l,u,c,d,h,f,p,m,g;return A(this,(function(_){switch(_.label){case 0:return s=t.multipleFileUploadInfo.uploadIndex,o=n.fileInfoList[s],l=new ao({file:o.file,channelUrl:e.url,thumbnailSizes:o.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(l)];case 1:return u=_.sent(),c=u.as(so),d=c.url,h=c.fileSize,f=void 0===h?o.fileSize:h,p=c.thumbnails,m=c.requireAuth,g=void 0!==m&&m,o.fileName=null!==(r=o.fileName)&&void 0!==r?r:o.file.name,o.mimeType=null!==(i=o.mimeType)&&void 0!==i?i:o.file.type,o.fileSize=null!==(a=o.fileSize)&&void 0!==a?a:o.file.size,o.file=void 0,o.fileUrl=d,o.fileSize=f,o._thumbnails=p,o._uploadedMetaData=S(S({},o._uploadedMetaData),{requireAuth:g,isUploaded:!0}),o instanceof tl||(n.fileInfoList[s]=new tl(this._iid,o)),[2]}}))}))},e.prototype.request=function(e,t,n,r){return void 0===r&&(r={}),w(this,0,void 0,(function(){var i,a,s,o,l;return A(this,(function(u){return this._queueMap.has(e.url)||(i={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(e.url,i)),a=this._queueMap.get(e.url),s=new Nt,o={requestId:t,params:n,state:Xo.PENDING,deferred:s},"fileInfoList"in n&&(l=S({uploadIndex:0,uploadCount:n.fileInfoList.length},r),o.multipleFileUploadInfo=l),a.messageQueue.push(o),this._uploadNextPendingItem(e),[2,s.promise]}))}))},e.prototype.cancel=function(e,t){var n,r,i=this._queueMap.get(e.url);if(i){var a=t?[i.messageQueue.find((function(e){return e.requestId===t}))]:R([],O(i.messageQueue),!1);try{for(var s=M(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(l)switch(l.state){case Xo.PENDING:if(l.state=Xo.FAILED,l.error=z.requestCanceled,l.multipleFileUploadInfo&&!l.multipleFileUploadInfo.isCopy){var u=l.multipleFileUploadInfo,c=u.uploadIndex,d=u.requestHandler,h=l.params.fileInfoList[c];null==d||d._triggerOnFileUploaded(l.requestId,c,h,z.fileUploadCanceled)}this._resolveMessageQueue(e);break;case Xo.UPLOADING:this._requestQueue.cancel(l.requestId),this._dispatcher.dispatch(new Tt({requestId:l.requestId}))}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}else t&&(this._requestQueue.cancel(t),this._dispatcher.dispatch(new Tt({requestId:t})))},e}(),cl={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:he.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:me.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},dl=function(e){return W("number",e.prevResultSize)&&W("number",e.nextResultSize)&&W("boolean",e.isInclusive)&&W("boolean",e.reverse)&&W("string",e.messageTypeFilter)&&Y(he,e.messageTypeFilter)&&X("string",e.customTypesFilter,!0)&&X("string",e.senderUserIdsFilter,!0)&&Y(me,e.replyType)&&W("boolean",e.includeMetaArray)&&W("boolean",e.includeReactions)&&W("boolean",e.includeParentMessageInfo)&&W("boolean",e.includeThreadInfo)&&W("boolean",e.showSubchannelMessagesOnly)},hl={replyType:me.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},fl=function(e){return Y(me,e.replyType)&&W("boolean",e.includeReactions)&&W("boolean",e.includeMetaArray)&&W("boolean",e.includeParentMessageInfo)&&W("boolean",e.includeThreadInfo)};!function(e){e.MESSAGE="message"}(ol||(ol={})),function(e){e.INTERNAL_BACKSYNC="internal_backsync",e.INTERNAL_FILL_GAP="internal_fill_gap",e.EXTERNAL_LEGACY="external_legacy",e.EXTERNAL_COLLECTION="external_collection"}(ll||(ll={}));var pl,ml=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.includeMetaArray,s=t.includeReactions,o=t.includeThreadInfo,l=t.includeParentMessageInfo,u=e.call(this)||this;return u.method=Me.GET,u.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i)),u.params={is_sdk:!0,with_sorted_meta_array:a,include_reactions_summary:null!=s&&s,include_thread_info:o,include_parent_message_info:l,include_poll_details:!0},u}return I(t,e),t}(it),gl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?$o(t,S({},n)):null,r}return I(t,e),t}(at),_l=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,s=t.prevResultSize,o=t.nextResultSize,l=t.isInclusive,u=t.reverse,c=t.messageTypeFilter,d=t.customTypesFilter,h=t.senderUserIdsFilter,f=t.replyType,p=t.includeMetaArray,m=t.includeReactions,g=t.parentMessageId,_=t.includeThreadInfo,v=t.includeParentMessageInfo,E=t.showSubchannelMessagesOnly,y=t.checkingHasNext,b=t.checkingContinuousMessages,C=t.sdkSource,N=e.call(this)||this;return N.method=Me.GET,N.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages"),N.params=we(Ae({is_sdk:!0,prev_limit:s,next_limit:o,include:l,reverse:u,message_ts:i,message_id:a,message_type:null!=c?c:null,custom_types:d,sender_ids:h,include_reply_type:f,with_sorted_meta_array:p,include_reactions_summary:m,parent_message_id:g,include_thread_info:_,include_parent_message_info:v,show_subchannel_message_only:E,include_poll_details:!0,checking_has_next:y,checking_continuous_messages:b,sdk_source:C})),N}return I(t,e),t}(it),vl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return void 0!==n.is_continuous_messages&&(r.isContinuousMessages=n.is_continuous_messages),void 0!==n.has_next&&(r.hasNext=n.has_next),r.messages=n.messages.map((function(e){return $o(t,e)})),r}return I(t,e),t}(at),El=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,s=t.replyType,o=t.includeMetaArray,l=t.includeReactions,u=t.includeThreadInfo,c=t.includeParentMessageInfo,d=e.call(this)||this;return d.method=Me.GET,d.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/changelogs"),d.params={change_ts:i,token:a,with_sorted_meta_array:o,include_reactions_summary:l,include_thread_info:u,include_reply_type:s,include_parent_message_info:c,include_poll_details:!0},d}return I(t,e),t}(it),yl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedMessages=n.updated.map((function(e){return $o(t,e)})),r.deletedMessagesInfo=n.deleted.map((function(e){return{messageId:e.message_id,deletedAt:e.deleted_at}})),r.hasMore=n.has_more,r.nextToken=n.next,r.forceUseNextToken=n.force_use_next_token||!1,r}return I(t,e),t}(at),bl=function(e){function t(t){var n=t.channelUrl,r=t.scheduledMessageId,i=e.call(this)||this;return i.method=Me.GET,i.path="".concat(De,"/").concat(encodeURIComponent(n),"/scheduled_messages/").concat(encodeURIComponent(r)),i.params={},i}return I(t,e),t}(it),Cl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?$o(t,S({},n)):null,r}return I(t,e),t}(at);!function(e){e.MUTED="muted",e.BANNED="banned"}(pl||(pl={}));var Nl=function(){function e(e){var t,n,r,i;this.restrictionType=null,Y(pl,e.restriction_type)&&(this.restrictionType=e.restriction_type),this.description=null!==(t=e.description)&&void 0!==t?t:null,this.endAt=null!==(r=null!==(n=e.end_at)&&void 0!==n?n:e.muted_end_at)&&void 0!==r?r:-1,this.remainingDuration=null!==(i=e.remaining_duration)&&void 0!==i?i:-1}return e.payloadify=function(e){return we(Ae({restriction_type:e.restrictionType,description:e.description,end_at:e.endAt,remaining_duration:e.remainingDuration}))},e}(),Tl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.restrictionInfo=new Nl(n),r}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),Nl.payloadify(t.restrictionInfo))))},t}(ga),Il=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isMuted=!1,i.isMuted=null!==(r=n.is_muted)&&void 0!==r&&r,i}return I(t,e),t}(ga),Sl=function(){function e(){this._onPending=At,this._onFailed=At,this._onSucceeded=At}return e.prototype._trigger=function(e){switch(null==e?void 0:e.sendingStatus){case _e.PENDING:0===e.errorCode&&this._onPending(e);break;case _e.SCHEDULED:case _e.SUCCEEDED:this._onSucceeded(e)}},e.prototype._triggerFailed=function(e,t){switch(null==t?void 0:t.sendingStatus){case _e.FAILED:case _e.CANCELED:this._onFailed(e,t.scheduledInfo?null:t)}},e.prototype.onPending=function(e){return this._onPending=e,this},e.prototype.onFailed=function(e){return this._onFailed=e,this},e.prototype.onSucceeded=function(e){return this._onSucceeded=e,this},e}(),wl={data:void 0,customType:void 0,mentionType:pe.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1,pollId:void 0},Al=function(e){return W("string",e.data,!0)&&W("string",e.customType,!0)&&Y(pe,e.mentionType)&&X("string",e.mentionedUserIds,!0)&&X(ga,e.mentionedUsers,!0)&&X(vo,e.metaArrays,!0)&&W("number",e.parentMessageId,!0)&&W("boolean",e.isReplyToChannel)&&Y(ge,e.pushNotificationDeliveryOption,!0)&&W(mo,e.appleCriticalAlertOptions,!0)&&W("boolean",e.isPinnedMessage,!0)&&W("number",e.pollId,!0)},Ml=function(e){return{isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,pollId:e.pollId}},Ol=S(S({},wl),{message:"",mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,extendedMessagePayload:void 0});function Rl(e){var t,n,r;return null!==(t=e.messageParams)&&void 0!==t?t:Ae(S(S({},e),{mentionType:e.mentionType,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),mentionedMessageTemplate:e.mentionedMessageTemplate,translationTargetLanguages:Object.keys(e.translations),pushNotificationDeliveryOption:ge.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}))}var kl,xl=function(e){var t;return we(Ae({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,pollId:null===(t=e.poll)||void 0===t?void 0:t.id,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,message:e.message,translationTargetLanguages:Object.keys(e.translations),extendedMessagePayload:e.extendedMessagePayload}))},Dl=function(e){return Al(e)&&W("string",e.message)&&W("string",e.mentionedMessageTemplate,!0)&&X("string",e.translationTargetLanguages,!0)&&W("object",e.extendedMessagePayload,!0)};!function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url"}(kl||(kl={}));var Ul=function(e){return"undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob},Ll=function(e){return e===kl.BLOB||e===kl.FILE},Pl=function(e){return{file:e.file,fileKey:e.fileKey,fileType:e.fileType,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption}},Fl=S(S({},wl),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1,message:void 0});function Bl(e){var t,n,r,i;return null!==(t=e.messageParams)&&void 0!==t?t:Ae(S(S({},e),{fileUrl:e.plainUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,mentionType:e.mentionType,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),pushNotificationDeliveryOption:ge.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(i=e.thumbnails)||void 0===i?void 0:i.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),requireAuth:e.requireAuth,isPinnedMessage:!1,_thumbnails:e.thumbnails,message:e.message}))}var jl,Hl=function(e,t){var n,r;return e.messageParams?(!e.url&&$(t)&&(e.messageParams.file=t),e.messageParams):we(Ae({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,file:t,fileUrl:e.url,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:null===(n=e.thumbnails)||void 0===n?void 0:n.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),message:e.message,pollId:null===(r=e.poll)||void 0===r?void 0:r.id}))},Gl=function(e){return Al(e)&&($(e.file)||W("string",e.fileUrl))&&W("string",e.fileName,!0)&&W("string",e.mimeType,!0)&&W("number",e.fileSize,!0)&&W("string",e.message,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every((function(e){return W("object",e)&&e.maxWidth>0&&e.maxHeight>0})))},zl={data:void 0,customType:void 0,mentionType:pe.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},Vl=function(e){return W("string",e.data,!0)&&W("string",e.customType,!0)&&Y(pe,e.mentionType)&&X("string",e.mentionedUserIds,!0)&&X(ga,e.mentionedUsers,!0)&&X(vo,e.metaArrays,!0)&&Y(ge,e.pushNotificationDeliveryOption,!0)&&W(mo,e.appleCriticalAlertOptions,!0)},ql=S(S({},zl),{message:void 0,mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,pollId:void 0}),Kl=function(e){return Vl(e)&&W("string",e.mentionedMessageTemplate,!0)&&W("string",e.message,!0)&&X("string",e.translationTargetLanguages,!0)&&W("number",e.pollId,!0)},Wl=S({},zl),Yl=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,a=t.limit,s=e.call(this)||this;return s.method=Me.GET,s.path="".concat(Je(r),"/").concat(encodeURIComponent(n),"/operators"),s.params={token:i,limit:a},s}return I(t,e),t}(it),Ql=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.operators=n.operators.map((function(e){return new ga(t,e)})),r.token=n.next,r}return I(t,e),t}(at),Xl=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=ms.of(this._iid).requestQueue,n=new Yl(S(S({},this),{channelUrl:this.channelUrl,token:this._token})),[4,t.send(n)]):[3,2]):[3,5];case 1:return r=o.sent(),i=r.as(Ql),a=i.operators,s=i.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,a];case 2:return[2,e];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),Zl=function(e){function t(t,n,r,i){var a,s,o,l,u,c,d,h,f,p,m=this;return(m=e.call(this,t,n,r,i)||this).reverse=!1,m.messageTypeFilter=he.ALL,m.customTypesFilter=null,m.senderUserIdsFilter=null,m.replyType=me.NONE,m.includeMetaArray=!1,m.includeReactions=!1,m.includeParentMessageInfo=!1,m.includeThreadInfo=!1,m.showSubchannelMessagesOnly=!1,m._edge=Number.MAX_SAFE_INTEGER,m.reverse=null!==(a=i.reverse)&&void 0!==a&&a,m.messageTypeFilter=null!==(s=i.messageTypeFilter)&&void 0!==s?s:he.ALL,m.customTypesFilter=null!==(o=i.customTypesFilter)&&void 0!==o?o:null,m.senderUserIdsFilter=null!==(l=i.senderUserIdsFilter)&&void 0!==l?l:null,m.replyType=null!==(u=i.replyType)&&void 0!==u?u:me.NONE,m.includeMetaArray=null!==(c=i.includeMetaArray)&&void 0!==c&&c,m.includeReactions=null!==(d=i.includeReactions)&&void 0!==d&&d,m.includeParentMessageInfo=null!==(h=i.includeParentMessageInfo)&&void 0!==h&&h,m.includeThreadInfo=null!==(f=i.includeThreadInfo)&&void 0!==f&&f,m.showSubchannelMessagesOnly=null!==(p=i.showSubchannelMessagesOnly)&&void 0!==p&&p,m}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("boolean",this.reverse)&&Y(he,this.messageTypeFilter)&&Y(me,this.replyType)&&X("string",this.customTypesFilter,!0)&&X("string",this.senderUserIdsFilter,!0)&&W("boolean",this.includeMetaArray)&&W("boolean",this.includeReactions)&&W("boolean",this.includeParentMessageInfo)&&W("boolean",this.includeThreadInfo)&&W("boolean",this.showSubchannelMessagesOnly)},t.prototype.load=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,fh.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,Ae({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,R([Number.MAX_SAFE_INTEGER],O(e.map((function(e){return e.createdAt}))),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),Jl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.limit,s=t.token;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={limit:a,token:s},n}return I(t,e),t}(it),$l=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.mutedUsers=[];var i=n.next,a=n.muted_list;return r.token=i,a&&a.length>0&&(r.mutedUsers=a.map((function(e){return new Tl(t,e)}))),r}return I(t,e),t}(at),eu=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return I(t,e),t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Jl(S(S({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as($l),i=r.mutedUsers,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),tu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.limit,s=t.token;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=we({limit:a,token:s}),n}return I(t,e),t}(it),nu=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.bannedUsers=[];var i=n.next,a=n.banned_list;return r.token=i,a&&a.length>0&&(r.bannedUsers=a.map((function(e){return new Tl(t,e.user)}))),r}return I(t,e),t}(at),ru=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new tu(S(S({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(nu),i=r.bannedUsers,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds);!function(e){e.SPAM="spam",e.HARASSING="harassing",e.SUSPICIOUS="suspicious",e.INAPPROPRIATE="inappropriate"}(jl||(jl={}));var iu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.operatorUserIds;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:a},n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var au=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.operatorUserIds;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:a},n}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var su=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/mute/").concat(a),n}return I(t,e),t}(it),ou=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.isMuted=!1,r.startAt=0,r.endAt=0;var i=n.is_muted,a=n.start_at,s=n.end_at,o=n.remaining_duration,l=n.description;return r.isMuted=i,r.startAt=a,r.endAt=s,r.remainingDuration=o,r.description=l,r}return I(t,e),t}(at),lu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.keys;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={keys:a,include_ts:!0},n}return I(t,e),t}(it),uu=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,a=n.ts;return r.metadata=i,r.ts=a,r}return I(t,e),t}(at),cu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metadata;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:a,include_ts:!0},n}return I(t,e),t}(it),du=function(e){function t(t,n){var r,i,a=this;return(a=e.call(this,t,n)||this).metaData=null!==(r=n.metadata)&&void 0!==r?r:{},a.ts=null!==(i=n.ts)&&void 0!==i?i:null,a}return I(t,e),t}(at),hu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metadata,s=t.upsert;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:a,include_ts:!0,upsert:null!=s&&s},n}return I(t,e),t}(it),fu=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,a=n.ts;return r.metadata=i,r.ts=a,r}return I(t,e),t}(at),pu=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return I(t,e),t}(lt),mu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.key;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metadata/").concat(a),n.params={include_ts:!0},n}return I(t,e),t}(it),gu=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r}return I(t,e),t}(at),_u=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={include_ts:!0},n}return I(t,e),t}(it),vu=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r}return I(t,e),t}(at),Eu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.keys;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={keys:a},n}return I(t,e),t}(it),yu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return I(t,e),t}(at),bu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metaCounter;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:a},n}return I(t,e),t}(it),Cu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return I(t,e),t}(at),Nu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metaCounter,s=t.upsert,o=void 0!==s&&s,l=t.mode,u=void 0===l?"set":l;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:a,upsert:o,mode:u},n}return I(t,e),t}(it),Tu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return I(t,e),t}(at),Iu=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return I(t,e),t}(lt),Su=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.key;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metacounter/").concat(a),n.params={},n}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var wu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={},n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Au=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId,s=t.seconds,o=t.description;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={user_id:a,seconds:s,description:o},n}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var Mu=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new Tl(t,r.data),i}return I(t,e),t}(lt),Ou=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/mute/").concat(encodeURIComponent(a)),n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Ru=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new Tl(t,r.data),i}return I(t,e),t}(lt),ku=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId,s=t.seconds,o=t.description;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=we({user_id:a,seconds:s,description:o}),n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var xu=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new Tl(t,r.data),r.data.member_count&&(i.memberCount=r.data.member_count),r.data.joined_member_count&&(i.joinedMemberCount=r.data.joined_member_count),i}return I(t,e),t}(lt),Du=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/ban/").concat(encodeURIComponent(a)),n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Uu=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new Tl(t,r.data),i}return I(t,e),t}(lt),Lu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.freezing;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/freeze"),n.params={freeze:a},n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Pu=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.freeze=r.data.freeze,i}return I(t,e),t}(lt),Fu=function(e){return e instanceof cs?e._custom?"custom":e.name:e},Bu=function(e){if(e instanceof cs&&e._custom)return e.name},ju=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.category,s=t.userId,o=t.description;return(n=e.call(this)||this).method=Me.POST,n.path="".concat($e(i),"/").concat(encodeURIComponent(r)),n.params=we({report_category:Fu(a),reporting_user_id:s,report_description:o,custom_report_category_name:Bu(a)}),n}return I(t,e),t}(it),Hu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.category,s=t.userId,o=t.offendingUserId,l=t.description;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(Be,"/users/").concat(o),n.params=we({channel_url:r,channel_type:i===le.OPEN?"open_channels":"group_channels",report_category:Fu(a),reporting_user_id:s,report_description:l,custom_report_category_name:Bu(a)}),n}return I(t,e),t}(it),Gu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.category,s=t.userId,o=t.offendingUserId,l=t.messageId,u=t.description;return(n=e.call(this)||this).method=Me.POST,n.path="".concat($e(i),"/").concat(encodeURIComponent(r),"/messages/").concat(l),n.params=we({report_category:Fu(a),reporting_user_id:s,report_description:u,offending_user_id:o,custom_report_category_name:Bu(a)}),n}return I(t,e),t}(it),zu=function(e){function t(t){var n=[];return t.mentionType===pe.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"MESG",ackRequired:!0,payload:we(Ae({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==ge.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage,extended_message_payload:t.extendedMessagePayload}))})||this}return I(t,e),t}(ut),Vu=function(e){function t(t,n,r){var i,a,s,o,l=this;(l=e.call(this,t,"MESG",r)||this).message=new Yo(t,r);var u=ms.of(t).sdkState;return l.isMentioned=et(l.message.mentionType,null!==(s=null!==(i=l.message.mentionedUserIds)&&void 0!==i?i:null===(a=l.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==s?s:[],u.userId),l.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,l}return I(t,e),t}(lt),qu=function(e){function t(t){var n=null;return t.mentionType===pe.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"MEDI",ackRequired:!0,payload:we(Ae({channel_url:t.channelUrl,msg_id:t.messageId,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,poll_id:t.pollId}))})||this}return I(t,e),t}(ut),Ku=function(e){function t(t,n,r){var i,a,s,o,l,u=this;(u=e.call(this,t,"MEDI",r)||this).message=new Yo(t,r);var c=ms.of(t).sdkState;return u.mentionCountChange=tt({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(s=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==s?s:[]},Ae({mentionType:u.message.mentionType,mentionedUserIds:null!==(o=u.message.mentionedUserIds)&&void 0!==o?o:null===(l=u.message.mentionedUsers)||void 0===l?void 0:l.map((function(e){return e.userId}))}),c.userId),u}return I(t,e),t}(lt),Wu=function(e){function t(t){var n=null;return t.mentionType===pe.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FEDI",ackRequired:!0,payload:we(Ae({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,apple_critical_alert_options:t.appleCriticalAlertOptions}))})||this}return I(t,e),t}(ut),Yu=function(e){function t(t,n,r){var i,a,s,o,l,u=this;(u=e.call(this,t,"FEDI",r)||this).message=new el(t,r);var c=ms.of(t).sdkState;return u.mentionCountChange=tt({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(s=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==s?s:[]},Ae({mentionType:u.message.mentionType,mentionedUserIds:null!==(o=u.message.mentionedUserIds)&&void 0!==o?o:null===(l=u.message.mentionedUsers)||void 0===l?void 0:l.map((function(e){return e.userId}))}),c.userId),u}return I(t,e),t}(lt),Qu=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.reactionKey,s=e.call(this)||this;return s.method=Me.POST,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),s.params={reaction:a},s}return I(t,e),t}(it),Xu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new uo(n),r}return I(t,e),t}(at),Zu=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.reactionKey,s=e.call(this)||this;return s.method=Me.DELETE,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),s.params={reaction:a},s}return I(t,e),t}(it),Ju=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new uo(S({},n)),r}return I(t,e),t}(at),$u=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.translationTargetLanguages,s=e.call(this)||this;return s.method=Me.POST,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i),"/translation"),s.params={target_langs:a},s}return I(t,e),t}(it),ec=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new Yo(t,n),r}return I(t,e),t}(at),tc=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===pe.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,s=t.channelUrl;return r.method=Me.POST,r.path="".concat(Je(a),"/").concat(encodeURIComponent(s),"/scheduled_messages"),r.params=we(Ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:fe.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return vo.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r}return I(t,e),t}(it),nc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new Yo(t,n),r}return I(t,e),t}(at),rc=function(e){function t(t){var n,r,i=this;i=e.call(this)||this;var a=[];t.mentionType===pe.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map((function(e){return e.userId}))));var s=t.channelType,o=t.channelUrl;return i.method=Me.POST,i.path="".concat(Je(s),"/").concat(encodeURIComponent(o),"/scheduled_messages"),i.params=Ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:fe.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:null===(n=t._thumbnails)||void 0===n?void 0:n.map((function(e){return io.payloadify(e)})),custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:a,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return vo.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption}),i}return I(t,e),t}(it),ic=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new el(t,n),r}return I(t,e),t}(at),ac=function(e){function t(t){var n=t.pollId,r=t.title,i=t.data,a=t.allowUserSuggestion,s=t.allowMultipleVotes,o=t.closeAt,l=e.call(this)||this;return l.method=Me.PUT,l.path="".concat(Ge,"/").concat(encodeURIComponent(n)),l.params={title:r,data:i,allow_user_suggestion:a,allow_multiple_votes:s,close_at:o},l}return I(t,e),t}(it),sc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new ks(t,n),r}return I(t,e),t}(at),oc=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=Me.DELETE,r.path="".concat(Ge,"/").concat(encodeURIComponent(n)),r}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var lc=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=Me.PUT,r.path="".concat(Ge,"/").concat(encodeURIComponent(n),"/close"),r}return I(t,e),t}(it),uc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new ks(t,n),r}return I(t,e),t}(at),cc=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=t.optionText,s=e.call(this)||this;return s.method=Me.POST,s.path="".concat(Ge,"/").concat(encodeURIComponent(i),"/options"),s.params={channel_url:n,channel_type:r,text:a},s}return I(t,e),t}(it),dc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new ks(t,n),r}return I(t,e),t}(at),hc=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=t.optionText,a=e.call(this)||this;return a.method=Me.PUT,a.path="".concat(Ge,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),a.params={text:i},a}return I(t,e),t}(it),fc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new ks(t,n),r}return I(t,e),t}(at),pc=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Ge,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var mc=function(e){function t(t){var n=t.reqId,r=t.channelType,i=t.channelUrl,a=t.pollId,s=t.pollOptionIds;return e.call(this,{code:"VOTE",ackRequired:!0,payload:we({req_id:n,channel_type:r===le.OPEN?"open_channels":"group_channels",channel_url:i,poll_id:a,option_ids:s})})||this}return I(t,e),t}(ut),gc=function(e){function t(t,n,r){var i=e.call(this,t,"VOTE",r)||this;return i.event=new Us(r),i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return I(t,e),t}(lt),_c="GroupChannel",vc="Message",Ec="NotificationMessage",yc="UserInfo";var bc=S(S({},wl),{fileInfoList:[],message:""}),Cc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onFileUploaded=At,t}return I(t,e),t.prototype._triggerOnFileUploaded=function(e,t,n,r){this._onFileUploaded(e,t,n,r)},t.prototype.onFileUploaded=function(e){return this._onFileUploaded=e,this},t.prototype.onPending=function(t){return e.prototype.onPending.call(this,t),this},t.prototype.onFailed=function(t){return e.prototype.onFailed.call(this,t),this},t.prototype.onSucceeded=function(t){return e.prototype.onSucceeded.call(this,t),this},t}(Sl),Nc=function(e){function t(t,n){var r=e.call(this,t)||this;return r.message=null,r.message=$o(t,n.message),r}return I(t,e),t}(ia),Tc=function(e){function t(t){var n=this,r=t.channelType,i=t.channelUrl,a=t.limit,s=t.token,o=t.includeReactions,l=t.includeMetaArray,u=t.includeParentMessageInfo,c=t.includeThreadInfo,d=t.includePollDetails;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(r),"/").concat(encodeURIComponent(i),"/pinned_messages"),n.params=we({limit:a,token:s,include_reactions_summary:o,with_sorted_meta_array:l,include_thread_info:c,include_parent_message_info:u,include_poll_details:d}),n}return I(t,e),t}(it),Ic=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.pinned_messages,a=n.has_more,s=n.next;return r.pinnedMessages=i.map((function(e){return new Nc(t,e)})),r.hasMore=a,r.token=s,r}return I(t,e),t}(at),Sc=function(e){function t(t,n,r,i){var a=e.call(this,t,n,r,i)||this;return a.includeMetaArray=i.includeMetaArray,a.includeReactions=i.includeReactions,a.includeParentMessageInfo=i.includeParentMessageInfo,a.includeThreadInfo=i.includeThreadInfo,a.includePollDetails=i.includePollDetails,a}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("boolean",this.includeMetaArray,!0)&&W("boolean",this.includeReactions,!0)&&W("boolean",this.includeParentMessageInfo,!0)&&W("boolean",this.includeThreadInfo,!0)&&W("boolean",this.includePollDetails,!0)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Tc(S(S({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(Ic),i=r.pinnedMessages,a=r.hasMore,s=r.token,this._token=s,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),wc=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=e.call(this)||this;return a.method=Me.POST,a.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/pin"),a}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var Ac=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=e.call(this)||this;return a.method=Me.DELETE,a.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/pin"),a}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var Mc;!function(e){e.SEND="send",e.RESEND="resend",e.COPY="copy"}(Mc||(Mc={}));var Oc,Rc=function(e){function t(t,n){var r,i,a,s,o,l,u,c=this;return(c=e.call(this,t)||this)._name="",c._createdAt=0,c.pinnedMessageIds=[],c.channelType=le.BASE,c.coverUrl="",c.customType="",c.data="",c.isFrozen=!1,c.isEphemeral=!1,c.creator=null,c._messageCollectionLastAccessedAt=0,c._url=n.channel_url,c._name=null!==(r=n.name)&&void 0!==r?r:"",c._createdAt=1e3*n.created_at,c.coverUrl=null!==(i=n.cover_url)&&void 0!==i?i:"",c.customType=null!==(a=n.custom_type)&&void 0!==a?a:"",c.data=null!==(s=n.data)&&void 0!==s?s:"",c.isFrozen=null!==(o=n.freeze)&&void 0!==o&&o,c.isEphemeral=null!==(l=n.is_ephemeral)&&void 0!==l&&l,c.creator=n.created_by?new ga(c._iid,n.created_by):null,n.metadata&&Object.keys(n.metadata).length>0&&n.ts?(c._cachedMetaData=new Map,Object.keys(n.metadata).forEach((function(e){c._cachedMetaData.set(e,{value:n.metadata[e],isRemoved:!1,updatedAt:n.ts})}))):"string"==typeof n.metadata&&(c._cachedMetaData=new Map(Object.entries(JSON.parse(n.metadata)))),c.pinnedMessageIds=null!==(u=n.pinned_message_ids)&&void 0!==u?u:[],c}return I(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return S(S({},this),{url:this._url,name:this._name,createdAt:this._createdAt})},t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:t.creator?ga.payloadify(t.creator):null,created_at:t.createdAt/1e3,metadata:t.cachedMetaData,pinned_message_ids:t.pinnedMessageIds})))},t.prototype.isGroupChannel=function(){return this.channelType===le.GROUP},t.prototype.isOpenChannel=function(){return this.channelType===le.OPEN},t.prototype.isFeedChannel=function(){return this.channelType===le.FEED},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData?(this._cachedMetaData.forEach((function(t,n){t.isRemoved||(e[n]=t.value)})),e):e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),t.prototype._serializeCachedMetaData=function(){return this._cachedMetaData?{cachedMetaData:JSON.stringify(Object.fromEntries(this._cachedMetaData))}:{}},t.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now()},t.prototype._update=function(e){Object.assign(this,e)},t.prototype._upsertCachedMetaData=function(e,t){var n=this;Object.keys(e).forEach((function(r){n._cachedMetaData||(n._cachedMetaData=new Map);var i=n._cachedMetaData.get(r);(!i||i.updatedAt<=t)&&n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})}))},t.prototype._updateCachedMetaData=function(e,t){var n=this,r=!1;return this._cachedMetaData?this._cachedMetaData.forEach((function(i,a){var s;i.updatedAt<=t&&(n._cachedMetaData.set(a,{value:null!==(s=e[a])&&void 0!==s?s:i.value,isRemoved:!e[a],updatedAt:t}),r=!0)})):(this._cachedMetaData=new Map,Object.keys(e).forEach((function(r){n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})})),r=!0),{isUpdated:r}},t.prototype._removeFromCachedMetaData=function(e,t){var n=this;this._cachedMetaData&&e.forEach((function(e){var r=n._cachedMetaData.get(e);r&&r.updatedAt<t&&(r.isRemoved=!0,r.updatedAt=t)}))},t.prototype._clearCachedMetaData=function(){this._cachedMetaData&&this._cachedMetaData.clear()},t.prototype._runIfHandleableWithGroupChannel=function(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel)},t.prototype._generateRequestId=function(){return"rq-".concat(Ce())},t.prototype.isIdentical=function(e){return e&&this.url===e.url},t.prototype.isEqual=function(e){return K(this,e)},t.prototype.createOperatorListQuery=function(e){return void 0===e&&(e={}),new Xl(this._iid,this.url,this.channelType,e)},t.prototype.createMutedUserListQuery=function(e){return void 0===e&&(e={}),new eu(this._iid,this.url,this.channelType,e)},t.prototype.createBannedUserListQuery=function(e){return void 0===e&&(e={}),new ru(this._iid,this.url,this.channelType,e)},t.prototype.createPreviousMessageListQuery=function(e){return void 0===e&&(e={}),new Zl(this._iid,this.url,this.channelType,e)},t.prototype.createPinnedMessageListQuery=function(e){return void 0===e&&(e={}),new Sc(this._iid,this.url,this.channelType,e)},t.prototype.addOperators=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new iu({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.removeOperators=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new au({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.getMyMutedInfo=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c;return A(this,(function(d){switch(d.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new su({channelUrl:this.url,channelType:this.channelType,userId:t.userId}),[4,n.send(r)];case 1:return i=d.sent(),a=i.as(ou),s=a.isMuted,o=a.startAt,l=a.endAt,u=a.remainingDuration,c=a.description,[2,{isMuted:s,startAt:o,endAt:l,remainingDuration:u,description:c}]}}))}))},t.prototype.getMetaData=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new lu({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return r=o.sent(),i=r.as(uu),a=i.metadata,s=i.ts,this._upsertCachedMetaData(a,s),[2,a]}}))}))},t.prototype.getAllMetaData=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return e=ms.of(this._iid).requestQueue,t=new lu({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return n=s.sent(),r=n.as(uu),i=r.metadata,a=r.ts,this._updateCachedMetaData(i,a),[2,i]}}))}))},t.prototype.createMetaData=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=ms.of(this._iid).requestQueue,n=new cu({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,t.send(n)];case 1:return r=a.sent(),i=r.as(du).metaData,this._upsertCachedMetaData(i,0),[2,i]}}))}))},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return n=ms.of(this._iid).requestQueue,r=new hu({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:t}),[4,n.send(r)];case 1:return i=l.sent(),a=i.as(fu),s=a.metadata,o=a.ts,this._upsertCachedMetaData(s,o),[2,s]}}))}))},t.prototype.deleteMetaData=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new mu({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r=a.sent(),i=r.as(gu).ts,this._removeFromCachedMetaData([e],i),[2]}}))}))},t.prototype.deleteAllMetaData=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid).requestQueue,t=new _u({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n=i.sent(),r=n.as(vu).ts,this._removeFromCachedMetaData(R([],O(this._cachedMetaData.keys()),!1),r),[2]}}))}))},t.prototype.getMetaCounters=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new Eu({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return[2,r.sent().as(yu).metaCounter]}}))}))},t.prototype.getAllMetaCounters=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new Eu({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return[2,n.sent().as(yu).metaCounter]}}))}))},t.prototype.createMetaCounters=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=ms.of(this._iid).requestQueue,n=new bu({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,t.send(n)];case 1:return[2,r.sent().as(Cu).metaCounter]}}))}))},t.prototype.updateMetaCounters=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return n=ms.of(this._iid).requestQueue,r=new Nu({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:t}),[4,n.send(r)];case 1:return[2,i.sent().as(Tu).metaCounter]}}))}))},t.prototype.increaseMetaCounters=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=ms.of(this._iid).requestQueue,n=new Nu({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,t.send(n)];case 1:return[2,r.sent().as(Tu).metaCounter]}}))}))},t.prototype.decreaseMetaCounters=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=ms.of(this._iid).requestQueue,n=new Nu({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,t.send(n)];case 1:return[2,r.sent().as(Tu).metaCounter]}}))}))},t.prototype.deleteMetaCounter=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new Su({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.deleteAllMetaCounters=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new wu({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.muteUser=function(e,t,n){return w(this,0,void 0,(function(){return A(this,(function(r){return[2,this.muteUserWithUserId(e.userId,t,n)]}))}))},t.prototype.muteUserWithUserId=function(e,t,n){return w(this,0,void 0,(function(){var r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("string",e)&&W("number",t,!0)&&W("string",n,!0)).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new Au({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},t.prototype.unmuteUser=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this.unmuteUserWithUserId(e.userId)]}))}))},t.prototype.unmuteUserWithUserId=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new Ou({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.banUser=function(e,t,n){return w(this,0,void 0,(function(){return A(this,(function(r){return[2,this.banUserWithUserId(e.userId,t,n)]}))}))},t.prototype.banUserWithUserId=function(e,t,n){return w(this,0,void 0,(function(){var r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("string",e)&&W("number",t,!0)&&W("string",n,!0)).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new ku({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},t.prototype.unbanUser=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this.unbanUserWithUserId(e.userId)]}))}))},t.prototype.unbanUserWithUserId=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new Du({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.freeze=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new Lu({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!0,[2]}}))}))},t.prototype.unfreeze=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new Lu({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!1,[2]}}))}))},t.prototype.getMessagesByMessageId=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},cl),t),pa(W("number",e)&&dl(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessagesByTimestamp=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},cl),t),pa(W("number",e)&&dl(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,t){return void 0===t&&(t={}),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},hl),t),pa(W("number",e)&&fl(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessageChangeLogsSinceToken=function(e,t){return void 0===t&&(t={}),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},hl),t),pa(W("string",e)&&fl(n)).throw(z.invalidParameters),[4,fh.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype._createPendingSendableMessagePayload=function(e,t,n){var r,i=ms.of(this._iid).sessionManager;return we(Ae({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map((function(e){return vo.payloadify(e)})):null,apple_critical_alert_options:e.appleCriticalAlertOptions?mo.payloadify(e.appleCriticalAlertOptions):null,created_at:n,user:i.currentUser?_o.payloadify(i.currentUser):null,req_id:t,request_state:_e.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return ga.payloadify(e)}))}))},t.prototype._createPendingUserMessage=function(e,t,n){var r,i,a={};if(e.translationTargetLanguages)try{for(var s=M(e.translationTargetLanguages),o=s.next();!o.done;o=s.next())a[o.value]=""}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}var l=we(S(S({},this._createPendingSendableMessagePayload(e,t,n)),{type:de.USER,message:e.message,translations:a,extended_message_payload:e.extendedMessagePayload})),u=new Yo(this._iid,l);return u.messageParams=e,u},t.prototype._createPendingScheduledUserMessage=function(e,t,n){var r=this._createPendingUserMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._createPendingFileMessage=function(e,t,n){var r,i,a,s,o,l,u,c=we(S(S({},this._createPendingSendableMessagePayload(e,t,n)),{type:de.FILE,url:e.fileUrl,file:{name:null!==(r=e.fileName)&&void 0!==r?r:null===(i=e.file)||void 0===i?void 0:i.name,size:null!==(a=e.fileSize)&&void 0!==a?a:null===(s=e.file)||void 0===s?void 0:s.size,type:null!==(o=e.mimeType)&&void 0!==o?o:null===(l=e.file)||void 0===l?void 0:l.type,data:e.data},thumbnails:null===(u=e._thumbnails)||void 0===u?void 0:u.map((function(e){return io.payloadify(e)})),message:e.message})),d=new el(this._iid,c);return d.messageParams=e,d},t.prototype._createPendingMultipleFilesMessage=function(e,t,n){var r=we(S(S({},this._createPendingSendableMessagePayload(e,t,n)),{type:de.FILE,file:e.fileInfoList.length>0?{name:e.fileInfoList[0].fileName,size:e.fileInfoList[0].fileSize,type:e.fileInfoList[0].mimeType,data:e.data}:void 0,message:e.message})),i=new Qo(this._iid,r);return i.messageParams=e,i},t.prototype._validateFailedFileMessageHasFile=function(e,t){var n;return Boolean(e.url)||$(t)||$(null===(n=e.messageParams)||void 0===n?void 0:n.file)},t.prototype._createPendingScheduledFileMessage=function(e,t,n){var r=this._createPendingFileMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._markMessageAsFailed=function(e,t,n){void 0===n&&(n=!1),e.errorCode=t.code,t.code===k.REQUEST_CANCELED||t.code===k.FILE_UPLOAD_CANCEL_FAILED?e.sendingStatus=_e.CANCELED:n||(e.sendingStatus=_e.FAILED)},t.prototype.sendUserMessage=function(e){var t=S(S({},Ol),e);return pa(Dl(t)).throw(z.invalidParameters),this._sendUserMessage(t)},t.prototype._sendUserMessage=function(e,t,n){var r=this;void 0===t&&(t=Mc.SEND);var i=ms.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=null!=n?n:this._generateRequestId(),l=Date.now(),u=new Sl;return Sa(2).then((function(){var n=r._createPendingUserMessage(e,o,l);a.dispatch(new vs({messages:[n],source:t===Mc.RESEND?os.LOCAL_MESSAGE_RESEND_STARTED:os.EVENT_MESSAGE_SENT_PENDING})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,u._trigger(n)]}))}))}));var i=new zu(S(S({},e),{channelUrl:r.url,channelType:r.channelType,reqId:o}));s.send(i).then((function(e){var t=e.as(Vu).message;a.dispatch(new vs({messages:[t],source:os.EVENT_MESSAGE_SENT_SUCCESS})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,u._trigger(t)]}))}))}))})).catch((function(t){if(G(t))throw t;Sa(2).then((function(){var n=r._createPendingUserMessage(e,o,l),i=ms.of(r._iid).cacheContext,s=i.localCacheEnabled&&i.localCacheConfig.enableAutoResend&&J(t.code);r._markMessageAsFailed(n,t,s),a.dispatch(new vs({messages:[n],source:n.sendingStatus===_e.PENDING?os.REQUEST_RESEND_MESSAGE:os.EVENT_MESSAGE_SENT_FAILED})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,u._triggerFailed(t,n)]}))}))}))}))}))})),u},t.prototype._autoResendUserMessage=function(e){return pa(e instanceof Yo&&!!e.messageParams).throw(z.invalidParameters),this._sendUserMessage(e.messageParams,Mc.SEND,e.reqId)},t.prototype.resendUserMessage=function(e){var t;return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){return pa(e instanceof Yo&&!e.scheduledInfo).throw(z.invalidParameters),n=new Nt,r=null!==(t=e.messageParams)&&void 0!==t?t:xl(e),this._sendUserMessage(r,Mc.RESEND,e.reqId).onFailed((function(e){return n.reject(e)})).onSucceeded((function(e){return n.resolve(e)})),[2,n.promise]}))}))},t.prototype.updateUserMessage=function(e,t){return w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){switch(a.label){case 0:return n=S(S({},ql),t),pa(W("number",e)&&Kl(n)).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new qu(S({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:n.metaArrays?{array:n.metaArrays,mode:"add",upsert:!0}:void 0},n)),[4,r.send(i)];case 1:return[2,a.sent().as(Ku).message]}}))}))},t.prototype.copyUserMessage=function(e,n){var r,i,a;return w(this,0,void 0,(function(){var s,o;return A(this,(function(l){return pa(e instanceof t&&n instanceof Yo&&n.sendingStatus===_e.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(z.invalidParameters),pa(!n.poll).throw(z.notSupportedError),s=new Nt,o=null!==(r=n.messageParams)&&void 0!==r?r:Ae(S(S({},n),{mentionType:n.mentionType,mentionedUserIds:null!==(i=n.mentionedUserIds)&&void 0!==i?i:null===(a=n.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})),translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:ge.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),e._sendUserMessage(o).onSucceeded((function(e){s.resolve(e)})).onFailed((function(e){return s.reject(e)})),[2,s.promise]}))}))},t.prototype.translateUserMessage=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return pa(e instanceof Yo&&e.messageId>0&&X("string",t)).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new $u({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:t}),[4,n.send(r)];case 1:return[2,i.sent().as(ec).message]}}))}))},t.prototype._createScheduledUserMessage=function(e,t){var n=this,r=ms.of(this._iid).requestQueue,i=Date.now(),a=this._generateRequestId();Sa(2).then((function(){var r=n._createPendingScheduledUserMessage(e,a,i);Fi((function(){return w(n,0,void 0,(function(){return A(this,(function(e){return[2,t._trigger(r)]}))}))}))}));var s=new tc(S({reqId:a,channelType:this.channelType,channelUrl:this.url},e));r.send(s).then((function(e){var r=e.as(nc).message;Fi((function(){return w(n,0,void 0,(function(){return A(this,(function(e){return[2,t._trigger(r)]}))}))}))})).catch((function(r){if(G(r))throw r;Sa(2).then((function(){var s=n._createPendingScheduledUserMessage(e,a,i);n._markMessageAsFailed(s,r),Fi((function(){return w(n,0,void 0,(function(){return A(this,(function(e){return[2,t._triggerFailed(r,s)]}))}))}))}))}))},t.prototype.sendFileMessage=function(e){var t=S(S({},Fl),e);return pa(Gl(t)).throw(z.invalidParameters),this._sendFileMessage(t)},t.prototype.sendMultipleFilesMessage=function(e){var t,n,r,i=S(S({},bc),e),a=ms.of(this._iid);pa((n=i,r=null===(t=a.appInfo)||void 0===t?void 0:t.multipleFilesMessageFileCountLimit,void 0===r&&(r=5),Al(n)&&W("string",n.message,!0)&&Array.isArray(n.fileInfoList)&&n.fileInfoList.length>=2&&n.fileInfoList.length<=r&&n.fileInfoList.every((function(e){return function(e){return($(e.file)||W("string",e.fileUrl))&&W("string",e.fileName,!0)&&W("string",e.mimeType,!0)&&W("number",e.fileSize,!0)&&(void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every((function(e){return e.maxWidth>0&&e.maxHeight>0})))}(e)})))).throw(z.invalidParameters);var s=!!e.fileInfoList.find((function(e){var t=a.appInfo.uploadSizeLimit;return e.file instanceof Blob&&e.file.size>t||e.fileSize>t}));return pa(!s).throw(z.fileSizeLimitExceededError),this._sendMultipleFilesMessage(i)},t.prototype._sendFileMessage=function(e,t,n){var r=this;void 0===t&&(t=Mc.SEND);var i=ms.of(this._iid).dispatcher,a=fh.of(this._iid).fileMessageQueue,s=null!=n?n:this._generateRequestId(),o=Date.now(),l=new Sl;return Sa(2).then((function(){var n=r._createPendingFileMessage(e,s,o);i.dispatch(new vs({messages:[n],source:t===Mc.RESEND?os.LOCAL_MESSAGE_RESEND_STARTED:os.EVENT_MESSAGE_SENT_PENDING})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,l._trigger(n)]}))}))})),a.request(r,s,e).then((function(e){i.dispatch(new vs({messages:[e],source:os.EVENT_MESSAGE_SENT_SUCCESS})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(t){return[2,l._trigger(e)]}))}))}))})).catch((function(t){if(G(t))throw t;Sa(2).then((function(){var n=r._createPendingFileMessage(e,s,o),a=ms.of(r._iid).cacheContext,u=a.localCacheEnabled&&a.localCacheConfig.enableAutoResend&&J(t.code);r._markMessageAsFailed(n,t,u),i.dispatch(new vs({messages:[n],source:n.sendingStatus===_e.PENDING?os.REQUEST_RESEND_MESSAGE:t.code===k.FILE_UPLOAD_CANCEL_FAILED?os.LOCAL_MESSAGE_CANCELED:os.EVENT_MESSAGE_SENT_FAILED})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,l._triggerFailed(t,n)]}))}))}))}))}))})),l},t.prototype._autoResendFileMessage=function(e){pa(e instanceof el&&!!e.messageParams).throw(z.invalidParameters);var t=ms.of(this._iid).logger;return t.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,Mc.SEND,e.reqId).onFailed((function(e){t.debug("autoResendFileMessage failed",e)})).onSucceeded((function(e){t.debug("autoResendFileMessage success",e)}))},t.prototype._sendMultipleFilesMessage=function(e,t,n){var r=this,i=ms.of(this._iid).dispatcher,a=fh.of(this._iid).fileMessageQueue,s=null!=n?n:this._generateRequestId(),o=Date.now(),l=new Cc;return Sa(2).then((function(){var n=r._createPendingMultipleFilesMessage(e,s,o);i.dispatch(new vs({messages:[n],source:t===Mc.RESEND?os.LOCAL_MESSAGE_RESEND_STARTED:os.EVENT_MESSAGE_SENT_PENDING})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,l._trigger(n)]}))}))})),a.request(r,s,e,{requestHandler:l,isCopy:t===Mc.COPY}).then((function(e){i.dispatch(new vs({messages:[e],source:os.EVENT_MESSAGE_SENT_SUCCESS})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(t){return[2,l._trigger(e)]}))}))}))})).catch((function(t){if(G(t))throw t;Sa(2).then((function(){var n=r._createPendingMultipleFilesMessage(e,s,o);r._markMessageAsFailed(n,t),i.dispatch(new vs({messages:[n],source:os.EVENT_MESSAGE_SENT_FAILED})),Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,l._triggerFailed(t,n)]}))}))}))}))}))})),l},t.prototype._createScheduledFileMessage=function(e,t,n,r){var i=this,a=ms.of(this._iid).requestQueue,s=new rc(S(S({reqId:n,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));a.send(s).then((function(e){var n=e.as(ic).message;Fi((function(){return w(i,0,void 0,(function(){return A(this,(function(e){return[2,t._trigger(n)]}))}))}))})).catch((function(a){if(G(a))throw a;Sa(2).then((function(){var s=i._createPendingScheduledFileMessage(e,n,r);i._markMessageAsFailed(s,a),Fi((function(){return w(i,0,void 0,(function(){return A(this,(function(e){return[2,t._triggerFailed(a,s)]}))}))}))}))}))},t.prototype.sendFileMessages=function(e){var t,n;pa(e.every((function(e){return Gl(S(S({},Fl),e))}))).throw(z.invalidParameters);var r=new Sl;try{for(var i=M(e),a=i.next();!a.done;a=i.next()){var s=a.value;this.sendFileMessage(s).onPending((function(e){return r._trigger(e)})).onFailed((function(e,t){return r._triggerFailed(e,t)})).onSucceeded((function(e){return r._trigger(e)}))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},t.prototype.resendFileMessage=function(e,t){return w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){return n=this._validateFailedFileMessageHasFile(e,t),pa(e instanceof el&&n&&!e.scheduledInfo).throw(z.invalidParameters),r=new Nt,i=Hl(e,t),this._sendFileMessage(i,Mc.RESEND,e.reqId).onFailed((function(e){return r.reject(e)})).onSucceeded((function(e){return r.resolve(e)})),[2,r.promise]}))}))},t.prototype.resendMessage=function(e,t){var n,r;if(pa(e instanceof Go&&!e.scheduledInfo&&e.isResendable).throw(z.invalidParameters),e.isUserMessage()){var i=null!==(n=e.messageParams)&&void 0!==n?n:xl(e);return this._sendUserMessage(i,Mc.RESEND,e.reqId)}if(e.isFileMessage()){var a=this._validateFailedFileMessageHasFile(e,t);return pa(a).throw(z.invalidParameters),i=null!==(r=e.messageParams)&&void 0!==r?r:Hl(e,t),this._sendFileMessage(i,Mc.RESEND,e.reqId)}if(e.isMultipleFilesMessage())throw z.channelTypeNotSupportedError},t.prototype.updateFileMessage=function(e,t){return w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){switch(a.label){case 0:return n=S(S({},Wl),t),pa(W("number",e)&&(s=n,Vl(s))).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new Wu(S({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:n.metaArrays?{array:n.metaArrays,mode:"add",upsert:!0}:void 0},n)),[4,r.send(i)];case 1:return[2,a.sent().as(Yu).message]}var s}))}))},t.prototype.uploadFile=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return t=ms.of(this._iid).requestQueue,n=Ce(),(r=new ao({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:n})).uploadProgressHandler=e.progressHandler,e.uploadStartedHandler&&e.uploadStartedHandler(n),[4,t.send(r)];case 1:return i=l.sent(),a=i.as(so),s=a.url,o=a.thumbnails,[2,{requestId:n,url:s,thumbnails:o}]}}))}))},t.prototype.cancelUploadingFileMessage=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return pa(W("string",e)).throw(z.invalidParameters),fh.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0]}))}))},t.prototype.copyFileMessage=function(e,n){var r,i,a;return w(this,0,void 0,(function(){var s,o;return A(this,(function(l){return pa(e instanceof t&&n instanceof el&&n.sendingStatus===_e.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(z.invalidParameters),s=new Nt,o=Ae(S(S({},n),{fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:null!==(r=n.mentionedUserIds)&&void 0!==r?r:null===(i=n.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})),pushNotificationDeliveryOption:ge.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(a=n.thumbnails)||void 0===a?void 0:a.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),requireAuth:n.requireAuth,isPinnedMessage:!1})),e._sendFileMessage(o).onSucceeded((function(e){return s.resolve(e)})).onFailed((function(e){return s.reject(e)})),[2,s.promise]}))}))},t.prototype.copyMessage=function(e,n){pa(e instanceof t&&n instanceof Go&&n.sendingStatus===_e.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(z.invalidParameters);var r=n,i=e;if(r.isUserMessage()){pa(!r.poll).throw(z.notSupportedError);var a=Rl(r);return i._sendUserMessage(a)}if(r.isFileMessage())return a=Bl(r),i._sendFileMessage(a);if(n.isMultipleFilesMessage())throw z.channelTypeNotSupportedError},t.prototype.deleteMessage=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(e instanceof Ho).throw(z.invalidParameters),e.messageId>0?(t=ms.of(this._iid).requestQueue,n=new It({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,messageToken:e instanceof Go?e._messageToken:void 0}),[4,t.send(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.addReaction=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return pa(e instanceof Ho&&e.messageId>0&&W("string",t)).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new Qu({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(Xu).reactionEvent]}}))}))},t.prototype.deleteReaction=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return pa(e instanceof Ho&&e.messageId>0&&W("string",t)).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new Zu({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(Ju).reactionEvent]}}))}))},t.prototype._updateUserMessageMetaArray=function(e,t,n,r){return w(this,0,void 0,(function(){var i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:return i=ms.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=new qu({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,s.send(o)];case 1:return l=c.sent(),u=l.as(Ku).message,a.dispatch(new vs({messages:[u],source:os.EVENT_MESSAGE_UPDATED})),[2,u]}}))}))},t.prototype._updateFileMessageMetaArray=function(e,t,n,r){return w(this,0,void 0,(function(){var i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:return i=ms.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=new Wu({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,s.send(o)];case 1:return l=c.sent(),u=l.as(Yu).message,a.dispatch(new vs({messages:[u],source:os.EVENT_MESSAGE_UPDATED})),[2,u]}}))}))},t.prototype.createMessageMetaArrayKeys=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){return pa(e instanceof Ho&&e.messageId>0&&X("string",t)).throw(z.invalidParameters),n=t.map((function(e){return new vo({key:e})})),e instanceof el?[2,this._updateFileMessageMetaArray(e.messageId,n,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"add",!0)]}))}))},t.prototype.deleteMessageMetaArrayKeys=function(e,t){return w(this,0,void 0,(function(){var n;return A(this,(function(r){return pa(e instanceof Ho&&e.messageId>0&&X("string",t)).throw(z.invalidParameters),n=t.map((function(e){return new vo({key:e})})),e instanceof el?[2,this._updateFileMessageMetaArray(e.messageId,n,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"remove",!0)]}))}))},t.prototype.addMessageMetaArrayValues=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){return pa(e instanceof Ho&&e.messageId>0&&t.every((function(e){return e instanceof vo}))).throw(z.invalidParameters),e instanceof el?[2,this._updateFileMessageMetaArray(e.messageId,t,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"add",!0)]}))}))},t.prototype.removeMessageMetaArrayValues=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){return pa(e instanceof Ho&&e.messageId>0&&t.every((function(e){return e instanceof vo}))).throw(z.invalidParameters),e instanceof el?[2,this._updateFileMessageMetaArray(e.messageId,t,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"remove",!0)]}))}))},t.prototype.report=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return pa((Y(jl,e)||e instanceof cs)&&W("string",t)).throw(z.invalidParameters),n=ms.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new ju({channelUrl:this.url,channelType:this.channelType,userId:r.userId,category:e,description:t}),[4,i.send(a)];case 1:return s.sent(),[2]}}))}))},t.prototype.reportUser=function(e,t,n){return w(this,0,void 0,(function(){var r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(e instanceof ga&&(Y(jl,t)||t instanceof cs)&&W("string",n)).throw(z.invalidParameters),r=ms.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new Hu({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.userId,category:t,description:n}),[4,a.send(s)];case 1:return o.sent(),[2]}}))}))},t.prototype.reportMessage=function(e,t,n){return w(this,0,void 0,(function(){var r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(e instanceof Go&&(Y(jl,t)||t instanceof cs)&&W("string",n)).throw(z.invalidParameters),r=ms.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new Gu({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:t,description:n,messageToken:e._messageToken}),[4,a.send(s)];case 1:return o.sent(),[2]}}))}))},t.prototype.updatePoll=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return pa(W("number",e)&&(a=t,W("string",a.title,!0)&&Os(a.data)&&W("boolean",a.allowUserSuggestion,!0)&&W("boolean",a.allowMultipleVotes,!0)&&W("number",a.closeAt,!0))).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new ac(S({pollId:e},t)),[4,n.send(r)];case 1:return[2,i.sent().as(sc).poll]}var a}))}))},t.prototype.deletePoll=function(e){return w(this,0,void 0,(function(){var t,n,r;return A(this,(function(i){switch(i.label){case 0:return t=W("number",e),pa(t).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new oc({pollId:e}),[4,n.send(r)];case 1:return i.sent(),[2]}}))}))},t.prototype.closePoll=function(e){return w(this,0,void 0,(function(){var t,n,r;return A(this,(function(i){switch(i.label){case 0:return t=W("number",e),pa(t).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new lc({pollId:e}),[4,n.send(r)];case 1:return[2,i.sent().as(uc).poll]}}))}))},t.prototype.addPollOption=function(e,t){return w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){switch(a.label){case 0:return n=W("number",e)&&W("string",t)&&""!==t.trim(),pa(n).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new cc({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:t}),[4,r.send(i)];case 1:return[2,a.sent().as(dc).poll]}}))}))},t.prototype.updatePollOption=function(e,t,n){return w(this,0,void 0,(function(){var r,i,a;return A(this,(function(s){switch(s.label){case 0:return r=W("number",e)&&W("number",t)&&W("string",n)&&""!==n.trim(),pa(r).throw(z.invalidParameters),i=ms.of(this._iid).requestQueue,a=new hc({pollId:e,pollOptionId:t,optionText:n}),[4,i.send(a)];case 1:return[2,s.sent().as(fc).poll]}}))}))},t.prototype.deletePollOption=function(e,t){return w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){switch(a.label){case 0:return n=W("number",e)&&W("number",t),pa(n).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new pc({pollId:e,pollOptionId:t}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},t.prototype.votePoll=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return n=W("number",e)&&X("number",t),pa(n).throw(z.invalidParameters),r=ms.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new mc({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:t}),[4,i.send(s)];case 1:return o=u.sent(),l=o.as(gc).event,a.dispatch(new Ss({event:l,source:os.EVENT_POLL_VOTED})),[2,l]}}))}))},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return pa(W("number",e)).throw(z.invalidParameters),[4,Zs.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getPollChangeLogsSinceToken=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return pa(W("string",e,!0)),[4,Zs.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.createPollListQuery=function(e){return void 0===e&&(e=10),new eo(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})},t.prototype.createPollVoterListQuery=function(e,t,n){return void 0===n&&(n=20),new ro(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:t,limit:n})},t.prototype.pinMessage=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(W("number",e)&&e>0).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new wc({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.unpinMessage=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return pa(W("number",e)&&e>0).throw(z.invalidParameters),t=ms.of(this._iid).requestQueue,n=new Ac({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t}(ia),kc=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return I(t,e),t}((function(){this.onConnected=At,this.onReconnectStarted=At,this.onReconnectSucceeded=At,this.onReconnectFailed=At,this.onDisconnected=At})),xc=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return I(t,e),t}((function(){this.onSessionExpired=At,this.onSessionTokenRequired=function(e){return e(null)},this.onSessionError=At,this.onSessionRefreshed=At,this.onSessionClosed=At})),Dc=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return I(t,e),t}((function(){this.onFriendsDiscovered=At,this.onTotalUnreadMessageCountChanged=At,this.onTotalUnreadMessageCountUpdated=At})),Uc=function(e){function t(t){var n=t.limit,r=t.token,i=t.userIdsFilter,a=t.metaDataKeyFilter,s=t.metaDataValuesFilter,o=t.nicknameStartsWithFilter,l=e.call(this)||this;return l.method=Me.GET,l.path=Re,l.params=we({limit:n,token:r,user_ids:i,metadatakey:a,metadatavalues_in:s,nickname_startswith:o}),l}return I(t,e),t}(it),Lc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new ga(t,e)})),r.next=n.next,r}return I(t,e),t}(at),Pc=function(e){function t(t,n){var r,i,a,s=this;return(s=e.call(this,t,n)||this).userIdsFilter=null,s.metaDataKeyFilter=null,s.metaDataValuesFilter=null,s.nicknameStartsWithFilter=null,s.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,s.metaDataKeyFilter=null!==(i=n.metaDataKeyFilter)&&void 0!==i?i:null,s.metaDataValuesFilter=null!==(a=n.metaDataValuesFilter)&&void 0!==a?a:null,s.nicknameStartsWithFilter=n.nicknameStartsWithFilter||null,s}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&X("string",this.userIdsFilter,!0)&&W("string",this.metaDataKeyFilter,!0)&&X("string",this.metaDataValuesFilter,!0)&&W("string",this.nicknameStartsWithFilter,!0)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Uc(Ae(S(S({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(Lc),i=r.users,a=r.next,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),Fc=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,a=t.userIdsFilter,s=e.call(this)||this;return s.method=Me.GET,s.path="".concat(Re,"/").concat(n,"/block"),s.params=we({limit:r,token:i,user_ids:a}),s}return I(t,e),t}(it),Bc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new ga(t,e)})),r.next=n.next,r}return I(t,e),t}(at),jc=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).userIdsFilter=null,i.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,i}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&X("string",this.userIdsFilter,!0)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Fc(Ae(S(S({},this),{userId:t.userId,token:this._token}))),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(Bc),s=a.users,o=a.next,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),Hc=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,a=e.call(this)||this;return a.method=Me.GET,a.path="".concat(Re,"/").concat(encodeURIComponent(n),"/friends"),a.params={limit:r,token:i},a}return I(t,e),t}(it),Gc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hasMore=n.has_more,r.users=n.users.map((function(e){return new ga(t,e)})),r.next=n.next,r}return I(t,e),t}(at),zc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Hc(S(S({},this),{userId:t.userId,token:this._token})),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=u.sent(),a=i.as(Gc),s=a.users,o=a.hasMore,l=a.next,this._token=l,this._hasNext=o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),Vc={},qc=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=void 0===n?1048576:n,i=e.cacheLimit,a=void 0===i?256:i,s=e.blockHashBase,o=void 0===s?2:s,l=e.blockHashMultiplier,u=void 0===l?10:l,c=e.blockHashConstant,d=void 0===c?11:c,h=e.transactionApplyDelay,f=void 0===h?200:h,p=e.disableLogger,m=void 0!==p&&p;return Vc[t]||(this.itemSizeLimit=r,this.cacheLimit=a,this.blockHashBase=o,this.blockHashMultiplier=u,this.blockHashConstant=d,this.transactionApplyDelay=f,this.disableLogger=m,Vc[t]=this),Vc[t]}return e.get=function(e){return Vc[e]},e}();!function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"}(Oc||(Oc={}));var Kc,Wc=function(e){function t(n){var r=n.code,i=void 0===r?Oc.UNKNOWN_ERROR:r,a=n.message,s=void 0===a?"Unknown error occurred.":a,o=e.call(this,s)||this;return o.code=i,Object.setPrototypeOf(o,t.prototype),o}return I(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:Oc.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:Oc.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:Oc.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:Oc.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotInitialized",{get:function(){return new t({code:Oc.STORE_NOT_INITIALIZED,message:"Store is not initialized."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:Oc.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:Oc.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:Oc.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:Oc.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:Oc.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:Oc.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:Oc.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:Oc.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:Oc.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:Oc.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:Oc.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:Oc.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:Oc.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:Oc.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:Oc.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:Oc.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:Oc.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:Oc.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:Oc.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:Oc.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed"}(Kc||(Kc={}));var Yc,Qc=function(e,t){if(void 0===t&&(t=new WeakMap),"object"==typeof e&&null!==e){if(t.has(e))throw Wc.circularReferenceFound;var n;return t.set(e,!0),Array.isArray(e)?n=e.map((function(e){return Qc(e,t)})):e instanceof RegExp||e instanceof Date?n=e:(n={},Object.keys(e).forEach((function(r){n[r]=Qc(e[r],t)}))),t.delete(e),n}return e},Xc=function(e,t){if(null==t)return 1;if(null==e)return-1;if(typeof e!=typeof t)throw Wc.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t)}return n},Zc=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return(n>>>0)%t},Jc=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},$c=function(e,t){if(!t)return!1;if("function"!=typeof e){for(var n in e)if(["/and","&&"].includes(n)){if(e[n].some((function(e){return!$c(e,t)})))return!1}else if(["/or","||"].includes(n)){if(e[n].every((function(e){return!$c(e,t)})))return!1}else if("/where"===n){if(!(0,e[n])(t))return!1}else{var r=n;if("object"==typeof e[r]){var i=e[r];for(var a in i)switch(a){case"/eq":case"=":if((s=t[r])!==(o=i[a]))return!1;break;case"/neq":case"!=":if((s=t[r])===(o=i[a]))return!1;break;case"/gt":case">":var s=t[r],o=i[a];if(!(Xc(s,o)>0))return!1;break;case"/gte":case">=":if(s=t[r],o=i[a],!(Xc(s,o)>=0))return!1;break;case"/lt":case"<":if(s=t[r],o=i[a],!(Xc(s,o)<0))return!1;break;case"/lte":case"<=":if(s=t[r],o=i[a],!(Xc(s,o)<=0))return!1;break;case"/in":if(s=t[r],!(o=i[a]).includes(s))return!1;break;case"/nin":if(s=t[r],(o=i[a]).includes(s))return!1;break;case"/contain":if(s=t[r],o=i[a],!s.includes(o))return!1;break;case"/regex":if(s=t[r],!(o=i[a]).test(s))return!1;break;case"/where":if(s=t[r],!(0,i[a])(s))return!1}}else if("function"==typeof e[r]){if(!e[r](t[r]))return!1}else if(e[r]!==t[r])return!1}return!0}return e(t)},ed=function(){},td=function(){return Promise.resolve()},nd=function(e){return e},rd=function(e,t){t()};!function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD"}(Yc||(Yc={}));var id,ad,sd,od=function(){function e(e){var t=e.initialPrevValue,n=void 0===t?null:t,r=e.initialNextValue,i=void 0===r?null:r,a=e.iterator,s=e.map,o=void 0===s?nd:s,l=e.backward,u=void 0===l?td:l,c=e.forward,d=void 0===c?td:c,h=e.complete,f=void 0===h?ed:h;this._prevValue=n,this._nextValue=i,this._error=null,this._map=o,this._backward=u,this._forward=d,this._iterator=a,this._complete=f}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:if(!this.hasPrevious)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:if(!this.hasNext)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},e}(),ld=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.blockManager,s=e.indexer;this.condition=n,this.backward=i,this._blockManager=a,this._indexer=s}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(h=0;h<this._indexer.fields.length;h++){var i=this._indexer.fields[h],a=1;if("-"===i[0]&&(i=i.slice(1),a=-1),this.condition[i])if("object"==typeof this.condition[i]){var s=a>0?n:t;for(var o in this.condition[i])if(s.includes(o))for(var l=r;l>=0;l--)if(a*Xc(this._indexer.origin[l].columnValues[h],this.condition[i][o])<=0){r=l;break}}else for(l=r;l>=0;l--)if(a*Xc(this._indexer.origin[l].columnValues[h],this.condition[i])<=0){r=l;break}}return Math.min(r+1,this._indexer.origin.length-1)}var u=0;if("function"!=typeof this.condition)for(var c=function(r){var i=d._indexer.fields[r],a=1;if("-"===i[0]&&(i=i.slice(1),a=-1),d.condition[i])if("object"==typeof d.condition[i])Object.keys(d.condition[i]).forEach((function(s){if((a>0?t:n).includes(s))for(var o=u;o<e._indexer.origin.length;o++)if(a*Xc(e._indexer.origin[o].columnValues[r],e.condition[i][s])>=0){u=o;break}}));else for(var s=u;s<d._indexer.origin.length;s++)if(a*Xc(d._indexer.origin[s].columnValues[r],d.condition[i])>=0){u=s;break}},d=this,h=0;h<this._indexer.fields.length;h++)c(h);return Math.max(u-1,0)},e.prototype.each=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l=this;return A(this,(function(u){switch(u.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(l._indexer.origin[t]){if(!l._indexer.origin[t].keys[++n]){if(!l._indexer.origin[++t])return!1;n=0}return!0}return!1},i=function(){if(l._indexer.origin[t]){if(!l._indexer.origin[t].keys[--n]){if(!l._indexer.origin[--t])return!1;n=l._indexer.origin[t].keys.length-1}return!0}return!1},a=null,!this._indexer.origin[t])return[3,4];s=this.backward?i:r,u.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if((o=u.sent())&&$c(this.condition,o))return a=o,[3,4];u.label=3;case 3:if(s())return[3,1];u.label=4;case 4:return[4,new Promise((function(s){var o=new od({initialNextValue:Qc(a),iterator:e,forward:function(){return w(l,0,void 0,(function(){var e,a;return A(this,(function(s){switch(s.label){case 0:e=this.backward?i:r,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return(a=s.sent())&&$c(this.condition,a)?[2,Qc(a)]:[3,1];case 3:return[2,null]}}))}))},backward:function(){return w(l,0,void 0,(function(){var e,a;return A(this,(function(s){switch(s.label){case 0:e=this.backward?r:i,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return(a=s.sent())&&$c(this.condition,a)?[2,Qc(a)]:[3,1];case 3:return[2,null]}}))}))},complete:s});e(o)}))];case 5:return[2,u.sent()]}}))}))},e}(),ud=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.mutex,s=e.blockManager,o=e.indexer;this._mutex=a,this._iterator=new ld({condition:n,backward:i,blockManager:s,indexer:o})}return e.prototype.fetch=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){var t,n,r,i,a=this;return A(this,(function(s){switch(s.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return[2,[]];if(n<0)throw Wc.collectionQueryNotValid;s.label=1;case 1:return s.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return s.sent(),[4,this._iterator.each((function(e){return w(a,0,void 0,(function(){return A(this,(function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2]}))}))}))];case 3:return s.sent(),this._mutex.unlock(),[2,r];case 4:throw i=s.sent(),this._mutex.unlock(),i;case 5:return[2]}}))}))},e.prototype.count=function(){return w(this,0,void 0,(function(){var e,t,n=this;return A(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each((function(t){return w(n,0,void 0,(function(){return A(this,(function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2]}))}))}))];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return[2]}}))}))},e}(),cd=function(e){return"".concat("nest","@").concat(e)},dd=function(e,t){return"".concat(cd(e),"/").concat(t)},hd=function(e,t){return"".concat(dd(e,t),".metadata")},fd=function(e,t){return"".concat(dd(e,t),"/block.")},pd=function(e,t){return"".concat(dd(e,t),"/blob.")},md=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this.dbname=t,this.collectionName=n,this.store=r}return e.prototype.get=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:return[4,this.store.get(e)];case 1:return(t=c.sent())?(n=t.data,r=t.type,"undefined"==typeof fetch?[3,4]:[4,fetch(n)]):[3,5];case 2:return[4,c.sent().blob()];case 3:return[2,c.sent()];case 4:for(i=[],a=atob(n.split(",")[1]),s=0;s<a.length;s+=512){for(o=a.slice(s,s+512),l=new Array(o.length),u=0;u<o.length;u++)l[u]=o.charCodeAt(u);i.push(new Uint8Array(l))}return[2,new Blob(i,{type:r})];case 5:return[2,null]}}))}))},e.prototype.save=function(e,t){return void 0===t&&(t="".concat(Date.now())),w(this,0,void 0,(function(){var n,r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(n){var r,i,a,o,l=(r=s.dbname,i=s.collectionName,a=t,void 0===o&&(o=0),"".concat(pd(r,i)).concat(a,".").concat(o)),u=new FileReader;u.onload=function(){n({blobId:l,data:u.result,type:e.type})},u.readAsDataURL(e)}))];case 1:return n=o.sent(),r=n.blobId,i=n.data,a=n.type,[4,this.store.set({key:r,value:{data:i,type:a}})];case 2:return o.sent(),[2,r]}}))}))},e.prototype.remove=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return w(this,0,void 0,(function(){var e,t,n=this;return A(this,(function(r){switch(r.label){case 0:return e=pd(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return t=r.sent(),[4,Promise.all(t.filter((function(t){return t.startsWith(e)})).map((function(e){return w(n,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return[2,t.sent()]}}))}))})))];case 2:return r.sent(),[2]}}))}))},e}();!function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR"}(id||(id={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile"}(ad||(ad={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT"}(sd||(sd={}));var gd,_d,vd=[ad.PENDING,ad.VOLATILE],Ed={},yd=function(){function e(e){var t=e.dbname,n=e.limit,r=void 0===n?256:n;return Ed[t]||(this.dbname=t,this._items=[],this._limit=r,Ed[t]=this),Ed[t]}return e.get=function(e){return Ed[e]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=sd.DEFAULT),w(this,0,void 0,(function(){var r,i;return A(this,(function(a){switch(a.label){case 0:return(r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return(i=a.sent())&&(r={key:t,value:i,state:n===sd.PERSISTENT?ad.PERSISTENT:ad.VOLATILE},this.put(r)),[3,3];case 2:n===sd.PERSISTENT&&(r.state=ad.PERSISTENT),a.label=3;case 3:return[2,r]}}))}))},e.prototype.get=function(e,t){void 0===t&&(t=sd.DEFAULT);var n=this._items.map((function(e){return e.key})).indexOf(e);if(n>-1){var r=this._items[n];return t===sd.PERSISTENT&&(r.state=ad.PERSISTENT),t!==sd.NO_CACHE&&this.put(r),r}return null},e.prototype.put=function(e){var t,n;if(this._limit>0){var r=this._items.map((function(e){return e.key})).indexOf(e.key);if(r>-1)vd.includes(this._items[r].state)&&vd.includes(e.state)?(this._items.splice(r,1),this._items.push(e)):(this._items[r].state=e.state,this._items[r].value=e.value);else{this._items.push(e);var i=this._items.filter((function(e){return e.state===ad.VOLATILE})).length-this._limit;if(i>0){var a=[];try{for(var s=M(this._items),o=s.next();!o.done;o=s.next()){var l=o.value;l.state===ad.VOLATILE&&i>0?i--:a.push(l)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}this._items=a}}}},e.prototype.remove=function(e){var t=this._items.map((function(e){return e.key})).indexOf(e);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(e){this._items=this._items.filter((function(t){return!e(t)}))},e.prototype.clearForDatabase=function(e){this.clearByCondition((function(t){return t.key.startsWith(cd(e))}))},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter((function(e){return e.state!==ad.VOLATILE}))},e}(),bd=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=n,this.metadataKey="".concat(dd(t,n),"/trans.metadata"),this.recordsetKey=function(e,t){return"".concat(dd(e,t),"/trans.recordset")}(t,n),this._store=r}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=n.sent()||[]).push.apply(t,R([],O(e),!1)),[2,this._reduceRecordSet(t)]}}))}))},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],a=[],s=i.requests.length-1;s>=0;s--){var o=i.requests[s],l=o.data;n[l.key]||(a.unshift(o),n[l.key]=!0)}a.length>0&&(i.requests=a,t.unshift(i))}return t},e.prototype._applyRecord=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c;return A(this,(function(d){switch(d.label){case 0:n=yd.get(this.dbname),r=t.generation,i=t.requests,a=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._store.setMany(i.map((function(e){return S(S({},e.data),{generation:r})})))];case 2:for(s=d.sent(),o=0;o<i.length;o++)s[o]instanceof Error&&(a||(a=s[o]),l=i[o].data,n.put(S(S({},l),{state:ad.PERSISTENT})));return[3,4];case 3:return u=d.sent(),a=u,[3,4];case 4:return a?[3,6]:(c=e.filter((function(e){return e.generation!==r})),[4,this._store.set({key:this.recordsetKey,value:c})]);case 5:return d.sent(),this._onWrite.forEach((function(e){e(i.map((function(e){return e.data})))})),[3,7];case 6:this._onError.forEach((function(e){a&&e(a)})),d.label=7;case 7:return[2]}}))}))},e.prototype.init=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=l.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=l.sent(),l.label=3;case 3:l.trys.push([3,8,9,10]),n=M(t),r=n.next(),l.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._applyRecord(t,i)]);case 5:l.sent(),l.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return a=l.sent(),s={error:a},[3,10];case 9:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}))},e.prototype.on=function(e,t,n){switch(e){case id.COMMIT:this._onCommit.set(t,n);break;case id.WRITE:this._onWrite.set(t,n);break;case id.ERROR:this._onError.set(t,n)}},e.prototype.requestWrite=function(e,t){this._requests.push({data:e,options:t}),yd.get(this.dbname).put(S({state:ad.PENDING},e))},e.prototype.requestMultipleWrite=function(e,t){var n,r,i=yd.get(this.dbname);try{for(var a=M(e),s=a.next();!s.done;s=a.next()){var o=s.value;this._requests.push({data:o,options:t}),i.put(S({state:ad.PENDING},o))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return yd.get(this.dbname).clearByCondition((function(e){return e.state===ad.PENDING})),this._requests=[],[2]}))}))},e.prototype.commit=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h=this;return A(this,(function(f){switch(f.label){case 0:if(!((e=this._requests).length>0))return[3,4];for(t=[],n={},o=e.length-1;o>=0;o--)r=e[o],u=r.data,n[u.key]||(n[u.key]=!0,t.unshift(r));return i={generation:this.generation,requests:t},[4,this._getReducedRecordset([i])];case 1:return a=f.sent(),[4,this._store.set({key:this.recordsetKey,value:a})];case 2:return f.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(f.sent(),s=yd.get(this.dbname),o=0;o<t.length;o++)l=t[o],u=l.data,c=l.options,s.put(S(S({},u),{state:c&&c.persistent?ad.PERSISTENT:ad.VOLATILE}));this._requests=[],this._onCommit.forEach((function(t){t(e.map((function(e){return e.data})))})),d=qc.get(this.dbname),setTimeout((function(){try{h._applyRecord(a,i)}catch(e){h._onError.forEach((function(t){return t(e)}))}}),d.transactionApplyDelay),f.label=4;case 4:return[2]}}))}))},e}(),Cd=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,i=void 0===r?[]:r,a=e.limit;this.blockId=t,this.keyName=n,this.limit=a,this._items=R([],O(i),!1)}return e.createFromCacheItem=function(t){return t?new e(t.value):null},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},e.prototype.getItemByKey=function(e){var t=this,n=this._items.find((function(n){var r=n[t.keyName];return e===r}));return null!=n?n:null},e.prototype.has=function(e){var t=this;return this._items.map((function(e){return e[t.keyName]})).includes(e)},e.prototype.add=function(e){var t=this,n=this._items.map((function(e){return e[t.keyName]})).indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0)},e.prototype.remove=function(e){for(var t=0;t<this._items.length;t++)if(this._items[t][this.keyName]===e)return this._items.splice(t,1),!0;return!1},e.prototype.clear=function(){this._items=[]},e}(),Nd=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,a=void 0===i?Zc:i,s=e.transaction,o=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=a,this.metadata=r,this._transaction=s,this._store=o}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){return void 0===t&&(t=this.metadata.blockLevel),s=this.dbname,o=this.collectionName,l=t,u="".concat((n=e,r=t,i={hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant},a=i.base*Math.pow(i.multiplier,r)+i.constant,(i.hashFunction||Zc)(n,a))),"".concat(fd(s,o)).concat(l,".").concat(u);var n,r,i,a,s,o,l,u},e.prototype._findBlock=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:t=yd.get(this.dbname),n=this.metadata.blockLevel,s.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((i=s.sent())&&(null==(a=Cd.createFromCacheItem(i))?void 0:a.getItemByKey(e)))return[2,a];s.label=3;case 3:return n--,[3,1];case 4:return[2,null]}}))}))},e.prototype.getFromBlock=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return[2,(t=n.sent())?t.getItemByKey(e):null]}}))}))},e.prototype.putToBlock=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return n=qc.get(this.dbname),r=this.createBlockId(e),i=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,yd.get(this.dbname).find(this._store,r)];case 1:return a=o.sent(),(null==(s=a?Cd.createFromCacheItem(a):new Cd({blockId:r,keyName:this.keyName,items:[],limit:i}))?void 0:s.add(t))?(this._transaction.requestWrite({key:s.blockId,value:s.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.removeFromBlock=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return(t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.clearAllBlocks=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:return e=fd(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=r.sent(),n=t.filter((function(t){return t.startsWith(e)})),[4,this._store.removeMany(n)];case 2:return r.sent(),[4,this._transaction.clear()];case 3:return r.sent(),yd.get(this.dbname).clearByCondition((function(t){return t.key.startsWith(e)})),[2]}}))}))},e}(),Td=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.fields,a=e.transaction,s=e.store,o=this;this._origin=[],this._table=[];var l,u,c,d=(l=t,u=n,c=i.join(">"),"".concat(dd(l,u),"/index.").concat(c));this.dbname=t,this.collectionName=n,this.keyName=r,this.fields=i,this.indexerKey=d,this._store=s,this._transaction=a,this._transaction.on(id.COMMIT,this.indexerKey,(function(){return o.commit()})),this._transaction.on(id.ERROR,this.indexerKey,(function(){return o.abort()}))}return e.createKey=function(e){return e.join(">")},e.parseKey=function(e){return e.split(">")},e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=O(this.indexOf(n),2),i=r[0];return r[1]?!this._table[i].keys.includes(t)&&(this._table[i].keys.push(t),!0):(this._table.splice(i,0,{columnValues:n,keys:[t]}),!0)},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=O(this.indexOf(n),2),i=r[0];if(r[1]){var a=this._table[i].keys.indexOf(t);if(a>-1)return this._table[i].keys.splice(a,1),0===this._table[i].keys.length&&this._table.splice(i,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){var t,n,r,i,a=[];try{for(var s=M(this.fields),o=s.next();!o.done;o=s.next()){var l=o.value;if("-"===l[0]&&(l=l.slice(1)),r=e[l],void 0,i=typeof r,null!==r&&"undefined"!==i&&"boolean"!==i&&"number"!==i&&"string"!==i)throw Wc.indexTypesNotMatch;a.push(e[l])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=Xc(e[n],t[n]);if(0!==i)return r*i}return 0},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else{if(!(i<0))return[r,!0];n=r-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,m,g;return A(this,(function(_){switch(_.label){case 0:return[4,(e=yd.get(this.dbname)).find(this._store,this.indexerKey,sd.PERSISTENT)];case 1:return(t=_.sent())?[3,11]:(n=fd(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=_.sent(),_.label=3;case 3:_.trys.push([3,8,9,10]),i=M(r),a=i.next(),_.label=4;case 4:return a.done?[3,7]:(s=a.value).startsWith(n)?[4,e.find(this._store,s,sd.NO_CACHE)]:[3,6];case 5:if(o=_.sent(),l=Cd.createFromCacheItem(o))try{for(m=void 0,u=M(l.items),c=u.next();!c.done;c=u.next())d=c.value,this._addItem(d)}catch(e){m={error:e}}finally{try{c&&!c.done&&(g=u.return)&&g.call(u)}finally{if(m)throw m.error}}_.label=6;case 6:return a=i.next(),[3,4];case 7:return[3,10];case 8:return h=_.sent(),f={error:h},[3,10];case 9:try{a&&!a.done&&(p=i.return)&&p.call(i)}finally{if(f)throw f.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=t.value,this._table=Qc(this._origin),_.label=12;case 12:return[2]}}))}))},e.prototype.drop=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return yd.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),[2]}}))}))},e.prototype.addItem=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.removeItem=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.commit=function(){this._origin=this._table,this._table=Qc(this._origin)},e.prototype.abort=function(){this._table=Qc(this._origin)},e}(),Id=function(){return"undefined"!=typeof document&&"undefined"!=typeof navigator&&"ReactNative"!==navigator.product},Sd=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))};!function(e){e[e.PROCESSING=0]="PROCESSING",e[e.DONE=1]="DONE"}(gd||(gd={})),function(e){e.NEWNODE="newnode",e.REMOVENODE="removenode",e.CLAIM_HOST="claimhost",e.SYNC_HOST="synchost",e.REQUEST_LOCK="requestlock",e.ACQUIRE_LOCK="acquirelock",e.RELEASE_LOCK="releaselock"}(_d||(_d={}));var wd,Ad={},Md=function(){function e(e,t){void 0===t&&(t={});var n=this;return this._state=gd.PROCESSING,this._queue=[],this._activationQueue=[],Ad[e]&&!t.forceCreate||(this.nodeId=Sd(),this.key=e,Id()&&(t.startAsInvisible?this.registerNode():"visible"===document.visibilityState?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&n.claimHost()})),window.addEventListener("message",(function(e){var t,r,i=e.data;if(null==i?void 0:i.isNestDbMessage){var a=i.nodeId,s=i.requestId,o=i.key,l=i.op,u=i.data;if(a!==n.nodeId&&o===n.key)switch(l){case _d.NEWNODE:n._sendSync();break;case _d.CLAIM_HOST:n._sendSync(),n._hostId=a;break;case _d.SYNC_HOST:if(!n.isInSync){n._activationTimeout&&clearTimeout(n._activationTimeout);var c=u,d=c.currentItemRequestId,h=c.queue,f=function(e){n._queue.findIndex((function(t){return t.requestId===e.requestId}))<0&&n._requestLock({isNestDbMessage:!0,nodeId:e.nodeId,requestId:e.requestId,key:n.key,op:_d.REQUEST_LOCK,ts:e.ts})};try{for(var p=M(h),m=p.next();!m.done;m=p.next())f(m.value)}catch(e){t={error:e}}finally{try{m&&!m.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}}n._currentItem=n._queue.find((function(e){return e.requestId===d})),n._completeSync()}break;case _d.REMOVENODE:n._queue=n._queue.filter((function(e){return e.nodeId!==i.nodeId})),n._currentItem&&n._currentItem.nodeId===i.nodeId&&(n._currentItem=void 0,n._acquire(n._queue[0]));break;case _d.REQUEST_LOCK:n._requestLock(i);break;case _d.ACQUIRE_LOCK:var g=n._queue.find((function(e){return e.requestId===s}));n._acquire(g);break;case _d.RELEASE_LOCK:n._release(s)}}})),window.addEventListener("beforeunload",(function(){n._send(_d.REMOVENODE)}))),Ad[e]=this),Ad[e]}return Object.defineProperty(e.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:function(){return this._state==gd.DONE},enumerable:!1,configurable:!0}),e.prototype._send=function(e,t){var n;void 0===t&&(t={});var r={isNestDbMessage:!0,nodeId:this.nodeId,requestId:null!==(n=null==t?void 0:t.requestId)&&void 0!==n?n:Sd(),key:this.key,op:e,data:t.data,ts:Date.now()};return Id()&&window.postMessage(r,"*"),r},e.prototype._acquire=function(e){e?(this._currentItem=e,this._currentItem.onAcquired&&this._currentItem.onAcquired(e.requestId)):this._currentItem=void 0},e.prototype._release=function(e){if(this._currentItem&&this._currentItem.requestId===e){var t=this._currentItem;this._currentItem=void 0,t.nodeId===this.nodeId&&this._send(_d.RELEASE_LOCK,{requestId:t.requestId});var n=this._queue.findIndex((function(t){return t.requestId===e}));n>-1&&this._queue.splice(n,1),t.onReleased&&t.onReleased(e)}},e.prototype._requestLock=function(e){var t=this;return new Promise((function(n){for(var r={nodeId:e.nodeId,requestId:e.requestId,ts:e.ts,onAcquired:function(e){t.isHost&&t._send(_d.ACQUIRE_LOCK,{requestId:e}),n()},onReleased:function(){t._acquire(t._queue[0])}},i=!1,a=0;a<t._queue.length;a++)if(t._queue[a].ts>r.ts){t._queue.splice(a,0,r),i=!0;break}i||t._queue.push(r),t._currentItem||t._acquire(t._queue[0])}))},e.prototype._sendSync=function(){var e;this.isHost&&this._send(_d.SYNC_HOST,{data:{currentItemRequestId:null===(e=this._currentItem)||void 0===e?void 0:e.requestId,queue:this._queue.map((function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}}))}})},e.prototype._waitUntilSyncCompleted=function(){return w(this,0,void 0,(function(){var e=this;return A(this,(function(t){return this.isHost&&!this.isInSync?[2,new Promise((function(t){e._activationQueue.push(t)}))]:[2]}))}))},e.prototype._waitSync=function(){var e=this;this.isInSync||(this._activationTimeout=setTimeout((function(){e._completeSync()}),8))},e.prototype._completeSync=function(){this.isInSync||(this._state=gd.DONE,this._activationQueue.forEach((function(e){return e()})),this._activationQueue=[])},e.prototype.registerNode=function(){this._send(_d.NEWNODE),this._waitSync()},e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(_d.CLAIM_HOST),this._waitSync()},e.prototype.lock=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return t.sent(),e=this._send(_d.REQUEST_LOCK),[4,this._requestLock(e)];case 2:return t.sent(),[2]}}))}))},e.prototype.unlock=function(){var e;(null===(e=this._currentItem)||void 0===e?void 0:e.requestId)&&this._release(this._currentItem.requestId)},e}(),Od=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.keyHash,a=e.indexes,s=e.store,o=this;this._state=Kc.INIT,this._indexers=[],this.dbname=t,this.name=n,this.keyName=r,this.indexes=R([[r]],O(a.filter((function(e){return Td.createKey(e)!==o.keyName}))),!1),this._keyHash=i,this._store=s,this._mutex=new Md("".concat(dd(t,n),".lock")),this._blobContainer=new md({dbname:t,collectionName:n,store:s}),this._transaction=new bd({dbname:t,collectionName:n,store:s})}return e.metadataOf=function(e,t,n){return w(this,0,void 0,(function(){var r;return A(this,(function(i){switch(i.label){case 0:return r=hd(e,t),[4,n.get(r)];case 1:return[2,i.sent()]}}))}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._state===Kc.READY},enumerable:!1,configurable:!0}),e.prototype.init=function(){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m=this;return A(this,(function(g){switch(g.label){case 0:return[4,this._mutex.lock()];case 1:g.sent(),g.label=2;case 2:return g.trys.push([2,9,,10]),t=qc.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=g.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:g.sent(),this._blockManager=new Nd({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=R([],O(this.indexes),!1),i=[],a=r.map((function(e){return Td.createKey(e)})),s=n?n.indexes.map((function(e){return Td.createKey(e)})):[];try{for(o=M(s),l=o.next();!l.done;l=o.next())u=l.value,a.includes(u)||i.push(Td.parseKey(u))}catch(e){f={error:e}}finally{try{l&&!l.done&&(p=o.return)&&p.call(o)}finally{if(f)throw f.error}}return(c=[]).push.apply(c,R([],O(r.map((function(e){var t=new Td({dbname:m.dbname,collectionName:m.name,keyName:m.keyName,fields:e,transaction:m._transaction,store:m._store});return m._indexers.push(t),t.ensure()}))),!1)),c.push.apply(c,R([],O(i.map((function(e){return new Td({dbname:m.dbname,collectionName:m.name,keyName:m.keyName,fields:e,transaction:m._transaction,store:m._store}).drop()}))),!1)),[4,Promise.all(c)];case 5:return g.sent(),[4,this._transaction.commit()];case 6:return g.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(d=hd(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata})]);case 7:g.sent(),g.label=8;case 8:return this._state=Kc.READY,this._mutex.unlock(),[3,10];case 9:throw h=g.sent(),this._mutex.unlock(),h;case 10:return[2]}}))}))},e.prototype.close=function(){this._state=Kc.CLOSED},e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return"string"==typeof t&&!!t},e.prototype._getIndexerBy=function(e){var t,n;void 0===e&&(e=null),e||(e=[this.keyName]);var r=Td.createKey(e);try{for(var i=M(this._indexers),a=i.next();!a.done;a=i.next()){var s=a.value;if(r===Td.createKey(s.fields))return s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}throw Wc.indexTableIsRequired},e.prototype._upgradeBlockLevel=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=hd(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata})];case 1:return t.sent(),[2]}}))}))},e.prototype._requestInsert=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return o.sent()?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return o.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return o.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:o.sent(),o.label=5;case 5:o.trys.push([5,10,11,12]),n=M(this._indexers),r=n.next(),o.label=6;case 6:return r.done?[3,9]:[4,r.value.addItem(e)];case 7:o.sent(),o.label=8;case 8:return r=n.next(),[3,6];case 9:return[3,12];case 10:return i=o.sent(),a={error:i},[3,12];case 11:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 12:return[3,14];case 13:throw Wc.collectionInsertDuplicate;case 14:return[2]}}))}))},e.prototype._requestUpsert=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f;return A(this,(function(p){switch(p.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=p.sent())?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return p.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return p.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:p.sent(),p.label=5;case 5:p.trys.push([5,10,11,12]),r=M(this._indexers),i=r.next(),p.label=6;case 6:return i.done?[3,9]:[4,(l=i.value).addItem(e)];case 7:p.sent(),p.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return a=p.sent(),c={error:a},[3,12];case 11:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(c)throw c.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(t,e)];case 14:p.sent(),p.label=15;case 15:p.trys.push([15,21,22,23]),s=M(this._indexers),o=s.next(),p.label=16;case 16:return o.done?[3,20]:0===(l=o.value).diff(l.getColumnValues(n),l.getColumnValues(e))?[3,19]:[4,l.removeItem(n)];case 17:return p.sent(),[4,l.addItem(e)];case 18:p.sent(),p.label=19;case 19:return o=s.next(),[3,16];case 20:return[3,23];case 21:return u=p.sent(),h={error:u},[3,23];case 22:try{o&&!o.done&&(f=s.return)&&f.call(s)}finally{if(h)throw h.error}return[7];case 23:return[2]}}))}))},e.prototype._requestUpdate=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=u.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,11];case 2:u.sent(),u.label=3;case 3:u.trys.push([3,9,10,11]),r=M(this._indexers),i=r.next(),u.label=4;case 4:return i.done?[3,8]:0===(a=i.value).diff(a.getColumnValues(n),a.getColumnValues(e))?[3,7]:[4,a.removeItem(n)];case 5:return u.sent(),[4,a.addItem(e)];case 6:u.sent(),u.label=7;case 7:return i=r.next(),[3,4];case 8:return[3,11];case 9:return s=u.sent(),o={error:s},[3,11];case 10:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 11:return[2]}}))}))},e.prototype._requestRemove=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return[4,this._blockManager.getFromBlock(e)];case 1:return(t=o.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,10];case 2:o.sent(),o.label=3;case 3:o.trys.push([3,8,9,10]),n=M(this._indexers),r=n.next(),o.label=4;case 4:return r.done?[3,7]:[4,r.value.removeItem(t)];case 5:o.sent(),o.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return i=o.sent(),a={error:i},[3,10];case 9:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 10:return[2]}}))}))},e.prototype._requestClear=function(){return w(this,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:a.sent(),a.label=2;case 2:a.trys.push([2,7,8,9]),e=M(this._indexers),t=e.next(),a.label=3;case 3:return t.done?[3,6]:[4,t.value.clear()];case 4:a.sent(),a.label=5;case 5:return t=e.next(),[3,3];case 6:return[3,9];case 7:return n=a.sent(),r={error:n},[3,9];case 8:try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}return[7];case 9:return[2]}}))}))},e.prototype.getByKey=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,Qc(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return[3,7];case 6:throw Wc.collectionNotReady;case 7:return[2]}}))}))},e.prototype.query=function(e){if(void 0===e&&(e={}),this.isReady)return new ud({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward});throw Wc.collectionNotReady},e.prototype.insertOne=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Wc.collectionKeyNotGiven;return[4,this._requestInsert(Qc(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Wc.collectionNotReady;case 9:return[2]}}))}))},e.prototype.insertMany=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l=this;return A(this,(function(u){switch(u.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:u.sent(),u.label=2;case 2:if(u.trys.push([2,12,,14]),e.some((function(e){return!l._hasPropertyOfKeyName(e)})))throw Wc.collectionKeyNotGiven;u.label=3;case 3:u.trys.push([3,8,9,10]),t=M(e),n=t.next(),u.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestInsert(Qc(r))]);case 5:u.sent(),u.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return i=u.sent(),s={error:i},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(s)throw s.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return u.sent(),this._mutex.unlock(),[2,e];case 12:return a=u.sent(),[4,this._transaction.clear()];case 13:throw u.sent(),this._mutex.unlock(),a;case 14:return[3,16];case 15:throw Wc.collectionNotReady;case 16:return[2]}}))}))},e.prototype.upsertOne=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Wc.collectionKeyNotGiven;return[4,this._requestUpsert(Qc(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Wc.collectionNotReady;case 9:return[2]}}))}))},e.prototype.upsertMany=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l=this;return A(this,(function(u){switch(u.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:u.sent(),u.label=2;case 2:if(u.trys.push([2,12,,14]),e.some((function(e){return!l._hasPropertyOfKeyName(e)})))throw Wc.collectionKeyNotGiven;u.label=3;case 3:u.trys.push([3,8,9,10]),t=M(e),n=t.next(),u.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestUpsert(Qc(r))]);case 5:u.sent(),u.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return i=u.sent(),s={error:i},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(s)throw s.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return u.sent(),this._mutex.unlock(),[2,e];case 12:return a=u.sent(),[4,this._transaction.clear()];case 13:throw u.sent(),this._mutex.unlock(),a;case 14:return[3,16];case 15:throw Wc.collectionNotReady;case 16:return[2]}}))}))},e.prototype.update=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Wc.collectionKeyNotGiven;return[4,this._requestUpdate(Qc(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Wc.collectionNotReady;case 9:return[2]}}))}))},e.prototype.updateIf=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f,p,m,g=this;return A(this,(function(_){switch(_.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:_.sent(),_.label=2;case 2:return _.trys.push([2,13,,15]),n=e.where,r=void 0===n?{}:n,i=e.index,a=void 0===i?null:i,s=e.backward,o=void 0!==s&&s,l=[],[4,new ld({condition:r,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(a)}).each((function(e){return w(g,0,void 0,(function(){var n;return A(this,(function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(n=e.nextValue,$c(r,n)&&t.set&&("function"!=typeof t.set?Object.keys(t.set).forEach((function(e){var r;n[e]=null===(r=t.set)||void 0===r?void 0:r[e]})):t.set(n),l.push(n)),e.next()):e.stop(),[2]}))}))}))];case 3:_.sent(),_.label=4;case 4:_.trys.push([4,9,10,11]),u=M(l),c=u.next(),_.label=5;case 5:return c.done?[3,8]:(d=c.value,[4,this._requestUpdate(Qc(d))]);case 6:_.sent(),_.label=7;case 7:return c=u.next(),[3,5];case 8:return[3,11];case 9:return h=_.sent(),p={error:h},[3,11];case 10:try{c&&!c.done&&(m=u.return)&&m.call(u)}finally{if(p)throw p.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return _.sent(),this._mutex.unlock(),[2,l];case 13:return f=_.sent(),[4,this._transaction.clear()];case 14:throw _.sent(),this._mutex.unlock(),f;case 15:return[3,17];case 16:throw this._transaction.clear(),Wc.collectionNotReady;case 17:return[2]}}))}))},e.prototype.remove=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Wc.collectionNotReady;case 9:return[2]}}))}))},e.prototype.removeIf=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m=this;return A(this,(function(g){switch(g.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:g.sent(),g.label=2;case 2:return g.trys.push([2,13,,14]),t=e.where,n=void 0===t?{}:t,r=e.index,i=void 0===r?null:r,a=e.backward,s=void 0!==a&&a,o=[],[4,new ld({condition:n,blockManager:this._blockManager,backward:s,indexer:this._getIndexerBy(i)}).each((function(e){return w(m,0,void 0,(function(){var t,r;return A(this,(function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(t=e.nextValue,$c(n,t)&&(r=t[this.keyName],o.push(r)),e.next()):e.stop(),[2]}))}))}))];case 3:g.sent(),g.label=4;case 4:g.trys.push([4,9,10,11]),l=M(o),u=l.next(),g.label=5;case 5:return u.done?[3,8]:(c=u.value,[4,this._requestRemove(c)]);case 6:g.sent(),g.label=7;case 7:return u=l.next(),[3,5];case 8:return[3,11];case 9:return d=g.sent(),f={error:d},[3,11];case 10:try{u&&!u.done&&(p=l.return)&&p.call(l)}finally{if(f)throw f.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return g.sent(),this._mutex.unlock(),[2,o];case 13:throw h=g.sent(),this._mutex.unlock(),h;case 14:return[3,16];case 15:throw this._transaction.clear(),Wc.collectionNotReady;case 16:return[2]}}))}))},e.prototype.clear=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Wc.collectionNotReady;case 9:return[2]}}))}))},e.prototype.getBlob=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.saveBlob=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._blobContainer.save(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.removeBlob=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.removeAllBlobs=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._blobContainer.clear()];case 1:return e.sent(),[2]}}))}))},e}(),Rd="[NESTDB]",kd=!0,xd=function(){function e(){}return e.off=function(){kd=!1},e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];kd&&console.log.apply(console,R(["".concat(Rd,"[LOG]")],O(e),!1))},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];kd&&console.warn.apply(console,R(["".concat(Rd,"[WARNING]")],O(e),!1))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];kd&&console.error.apply(console,R(["".concat(Rd,"[ERROR]")],O(e),!1))},e}(),Dd=[{},{a:700400,n:"error"}],Ud=function(){function e(e){var t,n,r;this.encryption=null!==(t=e.encryption)&&void 0!==t?t:ne,this.itemSizeLimit=null!==(n=e.itemSizeLimit)&&void 0!==n?n:4194304,this.metadataBuffer=null!==(r=e.metadataBuffer)&&void 0!==r?r:256}return Object.defineProperty(e.prototype,"_encryptionCheckKey",{get:function(){return"".concat(this.dbname,".encrypt")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_reservedKeys",{get:function(){return[this._encryptionCheckKey]},enumerable:!1,configurable:!0}),e.prototype._getRawKey=function(e,t){return void 0===t&&(t=""),"".concat(e).concat(t)},e.prototype._generateShardPostfixArray=function(e){return void 0===e&&(e=1),R([],O(Array(e).keys()),!1)},e.prototype._shardify=function(e){var t=this,n=e.key,r=e.value,i=JSON.stringify(this.encryption.encrypt(r)),a=Math.ceil(i.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(a).map((function(e){var r={key:t._getRawKey(n,".".concat(e)),data:i.substring(e*t.adjustedItemSizeLimit,(e+1)*t.adjustedItemSizeLimit)};return 0===e&&(r.metadata={shards:a}),r}))},e.prototype._resetIfEncryptionChanged=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u=this;return A(this,(function(c){switch(c.label){case 0:return[4,this.get(this._encryptionCheckKey)];case 1:if(e=c.sent(),t={encrypted:Dd.map((function(e){var t;return null===(t=u.encryption)||void 0===t?void 0:t.encrypt(e)}))},!e)return[3,8];if(!e.encrypted||!Array.isArray(e.encrypted))return[3,6];for(i in n=e.encrypted,r=[],n)r.push(i);a=0,c.label=2;case 2:return a<r.length?(i=r[a])in n?(s=i,o=JSON.stringify(e.encrypted[s]),l=JSON.stringify(t.encrypted[s]),o===l?[3,4]:(xd.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return c.sent(),[3,5];case 4:return a++,[3,2];case 5:return[3,8];case 6:return[4,this.clear()];case 7:c.sent(),c.label=8;case 8:return[4,this.set({key:this._encryptionCheckKey,value:t})];case 9:return c.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4)},enumerable:!1,configurable:!0}),e.prototype.usage=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return e=0,[4,this._getAllRawKeys()];case 1:t=u.sent(),u.label=2;case 2:u.trys.push([2,7,8,9]),n=M(t),r=n.next(),u.label=3;case 3:return r.done?[3,6]:(i=r.value,[4,this._getRaw(i)]);case 4:(a=u.sent())&&(e+=JSON.stringify(a).length),u.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return s=u.sent(),o={error:s},[3,9];case 8:try{r&&!r.done&&(l=n.return)&&l.call(n)}finally{if(o)throw o.error}return[7];case 9:return[2,e]}}))}))},e.prototype.getAllKeys=function(){return w(this,0,void 0,(function(){var e=this;return A(this,(function(t){switch(t.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,t.sent().filter((function(e){return e.endsWith(".0")})).map((function(e){return e.replace(/\.0$/,"")})).filter((function(t){return!e._reservedKeys.includes(t)}))]}}))}))},e.prototype.get=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:if(!(n=l.sent()))return[3,7];l.label=2;case 2:return l.trys.push([2,6,,7]),r=n.data,(null==(i=n.metadata)?void 0:i.shards)&&i.shards>1?[4,Promise.all(this._generateShardPostfixArray(null==i?void 0:i.shards).map((function(t){return w(o,0,void 0,(function(){var n,i;return A(this,(function(a){switch(a.label){case 0:return t>0?(n=this._getRawKey(e,".".concat(t)),[4,this._getRaw(n)]):[3,2];case 1:if(!(i=a.sent()))throw Wc.storeBrokenIntegrity;return[2,i.data];case 2:return[2,r]}}))}))})))]:[3,4];case 3:return s=l.sent(),[3,5];case 4:s=[r],l.label=5;case 5:return a=s,[2,this.encryption.decrypt(JSON.parse(a.join("")))];case 6:return l.sent(),[2,null];case 7:return[2,null]}}))}))},e.prototype.set=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=this._shardify(e),[4,this._setRaw(t)];case 1:return n.sent(),[2,S({},e.value)]}}))}))},e.prototype.setMany=function(e){return w(this,0,void 0,(function(){var t,n=this;return A(this,(function(r){switch(r.label){case 0:return t=[],[4,this._setRaw(t.concat.apply(t,R([],O(e.map((function(e){return n._shardify(e)}))),!1)))];case 1:return r.sent(),[2,e.map((function(e){return e.value}))]}}))}))},e.prototype.remove=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:return(n=o.sent())?(r=n.metadata,i=this._generateShardPostfixArray(null==r?void 0:r.shards).map((function(t){return s._getRawKey(e,".".concat(t))})),[4,this._removeRaw(i)]):[3,3];case 2:return o.sent(),null==(a=yd.get(this.dbname))||a.remove(e),[2,!0];case 3:return[2,!1]}}))}))},e.prototype.removeMany=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d=this;return A(this,(function(h){switch(h.label){case 0:t=yd.get(this.dbname),n=[],r=function(e){var r,a,s;return A(this,(function(o){switch(o.label){case 0:return r=i._getRawKey(e,".0"),[4,i._getRaw(r)];case 1:return(a=o.sent())&&(s=a.metadata,n.push.apply(n,R([],O(i._generateShardPostfixArray(null==s?void 0:s.shards).map((function(t){return d._getRawKey(e,".".concat(t))}))),!1))),null==t||t.remove(e),[2]}}))},i=this,h.label=1;case 1:h.trys.push([1,6,7,8]),a=M(e),s=a.next(),h.label=2;case 2:return s.done?[3,5]:(o=s.value,[5,r(o)]);case 3:h.sent(),h.label=4;case 4:return s=a.next(),[3,2];case 5:return[3,8];case 6:return l=h.sent(),u={error:l},[3,8];case 7:try{s&&!s.done&&(c=a.return)&&c.call(a)}finally{if(u)throw u.error}return[7];case 8:return n.length>0?[4,this._removeRaw(n)]:[3,10];case 9:h.sent(),h.label=10;case 10:return[2,e]}}))}))},e.prototype.clear=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){return null==(e=yd.get(this.dbname))||e.clearForDatabase(this.dbname),[2]}))}))},e}(),Ld={},Pd=function(e){function t(t){void 0===t&&(t={});var n,r=this;r=e.call(this,S(S({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:4194304}))||this;var i=t.delay,a=void 0===i?1:i;return r.delay=a,r.observer={},r}return I(t,e),Object.defineProperty(t.prototype,"rawData",{get:function(){return Ld[this.dbname]},set:function(e){Ld[this.dbname]=e},enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return w(this,0,void 0,(function(){return A(this,(function(e){if(Ld[this.dbname])return[2,Object.keys(Ld[this.dbname])];throw Wc.storeNotAvailable}))}))},t.prototype._getRaw=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return Ld[this.dbname]?[4,Jc(this.delay)]:[3,2];case 1:return t.sent(),[2,Ld[this.dbname][e]?S({key:e},Ld[this.dbname][e]):null];case 2:throw Wc.storeNotAvailable}}))}))},t.prototype._setRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return Ld[this.dbname]?[4,Jc(this.delay)]:[3,2];case 1:u.sent();try{for(t=M(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,a=r.data,s=r.metadata,Ld[this.dbname][i]=Object.freeze({data:a,metadata:s})}catch(e){o={error:e}}finally{try{n&&!n.done&&(l=t.return)&&l.call(t)}finally{if(o)throw o.error}}return[3,3];case 2:throw Wc.storeNotAvailable;case 3:return[2]}}))}))},t.prototype._removeRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return Ld[this.dbname]?[4,Jc(this.delay)]:[3,2];case 1:s.sent();try{for(t=M(e),n=t.next();!n.done;n=t.next())r=n.value,Ld[this.dbname][r]&&delete Ld[this.dbname][r]}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}}return[3,3];case 2:throw Wc.storeNotAvailable;case 3:return[2]}}))}))},t.prototype.observe=function(e,t,n){var r=this;this.observer[e]||(this.observer[e]={}),t.forEach((function(t){return r.observer[e][t]=n}))},t.prototype.checkAvailability=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},t.prototype.init=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this.dbname=e,Ld[this.dbname]||(Ld[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.set=function(t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){if((n=this.observer[t.key])&&"function"==typeof n.set&&(r=n.set()))throw r;return[2,e.prototype.set.call(this,t)]}))}))},t.prototype.setMany=function(t){return w(this,0,void 0,(function(){var n,r,i,a,s,o,l;return A(this,(function(u){try{for(n=M(t),r=n.next();!r.done;r=n.next())if(i=r.value,(a=this.observer[i.key])&&"function"==typeof a.set&&(s=a.set()))throw s}catch(e){o={error:e}}finally{try{r&&!r.done&&(l=n.return)&&l.call(n)}finally{if(o)throw o.error}}return[2,e.prototype.setMany.call(this,t)]}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return t.sent(),[4,Jc(this.delay)];case 2:return t.sent(),Ld[this.dbname]={},[2]}}))}))},t}(Ud);!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.OPENING=1]="OPENING",e[e.OPEN=2]="OPEN",e[e.CLOSED=3]="CLOSED"}(wd||(wd={}));var Fd,Bd=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this,S(S({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:104857600}))||this)._storeName="NestDBStore",r._state=wd.UNINITIALIZED,r._openJobQueue=[],r._window="undefined"!=typeof window?window:void 0,r._indexedDb=r._window?r._window.indexedDB||r._window.mozIndexedDB||r._window.webkitIndexedDB||r._window.msIndexedDB:void 0,r}return I(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.isTransactionInactiveError=function(e){return e instanceof Error&&e.message.includes("The transaction is inactive")},t.prototype._putToObjectStore=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){return[2,new Promise((function(n,r){var i=e.put(t);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(){r("Failed to write.")}))}))]}))}))},t.prototype._deleteFromObjectStore=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){return[2,new Promise((function(n,r){var i=e.delete(t);i.addEventListener("success",(function(){return n(t)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))]}))}))},t.prototype._openDatabase=function(e){var t=this;return new Promise((function(n,r){if(t._indexedDb){t._state=wd.OPENING;var i=t._indexedDb.open(e);i.addEventListener("upgradeneeded",(function(e){e.target.result.createObjectStore("NestDBStore",{keyPath:"key"})})),i.addEventListener("success",(function(r){t._state=wd.OPEN,t._database=r.target.result,t._openJobQueue.forEach((function(e){return e()})),t._openJobQueue=[],t._database.onclose=function(){t._database=void 0,t._state=wd.OPENING,setTimeout((function(){t._openDatabase(e)}),5)},n(t._database)})),i.addEventListener("error",(function(e){t._state=wd.UNINITIALIZED,r(e.target.error)}))}else r(Wc.storeNotAvailable)}))},t.prototype._getObjectStore=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return this._database?[2,this._database.transaction(this._storeName,e).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case wd.UNINITIALIZED:case wd.OPEN:return[3,2];case wd.OPENING:case wd.CLOSED:return[3,3]}return[3,4];case 2:throw Wc.storeNotInitialized;case 3:return[2,new Promise((function(n){t._openJobQueue.push((function(){return n(t._getObjectStore(e))}))}))];case 4:return[4,this._getObjectStore(e)];case 5:return[2,n.sent()]}}))}))},t.prototype._getAllRawKeys=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return e=t.sent(),[4,new Promise((function(t,n){var r=e.getAllKeys();r.addEventListener("success",(function(e){t(e.target.result)})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 2:return[2,t.sent()]}}))}))},t.prototype._getRaw=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return t=n.sent(),[4,new Promise((function(n,r){var i=t.get(e);i.addEventListener("success",(function(e){var t;n(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.result)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 2:return[2,n.sent()]}}))}))},t.prototype._setRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u=this;return A(this,(function(c){switch(c.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:t=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,15]),[4,Promise.all(e.map((function(e){return u._putToObjectStore(t,e)})))];case 3:return c.sent(),[3,15];case 4:if(n=c.sent(),!this.isTransactionInactiveError(n))return[3,13];c.label=5;case 5:c.trys.push([5,10,11,12]),r=M(e),i=r.next(),c.label=6;case 6:return i.done?[3,9]:(a=i.value,[4,this._putToObjectStore(t,a)]);case 7:c.sent(),c.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return s=c.sent(),o={error:s},[3,12];case 11:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 12:return[3,14];case 13:throw n;case 14:return[3,15];case 15:return[2]}}))}))},t.prototype._removeRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u=this;return A(this,(function(c){switch(c.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:t=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,15]),[4,Promise.all(e.map((function(e){return u._deleteFromObjectStore(t,e)})))];case 3:return c.sent(),[3,15];case 4:if(n=c.sent(),!this.isTransactionInactiveError(n))return[3,13];c.label=5;case 5:c.trys.push([5,10,11,12]),r=M(e),i=r.next(),c.label=6;case 6:return i.done?[3,9]:(a=i.value,[4,this._deleteFromObjectStore(t,a)]);case 7:c.sent(),c.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return s=c.sent(),o={error:s},[3,12];case 11:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 12:return[3,14];case 13:throw n;case 14:return[3,15];case 15:return[2]}}))}))},t.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"))},t.prototype.checkAvailability=function(){return w(this,0,void 0,(function(){var e,t=this;return A(this,(function(n){switch(n.label){case 0:if(!((null==(e="undefined"!=typeof window?window:null)?void 0:e.indexedDB)||(null==e?void 0:e.mozIndexedDB)||(null==e?void 0:e.webkitIndexedDB)||(null==e?void 0:e.msIndexedDB)))return[3,6];if(this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,!this._window||!Id())return[3,4];if(!(Id()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return[3,1];if(!this._window.indexedDB&&(e.PointerEvent||e.MSPointerEvent))throw Wc.storeNotAvailableInPrivateBrowsing;return[3,3];case 1:return[4,new Promise((function(e,n){if(t._indexedDb)try{var r=t._indexedDb.open("_testMozilla");r.onerror=function(){return n(Wc.storeNotAvailableInPrivateBrowsing)},r.onsuccess=function(r){if(r.target.result.close(),t._indexedDb){var i=t._indexedDb.deleteDatabase("_testMozilla");i.onerror=function(){return e()},i.onsuccess=function(){return e()}}else n(Wc.storeNotAvailable)}}catch(e){n(Wc.storeNotAvailableInPrivateBrowsing)}else n(Wc.storeNotAvailable)}))];case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:throw Wc.storeNotAvailable;case 5:return[3,7];case 6:throw Wc.storeNotAvailable;case 7:return[2]}}))}))},t.prototype.init=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this.checkAvailability()];case 1:return t.sent(),[4,this._openDatabase(e)];case 2:return t.sent(),[4,this._resetIfEncryptionChanged()];case 3:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return n.sent(),[4,this._getObjectStore("readwrite")];case 2:return t=n.sent(),[4,new Promise((function(e,n){var r=t.clear();r.addEventListener("success",(function(){return e()})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 3:return[2,n.sent()]}}))}))},t}(Ud),jd=function(e){function t(t){var n=this,r=t.AsyncStorage,i=t.itemSizeLimit,a=void 0===i?2097152:i,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["AsyncStorage","itemSizeLimit"]);return(n=e.call(this,S(S({},s),{itemSizeLimit:a}))||this)._asyncStorage=r,n}return I(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return w(this,0,void 0,(function(){var e=this;return A(this,(function(t){switch(t.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substring("".concat(e.dbname,"/").length)}))]}}))}))},t.prototype._getRaw=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}}))}))},t.prototype._setRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:t=[];try{for(n=M(e),r=n.next();!r.done;r=n.next())i=r.value,a=i.key,i.data.length<=this.adjustedItemSizeLimit&&t.push([this._getActualKey(a),JSON.stringify(i)])}catch(e){s={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(s)throw s.error}}return[4,this._asyncStorage.multiSet(t)];case 1:return l.sent(),[2]}}))}))},t.prototype._removeRaw=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.multiRemove(e.map((function(e){return t._getActualKey(e)})))];case 1:return n.sent(),[2]}}))}))},t.prototype.checkAvailability=function(){return w(this,0,void 0,(function(){return A(this,(function(e){if(!this._asyncStorage)throw Wc.storeNotAvailable;return[2]}))}))},t.prototype.init=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return n.sent(),[4,this.getAllKeys()];case 2:return t=n.sent(),[4,this.removeMany(t)];case 3:return n.sent(),[2]}}))}))},t}(Ud),Hd=function(e){function t(t){var n,r=this;return(r=e.call(this,S(S({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:6291456}))||this)._mmkv=t.MMKV,r}return I(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return w(this,0,void 0,(function(){var e=this;return A(this,(function(t){switch(t.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substring("".concat(e.dbname,"/").length)}))]}}))}))},t.prototype._getRaw=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}}))}))},t.prototype._setRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){try{for(t=M(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,r.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(i),JSON.stringify(r))}catch(e){a={error:e}}finally{try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}}return[2]}))}))},t.prototype._removeRaw=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){try{for(t=M(e),n=t.next();!n.done;n=t.next())r=n.value,this._mmkv.delete(this._getActualKey(r))}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}}return[2]}))}))},t.prototype.checkAvailability=function(){return w(this,0,void 0,(function(){return A(this,(function(e){if(!this._mmkv)throw Wc.storeNotAvailable;return[2]}))}))},t.prototype.init=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return n.sent(),[4,this.getAllKeys()];case 2:return t=n.sent(),[4,this.removeMany(t)];case 3:return n.sent(),[2]}}))}))},t}(Ud);!function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED"}(Fd||(Fd={}));var Gd,zd=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=Fd.INIT,this._config=i||new qc({dbname:t}),this._store=r,this._event={success:ed,error:ed,storeReplaced:ed,upgrade:rd},this._collections=new Map,this._globalMutex=new Md("".concat(this.name,".lock")),this._config.disableLogger&&xd.off(),new yd({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),e.prototype._initializeCollection=function(e,t){var n;return w(this,0,void 0,(function(){var r,i,a;return A(this,(function(s){switch(s.label){case 0:return i=this._collections.get(e),t?(r=new Od({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:null!==(n=t.index)&&void 0!==n?n:[[t.keyName]],store:this._store}),[3,3]):[3,1];case 1:return i&&i.state===Kc.READY?[3,3]:[4,Od.metadataOf(this.name,e,this._store)];case 2:(a=s.sent())&&(r=new Od({dbname:this.name,collectionName:e,keyName:a.keyName,indexes:a.indexes,store:this._store})),s.label=3;case 3:return r?(this._collections.set(e,r),[4,r.init()]):[3,5];case 4:s.sent(),s.label=5;case 5:return[2]}}))}))},e.prototype.estimateUsage=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,(t=this._store,w(void 0,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,t.usage()];case 1:return[2,e.sent()]}}))})))];case 1:return[2,e.sent()]}var t}))}))},e.prototype.commitSchema=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return this._state!==Fd.OPENING?[3,2]:[4,Promise.all(e.map((function(e){return w(t,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._initializeCollection(e.collectionName,e)];case 1:return t.sent(),[2]}}))}))})))];case 1:return n.sent(),[3,3];case 2:throw Wc.databaseSchemaNotOnUpgrade;case 3:return[2]}}))}))},e.prototype.open=function(){var e;return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d=this;return A(this,(function(h){switch(h.label){case 0:return[4,this._globalMutex.lock()];case 1:if(h.sent(),this._state===Fd.OPENED)return[3,20];this._state=Fd.OPENING,h.label=2;case 2:return h.trys.push([2,13,,20]),[4,this._store.init(this.name)];case 3:return h.sent(),f=this.name,t="".concat(cd(f),".metadata"),n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:r=null!==(e=h.sent())&&void 0!==e?e:n,h.label=5;case 5:h.trys.push([5,10,11,12]),i=M(r.collectionNames),a=i.next(),h.label=6;case 6:return a.done?[3,9]:(s=a.value,[4,this._initializeCollection(s)]);case 7:h.sent(),h.label=8;case 8:return a=i.next(),[3,6];case 9:return[3,12];case 10:return o=h.sent(),u={error:o},[3,12];case 11:try{a&&!a.done&&(c=i.return)&&c.call(i)}finally{if(u)throw u.error}return[7];case 12:return[2,new Promise((function(e,n){var i=function(e){r.version<d._version?d._event.upgrade(r.version,(function(n){return w(d,0,void 0,(function(){var i;return A(this,(function(a){switch(a.label){case 0:if(n)return[3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r})];case 2:return a.sent(),e({continued:!0}),[3,4];case 3:return i=a.sent(),e({continued:!1,err:i}),[3,4];case 4:return[3,6];case 5:e({continued:!1,err:n}),a.label=6;case 6:return[2]}}))}))})):e({continued:!1})},a=function(t){var s=t.continued,o=void 0!==s&&s,l=t.err,u=void 0===l?null:l;o?setTimeout((function(){return i(a)}),10):u?(xd.error(u.message),d._globalMutex.unlock(),d._event.error(u),n(u)):Promise.all(r.collectionNames.map((function(e){return d._initializeCollection(e)}))).then((function(){d._state=Fd.OPENED,d._globalMutex.unlock(),d._event.success(),e()})).catch((function(e){xd.error(e.message),d._globalMutex.unlock(),d._event.error(e),n(e)}))};i(a)}))];case 13:switch((l=h.sent()).code){case Oc.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,14];case Oc.STORE_NOT_AVAILABLE:return[3,16]}return[3,18];case 14:return xd.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new Pd({}),this._globalMutex.unlock(),this._event.error(l),this._event.storeReplaced(this._store),[4,this.open()];case 15:return h.sent(),[3,19];case 16:return xd.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new Pd({}),this._globalMutex.unlock(),this._event.error(l),this._event.storeReplaced(this._store),[4,this.open()];case 17:return h.sent(),[3,19];case 18:throw xd.error(l.message),this._globalMutex.unlock(),this._event.error(l),l;case 19:return[3,20];case 20:return[2]}var f}))}))},e.prototype.close=function(){this._collections.forEach((function(e){return e.close()})),this._state=Fd.CLOSED},e.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map((function(e){return e.clear()})))];case 1:return e.sent(),[2]}}))}))},e.prototype.reset=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return(e=yd.get(this.name))&&e.clearForDatabase(this.name),[4,this._store.clear()];case 1:return t.sent(),[2]}}))}))},e.prototype.on=function(e,t){this._event[e]=t},e.prototype.off=function(e){"function"==typeof this._event[e]&&(this._event[e]="upgrade"===e?rd:ed)},e.prototype.collection=function(e){var t=this._collections.get(e);if(t)return t;throw Wc.collectionNotReady},e}();!function(e){e[e.VERBOSE=0]="VERBOSE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.NONE=5]="NONE"}(Gd||(Gd={}));var Vd,qd=function(){function e(){this.level=Gd.WARN}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Gd.VERBOSE&&console.log.apply(console,R(["[verbose]"],O(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Gd.DEBUG&&console.log.apply(console,R(["[debug]"],O(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Gd.INFO&&console.log.apply(console,R(["[info]"],O(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Gd.WARN&&console.warn.apply(console,R(["[warn]"],O(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Gd.ERROR&&console.error.apply(console,R(["[error]"],O(e),!1))},e}(),Kd=function(){function e(e){var t,n,r,i;this.messageTypeFilter=null!==(t=null==e?void 0:e.messageTypeFilter)&&void 0!==t?t:he.ALL,this.customTypesFilter=null!==(n=null==e?void 0:e.customTypesFilter)&&void 0!==n?n:null,this.senderUserIdsFilter=null!==(r=null==e?void 0:e.senderUserIdsFilter)&&void 0!==r?r:null,this.replyType=null!==(i=null==e?void 0:e.replyType)&&void 0!==i?i:me.NONE}return e.prototype.clone=function(){var t=new e,n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){switch(this.messageTypeFilter){case he.USER:if(e.messageType!==de.USER)return!1;break;case he.FILE:if(e.messageType!==de.FILE)return!1;break;case he.ADMIN:if(e.messageType!==de.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(e.customType))return!1;if(this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0){if(!(e instanceof Go))return!1;if(!this.senderUserIdsFilter.includes(e.sender.userId))return!1}if(e instanceof Ho)switch(this.replyType){case me.NONE:if(e.parentMessageId>0)return!1;break;case me.ONLY_REPLY_TO_CHANNEL:if(e instanceof Go&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},e}();!function(e){e.CHANNEL_LATEST="channel_latest",e.NEWEST_CHILD_MESSAGE="newest_child_message"}(Vd||(Vd={}));var Wd,Yd=function(e){switch(e){case Vd.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case Vd.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},Qd=S(S({},Ol),{scheduledAt:void 0}),Xd=S(S({},wl),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),Zd="UnsentMessage",Jd={},$d=function(e){function t(t){var n=e.call(this,t)||this;return n._mutex=new Md("unsendmessagecache.lock"),Jd[t]=n,n}return I(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return ms.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),Jd[e]&&!n||(Jd[e]=new t(e)),Jd[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb,t=null==e?void 0:e.collection(Zd);if(!t)throw z.databaseError;return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw z.invalidParameters;var t,n,r=S({},e.serialize());return e instanceof Yo?(e.messageParams&&(r.messageParams=Ml(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(r.scheduledInfo.scheduledMessageParams=(t=e.scheduledInfo.scheduledMessageParams,S(S({},Ml(t)),{scheduledAt:t.scheduledAt})))):e instanceof el?(e.messageParams&&(r.messageParams=Pl(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(r.scheduledInfo.scheduledMessageParams=function(e){return S(S({},Pl(e)),{scheduledAt:e.scheduledAt})}(e.scheduledInfo.scheduledMessageParams))):e instanceof Qo&&e.messageParams&&(r.messageParams=(n=e.messageParams,we({fileInfoList:n.fileInfoList.map((function(e){return{file:e.file,fileUrl:tl.getPlainUrl(e),fileName:e.fileName,fileSize:e.fileSize,mimeType:e.mimeType,thumbnailSizes:e.thumbnailSizes,_thumbnails:e._thumbnails,_uploadedMetaData:e._uploadedMetaData}})),isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption}))),r},t.prototype._deserialize=function(e){return e=S(S({},e),{messageId:parseInt(e.messageId)}),fh.of(this._iid).buildMessageFromSerializedData(e)},t.prototype._deserializeWithMessageCreateParams=function(e){var t,n,r;return w(this,0,void 0,(function(){var i,a,s,o,l,u,c=this;return A(this,(function(d){switch(d.label){case 0:return i=fh.of(this._iid),a=this._deserialize(e),e.messageParams?a instanceof Yo?(o=e.messageParams,a.messageParams=i.buildUserMessageCreateParamsFromSerializedData(o,a),[3,6]):[3,1]:[3,6];case 1:return a instanceof el?(o=e.messageParams).fileKey&&"string"==typeof o.fileKey&&Ll(null!==(t=o.fileType)&&void 0!==t?t:"")?(s=o,[4,this.collection.getBlob(o.fileKey)]):[3,3]:[3,4];case 2:s.file=null!==(n=d.sent())&&void 0!==n?n:void 0,d.label=3;case 3:return a.messageParams=i.buildFileMessageCreateParamsFromSerializedData(o,a),[3,6];case 4:return a instanceof Qo&&(o=e.messageParams)&&o.fileInfoList?(a.messageParams=i.buildMultipleFilesMessageCreateParamsFromSerializedData(o,a),[4,Promise.all(a.messageParams.fileInfoList.map((function(e){return w(c,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return"string"==typeof(null===(n=e._uploadedMetaData)||void 0===n?void 0:n.fileKey)&&Ll(null!==(i=null===(r=e._uploadedMetaData)||void 0===r?void 0:r.fileType)&&void 0!==i?i:"")?(t=e,[4,this.collection.getBlob(e._uploadedMetaData.fileKey)]):[3,2];case 1:t.file=null!==(a=s.sent())&&void 0!==a?a:void 0,s.label=2;case 2:return[2]}}))}))})))]):[3,6];case 5:d.sent(),d.label=6;case 6:return a.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?a instanceof Yo?(l=e.scheduledInfo.scheduledMessageParams,a.scheduledInfo.scheduledMessageParams=i.buildScheduledUserMessageCreateParamsFromSerializedData(l,a),[3,10]):[3,7]:[3,10];case 7:return a instanceof el?(l=e.scheduledInfo.scheduledMessageParams).fileKey&&"string"==typeof l.fileKey&&"string"==typeof l.fileType&&Ll(l.fileType)?(u=l,[4,this.collection.getBlob(l.fileKey)]):[3,9]:[3,10];case 8:u.file=null!==(r=d.sent())&&void 0!==r?r:void 0,d.label=9;case 9:a.scheduledInfo.scheduledMessageParams=i.buildScheduledFileMessageCreateParamsFromSerializedData(l,a),d.label=10;case 10:return[2,a]}}))}))},t.prototype._getFileInfoBlobKey=function(e,t){return"".concat(e,".").concat(t)},t.prototype.get=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserializeWithMessageCreateParams(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.filter,r=void 0===n?new Kd:n,i=e.order,a=void 0===i?Vd.CHANNEL_LATEST:i,s=e.sendingStatus,o=e.backward,l=void 0!==o&&o,u=e.parentMessageId;return w(this,0,void 0,(function(){var e,n,i,o,c=this;return A(this,(function(d){switch(d.label){case 0:return this.localCacheEnabled?(e=Yd(a),n={"/where":function(e){return!!(a!==Vd.NEWEST_CHILD_MESSAGE||u&&0!==e.parentMessageId&&e.parentMessageId===u)&&r.match(c._deserialize(e))}},t&&(n.channelUrl=t),s&&(n.sendingStatus=s),i={where:n,index:e,backward:l},[4,this.collection.query(i)]):[3,3];case 1:return[4,d.sent().fetch({})];case 2:return o=d.sent(),[2,Promise.all(o.map((function(e){return w(c,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._deserializeWithMessageCreateParams(e)];case 1:return[2,t.sent()]}}))}))})))];case 3:return[2,[]]}}))}))},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new Kd),w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this.fetch({filter:t,order:Vd.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}}))}))},t.prototype.upsert=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return w(t,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return e instanceof el||e instanceof Qo?[4,this._mutex.lock()]:[3,4];case 1:return n.sent(),[4,this.saveBlob(e)];case 2:return n.sent(),[4,this._mutex.unlock()];case 3:n.sent(),n.label=4;case 4:return t=this._serialize(e),[4,this.collection.upsertOne(t)];case 5:return n.sent(),[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.upsertChildMessages=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return w(t,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=[],e.threadInfo&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return t.length>0?(t.forEach((function(t){return t.applyParentMessage(e)})),[4,this.upsert(t)]):[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),t=M(e),n=t.next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=o.sent(),a={error:i},[3,8];case 7:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.saveBlob=function(e){return w(this,0,void 0,(function(){var t,n,r,i=this;return A(this,(function(a){switch(a.label){case 0:return e instanceof el?e.messageParams&&(r=e.messageParams).file&&Ul(r.file)?[4,this.collection.saveBlob(r.file,e.reqId)]:[3,2]:[3,5];case 1:n=a.sent(),r.fileKey=n,r.fileType=kl.BLOB,a.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(t=e.scheduledInfo.scheduledMessageParams).file&&Ul(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,4];case 3:n=a.sent(),t.fileKey=n,t.fileType=kl.BLOB,a.label=4;case 4:return[3,7];case 5:return e instanceof Qo&&(r=e.messageParams)&&r.fileInfoList&&Array.isArray(r.fileInfoList)?[4,Promise.all(r.fileInfoList.map((function(t,n){return w(i,0,void 0,(function(){var r;return A(this,(function(i){switch(i.label){case 0:return t.file&&Ul(t.file)?[4,this.collection.saveBlob(t.file,this._getFileInfoBlobKey(e.reqId,n))]:[3,2];case 1:r=i.sent(),t._uploadedMetaData||(t._uploadedMetaData={}),t._uploadedMetaData.fileKey=r,t._uploadedMetaData.fileType=kl.BLOB,i.label=2;case 2:return[2]}}))}))})))]:[3,7];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},t}(ia),eh={},th=function(e){function t(t){var n=e.call(this,t)||this;return eh[t]=n,n}return I(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return ms.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return ms.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return $d.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),eh[e]&&!n||(eh[e]=new t(e)),eh[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return pa(!!e).throw(z.databaseError),e.collection(vc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return S(S({},e.serialize()),{messageId:"".concat(e.messageId)})},t.prototype._deserialize=function(e){return e=S(S({},e),{messageId:parseInt(e.messageId)}),fh.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,a=e.filter,s=void 0===a?new Kd:a,o=e.order,l=void 0===o?Vd.CHANNEL_LATEST:o,u=e.backward,c=void 0!==u&&u,d=e.parentMessageId,h=e.isPollOnly,f=void 0!==h&&h,p=e.exactMatch,m=void 0!==p&&p,g=e.inclusive,_=void 0===g||g;return w(this,0,void 0,(function(){var e,r,a,o=this;return A(this,(function(u){switch(u.label){case 0:return this.localCacheEnabled?(e=Yd(l),r={where:{channelUrl:t,"/where":function(e){if(null!=n&&""!==n)switch(l){case Vd.CHANNEL_LATEST:if(m&&e.createdAt!==n)return!1;if(c){if(_&&e.createdAt<n||!_&&e.createdAt<=n)return!1}else if(_&&e.createdAt>n||!_&&e.createdAt>=n)return!1;break;case Vd.NEWEST_CHILD_MESSAGE:if(!d||0===e.parentMessageId||e.parentMessageId!==d)return!1}return!(f&&!e._poll)&&s.match(o._deserialize(e))}},index:e,backward:c},[4,this.collection.query(r)]):[3,3];case 1:return[4,u.sent().fetch({limit:null!=i?i:void 0})];case 2:return a=u.sent(),[2,Promise.all(a.map((function(e){return w(o,0,void 0,(function(){return A(this,(function(t){return[2,this._deserialize(e)]}))}))})))];case 3:return[2,[]]}}))}))},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new Kd),w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:t,order:Vd.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}}))}))},t.prototype.upsert=function(e){var t;return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c=this;return A(this,(function(d){switch(d.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,13];case 1:d.sent(),d.label=2;case 2:d.trys.push([2,7,8,9]),n=M(e),r=n.next(),d.label=3;case 3:return r.done?[3,6]:(i=r.value,(null===(t=i.threadInfo)||void 0===t?void 0:t._isUpdateRequired)?[4,this.get(i.messageId)]:[3,5]);case 4:(null==(a=d.sent())?void 0:a.threadInfo)&&i.threadInfo._updateFrom(a.threadInfo),d.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return s=d.sent(),l={error:s},[3,9];case 8:try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(l)throw l.error}return[7];case 9:return o=e.map((function(e){return c._serialize(e)})),[4,this.collection.upsertMany(o)];case 10:return d.sent(),[4,this.upsertChildMessages(e)];case 11:return d.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 12:d.sent(),d.label=13;case 13:return[2]}}))}))},t.prototype.upsertChildMessages=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return w(t,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=[],(null===(n=e.threadInfo)||void 0===n?void 0:n.replyCount)&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return t.length>0?(t.forEach((function(t){return t.applyParentMessage(e)})),[4,this.upsert(t)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),t=M(e),n=t.next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove("".concat(r))]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=o.sent(),a={error:i},[3,8];case 7:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:Yd(Vd.CHANNEL_LATEST)})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},t.prototype.removeUnderOffset=function(e,t,n){return void 0===n&&(n=!1),w(this,0,void 0,(function(){return A(this,(function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:n?{"<=":t}:{"<":t}},index:Yd(Vd.CHANNEL_LATEST)})]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.countBetween=function(e,t,n){return w(this,0,void 0,(function(){var r,i=this;return A(this,(function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=Yd(Vd.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,a.sent()];case 2:return[2,0]}}))}))},t.prototype.saveBlobs=function(e){return w(this,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return w(t,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return e instanceof el&&e.messageParams&&(t=e.messageParams).file&&Ul(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,2];case 1:n=r.sent(),t.fileKey=n,r.label=2;case 2:return[2]}}))}))})))];case 1:return n.sent(),[2]}}))}))},t.prototype._getGroupChannelPreferenceSize=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return t=0,[4,(n=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return r=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return i=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return a=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return s=o.sent(),r&&(t+=JSON.stringify(r).length),i&&(t+=JSON.stringify(i).length),a&&(t+=JSON.stringify(a).length),s&&(t+=JSON.stringify(s).length),[2,t]}}))}))},t}(ia),nh={},rh=function(e){function t(t){var n=e.call(this,t)||this;return nh[t]=n,n}return I(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return ms.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return ms.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),nh[e]&&!n||(nh[e]=new t(e)),nh[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return pa(!!e).throw(z.databaseError),e.collection(Ec)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return S({},e.serialize())},t.prototype._deserialize=function(e){return fh.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,a=e.filter,s=void 0===a?new Kd:a,o=e.backward,l=void 0!==o&&o,u=e.exactMatch,c=void 0!==u&&u,d=e.inclusive,h=void 0===d||d;return w(this,0,void 0,(function(){var e,r=this;return A(this,(function(a){switch(a.label){case 0:return this.localCacheEnabled?(e={where:{channelUrl:t,"/where":function(e){if(n){if(c&&e.createdAt!==n)return!1;if(l){if(h&&e.createdAt<n||!h&&e.createdAt<=n)return!1}else if(h&&e.createdAt>n||!h&&e.createdAt>=n)return!1}return s.match(r._deserialize(e))}},index:["channelUrl","-createdAt","-notificationId"],backward:l},[4,this.collection.query(e)]):[3,3];case 1:return[4,a.sent().fetch({limit:null!=i?i:void 0})];case 2:return[2,a.sent().map((function(e){return r._deserialize(e)}))];case 3:return[2,[]]}}))}))},t.prototype.upsert=function(e){return w(this,0,void 0,(function(){var t,n=this;return A(this,(function(r){switch(r.label){case 0:return this.localCacheEnabled?(t=e.map((function(e){return n._serialize(e)})),[4,this.collection.upsertMany(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),t=M(e),n=t.next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=o.sent(),a={error:i},[3,8];case 7:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.markAsReadByTimestamp=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,messageStatus:jo.SENT,createdAt:{"<":t}}},{set:{messageStatus:jo.READ}})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.markAsReadByMessageIds=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,notificationId:{"/in":t},messageStatus:jo.SENT}},{set:{messageStatus:jo.READ}})]:[3,2];case 1:return[2,n.sent().length];case 2:return[2,0]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:["channelUrl","-createdAt","-notificationId"]})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},t.prototype.removeUnderOffset=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:Yd(Vd.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.countBetween=function(e,t,n){return w(this,0,void 0,(function(){var r,i=this;return A(this,(function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=["channelUrl","-createdAt","-notificationId"],[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,a.sent()];case 2:return[2,0]}}))}))},t}(ia),ih={},ah=function(e){function t(t){var n=e.call(this,t)||this;return n._observers=new Map,n._dispatcherContext=n._dispatcher.on((function(e){return w(n,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C=this;return A(this,(function(N){switch(N.label){case 0:return e instanceof vs?(t=e.messages,b=e.source,s=e.isWebSocketEventComing,n=t.filter((function(e){return e instanceof Ho&&e.channelType!==le.OPEN&&e.messageId>0})),r=t.filter((function(e){return e instanceof Ho&&e.channelType!==le.OPEN&&0===e.messageId})),i=t.filter((function(e){return e instanceof Zo})),n.length>0?[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert(n)];case 1:return e.sent(),[4,this._unsentMessageCache.remove(n.map((function(e){return e instanceof Go?e.reqId:null})).filter((function(e){return null!==e})))];case 2:return e.sent(),[2]}}))}))}))]:[3,2]):[3,7];case 1:N.sent(),s||this._broadcastUpdateEvent(n,b),N.label=2;case 2:return r.length>0?[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._unsentMessageCache.upsert(r)];case 1:return e.sent(),[2]}}))}))}))]:[3,4];case 3:N.sent(),s||this._broadcastUpdateEvent(r,b),N.label=4;case 4:return i.length>0?[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._notificationCache.upsert(i)];case 1:return e.sent(),[2]}}))}))}))]:[3,6];case 5:N.sent(),s||this._broadcastUpdateEvent(i,b),N.label=6;case 6:return[3,24];case 7:return e instanceof Es?(a=e.messageIds,b=e.source,s=e.isWebSocketEventComing,o=a.filter((function(e){return"number"==typeof e})),l=a.filter((function(e){return"string"==typeof e})),[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return o.length>0?[4,this._messageCache.remove(o)]:[3,2];case 1:e.sent(),e.label=2;case 2:return l.length>0?[4,this._notificationCache.remove(l)]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}))]):[3,9];case 8:return N.sent(),s||this._broadcastRemoveEvent(a,b),[3,24];case 9:return e instanceof Ns?(u=e.reqId,b=e.source,[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._unsentMessageCache.remove([u])];case 1:return e.sent(),[2]}}))}))}))]):[3,11];case 10:return N.sent(),this._broadcastRemoveUnsentEvent(u,b),[3,24];case 11:return e instanceof Ts?(c=e.polls,b=e.source,this._cacheContext.localCacheEnabled?(d=c.map((function(e){return e.messageId})),[4,Promise.all(d.map((function(e){return C._messageCache.get(e)})))]):[3,14]):[3,15];case 12:return(h=N.sent().filter((function(e){return e}))).length>0&&c.forEach((function(e){var t=h.find((function(t){return t.messageId===e.messageId}));t&&t.applyPoll(e)})),[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert(h)];case 1:return[2,e.sent()]}}))}))}))];case 13:N.sent(),N.label=14;case 14:return this._broadcastPollChangeLogEvent(c,b),[3,24];case 15:return e instanceof Is?(f=e.event,b=e.source,[4,this._messageCache.get(f.messageId)]):[3,19];case 16:return(p=N.sent())&&p.isUserMessage()&&p.poll&&p.poll.applyPollUpdateEvent(f)?[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert([p])];case 1:return[2,e.sent()]}}))}))}))]:[3,18];case 17:N.sent(),N.label=18;case 18:return this._broadcastPollUpdateEvent(f,b),[3,24];case 19:return e instanceof Ss?(m=e.event,b=e.source,[4,this._messageCache.get(m.messageId)]):[3,23];case 20:return(g=N.sent())&&g.isUserMessage()&&g.poll&&g.poll.applyPollVoteEvent(m)?[4,Bi((function(){return w(C,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert([g])];case 1:return[2,e.sent()]}}))}))}))]:[3,22];case 21:N.sent(),N.label=22;case 22:return this._broadcastPollVoteEvent(m,b),[3,24];case 23:e instanceof bs?(_=e.event,b=e.source,_.messageId>0&&this._broadcastReactionUpdateEvent(_,b)):e instanceof Cs?(v=e.event,b=e.source,this._broadcastThreadUpdateEvent(v,b)):e instanceof ys&&(E=e.messageDeletionTimestamp,y=e.channelUrl,b=e.source,this._broadcastMessageRetentionEvent(E,y,b)),N.label=24;case 24:return[2]}}))}))})),n}return I(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return ms.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dispatcher",{get:function(){return ms.of(this._iid).dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return th.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return $d.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_notificationCache",{get:function(){return rh.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,n){var r;return void 0===n&&(n=!1),ih[e]&&!n||(ih[e]&&(null===(r=ih[e]._dispatcherContext)||void 0===r||r.close()),ih[e]=new t(e)),ih[e]},t.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onUpdate&&s.onUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollChangeLogEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onPollChangeLogUpdate&&s.onPollChangeLogUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollUpdateEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onPollUpdate&&s.onPollUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollVoteEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onPollVote&&s.onPollVote(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onRemove&&s.onRemove(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastRemoveUnsentEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onRemoveUnsent&&s.onRemoveUnsent(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastReactionUpdateEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onReactionUpdate&&s.onReactionUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastThreadUpdateEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onThreadInfoUpdate&&s.onThreadInfoUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastMessageRetentionEvent=function(e,t,n){var r,i;try{for(var a=M(this._observers.values()),s=a.next();!s.done;s=a.next()){var o=s.value;o.onDeletedByRetentionPolicy&&o.onDeletedByRetentionPolicy(e,t,n)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.subscribe=function(e,t){this._observers.set(e,t)},t.prototype.unsubscribe=function(e){this._observers.delete(e)},t.prototype.unsubscribeAll=function(){this._observers.clear()},t}(ia),sh={},oh=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,a=e.call(this,t)||this;return a._users=new Map,a._sdkState=r,a._cacheContext=i,sh[t]=a,a}return I(t,e),t.of=function(e){return sh[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return pa(!!e).throw(z.databaseError),e.collection(yc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"users",{get:function(){return R([],O(this._users.values()),!1)},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e,t){return S(S({},e.serialize()),{updatedAt:t})},t.prototype._deserialize=function(e){return ga._buildUserFromSerializedData(e)},t.prototype.isCachedInMemory=function(e){return this._users.has(e)},t.prototype.getUserInfoFromCache=function(e){if(this._users.has(e))return this._users.get(e)},t.prototype.get=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return this._users.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=r.sent())return n=this._deserialize(t),this._users.set(n.userId,n),[2,n];r.label=2;case 2:return[2,void 0];case 3:return[2,this._users.get(e)]}}))}))},t.prototype.fetch=function(e){var t=e.limit,n=void 0===t?100:t,r=e.backward,i=void 0!==r&&r;return w(this,0,void 0,(function(){var e,t,r,a=this;return A(this,(function(s){switch(s.label){case 0:if(!this.localCacheEnabled)return[2,[]];s.label=1;case 1:return s.trys.push([1,4,,5]),e={index:["-userId","-updatedAt"],backward:i},[4,this.collection.query(e)];case 2:return[4,s.sent().fetch({limit:n})];case 3:return t=s.sent(),(r=t.map((function(e){return a._deserialize(e)}))).forEach((function(e){a._users.has(e.userId)||a._users.set(e.userId,e)})),[2,r];case 4:return s.sent(),[2,[]];case 5:return[2]}}))}))},t.prototype.upsert=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:if(!this.localCacheEnabled)return[3,2];if(n=this._serialize(e,t),r=this._users.get(e.userId)){if(r._hashValue===e._hashValue)return[2];if(r._updatedAt>t)return[2]}return this._users.set(e.userId,ga._buildUserFromSerializedData(n)),[4,this.collection.upsertOne(n)];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return this._users.has(e)&&this._users.delete(e),this.localCacheEnabled?[4,this.collection.remove(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.clearMemoryCache=function(){this._users.clear()},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t}(ia),lh=function(e){function t(t){var n=this,r=t.reverse,i=void 0!==r&&r,a=t.limit,s=void 0===a?20:a,o=t.keys,l=t.token;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(We),n.params=we({token:l,limit:s,reverse:i,order:ye.UPDATED_AT,show_ui_template:!0,show_color_variables:!0,keys:o}),n}return I(t,e),t}(it),uh=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.next,a=n.has_more,s=void 0!==a&&a,o=n.templates;return r.nextToken=i,r.hasMore=s,r.templates=o.map((function(e){return{template:JSON.stringify(e)}})),r}return I(t,e),t}(at),ch=function(e){function t(t){var n=this,r=t.key;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(We,"/").concat(r),n}return I(t,e),t}(it),dh=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.template=JSON.stringify(n),r}return I(t,e),t}(at),hh={},fh=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,a=t.onlineDetector,s=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=i,this._dispatcher=r,this._cacheContext=s,th.of(e),$d.of(e),ah.of(e),this.fileMessageQueue=new ul(e,{sdkState:n,dispatcher:r,requestQueue:i,onlineDetector:a,cacheContext:s}),hh[e]=this}return e.of=function(e){return hh[e]},e.prototype._setSenderInfo=function(e){if(this._cacheContext.localCacheEnabled&&(e.messageType===de.USER||e.messageType===de.FILE)){var t=e.sender;if(t){var n=oh.of(this._iid).getUserInfoFromCache(t.user_id);n&&(e.sender=ga.payloadify(n))}}},e.prototype.buildMessageFromSerializedData=function(e){var t=fa(e);if(t.notificationId)return new Zo(this._iid,Zo.payloadify(t));switch(this._setSenderInfo(t),t.messageType){case de.USER:return new Yo(this._iid,Yo.payloadify(t));case de.FILE:return Qo._isMultipleFilesMessageSerializedData(t)?new Qo(this._iid,Qo.payloadify(t)):new el(this._iid,el.payloadify(t));case de.ADMIN:return new qo(this._iid,qo.payloadify(t))}throw z.invalidParameters},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return we(Ae({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId}))},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){var n;return we(Ae({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:null===(n=t.thumbnails)||void 0===n?void 0:n.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),fileType:e.fileType,requireAuth:t.requireAuth}))},e.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(e,t){var n=this;return we({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,fileInfoList:e.fileInfoList.map((function(e){return new tl(n._iid,e)}))})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return S(S({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return S(S({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(e){var t=fa(e);return new _o(this._iid,_o.payloadify(t))},e.prototype.getMessage=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=new ml(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(gl).message]}}))}))},e.prototype.getScheduledMessage=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=new bl(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Cl).message]}}))}))},e.prototype.getMessagesByMessageId=function(e,t,n,r,i){return void 0===i&&(i=os.REQUEST_MESSAGE),w(this,0,void 0,(function(){var a,s,o;return A(this,(function(l){switch(l.label){case 0:return a=new _l(S(S(S({channelType:t,channelUrl:e,token:String(n)},cl),r),{sdkSource:ll.EXTERNAL_LEGACY})),[4,this._requestQueue.send(a)];case 1:return s=l.sent(),o=s.as(vl).messages,this._dispatcher.dispatch(new vs({messages:o,source:i})),[2,o]}}))}))},e.prototype.getMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=os.REQUEST_MESSAGE),w(this,0,void 0,(function(){var a,s,o;return A(this,(function(l){switch(l.label){case 0:return a=new _l(S(S(S({channelType:t,channelUrl:e,timestamp:n},cl),r),{sdkSource:ll.EXTERNAL_LEGACY})),[4,this._requestQueue.send(a)];case 1:return s=l.sent(),o=s.as(vl).messages,this._dispatcher.dispatch(new vs({messages:o,source:i})),[2,o]}}))}))},e.prototype._getMessagesByTimestampForCollection=function(e,t,n,r,i,a,s,o){return void 0===i&&(i=os.REQUEST_MESSAGE),w(this,0,void 0,(function(){var l,u,c,d,h,f;return A(this,(function(p){switch(p.label){case 0:return l=new _l(S(S(S({channelType:t,channelUrl:e,timestamp:n},cl),r),{checkingHasNext:a,checkingContinuousMessages:s,sdkSource:o})),[4,this._requestQueue.send(l)];case 1:return u=p.sent(),c=u.as(vl),d=c.messages,h=c.isContinuousMessages,f=c.hasNext,this._dispatcher.dispatch(new vs({messages:d,source:i})),[2,{messages:d,isContinuousMessages:h,hasNext:f}]}}))}))},e.prototype.getThreadedMessagesByTimestamp=function(e,t,n,r){return void 0===r&&(r=os.REQUEST_THREADED_MESSAGE),w(this,0,void 0,(function(){var i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return i=new _l(S(S(S({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},zo),n),{replyType:me.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(i)];case 1:return a=l.sent(),s=a.as(vl).messages,(o=s.slice(1)).forEach((function(t){t.parentMessage=e})),this._dispatcher.dispatch(new vs({messages:o,source:r})),[2,{parentMessage:s[0],threadedMessages:o}]}}))}))},e.prototype.getMessageTemplatesByToken=function(e,t){return void 0===t&&(t={}),w(this,0,void 0,(function(){var n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return n=new lh(S({token:e},t)),[4,this._requestQueue.send(n)];case 1:return r=l.sent(),i=r.as(uh),a=i.hasMore,s=i.nextToken,o=i.templates,[2,{hasMore:a,token:s,templates:o}]}}))}))},e.prototype.getMessageTemplate=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=new ch({key:e}),[4,this._requestQueue.send(t)];case 1:return[2,{template:n.sent().as(dh).template}]}}))}))},e.prototype.getMessageChangelogs=function(e,t,n,r,i){return void 0===i&&(i=os.REQUEST_MESSAGE_CHANGELOGS),w(this,0,void 0,(function(){var a,s,o,l,u,c,d,h,f;return A(this,(function(p){switch(p.label){case 0:return a=new El(we(Ae(S(S({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null},hl),r)))),[4,this._requestQueue.send(a)];case 1:return s=p.sent(),o=s.as(yl),l=o.updatedMessages,u=o.deletedMessagesInfo,c=o.hasMore,d=o.nextToken,h=o.forceUseNextToken,f=u.map((function(e){return e.messageId})),l.length>0&&this._dispatcher.dispatch(new vs({messages:l,source:i})),f.length>0&&this._dispatcher.dispatch(new Es({messageIds:f,source:i})),[2,{updatedMessages:l,deletedMessageIds:f,hasMore:c,token:d,forceUseNextToken:h}]}}))}))},e}(),ph=function(e){function t(t,n){var r=e.call(this,t)||this;r.targetMessageId=0;var i=n.thread_info,a=n.parent_message_id,s=n.channel_url,o=n.channel_type;return i&&W("object",i)&&W("number",a)&&W("string",s)&&W("string",o)&&(r.threadInfo=new oo(t,i),r.targetMessageId=a,r.channelUrl=s,r.channelType=o),r}return I(t,e),t}(ia),mh={channelUrl:"",channelType:le.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},gh=function(e){function t(t){var n=t.channelCustomType,r=t.keyword,i=t.limit,a=t.reverse,s=t.exactMatch,o=t.channelUrl,l=t.order,u=t.messageTimestampFrom,c=t.messageTimestampTo,d=t.advancedQuery,h=t.targetFields,f=t.nextToken,p=e.call(this)||this;return p.method=Me.GET,p.path="".concat(Fe,"/messages"),p.params=we({custom_type:n,query:r,limit:i,reverse:a,exact_match:s,channel_url:o,message_ts_from:u,message_ts_to:c,sort_field:l,advanced_query:d,target_fields:h,after:f}),p}return I(t,e),t}(it),_h=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.results.map((function(e){return $o(t,e)})),r.hasNext=n.has_next,r.nextToken=n.end_cursor,r.totalCount=n.total_count,r}return I(t,e),t}(at);!function(e){e.SCORE="score",e.TIMESTAMP="ts"}(Wd||(Wd={}));var vh,Eh,yh,bh=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h=this;return(h=e.call(this,t,n)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl=null,h.channelCustomType=null,h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=Wd.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=n.keyword,h.reverse=null!==(r=n.reverse)&&void 0!==r&&r,h.exactMatch=null!==(i=n.exactMatch)&&void 0!==i&&i,h.channelUrl=null!==(a=n.channelUrl)&&void 0!==a?a:null,h.channelCustomType=null!==(s=n.channelCustomType)&&void 0!==s?s:null,h.messageTimestampFrom=null!==(o=n.messageTimestampFrom)&&void 0!==o?o:null,h.messageTimestampTo=null!==(l=n.messageTimestampTo)&&void 0!==l?l:null,h.order=null!==(u=n.order)&&void 0!==u?u:Wd.SCORE,h.advancedQuery=null!==(c=n.advancedQuery)&&void 0!==c&&c,h.targetFields=null!==(d=n.targetFields)&&void 0!==d?d:null,h}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("string",this.keyword)&&this.keyword.length>0&&W("boolean",this.reverse)&&W("boolean",this.exactMatch)&&W("string",this.channelUrl,!0)&&W("string",this.channelCustomType,!0)&&W("number",this.messageTimestampFrom,!0)&&W("number",this.messageTimestampTo,!0)&&Y(Wd,this.order)&&W("boolean",this.advancedQuery)&&X("string",this.targetFields,!0)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new gh(Ae(S(S({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=l.sent(),r=n.as(_h),i=r.messages,a=r.hasNext,s=r.nextToken,o=r.totalCount,this._nextToken=s,this._hasNext=a,this._isLoading=!1,this.totalCount=o,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),Ch=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.limit,a=t.token,s=e.call(this)||this;return s.method=Me.GET,s.path="".concat(Je(n),"/").concat(encodeURIComponent(r),"/messages/parent_thread_message"),s.params=we(Ae({limit:i,token:a})),s}return I(t,e),t}(it),Nh=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.token=n.next,r.messages=n.messages.map((function(e){return $o(t,e)})),r}return I(t,e),t}(at),Th=function(e){function t(t,n,r,i){var a=e.call(this,t,n,r,i)||this;return a._edge="",a}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.load=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Ch({channelType:this.channelType,channelUrl:this.channelUrl,token:this._edge,limit:this.limit}),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(Nh),i=r.messages,a=r.token,this._edge=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),Ih={channelUrl:"",scheduledMessageId:0},Sh={reverse:!1,limit:20},wh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="message",t}return I(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,l=n.onlineDetector,u=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:l,cacheContext:u}),this._manager=new fh(t,{sdkState:r,dispatcher:i,requestQueue:s,onlineDetector:l,cacheContext:u})},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},t.prototype.getMessage=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=S(S({},mh),e),pa((i=t,W("string",i.channelUrl)&&Y(le,i.channelType)&&W("number",i.messageId)&&W("boolean",i.includeReactions,!0)&&W("boolean",i.includeMetaArray,!0)&&W("boolean",i.includeParentMessageInfo,!0)&&W("boolean",i.includeThreadInfo,!0))).throw(z.invalidParameters),[4,this._manager.getMessage(t)];case 1:if((n=r.sent())instanceof Ho||n instanceof Zo||null===n)return[2,n];throw"Unknown message type is given."}var i}))}))},t.prototype.getScheduledMessage=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},Ih),e),pa((r=t,W("string",r.channelUrl)&&""!==r.channelUrl&&W("number",r.scheduledMessageId)&&r.scheduledMessageId>0)).throw(z.invalidParameters),[2,this._manager.getScheduledMessage(t)];var r}))}))},t.prototype.getMessageTemplatesByToken=function(e,t){return void 0===t&&(t={}),w(this,0,void 0,(function(){var n;return A(this,(function(r){return n=S(S({},Sh),t),pa(W("string",e,!0)&&(i=n,W("boolean",i.reverse,!0)&&W("number",i.limit,!0)&&X("string",i.keys,!0))).throw(z.invalidParameters),[2,this._manager.getMessageTemplatesByToken(e,n)];var i}))}))},t.prototype.getMessageTemplate=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return pa(W("string",e)).throw(z.invalidParameters),[2,this._manager.getMessageTemplate(e)]}))}))},t}(gs);!function(e){e.LATEST_LAST_MESSAGE="latest_last_message",e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(vh||(vh={})),function(e){e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(Eh||(Eh={})),function(e){e.CREATED_AT="created_at",e.SCHEDULED_AT="scheduled_at"}(yh||(yh={}));var Ah,Mh=function(e){switch(e){case vh.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case vh.CHRONOLOGICAL:return["-createdAt","syncIndex"];case vh.CHANNEL_NAME_ALPHABETICAL:return["name"];default:return["-lastMessageUpdatedAt","-createdAt","syncIndex"]}},Oh=function(e){function t(t){var n=t.message,r=e.call(this)||this;return r.message=n,r}return I(t,e),t}(Se),Rh={},kh=function(){function e(e,t){var n=t.localCacheEnabled,r=t.enableAutoResend,i=t.dispatcher,a=t.sdkState,s=t.logger,o=this;this._iid=e,Rh[e]=this,this._localCacheEnabled=n,this._enableAutoResend=r,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=i,this._logger=s,this._sdkState=a,this._localCacheEnabled&&i.on((function(e){if(e instanceof Ki)switch(e.stateType){case ji.CONNECTED:o._isProcessingAutoResend||o.processAutoResendRegisteredPendingMessages().then((function(){return o._processNextAutoResend()}));break;case ji.INTERNAL_DISCONNECTED:case ji.EXTERNAL_DISCONNECTED:o._isProcessingAutoResend=!1}}))}return e.of=function(e){return Rh[e]},e.prototype.processNonAutoResendRegisteredPendingMessages=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._enableAutoResend?[4,this._fetchAllCachedPendingMessages()]:[2];case 1:e=s.sent();try{for(t=M(e),n=t.next();!n.done;n=t.next())0===(r=n.value).errorCode&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",r.reqId),r.sendingStatus=_e.FAILED,r.errorCode=k.ACK_TIMEOUT,this._dispatcher.dispatch(new vs({messages:[r],source:os.LOCAL_MESSAGE_FAILED})))}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}}return[2]}}))}))},e.prototype.processAutoResendRegisteredPendingMessages=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:e=l.sent();try{for(t=M(e),n=t.next();!n.done;n=t.next())r=n.value,this._enableAutoResend&&r.errorCode&&J(r.errorCode)&&(i=(new Date).getTime(),a=r.createdAt+2592e5,this._enableAutoResend&&i<=a?this._autoResendQueue.map((function(e){return e.reqId})).indexOf(r.reqId)<0&&this._autoResendQueue.push(r):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(a).toLocaleString()),r.sendingStatus=_e.FAILED,this._dispatcher.dispatch(new vs({messages:[r],source:os.LOCAL_MESSAGE_FAILED}))))}catch(e){s={error:e}}finally{try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(s)throw s.error}}return[2]}}))}))},e.prototype.completeCurrentAndProcessNextAutoResend=function(e){if(this._localCacheEnabled&&this._enableAutoResend&&(e.sendingStatus===_e.SUCCEEDED||e.sendingStatus===_e.FAILED&&!J(e.errorCode))){var t=this.indexOf(e);t>=0&&this._autoResendQueue.splice(t,1),0===t&&this._processNextAutoResend()}},e.prototype._fetchAllCachedPendingMessages=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=$d.of(this._iid),(t=new Kd).replyType=me.ALL,[4,e.fetch({sendingStatus:_e.PENDING,backward:!0,filter:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.indexOf=function(e){return this._autoResendQueue.length>0?this._autoResendQueue.map((function(e){return e.reqId})).indexOf(e.reqId):-1},e.prototype._isNotInQueue=function(e){return-1===this._autoResendQueue.map((function(e){return e.reqId})).indexOf(e.reqId)},e.prototype._processNextAutoResend=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){if(this._localCacheEnabled&&this._enableAutoResend&&"foreground"===this._sdkState.appState)try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),e=this._autoResendQueue[0],this._dispatcher.dispatch(new Oh({message:e})),this._logger.debug("processing auto-resend for message request id: ",e.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(e){this._logger.warn("process auto-resend error: ",e),this._isProcessingAutoResend=!1}return[2]}))}))},e}();!function(e){e[e.USER_BLOCK=20001]="USER_BLOCK",e[e.USER_UNBLOCK=2e4]="USER_UNBLOCK",e[e.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED"}(Ah||(Ah={}));var xh,Dh=function(){function e(e){this.category=e.cat,this.data=e.data}return e.getDataAsUserBlockEvent=function(e,t){var n=t.data,r=n.blocker,i=n.blockee;return{blocker:new ga(e,r),blockee:new ga(e,i)}},e.getDataAsFriendDiscoveredEvent=function(e,t){var n=t.data.friend_discoveries;return{friendDiscoveries:Array.isArray(n)?n.map((function(t){return new ga(e,t)})):[]}},e}(),Uh=function(e){function t(t,n){var r=n.userId,i=e.call(this)||this;return i._iid=t,i.userId=r,i}return I(t,e),t}(Se),Lh=function(e){function t(){return e.call(this)||this}return I(t,e),t}(Se),Ph=function(e){function t(t){var n=t.configTs,r=e.call(this)||this;return r.configTs=n,r}return I(t,e),t}(Se),Fh=function(e){function t(t,n,r){var i=e.call(this,t,"USEV",r)||this;return i.event=new Dh(r),i}return I(t,e),t}(lt),Bh=function(e){function t(t){var n=t.appConfigsInfo,r=t.configTs,i=e.call(this)||this;return i.appConfigsInfo={},i.configTs=0,i.appConfigsInfo=n,i.configTs=r,i}return I(t,e),t}(Se);!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"}(xh||(xh={}));var jh,Hh=function(e){function t(t,n,r,i){var a=e.call(this)||this;return a._state=xh.IDLE,a._retryCount=0,a._retryLimit=3,a.priority=0,a._worker=n,a}return I(t,e),Object.defineProperty(t.prototype,"isIdle",{get:function(){return this._state===xh.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._state===xh.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDone",{get:function(){return this._state===xh.END},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),t.prototype._run=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:if(!this.isRunning)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return t=r.sent(),this._retryCount=0,this.dispatch("progress",t),t.hasNext?this._run(t.nextToken):this.end(),[3,4];case 3:return n=r.sent(),this.dispatch("error",n),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return[2]}}))}))},t.prototype.start=function(e){this.isIdle&&(this._state=xh.RUNNING,this._run(e))},t.prototype.stop=function(){this._state=xh.IDLE,this.dispatch("stop")},t.prototype.end=function(){this._state=xh.END,this.dispatch("end")},t}(Te),Gh=function(e,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=e,this._payload=t};!function(e){e[e.NONE=0]="NONE",e[e.CHANNEL_ENTER=10102]="CHANNEL_ENTER",e[e.CHANNEL_EXIT=10103]="CHANNEL_EXIT",e[e.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",e[e.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",e[e.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",e[e.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",e[e.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",e[e.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",e[e.TYPING_START=10900]="TYPING_START",e[e.TYPING_END=10901]="TYPING_END",e[e.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",e[e.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",e[e.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",e[e.CHANNEL_INVITE=10020]="CHANNEL_INVITE",e[e.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",e[e.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",e[e.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",e[e.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",e[e.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",e[e.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",e[e.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",e[e.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",e[e.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED"}(jh||(jh={}));var zh,Vh=function(){function e(e){var t;this.channelUrl=e.channel_url,this.channelType=e.channel_type,this.category=e.cat,this.data=null!==(t=e.data)&&void 0!==t?t:{},this.ts=e.ts}return Object.defineProperty(e.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===le.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===le.OPEN},enumerable:!1,configurable:!0}),e}(),qh=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.event=new Vh(r),i}return I(t,e),t}(lt),Kh=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data.operators,s=void 0===a?[]:a;return i.operators=s.map((function(e){return new ga(i._iid,e)})),i}return I(t,e),t}(qh),Wh=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t,"SYEV",r)||this).pinnedMessageIds=[],a.latestPinnedMessage=null,a.ts=0,r.data&&(a.pinnedMessageIds=null!==(i=r.data.pinned_message_ids)&&void 0!==i?i:[],a.latestPinnedMessage=r.data.latest_pinned_message?$o(t,S({},r.data.latest_pinned_message)):null),a.ts=r.ts,a}return I(t,e),t}(lt),Yh=function(e){function t(t,n){var r=e.call(this,t)||this;return r._logger=n.logger,r._sdkState=n.sdkState,r._sessionManager=n.sessionManager,r._requestQueue=n.requestQueue,r._dispatcher=n.dispatcher,r._cacheContext=n.cacheContext,r._channelType=n.channelType,r}return I(t,e),Object.defineProperty(t.prototype,"_messageBroadcast",{get:function(){return ah.of(this._iid)},enumerable:!1,configurable:!0}),t.prototype.subscribeMessageEvent=function(e,t){this._messageBroadcast.subscribe(e,t)},t.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e)},t.prototype.getMessageFromCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,null]}))}))},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,[]]}))}))},t.prototype.getMessagesFromCache=function(e,t,n,r,i,a){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,[]]}))}))},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,[]]}))}))},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,0]}))}))},t.prototype.getUnsentMessagesFromCache=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,[]]}))}))},t.prototype.removeFailedMessageFromCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(e){return[2]}))}))},t}(ia),Qh=function(e){function t(t,n,r){var i,a,s,o,l=this;(l=e.call(this,t,"ADMM",r)||this).message=new qo(t,r);var u=ms.of(t).sdkState;return l.isMentioned=et(l.message.mentionType,null!==(s=null!==(i=l.message.mentionedUserIds)&&void 0!==i?i:null===(a=l.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==s?s:[],u.userId),l.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,l}return I(t,e),t}(lt),Xh=function(e){function t(t,n,r){var i,a,s,o,l,u=this;(u=e.call(this,t,"AEDI",r)||this).message=new qo(t,r);var c=ms.of(t).sdkState;return u.mentionCountChange=tt({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(s=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==s?s:[]},Ae({mentionType:u.message.mentionType,mentionedUserIds:null!==(o=u.message.mentionedUserIds)&&void 0!==o?o:null===(l=u.message.mentionedUsers)||void 0===l?void 0:l.map((function(e){return e.userId}))}),c.userId),u}return I(t,e),t}(lt),Zh=function(e){function t(t,n,r){var i=e.call(this,t,"MRCT",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.event=new uo(r),i}return I(t,e),t}(lt),Jh=function(e){function t(t,n,r){var i=e.call(this,t,"MTHD",r)||this;return i.event=new ph(t,r),i}return I(t,e),t}(lt),$h=function(e){function t(t,n,r){var i=e.call(this,t,"MCNT",r)||this;return i.groupChannelMemberCounts=r.group_channels.map((function(e){return{channelUrl:e.channel_url,memberCount:e.member_count,joinedMemberCount:e.joined_member_count,updatedAt:e.ts}})),i.openChannelMemberCounts=r.open_channels.map((function(e){return{channelUrl:e.channel_url,participantCount:e.participant_count,updatedAt:e.ts}})),i}return I(t,e),t}(lt),ef=function(e){function t(t,n,r){var i=e.call(this,t,"PEDI",r)||this;return i.event=new Gh(t,r),i.status=Ms(r.poll.status)||r.poll.status,i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return I(t,e),t}(lt);!function(e){e.NONE="none",e.JOINED="joined",e.INVITED="invited",e.LEFT="left"}(zh||(zh={}));var tf,nf,rf,af,sf,of,lf,uf,cf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state=null,r.role=null,r.isMuted=!1,r.isBlockedByMe=!1,r.isBlockingMe=!1,r.state=Y(zh,n.state)?n.state:null,r.role=Y(ue,n.role)?n.role:null,"boolean"==typeof n.is_muted&&(r.isMuted=n.is_muted),"boolean"==typeof n.is_blocked_by_me&&(r.isBlockedByMe=n.is_blocked_by_me),"boolean"==typeof n.is_blocking_me&&(r.isBlockingMe=n.is_blocking_me),r}return I(t,e),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{state:t.state,role:t.role,is_muted:t.isMuted,is_blocked_by_me:t.isBlockedByMe,is_blocking_me:t.isBlockingMe})))},t}(Tl),df=function(e){function t(t,n){var r,i,a=this;return(a=e.call(this,t)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",a.channelType=null!==(i=n.channel_type)&&void 0!==i?i:le.GROUP,a.member=new ga(a._iid,n.user),a.deliveryAt=n.ts,a}return I(t,e),t}(ia);!function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"}(tf||(tf={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(nf||(nf={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper",e.BROADCAST_ONLY="broadcast_only",e.EXCLUSIVE_ONLY="exclusive_only"}(rf||(rf={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(af||(af={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(sf||(sf={})),function(e){e.ALL="all",e.OPERATOR="operator",e.NONOPERATOR="nonoperator"}(of||(of={})),function(e){e.AND="AND",e.OR="OR"}(lf||(lf={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(uf||(uf={}));var hf,ff=function(){function e(e){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m;this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=null!==(t=null==e?void 0:e.includeEmpty)&&void 0!==t&&t,this.nicknameContainsFilter=null!==(n=null==e?void 0:e.nicknameContainsFilter)&&void 0!==n?n:null,this.nicknameStartsWithFilter=null!==(r=null==e?void 0:e.nicknameStartsWithFilter)&&void 0!==r?r:null,this.nicknameExactMatchFilter=null!==(i=null==e?void 0:e.nicknameExactMatchFilter)&&void 0!==i?i:null,this.channelNameContainsFilter=null!==(a=null==e?void 0:e.channelNameContainsFilter)&&void 0!==a?a:"",this.myMemberStateFilter=null!==(s=null==e?void 0:e.myMemberStateFilter)&&void 0!==s?s:nf.ALL,this.customTypesFilter=null!==(o=null==e?void 0:e.customTypesFilter)&&void 0!==o?o:null,this.channelUrlsFilter=null!==(l=null==e?void 0:e.channelUrlsFilter)&&void 0!==l?l:null,this.superChannelFilter=null!==(u=null==e?void 0:e.superChannelFilter)&&void 0!==u?u:rf.ALL,this.publicChannelFilter=null!==(c=null==e?void 0:e.publicChannelFilter)&&void 0!==c?c:tf.ALL,this.customTypeStartsWithFilter=null!==(d=null==e?void 0:e.customTypeStartsWithFilter)&&void 0!==d?d:null,this.unreadChannelFilter=null!==(h=null==e?void 0:e.unreadChannelFilter)&&void 0!==h?h:af.ALL,this.hiddenChannelFilter=null!==(f=null==e?void 0:e.hiddenChannelFilter)&&void 0!==f?f:sf.UNHIDDEN,this.includeFrozen=null===(p=null==e?void 0:e.includeFrozen)||void 0===p||p,(null==e?void 0:e.createdAfter)&&(this.createdAfter=e.createdAfter),(null==e?void 0:e.createdBefore)&&(this.createdBefore=e.createdBefore),this.includeMetaData=null===(m=null==e?void 0:e.includeMetaData)||void 0===m||m}return e.prototype._isFriend=function(e){return!(!e||!e.friendDiscoveryKey&&!e.friendName)},Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={query:t,fields:e})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=lf.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n}},e.prototype.clone=function(){var t,n=new e;this.searchFilter&&n.setSearchFilter(this.searchFilter.fields,null!==(t=this.searchFilter.query)&&void 0!==t?t:void 0),this.userIdsFilter&&n.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach((function(e){n[e]=r[e]})),n},e.prototype.match=function(e,t){if(this._searchFilter){var n=this._searchFilter,r=n.query,i=n.fields;if(r&&i&&i.length>0&&!i.some((function(t){switch(t){case uf.CHANNEL_NAME:return e.name.toLowerCase().includes(r.toLowerCase());case uf.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(r.toLowerCase())}));default:return!0}})))return!1}if(this._userIdsFilter){var a=this._userIdsFilter,s=a.userIds,o=a.includeMode,l=a.queryType,u=e.members.map((function(e){return e.userId}));if(o){if(s.length>0)switch(l){case lf.AND:if(s.some((function(e){return!u.includes(e)})))return!1;break;case lf.OR:if(s.every((function(e){return!u.includes(e)})))return!1}}else{if(s.includes(t)||s.push(t),e.members.length>s.length)return!1;if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=R([],O(e),!1).sort(),r=R([],O(t),!1).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(s,u))return!1}}if(!this.includeEmpty&&!e.lastMessage)return!1;if(!this.includeFrozen&&e.isFrozen)return!1;if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(e.customType))return!1;if(this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType))return!1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var c=this.nicknameContainsFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().includes(c)})))return!1}if(this.nicknameStartsWithFilter){var d=this.nicknameStartsWithFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().startsWith(d)})))return!1}if(this.nicknameExactMatchFilter){var h=this.nicknameExactMatchFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase()!=h})))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case nf.ALL:if("none"===e.myMemberState)return!1;break;case nf.JOINED:if("joined"!==e.myMemberState)return!1;break;case nf.INVITED:if("invited"!==e.myMemberState)return!1;break;case nf.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return!1;break;case nf.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case sf.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return!1;break;case sf.HIDDEN:if(!e.isHidden)return!1;break;case sf.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return!1;break;case sf.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===af.UNREAD_MESSAGE&&0===e.unreadMessageCount)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case tf.PUBLIC:if(!e.isPublic)return!1;break;case tf.PRIVATE:if(e.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case rf.SUPER:if(!e.isSuper)return!1;break;case rf.NON_SUPER:if(e.isSuper)return!1}return!(this.createdAfter&&e.createdAt<this.createdAfter||this.createdBefore&&e.createdAt>this.createdBefore)},e}(),pf=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,a=e.call(this,t)||this;return a._channels=new Map,a._sdkState=r,a._cacheContext=i,a}return I(t,e),Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return pa(!!e).throw(z.databaseError),e.collection(_c)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e,t){return void 0===t&&(t=0),S(S({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:t})},t.prototype._deserialize=function(e){return Np.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(t.prototype,"channels",{get:function(){return R([],O(this._channels.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.isCachedInMemory=function(e){return this._channels.has(e)},t.prototype.filterOffsetChanged=function(e){var t=this;return e.filter((function(e){if(t._channels.has(e.url))return t._channels.get(e.url).messageOffsetTimestamp<e.messageOffsetTimestamp}))},t.prototype.get=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=r.sent())return n=this._deserialize(t),this._channels.set(e,n),[2,n];r.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(e)]}}))}))},t.prototype.fetch=function(e){var t=e.token,n=e.limit,r=void 0===n?100:n,i=e.backward,a=void 0!==i&&i,s=e.filter,o=void 0===s?new ff:s,l=e.order,u=void 0===l?vh.LATEST_LAST_MESSAGE:l,c=e.borderlineChannelUrl;return w(this,0,void 0,(function(){var e,n,i,s,l,d=this;return A(this,(function(h){switch(h.label){case 0:return this.localCacheEnabled?(e=!!c,n=Mh(u),i={where:function(n){if(t)switch(u){case vh.CHANNEL_NAME_ALPHABETICAL:if(!a&&n.name.localeCompare(t)<0||a&&n.name.localeCompare(t)>0)return!1;break;case vh.CHRONOLOGICAL:if(!a&&n.createdAt>t||a&&n.createdAt<t)return!1;break;case vh.LATEST_LAST_MESSAGE:if(!a&&n.lastMessageUpdatedAt>t||a&&n.lastMessageUpdatedAt<t)return!1}return e&&c&&c===n.url?(e=!1,!1):!e&&o.match(d._deserialize(n),d._sdkState.userId)},index:n,backward:a},[4,this.collection.query(i)]):[3,3];case 1:return[4,h.sent().fetch({limit:r})];case 2:return s=h.sent(),(l=s.map((function(e){return d._deserialize(e)}))).forEach((function(e){!o.includeMetaData&&e.cachedMetaData&&e._clearCachedMetaData(),d._channels.has(e.url)||d._channels.set(e.url,e)})),[2,l];case 3:return[2,[]]}}))}))},t.prototype.upsert=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a=this;return A(this,(function(s){switch(s.label){case 0:if(n=[],e.forEach((function(e){if(a._channels.has(e.url)){var r=a._channels.get(e.url);r._pinnedMessagesUpdatedAt<e._pinnedMessagesUpdatedAt&&(r._pinnedMessagesUpdatedAt=e._pinnedMessagesUpdatedAt),r._messageCollectionLastAccessedAt>e._messageCollectionLastAccessedAt&&(e._messageCollectionLastAccessedAt=r._messageCollectionLastAccessedAt),e.cachedMetaData instanceof Map&&e.cachedMetaData.size>0&&t&&(r._updateCachedMetaData(e.cachedMetaData,t).isUpdated||Object.assign(e,{_cachedMetaData:r.cachedMetaData})),r._update(e),n.push(r)}else a._channels.set(e.url,e),n.push(e)})),!this.localCacheEnabled)return[3,2];for(r=[],i=0;i<n.length;i++)r.push(this._serialize(n[i],i));return[4,this.collection.upsertMany(r)];case 1:s.sent(),s.label=2;case 2:return[2,n]}}))}))},t.prototype.remove=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=M(e),n=t.next(),o.label=1;case 1:return n.done?[3,4]:(r=n.value,this._channels.delete(r),this.localCacheEnabled?[4,this.collection.remove(r)]:[3,3]);case 2:o.sent(),o.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),a={error:i},[3,7];case 6:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.clearMemoryCache=function(){this._channels.clear()},t.prototype._setBlockStateOfAllChannels=function(e,t,n){return w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b;return A(this,(function(C){switch(C.label){case 0:if(r=[],e===this._sdkState.userId)try{for(i=M(this._channels.values()),a=i.next();!a.done;a=i.next()){c=a.value;try{for(g=void 0,s=M(c.members),o=s.next();!o.done;o=s.next())if((f=o.value).userId===t){f.isBlockedByMe=n,r.push(c);break}}catch(e){g={error:e}}finally{try{o&&!o.done&&(_=s.return)&&_.call(s)}finally{if(g)throw g.error}}}}catch(e){p={error:e}}finally{try{a&&!a.done&&(m=i.return)&&m.call(i)}finally{if(p)throw p.error}}else if(t===this._sdkState.userId)try{for(l=M(this._channels.values()),u=l.next();!u.done;u=l.next()){c=u.value;try{for(y=void 0,d=M(c.members),h=d.next();!h.done;h=d.next())if((f=h.value).userId===e){f.isBlockingMe=n,r.push(c);break}}catch(e){y={error:e}}finally{try{h&&!h.done&&(b=d.return)&&b.call(d)}finally{if(y)throw y.error}}}}catch(e){v={error:e}}finally{try{u&&!u.done&&(E=l.return)&&E.call(l)}finally{if(v)throw v.error}}return r.length>0?[4,this.upsert(r)]:[3,2];case 1:C.sent(),C.label=2;case 2:return[2]}}))}))},t.prototype.block=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!0)];case 1:return n.sent(),[2]}}))}))},t.prototype.unblock=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!1)];case 1:return n.sent(),[2]}}))}))},t.prototype.markAsRead=function(e,t){return void 0===t&&(t=R([],O(this._channels.keys()),!1)),w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:n=[],c.label=1;case 1:c.trys.push([1,6,7,8]),r=M(t),i=r.next(),c.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.get(a)]);case 3:(null==(s=c.sent())?void 0:s._updateUnreadMemberState(this._sdkState.userId,e))&&(s._updateUnreadCount(0,0),n.push(s)),c.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),l={error:o},[3,8];case 7:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(l)throw l.error}return[7];case 8:return n.length>0?[4,this.upsert(n)]:[3,10];case 9:c.sent(),c.label=10;case 10:return[2]}}))}))},t}(ia),mf={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},gf=function(e){return X("string",e.invitedUserIds,!0)&&W("string",e.channelUrl,!0)&&W("string",e.coverUrl,!0)&&($(e.coverImage)||W("string",e.coverImage,!0))&&W("boolean",e.isDistinct,!0)&&W("boolean",e.isSuper,!0)&&W("boolean",e.isBroadcast,!0)&&W("boolean",e.isExclusive,!0)&&W("boolean",e.isPublic,!0)&&W("boolean",e.isStrict,!0)&&W("boolean",e.isDiscoverable,!0)&&W("boolean",e.isEphemeral,!0)&&W("string",e.accessCode,!0)&&W("string",e.name,!0)&&W("string",e.data,!0)&&W("string",e.customType,!0)&&X("string",e.operatorUserIds,!0)&&W("number",e.messageSurvivalSeconds,!0)},_f={customTypes:void 0,includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1},vf=function(e){return X("string",e.customTypes,!0)&&W("boolean",e.includeEmpty,!0)&&W("boolean",e.includeFrozen,!0)&&W("boolean",e.includeMetaData,!0)&&W("boolean",e.includeChatNotification,!0)},Ef={myMemberStateFilter:nf.ALL},yf=function(e){return Y(nf,e.myMemberStateFilter)};!function(e){e.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",e.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",e.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",e.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",e.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",e.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",e.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",e.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"}(hf||(hf={}));var bf,Cf={keys:[hf.GROUP_CHANNEL_UNREAD_MENTION_COUNT,hf.NONSUPER_UNREAD_MENTION_COUNT,hf.SUPER_UNREAD_MENTION_COUNT,hf.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT,hf.NONSUPER_UNREAD_MESSAGE_COUNT,hf.SUPER_UNREAD_MESSAGE_COUNT,hf.GROUP_CHANNEL_INVITATION_COUNT,hf.NONSUPER_INVITATION_COUNT,hf.SUPER_INVITATION_COUNT],customTypeFilters:void 0,customTypesFilter:void 0},Nf={channelCustomTypesFilter:void 0,superChannelFilter:rf.ALL},Tf={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:he.ALL},If=S({},os),Sf=function(e){return e.startsWith("EVENT_")||e===os.SYNC_CHANNEL_CHANGELOGS||e===os.REFRESH_CHANNEL},wf=function(e){function t(t){var n=t.channels,r=t.context,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=t.ts,o=e.call(this)||this;return o.channels=n,o.context=r,o.isWebSocketEventComing=a,o.ts=s,o}return I(t,e),t}(Se),Af=function(e){function t(t){var n=t.channelUrls,r=t.context,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.channelUrls=n,s.context=r,s.isWebSocketEventComing=a,s}return I(t,e),t}(Se),Mf=function(e){function t(t){var n=t.channel,r=e.call(this)||this;return r.channel=n,r}return I(t,e),t}(Se),Of=function(){function e(e){var t=e.groupChannelCache,n=e.userInfoCache,r=e.messageCache,i=e.unsentMessageCache,a=e.dispatcher,s=this;this._observers=new Map,a.on((function(e){return w(s,0,void 0,(function(){var a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N=this;return A(this,(function(T){switch(T.label){case 0:if(!(e instanceof wf))return[3,19];if(a=e.channels,_=e.context,v=e.isWebSocketEventComing,s=a.filter((function(e){return e instanceof _m})),_.source!==os.EVENT_CHANNEL_RESET_HISTORY&&_.source!==os.EVENT_CHANNEL_HIDDEN)return[3,9];T.label=1;case 1:T.trys.push([1,6,7,8]),o=M(s),l=o.next(),T.label=2;case 2:return l.done?[3,5]:(f=l.value,[4,r.removeUnderOffset(f.url,f.messageOffsetTimestamp)]);case 3:T.sent(),T.label=4;case 4:return l=o.next(),[3,2];case 5:return[3,8];case 6:return u=T.sent(),E={error:u},[3,8];case 7:try{l&&!l.done&&(y=o.return)&&y.call(o)}finally{if(E)throw E.error}return[7];case 8:return[3,17];case 9:c=t.filterOffsetChanged(s),T.label=10;case 10:T.trys.push([10,15,16,17]),d=M(c),h=d.next(),T.label=11;case 11:return h.done?[3,14]:(f=h.value,[4,r.removeUnderOffset(f.url,f.messageOffsetTimestamp)]);case 12:T.sent(),T.label=13;case 13:return h=d.next(),[3,11];case 14:return[3,17];case 15:return p=T.sent(),b={error:p},[3,17];case 16:try{h&&!h.done&&(C=d.return)&&C.call(d)}finally{if(b)throw b.error}return[7];case 17:return[4,t.upsert(s,e.ts)];case 18:return m=T.sent(),v||this._broadcastUpdateEvent(m,_),[3,25];case 19:return e instanceof Af?(g=e.channelUrls,_=e.context,v=e.isWebSocketEventComing,[4,t.remove(g)]):[3,22];case 20:return T.sent(),[4,Bi((function(){return w(N,0,void 0,(function(){var e,t,n,a,s,o;return A(this,(function(l){switch(l.label){case 0:l.trys.push([0,6,7,8]),e=M(g),t=e.next(),l.label=1;case 1:return t.done?[3,5]:(n=t.value,[4,r.removeMessagesOfChannel(n)]);case 2:return l.sent(),[4,i.removeMessagesOfChannel(n)];case 3:l.sent(),l.label=4;case 4:return t=e.next(),[3,1];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))}))];case 21:return T.sent(),v||this._broadcastRemoveEvent(g,_),[3,25];case 22:return e instanceof Uh?[4,t.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,25];case 23:return T.sent(),[4,n.fetch({limit:Number.MAX_SAFE_INTEGER})];case 24:T.sent(),T.label=25;case 25:return[2]}}))}))}))}return e.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onUpdate&&s.onUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=M(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onRemove&&s.onRemove(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t)},e.prototype.unsubscribe=function(e){this._observers.delete(e)},e.prototype.unsubscribeAll=function(){this._observers.clear()},e}(),Rf=function(e){function t(t){var n=t.userId,r=t.ts,i=t.token,a=t.filter,s=t.includeChatNotification,o=void 0!==s&&s,l=e.call(this)||this,u=S(S({},_f),a),c=u.customTypes,d=u.includeEmpty,h=u.includeFrozen;return l.method=Me.GET,l.path="".concat(Re,"/").concat(encodeURIComponent(n),"/my_group_channels/changelogs"),l.params=we(Ae({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:r||null,token:i,custom_types:c,show_empty:d,show_frozen:h,include_chat_notification:o})),l}return I(t,e),t}(it),kf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedChannels=n.updated.map((function(e){return new _m(t,Object.assign(e,{ts:n.ts}))})),r.deletedChannelUrls=n.deleted,r.hasMore=n.has_more,r.token=n.next,r.ts=n.ts,r}return I(t,e),t}(at),xf=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,i=t.showLatestMessage,a=e.call(this)||this;return a.method=Me.GET,a.path="".concat(r?Ue:De,"/").concat(encodeURIComponent(n)),a.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_latest_message:null!=i&&i},a}return I(t,e),t}(it),Df=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _m(t,n),r}return I(t,e),t}(at),Uf={includeEmpty:!1,myMemberStateFilter:nf.ALL,unreadChannelFilter:af.ALL,superChannelFilter:rf.ALL,publicChannelFilter:tf.ALL,hiddenChannelFilter:sf.ALL,userIdsFilter:{queryType:lf.AND},order:vh.LATEST_LAST_MESSAGE},Lf=function(e){function t(t){var n=this,r=t.userId,i=t.token,a=t.limit,s=t.order,o=t.includeEmpty,l=t.myMemberStateFilter,u=t.superChannelFilter,c=t.publicChannelFilter,d=t.unreadChannelFilter,h=t.nicknameContainsFilter,f=t.nicknameStartsWithFilter,p=t.nicknameExactMatchFilter,m=t.channelNameContainsFilter,g=t.channelUrlsFilter,_=t.customTypesFilter,v=t.customTypeStartsWithFilter,E=t.hiddenChannelFilter,y=t.metadataOrderKeyFilter,b=t.metadataKey,C=t.metadataValues,N=t.metadataValueStartsWith,T=t.includeFrozen,I=t.includeMetaData,S=t.searchFilter,w=t.userIdsFilter,A=t.includeChatNotification,M=void 0!==A&&A,O=t.includeLeftChannel,R=void 0!==O&&O,k=t.createdAfter,x=t.createdBefore;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Re,"/").concat(encodeURIComponent(r),"/my_group_channels"),n.params=we({token:i,limit:a,order:null!=s?s:Uf.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:null!=o?o:Uf.includeEmpty,member_state_filter:null!=l?l:Uf.myMemberStateFilter,super_mode:null!=u?u:Uf.superChannelFilter,public_mode:null!=c?c:Uf.publicChannelFilter,unread_filter:null!=d?d:Uf.unreadChannelFilter,members_nickname_contains:h,members_nickname_startswith:f,members_nickname:p,name_contains:m,channel_urls:g,custom_types:_,custom_type_startswith:v,hidden_mode:E,metadata_order_key:y,metadata_key:b,metadata_values:C,metadata_value_startswith:N,show_frozen:T,show_metadata:I,include_chat_notification:M,include_left_channel:R,created_after:k,created_before:x}),S&&S.query&&S.fields&&(n.params.search_query=S.query,n.params.search_fields=S.fields),w&&w.userIds&&w.userIds.length>0&&(w.includeMode?(n.params.members_include_in=w.userIds,n.params.query_type=w.queryType.toUpperCase()):n.params.members_exactly_in=w.userIds),n}return I(t,e),t}(it),Pf=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,a=n.channels,s=n.ts;return r.token=i,a&&a.length>0&&(r.channels=a.map((function(e){return e.ts=s,new _m(t,e)}))),r.ts=null!=s?s:0,r}return I(t,e),t}(at),Ff=function(e){function t(t){var n=t.userId,r=t.filter,i=e.call(this)||this,a=r.myMemberStateFilter;return i.method=Me.GET,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/group_channel_count"),i.params={state:null!=a?a:nf.ALL},i}return I(t,e),t}(it),Bf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.groupChannelCount=n.group_channel_count,r}return I(t,e),t}(at),jf=function(e){function t(t){var n=t.userId,r=t.filter,i=e.call(this)||this,a=r.keys,s=r.customTypeFilters,o=r.customTypesFilter;return i.method=Me.GET,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/unread_item_count"),i.params=we({item_keys:a,custom_types:null!=o?o:s}),i}return I(t,e),t}(it),Hf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return"number"==typeof n[hf.GROUP_CHANNEL_UNREAD_MENTION_COUNT]&&(r.groupChannelUnreadMentionCount=n[hf.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),"number"==typeof n[hf.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]&&(r.groupChannelUnreadMessageCount=n[hf.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),"number"==typeof n[hf.GROUP_CHANNEL_INVITATION_COUNT]&&(r.groupChannelInvitationCount=n[hf.GROUP_CHANNEL_INVITATION_COUNT]),"number"==typeof n[hf.SUPER_UNREAD_MENTION_COUNT]&&(r.superGroupChannelUnreadMentionCount=n[hf.SUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[hf.SUPER_UNREAD_MESSAGE_COUNT]&&(r.superGroupChannelUnreadMessageCount=n[hf.SUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[hf.SUPER_INVITATION_COUNT]&&(r.superGroupChannelInvitationCount=n[hf.SUPER_INVITATION_COUNT]),"number"==typeof n[hf.NONSUPER_UNREAD_MENTION_COUNT]&&(r.nonSuperGroupChannelUnreadMentionCount=n[hf.NONSUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[hf.NONSUPER_UNREAD_MESSAGE_COUNT]&&(r.nonSuperGroupChannelUnreadMessageCount=n[hf.NONSUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[hf.NONSUPER_INVITATION_COUNT]&&(r.nonSuperGroupChannelInvitationCount=n[hf.NONSUPER_INVITATION_COUNT]),r}return I(t,e),t}(at),Gf=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/unread_channel_count"),r}return I(t,e),t}(it),zf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unreadCount=n.unread_count,r}return I(t,e),t}(at),Vf=function(e){function t(t){var n=t.userId,r=t.filter,i=t.includeFeedChannel,a=void 0!==i&&i,s=e.call(this)||this,o=r.channelCustomTypesFilter,l=r.superChannelFilter;return s.method=Me.GET,s.path="".concat(Re,"/").concat(encodeURIComponent(n),"/unread_message_count"),s.params={super_mode:null!=l?l:rf.ALL,custom_types:o,include_feed_channel:a},s}return I(t,e),t}(it),qf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unreadCount=n.unread_count,r.unreadFeedCount=n.unread_feed_count,r}return I(t,e),t}(at),Kf=function(e){function t(t){var n=t.channelUrl,r=t.scheduledStatus,i=t.messageTypeFilter,a=e.call(this)||this;return a.method=Me.GET,a.path="".concat(ze,"/count"),a.params={channel_url:n,status:Yf(r)},i&&(a.params.message_type=i),a}return I(t,e),t}(it),Wf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.count=n.count,r}return I(t,e),t}(at),Yf=function(e){if(!e)return[];var t=[];return e.forEach((function(e){switch(e){case Uo.PENDING:t.push(Lo.PENDING);break;case Uo.SENT:t.push(Lo.IN_QUEUE),t.push(Lo.SENT);break;case Uo.CANCELED:t.push(Lo.CANCELED);break;case Uo.FAILED:t.push(Lo.FAILED)}})),t},Qf=function(e){function t(t){var n=this,r=t.userId,i=t.channelUrl,a=t.coverUrl,s=t.coverImage,o=t.isDistinct,l=t.isSuper,u=t.isBroadcast,c=t.isPublic,d=t.isExclusive,h=t.isDiscoverable,f=t.isStrict,p=t.isEphemeral,m=t.accessCode,g=t.name,_=t.data,v=t.customType,E=t.messageSurvivalSeconds,y=t.invitedUserIds,b=t.operatorUserIds;return(n=e.call(this)||this).method=Me.POST,n.path=De,n.params=we({user_ids:R([r],O(null!=y?y:[]),!1).filter((function(e,t,n){return t===n.indexOf(e)})),channel_url:i,cover_url:a,cover_file:s,is_distinct:o,is_super:l,is_broadcast:u,is_exclusive:d,is_public:c,is_discoverable:h,strict:f,is_ephemeral:p,access_code:m,name:g,data:_,custom_type:v,operator_ids:b,message_survival_seconds:E}),n}return I(t,e),t}(it),Xf=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).channel=new _m(t,n),i.isCreated=null===(r=n.is_created)||void 0===r||r,i}return I(t,e),t}(at),Zf=function(e){function t(t){var n=t.userId,r=t.channelUrls,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/mark_as_read_all"),i.params={channel_urls:r},i}return I(t,e),t}(it);I((function(){return null!==bf&&bf.apply(this,arguments)||this}),bf=at);var Jf=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.accessCode;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/join"),n.params={user_id:i,access_code:a},n}return I(t,e),t}(it),$f=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _m(t,n),r}return I(t,e),t}(at),ep=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data,s=a.member_count,o=void 0===s?0:s,l=a.joined_member_count,u=void 0===l?0:l,c=a.users,d=void 0===c?null:c;return i.memberCount=o,i.joinedMemberCount=u,i.members=Array.isArray(d)?d.map((function(e){return new cf(t,e)})):[new cf(t,r.data)],i}return I(t,e),t}(qh),tp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.shouldRemoveOperatorStatus;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/leave"),n.params={user_id:i,should_remove_operator_status:a},n}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var np=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data,s=a.member_count,o=void 0===s?0:s,l=a.joined_member_count,u=void 0===l?0:l;return i.memberCount=o,i.joinedMemberCount=u,i.member=new cf(i._iid,r.data),i}return I(t,e),t}(qh),rp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userIds;return(n=e.call(this)||this).method=Me.POST,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/invite"),n.params={user_ids:i},n}return I(t,e),t}(it),ip=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _m(t,n),r}return I(t,e),t}(at),ap=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;i.inviter=null;var a=r.data,s=a.member_count,o=void 0===s?0:s,l=a.joined_member_count,u=void 0===l?0:l,c=a.inviter,d=a.invitees,h=void 0===d?[]:d;return i.memberCount=o,i.joinedMemberCount=u,c&&Object.keys(c).length>0&&(i.inviter=new ga(t,c)),i.invitees=h.map((function(e){return new cf(t,e)})),i}return I(t,e),t}(qh),sp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/decline"),n.params={user_id:i},n}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.channel=new _m(t,n),r.channel.myMemberState=zh.NONE,r}),e)}(at);var op=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data,s=a.member_count,o=a.joined_member_count,l=a.inviter,u=a.invitee;return i.memberCount=null!=s?s:0,i.joinedMemberCount=null!=o?o:0,i.inviter=new ga(t,l),i.invitee=new cf(t,u),i}return I(t,e),t}(qh),lp={hidePreviousMessages:!1,allowAutoUnhide:!0},up=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.hidePreviousMessages,s=t.allowAutoUnhide;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/hide"),n.params={user_id:i,hide_previous_messages:null!=a?a:lp.hidePreviousMessages,allow_auto_unhide:null!=s?s:lp.allowAutoUnhide},n}return I(t,e),t}(it),cp=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts_message_offset;return r.messageOffsetTimestamp=i,r}return I(t,e),t}(at),dp=function(e){function t(t,n,r){var i,a,s,o=this;return(o=e.call(this,t,"SYEV",r)||this).allowAutoUnhide=null,o.hidePreviousMessages=null,o.messageOffsetTimestamp=null,r.data&&(o.allowAutoUnhide=null!==(i=r.data.allow_auto_unhide)&&void 0!==i?i:null,o.hidePreviousMessages=null!==(a=r.data.hide_previous_messages)&&void 0!==a?a:null),o.messageOffsetTimestamp=null!==(s=r.ts_message_offset)&&void 0!==s?s:null,o}return I(t,e),t}(lt),hp=function(e){function t(t){var n=t.channelUrl,r=t.time;return e.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return I(t,e),t}(ut),fp=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new ga(t,r.data),i}return I(t,e),t}(lt),pp=function(e){function t(t){var n=t.channelUrl,r=t.time;return e.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return I(t,e),t}(ut),mp=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new ga(t,r.data),i}return I(t,e),t}(lt),gp=function(e){function t(t){var n=t.channelUrl,r=t.messageId;return e.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:n,msg_id:r}})||this}return I(t,e),t}(ut),_p=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,S=this;return(S=e.call(this,t,n)||this).includeEmpty=!1,S.includeFrozen=!0,S.includeMetaData=!0,S.includeChatNotification=!1,S.channelUrlsFilter=null,S.customTypesFilter=null,S.customTypeStartsWithFilter=null,S.nicknameContainsFilter=null,S.nicknameStartsWithFilter=null,S.nicknameExactMatchFilter=null,S.channelNameContainsFilter="",S.myMemberStateFilter=nf.ALL,S.unreadChannelFilter=af.ALL,S.superChannelFilter=rf.ALL,S.publicChannelFilter=tf.ALL,S.hiddenChannelFilter=sf.UNHIDDEN,S.searchFilter={fields:[],query:null},S.userIdsFilter={userIds:[],includeMode:!0,queryType:lf.AND},S.metadataKey=null,S.metadataValues=null,S.metadataOrderKeyFilter=null,S.metadataValueStartsWith=null,S.order=vh.LATEST_LAST_MESSAGE,S.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,S.includeFrozen=null===(i=n.includeFrozen)||void 0===i||i,S.includeMetaData=null===(a=n.includeMetaData)||void 0===a||a,S.includeChatNotification=null!==(s=n.includeChatNotification)&&void 0!==s&&s,S.channelUrlsFilter=null!==(o=n.channelUrlsFilter)&&void 0!==o?o:null,S.customTypesFilter=null!==(l=n.customTypesFilter)&&void 0!==l?l:null,S.customTypeStartsWithFilter=null!==(u=n.customTypeStartsWithFilter)&&void 0!==u?u:"",S.nicknameContainsFilter=null!==(c=n.nicknameContainsFilter)&&void 0!==c?c:null,S.nicknameStartsWithFilter=null!==(d=n.nicknameStartsWithFilter)&&void 0!==d?d:null,S.nicknameExactMatchFilter=null!==(h=n.nicknameExactMatchFilter)&&void 0!==h?h:null,S.channelNameContainsFilter=null!==(f=n.channelNameContainsFilter)&&void 0!==f?f:"",S.myMemberStateFilter=null!==(p=n.myMemberStateFilter)&&void 0!==p?p:nf.ALL,S.unreadChannelFilter=null!==(m=n.unreadChannelFilter)&&void 0!==m?m:af.ALL,S.superChannelFilter=null!==(g=n.superChannelFilter)&&void 0!==g?g:rf.ALL,S.publicChannelFilter=null!==(_=n.publicChannelFilter)&&void 0!==_?_:tf.ALL,S.hiddenChannelFilter=null!==(v=n.hiddenChannelFilter)&&void 0!==v?v:sf.UNHIDDEN,S.searchFilter=null!==(E=n.searchFilter)&&void 0!==E?E:{fields:[],query:null},S.userIdsFilter=null!==(y=n.userIdsFilter)&&void 0!==y?y:{userIds:[],includeMode:!0,queryType:lf.AND},S.metadataKey=null!==(b=n.metadataKey)&&void 0!==b?b:null,S.metadataValues=null!==(C=n.metadataValues)&&void 0!==C?C:null,S.metadataOrderKeyFilter=null!==(N=n.metadataOrderKeyFilter)&&void 0!==N?N:null,S.metadataValueStartsWith=null!==(T=n.metadataValueStartsWith)&&void 0!==T?T:null,S.order=null!==(I=n.order)&&void 0!==I?I:vh.LATEST_LAST_MESSAGE,n.createdAfter&&(S.createdAfter=n.createdAfter),n.createdBefore&&(S.createdBefore=n.createdBefore),S}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("boolean",this.includeEmpty)&&W("boolean",this.includeFrozen)&&W("boolean",this.includeMetaData)&&W("string",this.channelNameContainsFilter)&&X("string",this.channelUrlsFilter,!0)&&X("string",this.customTypesFilter,!0)&&W("string",this.customTypeStartsWithFilter)&&W("string",this.nicknameContainsFilter,!0)&&W("string",this.nicknameStartsWithFilter,!0)&&W("string",this.nicknameExactMatchFilter,!0)&&Y(nf,this.myMemberStateFilter)&&Y(rf,this.superChannelFilter)&&Y(tf,this.publicChannelFilter)&&Y(af,this.unreadChannelFilter)&&Y(sf,this.hiddenChannelFilter)&&X(uf,this.searchFilter.fields)&&W("string",this.searchFilter.query,!0)&&X("string",this.userIdsFilter.userIds)&&W("boolean",this.userIdsFilter.includeMode)&&Y(lf,this.userIdsFilter.queryType)&&Y(vh,this.order)&&W("string",this.metadataOrderKeyFilter,!0)&&W("string",this.metadataKey,!0)&&X("string",this.metadataValues,!0)&&W("string",this.metadataValueStartsWith,!0)&&Z(this.createdAfter)&&Z(this.createdBefore)},t.prototype.serialize=function(){return ha(this)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,Np.of(this._iid).getMyGroupChannels(this._token,Ae(S({},this)),this.limit,os.REQUEST_CHANNEL,!0)]):[3,2]:[3,5];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasNext=!!n,this._isLoading=!1,[2,t];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),vp=function(e){function t(t){var n=t.channelUrl,r=t.userId,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(De,"/").concat(encodeURIComponent(n),"/messages/mark_as_delivered"),i.params=we({user_id:r}),i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Ep,yp=function(e){function t(t,n,r){var i=e.call(this,t,"DLVR",r)||this;return i.channelUrl=r.channel_url,i.deliveredStateUpdate=r.updated,i}return I(t,e),t}(lt),bp=function(){function e(e){var t=e.top,n=void 0===t?Number.MAX_SAFE_INTEGER:t,r=e.bottom,i=void 0===r?0:r;this.top=n,this.bottom=i}return e.prototype.includes=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.every((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.overlap=function(e){return this.includes(e.top)||this.includes(e.bottom)},e.prototype.intersect=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.extends=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.top=Math.min.apply(Math,R([this.top],O(e),!1)),this.bottom=Math.max.apply(Math,R([this.bottom],O(e),!1))},e}(),Cp={},Np=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,S(S({},n),{channelType:le.GROUP}))||this)._leftChannels=new Map,i._markAsReadAllLastSentAt=0,i._forceDisableMack=null!==(r=n.forceDisableMack)&&void 0!==r&&r,i._groupChannelHandlers=new Map,i._groupChannelCache=new pf(i._iid,{sdkState:n.sdkState,cacheContext:n.cacheContext}),i._userInfoCache=new oh(i._iid,{sdkState:n.sdkState,cacheContext:n.cacheContext}),i._groupChannelBroadcast=new Of({dispatcher:n.dispatcher,groupChannelCache:i._groupChannelCache,userInfoCache:i._userInfoCache,messageCache:th.of(i._iid),unsentMessageCache:$d.of(i._iid)}),setInterval((function(){var e,t,n=function(e){e.invalidateTypingStatus()&&(i._dispatcher.dispatch(new wf({channels:[e],context:{source:os.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),i._groupChannelHandlers.forEach((function(t){t.onTypingStatusUpdated&&t.onTypingStatusUpdated(e)})))};try{for(var r=M(i._groupChannelCache.channels),a=r.next();!a.done;a=r.next())n(a.value)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}),1e3),i._dispatcher.on((function(e){if(e instanceof lt)i._handleEvent(e).catch((function(e){if(G(e)&&"foreground"===i._sdkState.appState)throw e}));else if(e instanceof Oh)w(i,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=e.message,[4,this.getChannelFromCache(t.channelUrl)];case 1:return(n=r.sent())&&!n.isFrozen?[3,3]:[4,this.getChannelWithoutCache(t.channelUrl,!0)];case 2:n=r.sent(),r.label=3;case 3:return n.isFrozen||(t instanceof Yo?n._autoResendUserMessage(t):t instanceof el&&n._autoResendFileMessage(t)),[2]}}))}));else if(e instanceof Lh)i.reduceDBSize();else if(e instanceof Bh){var t=e.appConfigsInfo,n=e.configTs,r=t.message_purge_offset;r&&i._messageDataRetention(r),i._dispatcher.dispatch(new Ph({configTs:n}))}else e instanceof Do&&w(i,0,void 0,(function(){var t,n,r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return t=e.channelUrl,n=e.channelType,r=e.parentMessage,i=new ph(this._iid,{channel_type:le.GROUP,channel_url:t,parent_message_id:r.messageId,thread_info:oo.payloadify(r.threadInfo)}),n!==le.GROUP?[3,2]:[4,this.getChannel(t,!0)];case 1:a=o.sent(),Fi((function(){return w(s,0,void 0,(function(){var e,t,n,r,s;return A(this,(function(o){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onThreadInfoUpdated&&n.onThreadInfoUpdated(a,i)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),o.label=2;case 2:return[2]}}))}))})),Cp[t]||(Cp[t]=i),i}return I(t,e),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return th.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return $d.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e){return Cp[e]||(Cp[e]=new t(e,ms.of(e))),Cp[e]},t.clear=function(e){Cp[e]&&delete Cp[e]},Object.defineProperty(t.prototype,"handlers",{get:function(){return R([],O(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.buildGroupChannelFromSerializedData=function(e){var t=fa(e);return new _m(this._iid,_m.payloadify(t))},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var t=fa(e);return new _p(this._iid,t)},t.prototype.buildMemberFromSerializedData=function(e){var t=fa(e);return new cf(this._iid,cf.payloadify(t))},t.prototype.getChannelFromCache=function(e){var t;return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._groupChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.getChannelsFromCache=function(e,t,n,r,i){return w(this,0,void 0,(function(){return A(this,(function(a){switch(a.label){case 0:return[4,this._groupChannelCache.fetch({token:e,filter:t,order:n,limit:r,borderlineChannelUrl:i})];case 1:return[2,a.sent()]}}))}))},t.prototype.upsertChannelsToCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.removeChannelsFromCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.remove(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.clearChannelsFromCache=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return e.sent(),[2]}}))}))},t.prototype.reduceDBSize=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h,f,p;return A(this,(function(m){switch(m.label){case 0:return e=th.of(this._iid),t=ms.of(this._iid).cacheContext,n=t.localCacheConfig,r=t.nestdb,t.localCacheEnabled&&r&&r.state==Fd.OPENED?(i=1024*n.maxSize*1024,[4,r.estimateUsage()]):[2];case 1:if((a=m.sent())<i)return[2];s=[],o=this._groupChannelCache.channels,l={},h=0,m.label=2;case 2:return h<o.length?[4,this.getMessagesFromCache(o[h].url,0,"prev",new Kd)]:[3,5];case 3:u=m.sent(),l[o[h].url]=JSON.stringify(u).length,c=new se({channel:o[h],cachedMessageCount:u.length}),s.push(c),m.label=4;case 4:return h++,[3,2];case 5:d=s.sort(n.clearOrderComparator),h=0,m.label=6;case 6:return h<d.length?[4,e.removeMessagesOfChannel(d[h].channel.url)]:[3,10];case 7:return m.sent(),[4,e._getGroupChannelPreferenceSize(d[h].channel.url)];case 8:if(f=m.sent(),p=l[d[h].channel.url]+f,(a-=p)<i)return[3,10];m.label=9;case 9:return h++,[3,6];case 10:return[4,oh.of(this._iid).clear()];case 11:return m.sent(),[2]}}))}))},t.prototype._messageDataRetention=function(e){var t;return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h=this;return A(this,(function(f){switch(f.label){case 0:n=[],r=th.of(this._iid),i=function(i){var s,o;return A(this,(function(l){switch(l.label){case 0:return s=i.customType,o=null!==(t=e[s])&&void 0!==t?t:e.global,[4,r.removeUnderOffset(i.url,o,!0)];case 1:return l.sent(),i.lastMessage&&i.lastMessage.createdAt<=o&&(i.lastMessage=null,n.push(i),Fi((function(){return w(h,0,void 0,(function(){var e,t,n,r,a;return A(this,(function(s){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(i)}catch(e){r={error:e}}finally{try{t&&!t.done&&(a=e.return)&&a.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),a._dispatcher.dispatch(new ys({channelUrl:i.url,messageDeletionTimestamp:o,source:os.EVENT_MESSAGE_OFFSET_UPDATED})),[2]}}))},a=this,f.label=1;case 1:f.trys.push([1,6,7,8]),s=M(this._groupChannelCache.channels),o=s.next(),f.label=2;case 2:return o.done?[3,5]:(l=o.value,[5,i(l)]);case 3:f.sent(),f.label=4;case 4:return o=s.next(),[3,2];case 5:return[3,8];case 6:return u=f.sent(),c={error:u},[3,8];case 7:try{o&&!o.done&&(d=s.return)&&d.call(s)}finally{if(c)throw c.error}return[7];case 8:return n.length>0&&this._dispatcher.dispatch(new wf({channels:n,context:{source:os.EVENT_CHANNEL_UPDATED}})),[2]}}))}))},t.prototype._isSuperGroupMackDisabled=function(e){var t=ms.of(this._iid).appInfo;return!(!e.isSuper||e.isBroadcast||!(null==t?void 0:t.disableSuperGroupMack))},t.prototype._getCachedUserInfo=function(e){return this._userInfoCache.getUserInfoFromCache(e)},t.prototype._upsertCachedUserInfo=function(e,t){ms.of(this._iid).useMemberInfoInMessage&&this._userInfoCache.upsert(e,t)},t.prototype._handleEvent=function(e){var t,n;return w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,S,O,R,k,x,D,U,L,P,F,B,j,H,z,V,q,K,W,Y,Q,X,Z,J,$,ee,te,ne,re,ie,ae,se,oe,de,he,fe,pe,me,ge,_e,ve,Ee,ye,be,Ce,Ne,Te,Ie,Se,we,Ae,Me,Oe,Re,ke,xe,De,Ue,Le,Pe,Fe,Be,je,He,Ge,ze,Ve,qe,Ke,We,Ye,Qe,Xe,Ze,Je,$e,et,tt,nt,rt,it,at,st,ot,lt,ut,ct,dt,ht,ft,pt,mt,gt,_t,vt,Et,yt,bt,Ct,Nt,Tt,It,wt,At,Mt,Ot,Rt,kt,xt,Dt,Ut,Lt,Pt,Ft,Bt,jt,Ht,Gt,zt,Vt,qt,Kt,Wt,Yt,Qt,Xt,Zt,Jt,$t,en,tn,nn,rn,an,sn,on,ln,un,cn,dn,hn=this;return A(this,(function(fn){switch(fn.label){case 0:switch(fn.trys.push([0,88,,89]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,27];case"MCNT":return[3,31];case"PEDI":return[3,40];case"VOTE":return[3,43];case"SYEV":return[3,46];case"USEV":return[3,86]}return[3,87];case 1:return c=null,"MESG"===e.code?c=e.as(Vu):"FILE"===e.code?c=e.as(il):"ADMM"!==e.code&&"BRDM"!=e.code||(c=e.as(Qh)),c?(r=c.message,i=c.isMentioned,a=c.forceUpdateLastMessage,r.channelType!==le.GROUP?[3,3]:(L=this._groupChannelCache.isCachedInMemory(r.channelUrl),O=r instanceof Go&&r.sender.userId===this._sdkState.userId,[4,this.getChannel(r.channelUrl,!0)])):[3,3];case 2:if(s=fn.sent(),f=ms.of(this._iid).useMemberInfoInMessage,this._forceDisableMack||this._isSuperGroupMackDisabled(s)||r instanceof qo||O||Bi((function(){return w(hn,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=new gp(r),[4,this._requestQueue.send(e)];case 1:return t.sent(),[2]}}))}))})),r instanceof Go){o=r.sender,s.isSuper&&this._upsertCachedUserInfo(o,r.createdAt);try{for(l=M(s.members),u=l.next();!u.done;u=l.next())if((ot=u.value).userId===r.sender.userId){f&&(ot.nickname=r.sender.nickname,ot.plainProfileUrl=r.sender.plainProfileUrl,ot.metaData=r.sender.metaData,ot.isBlockedByMe=r.sender.isBlockedByMe);break}}catch(e){Wt={error:e}}finally{try{u&&!u.done&&(Yt=l.return)&&Yt.call(l)}finally{if(Wt)throw Wt.error}}f&&i&&(null===(t=r.mentionedUsers)||void 0===t||t.forEach((function(e){var t,n;try{for(var r=M(s.members),i=r.next();!i.done;i=r.next()){var a=i.value;if(e.userId===a.userId){a.nickname=e.nickname,a.plainProfileUrl=e.plainProfileUrl,a.metaData=e.metaData;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}))),O&&(E=this._sessionManager.currentUser)&&(E.nickname=r.sender.nickname,E.plainProfileUrl=r.sender.plainProfileUrl,E.metaData=r.sender.metaData)}r.silent&&!O||(s.isEphemeral||L)&&(s._updateLastMessage(r),O||s._shouldUpdateUnreadCountWith(r)&&s._updateUnreadCount(s.unreadMessageCount+1,s.unreadMentionCount+(i?1:0))),a&&s._updateLastMessage(r),this._dispatcher.dispatch(new wf({channels:[s],context:{source:os.EVENT_MESSAGE_RECEIVED}})),r.silent&&!O||Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(s)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),this._dispatcher.dispatch(new vs({messages:[r],source:os.EVENT_MESSAGE_RECEIVED})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,a,o;return A(this,(function(l){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageReceived&&n.onMessageReceived(s,r),i&&n.onMentionReceived&&n.onMentionReceived(s,r)}catch(e){a={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(a)throw a.error}}return[2]}))}))})),fn.label=3;case 3:return[3,87];case 4:return c=null,"MEDI"===e.code?c=e.as(Ku):"FEDI"===e.code?c=e.as(Yu):"AEDI"===e.code&&(c=e.as(Xh)),c?(d=c.message,h=c.mentionCountChange,f=ms.of(this._iid).useMemberInfoInMessage,d.threadInfo&&(d.threadInfo.unreadReplyCount=void 0),d.channelType!==le.GROUP?[3,6]:(L=this._groupChannelCache.isCachedInMemory(d.channelUrl),[4,this.getChannel(d.channelUrl,!0)])):[3,6];case 5:if(p=fn.sent(),O=!1,d instanceof Go){O=d.sender.userId===this._sdkState.userId,p.isSuper&&this._upsertCachedUserInfo(d.sender,d.updatedAt);try{for(m=M(p.members),g=m.next();!g.done;g=m.next())if((ot=g.value).userId===d.sender.userId){f&&(ot.nickname=d.sender.nickname,ot.plainProfileUrl=d.sender.plainProfileUrl,ot.metaData=d.sender.metaData,ot.isBlockedByMe=d.sender.isBlockedByMe);break}}catch(e){Qt={error:e}}finally{try{g&&!g.done&&(Xt=m.return)&&Xt.call(m)}finally{if(Qt)throw Qt.error}}}_=!1,O?(v=d.sender,(E=this._sessionManager.currentUser)&&(E.nickname=v.nickname,E.plainProfileUrl=v.plainProfileUrl,E.metaData=v.metaData)):p.isReadMessage(d)||0!==h&&!d.silent&&L&&(p._updateUnreadCount(p.unreadMessageCount,p.unreadMentionCount+h),_=!0),p._updateLastMessage(d)?_=!0:(null===(n=p.lastMessage)||void 0===n?void 0:n.isIdentical(d))&&(L?p._updateLastMessage(d)&&(_=!0):_=!0),y=!1,p.lastPinnedMessage&&p.lastPinnedMessage.messageId===d.messageId&&(p.lastPinnedMessage=d,_=!0,y=!0),_&&(this._dispatcher.dispatch(new wf({channels:[p],context:{source:y?os.EVENT_PINNED_MESSAGE_UPDATED:os.EVENT_MESSAGE_UPDATED}})),d.silent&&!O||Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(p)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),y&&Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPinnedMessageUpdated&&n.onPinnedMessageUpdated(p)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),this._dispatcher.dispatch(new vs({messages:[d],source:os.EVENT_MESSAGE_UPDATED})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageUpdated&&n.onMessageUpdated(p,d),h>0&&n.onMentionReceived&&n.onMentionReceived(p,d)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),fn.label=6;case 6:return[3,87];case 7:return b=e.as(St),ge=b.channelUrl,_e=b.channelType,C=b.messageId,N=b.silent,T=b.messageCreatedAt,I=b.senderId,_e!==le.GROUP?[3,9]:[4,this.getChannel(ge,!0)];case 8:S=fn.sent(),O=I===this._sdkState.userId,N||O||T>0&&S.myLastRead<T&&S.unreadMessageCount>0&&S._updateUnreadCount(S.unreadMessageCount-1,0),this._dispatcher.dispatch(new Es({messageIds:[C],source:os.EVENT_MESSAGE_DELETED})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageDeleted&&n.onMessageDeleted(S,C)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),fn.label=9;case 9:return[3,87];case 10:return(R=e.as(No).readStatus).channelType!==le.GROUP?[3,12]:(L=this._groupChannelCache.isCachedInMemory(R.channelUrl),[4,this.getChannel(R.channelUrl,!0)]);case 11:k=fn.sent(),L&&k._updateUnreadMemberState(R.reader.userId,R.readAt),R.reader.userId===this._sdkState.userId?L?(k.unreadMessageCount>0||k.unreadMentionCount>0)&&(k._updateUnreadCount(0,0),this._dispatcher.dispatch(new wf({channels:[k],context:{source:os.EVENT_CHANNEL_READ}})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(k)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):0!==k.unreadMessageCount&&0!==k.unreadMentionCount||(this._dispatcher.dispatch(new wf({channels:[k],context:{source:os.EVENT_CHANNEL_READ}})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(k)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):(this._dispatcher.dispatch(new wf({channels:[k],context:{source:os.EVENT_CHANNEL_READ}})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUnreadMemberStatusUpdated&&n.onUnreadMemberStatusUpdated(k)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),fn.label=12;case 12:return[3,87];case 13:return x=e.as(yp),ge=x.channelUrl,D=x.deliveredStateUpdate,U=void 0===D?{}:D,L=this._groupChannelCache.isCachedInMemory(ge),[4,this.getChannel(ge,!0)];case 14:return P=fn.sent(),L&&Object.keys(U).forEach((function(e){P._updateUndeliveredMemberState(e,U[e])})),Object.keys(U).some((function(e){return e!==hn._sdkState.userId}))&&(this._dispatcher.dispatch(new wf({channels:[P],context:{source:os.EVENT_CHANNEL_DELIVERED}})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUndeliveredMemberStatusUpdated&&n.onUndeliveredMemberStatusUpdated(P)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,87];case 15:return F=e.as(Zh),ge=F.channelUrl,_e=F.channelType,B=F.event,_e!==le.GROUP?[3,26]:[4,this.getChannel(ge,!0)];case 16:return j=fn.sent(),[4,this.getMessageFromCache(B.messageId)];case 17:if(X=fn.sent(),!j.isSuper)return[3,25];fn.label=18;case 18:fn.trys.push([18,23,24,25]),H=M(Object.keys(B._sampledUserInfoList)),z=H.next(),fn.label=19;case 19:return z.done?[3,22]:(V=z.value,[4,this._userInfoCache.get(V)]);case 20:(q=fn.sent())?(q.plainProfileUrl=B._sampledUserInfoList[V].profile_url,q.nickname=B._sampledUserInfoList[V].nickname,this._upsertCachedUserInfo(q,B.updatedAt)):(K=new ga(this._iid,{user_id:V,nickname:B._sampledUserInfoList[V].nickname,profile_url:B._sampledUserInfoList[V].profile_url,require_auth_for_profile_image:B._sampledUserInfoList[V].require_auth_for_profile_image}),this._upsertCachedUserInfo(K,B.updatedAt)),fn.label=21;case 21:return z=H.next(),[3,19];case 22:return[3,25];case 23:return W=fn.sent(),Zt={error:W},[3,25];case 24:try{z&&!z.done&&(Jt=H.return)&&Jt.call(H)}finally{if(Zt)throw Zt.error}return[7];case 25:X?X instanceof Ho&&(X.applyReactionEvent(B),this._dispatcher.dispatch(new vs({messages:[X],source:os.EVENT_MESSAGE_REACTION_UPDATED}))):this._dispatcher.dispatch(new bs({event:B,source:os.EVENT_MESSAGE_REACTION_UPDATED})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onReactionUpdated&&n.onReactionUpdated(j,B)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),fn.label=26;case 26:return[3,87];case 27:return(Y=e.as(Jh).event).channelType!==le.GROUP?[3,30]:[4,this.getChannel(Y.channelUrl,!0)];case 28:return Q=fn.sent(),[4,this.getMessageFromCache(Y.targetMessageId)];case 29:if((X=fn.sent())?X instanceof Ho&&(X.applyThreadInfoUpdateEvent(Y),this._dispatcher.dispatch(new vs({messages:[X],source:os.EVENT_MESSAGE_THREADINFO_UPDATED}))):this._dispatcher.dispatch(new Cs({event:Y,source:os.EVENT_MESSAGE_THREADINFO_UPDATED})),Q.isSuper)try{for(Z=M(Y.threadInfo.mostRepliedUsers),J=Z.next();!J.done;J=Z.next())tt=J.value,this._upsertCachedUserInfo(tt,Y.threadInfo.updatedAt)}catch(e){$t={error:e}}finally{try{J&&!J.done&&(en=Z.return)&&en.call(Z)}finally{if($t)throw $t.error}}Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onThreadInfoUpdated&&n.onThreadInfoUpdated(Q,Y)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),fn.label=30;case 30:return[3,87];case 31:$=e.as($h).groupChannelMemberCounts,ee=[],fn.label=32;case 32:fn.trys.push([32,37,38,39]),te=M($),ne=te.next(),fn.label=33;case 33:return ne.done?[3,36]:(re=ne.value,ge=re.channelUrl,Qe=re.memberCount,Xe=re.joinedMemberCount,ie=re.updatedAt,[4,this.getChannelFromCache(ge)]);case 34:(ae=fn.sent())&&ae._setLatestMemberCount(Qe,Xe,ie)&&ee.push(ae),fn.label=35;case 35:return ne=te.next(),[3,33];case 36:return[3,39];case 37:return se=fn.sent(),tn={error:se},[3,39];case 38:try{ne&&!ne.done&&(nn=te.return)&&nn.call(te)}finally{if(tn)throw tn.error}return[7];case 39:return ee.length>0&&(this._dispatcher.dispatch(new wf({channels:ee,context:{source:os.EVENT_CHANNEL_MEMBER_COUNT_UPDATED}})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(ee)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,87];case 40:return oe=e.as(ef),de=oe.event,he=oe.status,ge=oe.channelUrl,_e=oe.channelType,ge&&_e===le.GROUP?[4,this.getChannel(ge,!0)]:[3,42];case 41:fe=fn.sent(),this._dispatcher.dispatch(new Is({event:de,source:os.EVENT_POLL_UPDATED})),Fi(he===As?function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(fe,de.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(fe,de)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),fn.label=42;case 42:return[3,87];case 43:return pe=e.as(gc),me=pe.event,ge=pe.channelUrl,_e=pe.channelType,ge&&_e===le.GROUP?[4,this.getChannel(ge,!0)]:[3,45];case 44:ve=fn.sent(),this._dispatcher.dispatch(new Ss({event:me,source:os.EVENT_POLL_VOTED})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(ve,me)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),fn.label=45;case 45:return[3,87];case 46:if(!(Ee=e.as(qh).event).isGroupChannelEvent)return[3,85];switch(Ee.category){case jh.CHANNEL_JOIN:return[3,47];case jh.CHANNEL_LEAVE:return[3,49];case jh.CHANNEL_OPERATOR_UPDATE:return[3,53];case jh.CHANNEL_INVITE:return[3,55];case jh.CHANNEL_DECLINE_INVITE:return[3,57];case jh.TYPING_START:case jh.TYPING_END:return[3,59];case jh.USER_CHANNEL_MUTE:case jh.USER_CHANNEL_UNMUTE:return[3,61];case jh.USER_CHANNEL_BAN:return[3,63];case jh.USER_CHANNEL_UNBAN:return[3,67];case jh.CHANNEL_FREEZE:case jh.CHANNEL_UNFREEZE:return[3,69];case jh.CHANNEL_HIDE:return[3,71];case jh.CHANNEL_UNHIDE:return[3,73];case jh.CHANNEL_DELETED:return[3,75];case jh.CHANNEL_PROP_CHANGED:return[3,77];case jh.CHANNEL_META_DATA_CHANGED:return[3,79];case jh.CHANNEL_META_COUNTERS_CHANGED:return[3,81];case jh.PINNED_MESSAGE_CHANGED:return[3,83]}return[3,85];case 47:return[4,this.getChannel(Ee.channelUrl,!0)];case 48:if(ye=fn.sent(),be=e.as(ep),Ce=be.memberCount,Ne=be.joinedMemberCount,Te=be.members,Ie=!1,Te.forEach((function(e){ye.isExclusive||ye.isSuper||ye.isBroadcast?Ie=Ie||ye._setLatestMemberCount(Ce,Ne,Ee.ts):(e.state=zh.JOINED,ye.addMember(e,Ee.ts),hn._updateJoinedMemberCount(ye)),e.userId===hn._sdkState.userId&&(ye.myMemberState=zh.JOINED)})),ye.isSuper)try{for(Se=M(Te),we=Se.next();!we.done;we=Se.next())ot=we.value,this._upsertCachedUserInfo(ot,Ee.ts)}catch(e){rn={error:e}}finally{try{we&&!we.done&&(an=Se.return)&&an.call(Se)}finally{if(rn)throw rn.error}}return this._dispatcher.dispatch(new wf({channels:[ye],context:{source:os.EVENT_CHANNEL_JOINED,users:Te}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){var t,n;try{for(var r=M(Te),i=r.next();!i.done;i=r.next()){var a=i.value;e.onUserJoined&&e.onUserJoined(ye,a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}ye.isBroadcast&&Ie&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([ye])})),[2]}))}))})),[3,85];case 49:return(lt=this._leftChannels.get(Ee.channelUrl))?(Me=lt.channel,[3,52]):[3,50];case 50:return[4,this.getChannel(Ee.channelUrl,!0)];case 51:Me=fn.sent(),fn.label=52;case 52:return Ae=Me,Oe=e.as(np),Qe=Oe.memberCount,Xe=Oe.joinedMemberCount,Re=Oe.member,ke=!1,xe=ms.of(this._iid).appInfo,Ae.isExclusive||Ae.isSuper||Ae.isBroadcast?ke=Ae._setLatestMemberCount(Qe,Xe,Ee.ts):((null==xe?void 0:xe.enabledChannelMemberShipHistory)?((De=Ae.members.find((function(e){return e.userId===Re.userId})))&&(De.state=zh.LEFT),Ae.memberCount=Qe):Ae.removeMember(Re),this._updateJoinedMemberCount(Ae)),Re.userId===this._sdkState.userId?(Ae.myMemberState=zh.NONE,Ae.invitedAt=0,Ae.joinedAt=0,Ae._updateUnreadCount(0,0),Ae.isPublic?this._dispatcher.dispatch(new wf({channels:[Ae],context:{source:os.EVENT_CHANNEL_LEFT,user:Re}})):(this._markAsLeave(Ae),this._dispatcher.dispatch(new Af({channelUrls:[Ae.url],context:{source:os.EVENT_CHANNEL_LEFT,user:Re}})))):this._dispatcher.dispatch(new wf({channels:[Ae],context:{source:os.EVENT_CHANNEL_LEFT,user:Re}})),Ae.isSuper&&this._upsertCachedUserInfo(Re,Ee.ts),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserLeft&&e.onUserLeft(Ae,Re),Ae.isBroadcast&&ke&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([Ae])})),[2]}))}))})),[3,85];case 53:return[4,this.getChannel(Ee.channelUrl,!0)];case 54:Ue=fn.sent(),Le=e.as(Kh).operators,Pe=Le.map((function(e){return e.userId}));try{for(Fe=M(Ue.members),Be=Fe.next();!Be.done;Be=Fe.next())(ot=Be.value).role=Pe.includes(ot.userId)?ue.OPERATOR:ue.NONE}catch(e){sn={error:e}}finally{try{Be&&!Be.done&&(on=Fe.return)&&on.call(Fe)}finally{if(sn)throw sn.error}}return Ue.myRole=Pe.includes(this._sdkState.userId)?ue.OPERATOR:ue.NONE,this._dispatcher.dispatch(new wf({channels:[Ue],context:{source:os.EVENT_CHANNEL_OPERATOR_UPDATED,operators:Le}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(Ue,Le)})),[2]}))}))})),[3,85];case 55:return[4,this.getChannel(Ee.channelUrl,!0)];case 56:je=fn.sent(),He=e.as(ap),Qe=He.memberCount,Xe=He.joinedMemberCount,Ge=He.inviter,(ze=He.invitees).forEach((function(e){return e.state=zh.INVITED}));try{for(Ve=M(ze),qe=Ve.next();!qe.done;qe=Ve.next())Ke=qe.value,je.isExclusive||je.isSuper||je.isBroadcast?(je.isSuper&&this._userInfoCache.upsert(Ke,Ee.ts),je._setLatestMemberCount(Qe,Xe,Ee.ts)):je.addMember(Ke,Ee.ts),this._sdkState.userId===Ke.userId&&(je.hiddenState=om.UNHIDDEN,je.myMemberState!==zh.JOINED&&(je.myMemberState=zh.INVITED),je.invitedAt=Ee.ts)}catch(e){ln={error:e}}finally{try{qe&&!qe.done&&(un=Ve.return)&&un.call(Ve)}finally{if(ln)throw ln.error}}return this._dispatcher.dispatch(new wf({channels:[je],context:{source:os.EVENT_CHANNEL_INVITED,inviter:Ge,invitees:ze}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserReceivedInvitation&&e.onUserReceivedInvitation(je,Ge,ze)})),[2]}))}))})),[3,85];case 57:return[4,this.getChannel(Ee.channelUrl,!0)];case 58:return We=fn.sent(),Ye=e.as(op),Qe=Ye.memberCount,Xe=Ye.joinedMemberCount,Ze=Ye.inviter,Je=Ye.invitee,We.isExclusive||We.isSuper||We.isBroadcast?(We.isSuper&&this._userInfoCache.upsert(Je,Ee.ts),We._setLatestMemberCount(Qe,Xe,Ee.ts)):We.removeMember(Je),this._sdkState.userId===Je.userId?(We.invitedAt=0,We.myMemberState=zh.NONE,We.isPublic?this._dispatcher.dispatch(new wf({channels:[We],context:{source:os.EVENT_CHANNEL_DECLINED_INVITE,inviter:Ze,invitee:Je}})):this._dispatcher.dispatch(new Af({channelUrls:[We.url],context:{source:os.EVENT_CHANNEL_DECLINED_INVITE,inviter:Ze,invitee:Je}}))):this._dispatcher.dispatch(new wf({channels:[We],context:{source:os.EVENT_CHANNEL_DECLINED_INVITE,inviter:Ze,invitee:Je}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserDeclinedInvitation&&e.onUserDeclinedInvitation(We,Ze,Je)})),[2]}))}))})),[3,85];case 59:return[4,this.getChannel(Ee.channelUrl,!0)];case 60:return $e=fn.sent(),et=Ee.category===jh.TYPING_START,tt=e.as(et?fp:mp).user,$e._updateTypingStatus(tt,et?Ee.ts:0),this._dispatcher.dispatch(new wf({channels:[$e],context:{source:os.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onTypingStatusUpdated&&e.onTypingStatusUpdated($e)})),[2]}))}))})),[3,85];case 61:return[4,this.getChannel(Ee.channelUrl,!0)];case 62:nt=fn.sent(),rt=Ee.category===jh.USER_CHANNEL_MUTE,(it=e.as(rt?Mu:Ru).user).userId===this._sdkState.userId&&(nt.myMutedState=rt?ce.MUTED:ce.UNMUTED,nt._myMutedRemainingTime=it.restrictionInfo.remainingDuration);try{for(at=M(nt.members),st=at.next();!st.done;st=at.next())if((ot=st.value).userId===it.userId){ot.isMuted=rt;break}}catch(e){cn={error:e}}finally{try{st&&!st.done&&(dn=at.return)&&dn.call(at)}finally{if(cn)throw cn.error}}return nt.isSuper&&this._userInfoCache.upsert(it,Ee.ts),this._dispatcher.dispatch(new wf({channels:[nt],context:{source:rt?os.EVENT_CHANNEL_MUTED:os.EVENT_CHANNEL_UNMUTED,user:it}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){rt?e.onUserMuted&&e.onUserMuted(nt,it):e.onUserUnmuted&&e.onUserUnmuted(nt,it)})),[2]}))}))})),[3,85];case 63:return(lt=this._leftChannels.get(Ee.channelUrl))?(ct=lt.channel,[3,66]):[3,64];case 64:return[4,this.getChannel(Ee.channelUrl,!0)];case 65:ct=fn.sent(),fn.label=66;case 66:return ut=ct,this._markAsLeave(ut),dt=e.as(xu).user,pt=dt.userId===this._sdkState.userId,ut.isSuper&&this._userInfoCache.upsert(dt,Ee.ts),pt&&this._dispatcher.dispatch(new Af({channelUrls:[ut.url],context:{source:os.EVENT_CHANNEL_BANNED,user:dt}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserBanned&&e.onUserBanned(ut,dt)})),[2]}))}))})),[3,85];case 67:return[4,this.getChannel(Ee.channelUrl,!0)];case 68:return ht=fn.sent(),ft=e.as(Uu).user,pt=ft.userId===this._sdkState.userId,ht.isSuper&&this._userInfoCache.upsert(ft,Ee.ts),pt&&this._dispatcher.dispatch(new Af({channelUrls:[ht.url],context:{source:os.EVENT_CHANNEL_UNBANNED,user:ft}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserUnbanned&&e.onUserUnbanned(ht,ft)})),[2]}))}))})),[3,85];case 69:return[4,this.getChannel(Ee.channelUrl,!0)];case 70:return mt=fn.sent(),gt=e.as(Pu).freeze,mt.isFrozen=gt,this._dispatcher.dispatch(new wf({channels:[mt],context:{source:gt?os.EVENT_CHANNEL_FROZEN:os.EVENT_CHANNEL_UNFROZEN}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){gt?e.onChannelFrozen&&e.onChannelFrozen(mt):e.onChannelUnfrozen&&e.onChannelUnfrozen(mt)})),[2]}))}))})),[3,85];case 71:return[4,this.getChannel(Ee.channelUrl,!0)];case 72:return _t=fn.sent(),vt=e.as(dp),Et=vt.allowAutoUnhide,yt=vt.hidePreviousMessages,bt=vt.messageOffsetTimestamp,null!==Et&&(_t.hiddenState=Et?om.HIDDEN_ALLOW_AUTO_UNHIDE:om.HIDDEN_PREVENT_AUTO_UNHIDE),null!==yt&&yt&&_t._updateUnreadCount(0,0),null!==bt&&(_t.messageOffsetTimestamp=bt),this._dispatcher.dispatch(new wf({channels:[_t],context:{source:os.EVENT_CHANNEL_HIDDEN}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelHidden&&e.onChannelHidden(_t)})),[2]}))}))})),[3,85];case 73:return[4,this.getChannel(Ee.channelUrl,!0)];case 74:return(Ct=fn.sent()).hiddenState=om.UNHIDDEN,this._dispatcher.dispatch(new wf({channels:[Ct],context:{source:os.EVENT_CHANNEL_UNHIDDEN}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(Ct)})),[2]}))}))})),[3,85];case 75:return[4,this.getChannel(Ee.channelUrl,!0)];case 76:return Nt=fn.sent(),this._dispatcher.dispatch(new Af({channelUrls:[Ee.channelUrl],context:{source:os.EVENT_CHANNEL_DELETED}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(Nt.url,Nt.channelType)})),[2]}))}))})),[3,85];case 77:return[4,this.getChannelWithoutCache(Ee.channelUrl,!0)];case 78:return Tt=fn.sent(),this._dispatcher.dispatch(new wf({channels:[Tt],context:{source:os.EVENT_CHANNEL_UPDATED}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(Tt)})),[2]}))}))})),[3,85];case 79:return[4,this.getChannel(Ee.channelUrl,!0)];case 80:return It=fn.sent(),wt=e.as(pu),At=wt.created,Mt=wt.updated,Ot=wt.deleted,At&&(It._upsertCachedMetaData(At,Ee.ts),this._dispatcher.dispatch(new wf({channels:[It],context:{source:os.EVENT_CHANNEL_METADATA_CREATED,metaData:At},ts:Ee.ts}))),Mt&&(It._upsertCachedMetaData(Mt,Ee.ts),this._dispatcher.dispatch(new wf({channels:[It],context:{source:os.EVENT_CHANNEL_METADATA_UPDATED,metaData:Mt},ts:Ee.ts}))),Ot&&(It._removeFromCachedMetaData(Ot,Ee.ts),this._dispatcher.dispatch(new wf({channels:[It],context:{source:os.EVENT_CHANNEL_METADATA_DELETED,metaDataKeys:Ot},ts:Ee.ts}))),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){At&&e.onMetaDataCreated&&e.onMetaDataCreated(It,At),Mt&&e.onMetaDataUpdated&&e.onMetaDataUpdated(It,Mt),Ot&&e.onMetaDataDeleted&&e.onMetaDataDeleted(It,Ot)})),[2]}))}))})),[3,85];case 81:return[4,this.getChannel(Ee.channelUrl,!0)];case 82:return Rt=fn.sent(),kt=e.as(Iu),xt=kt.created,Dt=kt.updated,Ut=kt.deleted,xt&&this._dispatcher.dispatch(new wf({channels:[Rt],context:{source:os.EVENT_CHANNEL_METACOUNTER_CREATED,metaCounters:xt}})),Dt&&this._dispatcher.dispatch(new wf({channels:[Rt],context:{source:os.EVENT_CHANNEL_METACOUNTER_UPDATED,metaCounters:Dt}})),Ut&&this._dispatcher.dispatch(new wf({channels:[Rt],context:{source:os.EVENT_CHANNEL_METACOUNTER_DELETED,metaCounterKeys:Ut}})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){xt&&e.onMetaCounterCreated&&e.onMetaCounterCreated(Rt,xt),Dt&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(Rt,Dt),Ut&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(Rt,Ut)})),[2]}))}))})),[3,85];case 83:return[4,this.getChannel(Ee.channelUrl,!0)];case 84:return Lt=fn.sent(),Pt=e.as(Wh),Ft=Pt.pinnedMessageIds,Bt=Pt.latestPinnedMessage,(jt=Pt.ts)>Lt._pinnedMessagesUpdatedAt&&(Lt.pinnedMessageIds=null!=Ft?Ft:[],Lt.lastPinnedMessage=Bt,Lt._pinnedMessagesUpdatedAt=jt,this._dispatcher.dispatch(new wf({channels:[Lt],context:{source:os.EVENT_PINNED_MESSAGE_UPDATED}})),Fi((function(){return w(hn,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(Lt)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Fi((function(){return w(hn,0,void 0,(function(){return A(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(Lt)})),[2]}))}))}))),[3,85];case 85:return[3,87];case 86:switch((Ht=e.as(Fh).event).category){case Ah.USER_BLOCK:Gt=Dh.getDataAsUserBlockEvent(this._iid,Ht),Vt=Gt.blocker,qt=Gt.blockee,this._groupChannelCache.block(Vt.userId,qt.userId);break;case Ah.USER_UNBLOCK:zt=Dh.getDataAsUserBlockEvent(this._iid,Ht),Vt=zt.blocker,qt=zt.blockee,this._groupChannelCache.unblock(Vt.userId,qt.userId)}return[3,87];case 87:return[3,89];case 88:if(Kt=fn.sent(),G(Kt))throw Kt;return[3,89];case 89:return[2]}}))}))},t.prototype._markAsLeave=function(e){var t,n=this,r=null!==(t=this._leftChannels.get(e.url))&&void 0!==t?t:{channel:e,ref:0};r.ref++,this._leftChannels.set(e.url,r),setTimeout((function(){r.ref--,0===r.ref&&n._leftChannels.delete(e.url)}),1e4)},t.prototype.addHandler=function(e,t){this._groupChannelHandlers.set(e,t)},t.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},t.prototype.subscribeChannelEvent=function(e,t){this._groupChannelBroadcast.subscribe(e,t)},t.prototype.unsubscribeChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e)},t.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter((function(e){return e.state===zh.JOINED})).length},t.prototype.getChannel=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:pa(W("string",e)).throw(z.invalidParameters),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(n=r.sent())?[2,n]:[3,4];case 3:return r.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,t)];case 5:return[2,r.sent()]}}))}))},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),n=new xf({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:switch(r=o.sent(),i=r.as(Df).channel,a=i.unreadMessageCount,s=i.unreadMentionCount,i.myCountPreference){case sm.UNREAD_MESSAGE_COUNT_ONLY:s=0;break;case sm.UNREAD_MENTION_COUNT_ONLY:a=0;break;case sm.OFF:a=0,s=0}return i._updateUnreadCount(a,s),[4,this.upsertChannelsToCache([i])];case 2:return[2,o.sent()[0]]}}))}))},t.prototype.refreshChannel=function(e,t,n,r){return void 0===t&&(t=!0),void 0===n&&(n=os.REFRESH_CHANNEL),void 0===r&&(r=!1),w(this,0,void 0,(function(){var i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),i=new xf({channelUrl:e,isInternalCall:t,showLatestMessage:r}),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),(s=a.as(Df).channel).myMemberState!==zh.NONE?[3,2]:(this._dispatcher.dispatch(new Af({channelUrls:[s.url],context:{source:n}})),[3,4]);case 2:return[4,this.upsertChannelsToCache([s])];case 3:o=u.sent(),this._dispatcher.dispatch(new wf({channels:o,context:{source:n}})),u.label=4;case 4:return[3,6];case 5:return(l=u.sent()).code!==k.NON_AUTHORIZED&&l.code!==k.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new Af({channelUrls:[e],context:{source:n}})),[3,6];case 6:return[2]}}))}))},t.prototype.getMyGroupChannels=function(e,t,n,r,i){return void 0===r&&(r=os.REQUEST_CHANNEL),void 0===i&&(i=!1),w(this,0,void 0,(function(){var a,s,o,l,u,c,d,h,f;return A(this,(function(p){switch(p.label){case 0:return t.createdAfter&&(t.createdAfter=Math.floor(t.createdAfter/1e3)),t.createdBefore&&(t.createdBefore=Math.floor(t.createdBefore/1e3)),a=!1,i&&(s=ms.of(this._iid),o=s.appInfo,(l=s.cacheContext)&&!l.localCacheEnabled&&(null==o?void 0:o.enabledChannelMemberShipHistory)&&(null==o?void 0:o.applicationAttributes.includes("left_user_view_support"))&&(a=!0)),u=new Lf(S(S({},t),{userId:this._sdkState.userId,token:e,limit:n,includeLeftChannel:i&&a})),[4,this._requestQueue.send(u)];case 1:return c=p.sent(),d=c.as(Pf),h=d.channels,f=d.token,this._dispatcher.dispatch(new wf({channels:h,context:{source:r}})),[2,{channels:h,token:f}]}}))}))},t.prototype.getMyGroupChannelChangeLogs=function(e,t,n){return void 0===n&&(n=os.REQUEST_CHANNEL_CHANGELOGS),w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c;return A(this,(function(d){switch(d.label){case 0:return r=S(S({},_f),t),pa((W("string",e)||W("number",e))&&vf(r)).throw(z.invalidParameters),i=new Rf(Ae({userId:this._sdkState.userId,ts:"number"==typeof e?e:null,token:"string"==typeof e?e:null,filter:r})),[4,this._requestQueue.send(i)];case 1:return a=d.sent(),s=a.as(kf),o=s.updatedChannels,l=s.deletedChannelUrls,u=s.hasMore,c=s.ts,o.length>0&&this._dispatcher.dispatch(new wf({channels:o,context:{source:n},ts:c})),l.length>0&&this._dispatcher.dispatch(new Af({channelUrls:l,context:{source:n}})),[2,{updatedChannels:o,deletedChannelUrls:l,hasMore:u,token:s.token}]}}))}))},t.prototype.getGroupChannelCount=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=S(S({},Ef),e),pa(yf(t)).throw(z.invalidParameters),n=new Ff({userId:this._sdkState.userId,filter:t}),[4,this._requestQueue.send(n)];case 1:return[2,r.sent().as(Bf).groupChannelCount]}}))}))},t.prototype.getUnreadItemCount=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m,g;return A(this,(function(_){switch(_.label){case 0:return t=S(S({},Cf),e),pa((v=t,X(hf,v.keys)&&X("string",v.customTypeFilters,!0)&&X("string",v.customTypesFilter,!0))).throw(z.invalidParameters),n=ms.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new jf({userId:r.userId,filter:t}),[4,i.send(a)];case 1:return s=_.sent(),o=s.as(Hf),l=o.groupChannelUnreadMentionCount,u=o.groupChannelUnreadMessageCount,c=o.groupChannelInvitationCount,d=o.superGroupChannelUnreadMentionCount,h=o.superGroupChannelUnreadMessageCount,f=o.superGroupChannelInvitationCount,p=o.nonSuperGroupChannelUnreadMentionCount,m=o.nonSuperGroupChannelUnreadMessageCount,g=o.nonSuperGroupChannelInvitationCount,[2,we({groupChannelUnreadMentionCount:l,groupChannelUnreadMessageCount:u,groupChannelInvitationCount:c,superGroupChannelUnreadMentionCount:d,superGroupChannelUnreadMessageCount:h,superGroupChannelInvitationCount:f,nonSuperGroupChannelUnreadMentionCount:p,nonSuperGroupChannelUnreadMessageCount:m,nonSuperGroupChannelInvitationCount:g})]}var v}))}))},t.prototype.getTotalUnreadChannelCount=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Gf({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(zf).unreadCount]}}))}))},t.prototype.getTotalUnreadMessageCount=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return t=S(S({},Nf),e),pa(function(e){return X("string",e.channelCustomTypesFilter,!0)&&Y(rf,e.superChannelFilter)}(t)).throw(z.invalidParameters),n=ms.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new Vf({userId:r.userId,filter:t}),[4,i.send(a)];case 1:return[2,s.sent().as(qf).unreadCount]}}))}))},t.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){var t,n,r;return A(this,(function(i){switch(i.label){case 0:return t=S(S({},Tf),e),pa((a=t,W("string",a.channelUrl,!0)&&X(Uo,a.scheduledStatus,!0)&&Y(he,a.messageTypeFilter))).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new Kf(t),[4,n.send(r)];case 1:return[2,i.sent().as(Wf).count]}var a}))}))},t.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=ms.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,t=ms.of(this._iid).subscribedUnreadMessageCount;return Object.keys(t.customTypes).forEach((function(n){e+=t.customTypes[n]})),e},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var t;return null!==(t=ms.of(this._iid).subscribedUnreadMessageCount.customTypes[e])&&void 0!==t?t:0},t.prototype.createChannel=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=S(S({},mf),e),pa(gf(t)).throw(z.invalidParameters),t.isPublic||(t.accessCode=void 0),n=new Qf(S({userId:this._sdkState.userId},t)),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),i=r.as(Xf).channel,[4,this.upsertChannelsToCache([i])];case 2:return a.sent(),[2,i]}}))}))},t.prototype.markAsReadAll=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return e=Date.now(),pa(e-this._markAsReadAllLastSentAt>=1e3).throw(z.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,t=new Zf({userId:this._sdkState.userId}),[4,this._requestQueue.send(t)];case 1:l.sent(),n=this._groupChannelCache.channels;try{for(r=M(n),i=r.next();!i.done;i=r.next())(a=i.value)._updateUnreadMemberState(this._sdkState.userId,e),a._updateUnreadCount(0,0)}catch(e){s={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}}return n.length>0?[4,this.upsertChannelsToCache(n)]:[3,3];case 2:l.sent(),l.label=3;case 3:return[2]}}))}))},t.prototype.markAsReadWithChannelUrls=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:return t=Date.now(),pa(X("string",e)&&t-this._markAsReadAllLastSentAt>=1e3).throw(z.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=t,n=new Zf({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(n)];case 1:c.sent(),r=this._groupChannelCache.channels,i=[];try{for(a=M(r),s=a.next();!s.done;s=a.next())o=s.value,e.includes(o.url)&&(o._updateUnreadMemberState(this._sdkState.userId,t),o._updateUnreadCount(0,0),i.push(o))}catch(e){l={error:e}}finally{try{s&&!s.done&&(u=a.return)&&u.call(a)}finally{if(l)throw l.error}}return i.length>0?[4,this.upsertChannelsToCache(i)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))},t.prototype.markAsDelivered=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},t.prototype.getMessageFromCache=function(e){var t;return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._messageCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return w(this,0,void 0,(function(){return A(this,(function(r){switch(r.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,filter:n,exactMatch:!0})];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessagesFromCache=function(e,t,n,r,i,a){return void 0===i&&(i=100),void 0===a&&(a=!0),w(this,0,void 0,(function(){return A(this,(function(s){switch(s.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:i,filter:r,backward:"next"===n,inclusive:a})];case 1:return[2,s.sent()]}}))}))},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return w(this,0,void 0,(function(){return A(this,(function(i){switch(i.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:r,filter:n,backward:!1,isPollOnly:!0})];case 1:return[2,i.sent()]}}))}))},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return w(this,0,void 0,(function(){return A(this,(function(i){switch(i.label){case 0:return[4,this._messageCache.countBetween(e,t,new bp({top:n,bottom:r}))];case 1:return[2,i.sent()]}}))}))},t.prototype.getUnsentMessagesFromCache=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:e,filter:t})];case 1:return[2,n.sent()]}}))}))},t.prototype.removeFailedMessageFromCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._unsentMessageCache.remove([e])];case 1:return t.sent(),[2]}}))}))},t}(Yh),Tp=function(e,t){return t instanceof Go?e.findIndex((function(e){return e instanceof Go&&t.isIdentical(e)})):e.findIndex((function(e){return e.isIdentical(t)}))},Ip=function(e,t){return e.findIndex((function(e){return e instanceof Ho?e.messageId===t:e instanceof Zo?e.notificationId===t:void 0}))},Sp=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,i=Math.floor((n+r)/2);n<r;){var a=e[i].createdAt-t.createdAt;if(a>0)r=i,i=Math.floor((n+r)/2);else{if(!(a<0))return i;n=i+1,i=Math.floor((n+r)/2)}}return e[i].createdAt>t.createdAt?i:i+1}return e.length},wp={},Ap=function(){function e(e){var t=e._iid,n=e.channel,r=e.limit,i=void 0===r?100:r,a=this;this.ref=0,this._iid=t,this._channel=n,this._limit=i,this._prevSyncLoopCount=0;var s,o,l=ms.of(this._iid),u=l.sdkState,c=l.cacheContext,d=l.dispatcher,h=l.logger,f=l.statManager,p=l.messageBackgroundSyncThrottleController;this._metadataKey=(s=u.userId,o=n.url,"sendbird:".concat(s,"@groupchannel/").concat(o,"/message/sync.meta"));var m,g,_=(m=u.userId,g=n.url,"sendbird:".concat(m,"@groupchannel/").concat(g,"/message/sync"));this._prevSync=new Hh(_,(function(e){return w(a,0,void 0,(function(){var t=this;return A(this,(function(r){switch(r.label){case 0:return[4,p.run("message-background-sync-".concat(n.url,"-prev"),(function(){return w(t,0,void 0,(function(){var t,r,i,a,s,o,l,u,d,p,m,g;return A(this,(function(_){switch(_.label){case 0:return t={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata()];case 1:if(_.sent(),h.debug("message background prev sync from",null===(o=this._metadata)||void 0===o?void 0:o.range.top),null===(l=this._metadata)||void 0===l?void 0:l.previousComplete)return[3,10];_.label=2;case 2:return _.trys.push([2,5,8,9]),[4,fh.of(this._iid)._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,(null===(d=null===(u=this._metadata)||void 0===u?void 0:u.range)||void 0===d?void 0:d.top)?this._metadata.range.top:e,{prevResultSize:this._limit,nextResultSize:0,replyType:me.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},os.SYNC_MESSAGE_BACKGROUND,!1,!1,ll.INTERNAL_BACKSYNC)];case 3:return(r=_.sent().messages).length>0&&(i=r.map((function(e){return e.createdAt})),(null===(p=this._metadata)||void 0===p?void 0:(s=p.range).intersect.apply(s,R([],O(i),!1)))?this.extendRange(r):this._metadata={range:new bp({top:Math.min.apply(Math,R([],O(i),!1)),bottom:Math.max.apply(Math,R([],O(i),!1))}),previousComplete:!1}),t.hasNext=r.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.top,this._metadata.previousComplete=r.length<this._limit),h.debug("message background prev sync progress",t),[4,this.saveMetadata()];case 4:return _.sent(),[3,9];case 5:return a=_.sent(),h.debug("message background prev sync error",a),a instanceof z&&a.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:_.sent(),_.label=7;case 7:throw a;case 8:return f.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:n.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:null!==(g=null===(m=c.localCacheConfig)||void 0===m?void 0:m.maxSize)&&void 0!==g?g:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 9:return[3,11];case 10:t.hasNext=!1,_.label=11;case 11:return[2,t]}}))}))}))];case 1:return[2,r.sent()]}}))}))})),this._nextSync=new Hh(_,(function(e){return w(a,0,void 0,(function(){var t=this;return A(this,(function(r){switch(r.label){case 0:return[4,p.run("message-background-sync-".concat(n.url,"-next"),(function(){return w(t,0,void 0,(function(){var t,r,i,a,s,o,l,u,d,p,m;return A(this,(function(g){switch(g.label){case 0:return t={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:g.sent(),h.debug("message background next sync from",null===(o=this._metadata)||void 0===o?void 0:o.range.bottom),g.label=2;case 2:return g.trys.push([2,5,6,7]),[4,fh.of(this._iid)._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,(null===(u=null===(l=this._metadata)||void 0===l?void 0:l.range)||void 0===u?void 0:u.bottom)?this._metadata.range.bottom:e,{prevResultSize:0,nextResultSize:this._limit,replyType:me.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},os.SYNC_MESSAGE_BACKGROUND,!1,!1,ll.INTERNAL_BACKSYNC)];case 3:return(r=g.sent().messages).length>0&&(i=r.map((function(e){return e.createdAt})),(null===(d=this._metadata)||void 0===d?void 0:(s=d.range).intersect.apply(s,R([],O(i),!1)))?this.extendRange(r):this._metadata={range:new bp({top:Math.min.apply(Math,R([],O(i),!1)),bottom:Math.max.apply(Math,R([],O(i),!1))}),previousComplete:!1}),t.hasNext=r.length>=this._limit,this._metadata&&(t.nextToken=this._metadata.range.bottom),h.debug("message background next sync progress",t),[4,this.saveMetadata()];case 4:return g.sent(),[3,7];case 5:throw a=g.sent(),h.debug("message background next sync error",a),a;case 6:return f.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:n.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:null!==(m=null===(p=c.localCacheConfig)||void 0===p?void 0:p.maxSize)&&void 0!==m?m:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[2,t]}}))}))}))];case 1:return[2,r.sent()]}}))}))})),this._connectionEventContext=d.on((function(e){e instanceof Ki&&(e.stateType===ji.CONNECTED?a.resume():a.pause())}))}return e.of=function(t,n){return wp[t]||(wp[t]={}),wp[t][n.url]||(wp[t][n.url]=new e({_iid:t,channel:n})),wp[t][n.url].ref++,wp[t][n.url]},e.clear=function(e,t){wp[e]&&wp[e][t]&&(wp[e][t].close(),delete wp[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new bp({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousComplete",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.previousComplete)},enumerable:!1,configurable:!0}),e.prototype.isWrappingMessages=function(e){var t;return null===(t=this.range)||void 0===t?void 0:t.includes.apply(t,R([],O(e.map((function(e){return e.createdAt}))),!1))},e.prototype.extendRange=function(e){var t;this._metadata&&(t=this._metadata.range).extends.apply(t,R([],O(e.map((function(e){return e.createdAt}))),!1))},e.prototype.loadMetadata=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,ms.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata=e?{range:new bp(e.range),previousComplete:e.previousComplete}:{range:new bp({}),previousComplete:!1},t.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._metadata?[4,ms.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,ms.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(e){var t,n,r,i;void 0===e&&(e=Date.now());var a=ms.of(this._iid),s=a.logger,o=a.sessionManager;a.cacheContext.localCacheEnabled&&o.session.hasSession&&(s.debug("message background sync resume()"),this._prevSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start(null!==(n=null===(t=this._metadata)||void 0===t?void 0:t.range.top)&&void 0!==n?n:e),this._nextSync.start(null!==(i=null===(r=this._metadata)||void 0===r?void 0:r.range.bottom)&&void 0!==i?i:e))},e.prototype.pause=function(){ms.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete wp[this._iid][this._channel.url])},e}(),Mp={},Op=function(){function e(e){var t=e._iid,n=e.channel,r=e.includeParams,i=this;this.ref=0,this._iid=t,this._channel=n,this._includeParams=r;var a,s,o=ms.of(this._iid),l=o.logger,u=o.sdkState,c=o.dispatcher;this._metadataKey=(a=u.userId,s=n.url,"sendbird:".concat(a,"@groupchannel/").concat(s,"/message/changelogs.meta"));var d,h,f=(d=u.userId,h=this._channel.url,"sendbird:".concat(d,"@groupchannel/").concat(h,"/message/changelogs"));this._sync=new Hh(f,(function(){return w(i,0,void 0,(function(){var e,t,n,r,i,a,s,o,u;return A(this,(function(c){switch(c.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:c.sent(),l.debug("message changelog sync from",null===(u=this._metadata)||void 0===u?void 0:u.token),c.label=2;case 2:return c.trys.push([2,5,,8]),[4,fh.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,S({replyType:me.ALL},this._includeParams),os.SYNC_MESSAGE_CHANGELOGS)];case 3:return t=c.sent(),n=t.updatedMessages,r=t.deletedMessageIds,i=t.hasMore,a=t.token,s=t.forceUseNextToken,e.hasNext=i,e.nextToken=a,n.length>0||r.length>0?this._metadata&&(this._metadata.token=a):s&&this._metadata&&(this._metadata.token=a),l.debug("message changelog sync progress",e),[4,this.saveMetadata()];case 4:return c.sent(),[3,8];case 5:return o=c.sent(),l.debug("message changelog sync error",o),o instanceof z&&o.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:c.sent(),c.label=7;case 7:throw o;case 8:return[2,e]}}))}))})),this._connectionEventContext=c.on((function(e){e instanceof Ki&&(e.stateType===ji.CONNECTED?i.resume():i.pause())}))}return e.of=function(t,n,r){return Mp[t]||(Mp[t]={}),Mp[t][n.url]||(Mp[t][n.url]=new e({_iid:t,channel:n,includeParams:r})),Mp[t][n.url].ref++,Mp[t][n.url]},e.clear=function(e,t){Mp[e]&&Mp[e][t]&&(Mp[e][t].close(),delete Mp[e])},e.prototype.loadMetadata=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return this._metadata?[3,2]:(e=ms.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=i.sent(),this._metadata={token:r?r.token:n},i.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._metadata?[4,ms.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,ms.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e=ms.of(this._iid),t=e.logger;e.sessionManager.session.hasSession&&(t.debug("message changelog sync resume()"),this._sync.start(0))},e.prototype.pause=function(){ms.of(this._iid).logger.debug("message changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Mp[this._iid][this._channel.url])},e}(),Rp={},kp=function(){function e(e){var t=e._iid,n=e.channel,r=e.hasPollMessage,i=this;this.ref=0,this._iid=t,this._channel=n;var a,s,o=ms.of(this._iid),l=o.logger,u=o.sdkState,c=o.dispatcher;this._metadataKey=(a=u.userId,s=n.url,"sendbird:".concat(a,"@groupchannel/").concat(s,"/poll/changelogs.meta"));var d,h,f=(d=u.userId,h=this._channel.url,"sendbird:".concat(d,"@groupchannel/").concat(h,"/poll/changelogs"));this._sync=new Hh(f,(function(){return w(i,0,void 0,(function(){var e,t,n,i,a,s,o,u;return A(this,(function(c){switch(c.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return c.sent(),l.debug("poll changelog sync from",null===(u=this._metadata)||void 0===u?void 0:u.token),(t=!this._metadata||!this._metadata.token)?[4,r()]:[3,3];case 2:t=!c.sent(),c.label=3;case 3:if(t)return[2,{hasNext:!1,nextToken:0}];this._metadata||(n=ms.of(this._iid).firstConnectedAt,this._metadata={token:n}),c.label=4;case 4:return c.trys.push([4,7,,10]),[4,Zs.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return i=c.sent(),a=i.hasMore,s=i.token,e.hasNext=a,e.nextToken=s,this._metadata.token=s,l.debug("poll changelog sync progress",e),[4,this.saveMetadata()];case 6:return c.sent(),[3,10];case 7:return o=c.sent(),l.debug("poll changelog sync error",o),o instanceof z&&o.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:c.sent(),c.label=9;case 9:throw o;case 10:return[2,e]}}))}))})),this._connectionEventContext=c.on((function(e){e instanceof Ki&&(e.stateType===ji.CONNECTED?i.resume():i.pause())}))}return e.of=function(t,n,r){return Rp[t]||(Rp[t]={}),Rp[t][n.url]||(Rp[t][n.url]=new e({_iid:t,channel:n,hasPollMessage:r})),Rp[t][n.url].ref++,Rp[t][n.url]},e.prototype.loadMetadata=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,ms.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata=e?{token:e.token}:void 0,t.label=2;case 2:return[2]}}))}))},e.prototype.saveMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._metadata?[4,ms.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.clearMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,ms.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){ms.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},e.prototype.pause=function(){ms.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Rp[this._iid][this._channel.url])},e}(),xp=function(e){function t(t){var n,r,i,a,s,o,l,u,c,d,h=this;return(h=e.call(this)||this).method=Me.GET,h.path="".concat(Je(t.channelType),"/").concat(t.channelUrl,"/messages_gap"),h.params=we({prev_start_ts:t.prevStart,prev_end_ts:t.prevEnd,prev_cache_count:t.prevCount,next_start_ts:t.nextStart,next_end_ts:t.nextEnd,next_cache_count:t.nextCount,huge_gap_threshold:null!==(n=t.threshold)&&void 0!==n?n:null,reverse:!0,custom_types:null!==(r=t.customTypes)&&void 0!==r?r:["*"],message_type:null!==(i=t.messageType)&&void 0!==i?i:null,include_reply_type:null!==(a=t.replyType)&&void 0!==a?a:me.NONE,include_reactions_summary:null===(s=t.includeReactions)||void 0===s||s,include_meta_array:null===(o=t.includeMetaArray)||void 0===o||o,include_thread_info:null===(l=t.includeThreadInfo)||void 0===l||l,include_parent_message_info:null===(u=t.includeParentMessageInfo)||void 0===u||u,with_sorted_meta_array:null===(c=t.includeMetaArray)||void 0===c||c,show_subchannel_messages_only:null!==(d=t.showSubchannelMessagesOnly)&&void 0!==d&&d,include_poll_details:!0,checking_continuous_messages:t.checkingContinuousMessages}),h}return I(t,e),t}(it),Dp=function(e){function t(t,n){var r,i,a,s,o,l,u=this;return(u=e.call(this,t,n)||this).isHugeGap=n.is_huge_gap,u.prevMessages=(null!==(r=n.prev_messages)&&void 0!==r?r:[]).map((function(e){return $o(t,e)})),u.prevHasMore=null!==(i=n.prev_hasmore)&&void 0!==i&&i,u.isContinuousPrevMessages=null!==(a=n.is_continuous_prev_messages)&&void 0!==a&&a,u.nextMessages=(null!==(s=n.next_messages)&&void 0!==s?s:[]).map((function(e){return $o(t,e)})),u.nextHasmore=null!==(o=n.next_hasmore)&&void 0!==o&&o,u.isContinuousNextMessages=null!==(l=n.is_continuous_next_messages)&&void 0!==l&&l,u}return I(t,e),t}(at),Up={includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0};!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"}(Ep||(Ep={}));var Lp,Pp,Fp,Bp=function(){function e(){this._onCacheResult=At,this._onApiResult=At}return e.prototype._invokeResponse=function(e,t,n){var r=this;Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(r){switch(e){case"local":this._onCacheResult(t,n);break;case"remote":this._onApiResult(t,n)}return[2]}))}))}))},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}(),jp=function(e){function t(t,n){return e.call(this,t,S(S({},n),{channelManager:Np.of(t)}))||this}return I(t,e),t.prototype.keyOf=function(e){return e.messageId},t.prototype.initialize=function(t){return e.prototype.initialize.call(this,t)},t.prototype.setMessageCollectionHandler=function(e){this._setBaseMessageCollectionHandler(e)},t.prototype._addMessagesToView=function(e,t){var n,r,i=this,a=this._filterUnderOffsetMessage(e),s=[],o=[];try{for(var l=M(a),u=l.next();!u.done;u=l.next()){var c=u.value;if(t===os.SYNC_MESSAGE_FILL)if(c.messageId>0){if((p=Tp(this._messages,c))<0){Tp(this._unsentMessages,c)<0&&s.push(c);var d=Sp(this._messages,c);this._messages.splice(d,0,c)}}else c instanceof Go&&(p=Tp(this._unsentMessages,c))<0&&Tp(this._messages,c)<0&&(this._unsentMessages.push(c),s.push(c));else if(c.messageId>0){if((p=Tp(this._messages,c))<0){var h=Tp(this._unsentMessages,c);h<0?s.push(c):(this._unsentMessages.splice(h,1),o.push(c)),d=Sp(this._messages,c),this._messages.splice(d,0,c)}else o.push(c),this._messages[p]=c;if(c.updatedAt>0){var f=this._updateChildMessagesInView(c);o.push.apply(o,R([],O(f),!1))}}else if(c instanceof Go){var p;(p=Tp(this._unsentMessages,c))<0?Tp(this._messages,c)<0&&(this._unsentMessages.push(c),s.push(c)):(o.push(c),this._unsentMessages[p]=c)}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}_s(t)&&Fi((function(){return w(i,0,void 0,(function(){var e,n,r,i,a;return A(this,(function(l){return e={source:t},s.length>0&&(null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesAdded)||void 0===r||r.call(n,e,this.channel,s)),o.length>0&&(null===(a=null===(i=this._handler)||void 0===i?void 0:i.onMessagesUpdated)||void 0===a||a.call(i,e,this.channel,o)),[2]}))}))}))},t.prototype._updateMessagesToView=function(e,t){var n,r,i=this,a=[],s=[],o=[];try{for(var l=M(e),u=l.next();!u.done;u=l.next()){var c,d=u.value;if(d.messageId>0)if((c=Tp(this._messages,d))>=0)s.push(d),this._messages[c]=d;else{var h=Tp(this._unsentMessages,d);if(h>=0){var f=O(this._unsentMessages.splice(h,1),1)[0];if(this.hasNext&&f)o.push(f);else{s.push(d);var p=Sp(this._messages,d);this._messages.splice(p,0,d)}}else{var m=this._messages.map((function(e){return e.createdAt}));(d.createdAt<Math.min.apply(Math,R([],O(m),!1))&&!this._hasPrevious||d.createdAt>Math.max.apply(Math,R([],O(m),!1))&&!this._hasNext)&&a.push(d)}}else d instanceof Go&&(c=Tp(this._unsentMessages,d))>=0&&(s.push(d),this._unsentMessages[c]=d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return _s(t)&&Fi((function(){return w(i,0,void 0,(function(){var e,n,r,i,l;return A(this,(function(u){return e={source:t},s.length>0?null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,s):o.length>0?null===(l=null===(i=this._handler)||void 0===i?void 0:i.onMessagesDeleted)||void 0===l||l.call(i,e,this.channel,[],o):a.length>0&&this._addMessagesToView(a,t),[2]}))}))})),s},t}(function(){function e(e,t){var n=t.filter,r=t.startingPoint,i=t.limit,a=t.prevResultLimit,s=t.nextResultLimit,o=t.channel,l=t.channelManager,u=t.disableBackgroundSync,c=void 0!==u&&u,d=this;this._messages=[],this._unsentMessages=[],this._isLoadingPrevious=!1,this._isLoadingNext=!1,this._iid=e,this._key="mc-".concat(Ce()),this._isDisposed=!1,this.filter=null!=n?n:new Kd,this._channel=o,this._syncRange=new bp({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint="number"==typeof r&&Number.isFinite(r)?r:Number.MAX_SAFE_INTEGER,this._limit=i||100,this._prevResultLimit=null!=a?a:Math.floor(this._limit/2),this._nextResultLimit=null!=s?s:Math.floor(this._limit/2),this._channelManager=l;var h=ms.of(this._iid).statManager;this._channelManager.subscribeChannelEvent(this._key,{onUpdate:function(e,t){var n=t.source,r=e.findIndex((function(e){return e.isIdentical(d.channel)}));r>=0&&(d._replaceChannelOfCollection(e[r]),d.channel._runIfHandleableWithGroupChannel((function(e){switch(n){case os.EVENT_CHANNEL_UPDATED:for(var r=!1,i=0;i<d._messages.length;i++)if(d._messages[i].createdAt>=e.messageOffsetTimestamp){r=!0;var a=i;if(a>0){var s=d._messages.splice(0,a);d._removeMessagesFromView(s.map((function(e){return d.keyOf(e)})),os.EVENT_MESSAGE_OFFSET_UPDATED)}break}!r&&d._messages.length>0&&d._removeMessagesFromView(d._messages.map((function(e){return d.keyOf(e)})),os.EVENT_MESSAGE_OFFSET_UPDATED);break;case os.EVENT_CHANNEL_UNMUTED:var o=ms.of(d._iid).sdkState,l=t.user;o.userId===l.userId&&d._clearCheckMyMutedTimer();break;case os.EVENT_CHANNEL_MUTED:o=ms.of(d._iid).sdkState,l=t.user,o.userId===l.userId&&-1!==e._myMutedRemainingTime&&d._startCheckMyMutedTimer(e._myMutedRemainingTime);break;case os.EVENT_CHANNEL_LEFT:e.isPublic&&d._clearCheckMyMutedTimer()}Fi((function(){return w(d,0,void 0,(function(){var e;return A(this,(function(r){return Sf(n)&&(null===(e=this._handler)||void 0===e?void 0:e.onChannelUpdated)&&this._handler.onChannelUpdated(t,this.channel),[2]}))}))}))})),d._postprocessChannelUpdateEvent(e[r],n))},onRemove:function(e,t){var n=e.indexOf(d.channel.url);n>=0&&d._channel._runIfHandleableWithGroupChannel((function(r){r.myMemberState=zh.NONE,d._clearCheckMyMutedTimer(),Fi((function(){return w(d,0,void 0,(function(){var e;return A(this,(function(n){return(null===(e=this._handler)||void 0===e?void 0:e.onChannelDeleted)&&this._handler.onChannelDeleted(t,this.channel.url),[2]}))}))})),d._postprocessChannelRemoveEvent(e[n])}))}}),this._channelManager.subscribeMessageEvent(this._key,{onUpdate:function(e,t){var n,r,i=[],a=[];try{for(var s=M(e),o=s.next();!o.done;o=s.next()){var l=o.value;l.channelUrl===d._channel.url&&(d.filter.match(l)?i.push(l):a.push(d.keyOf(l)))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}if(_s(t)){if(i.length>0)switch(t){case os.LOCAL_MESSAGE_CANCELED:case os.LOCAL_MESSAGE_RESEND_STARTED:case os.EVENT_MESSAGE_SENT_FAILED:case os.EVENT_MESSAGE_SENT_SUCCESS:case os.EVENT_MESSAGE_UPDATED:case os.EVENT_MESSAGE_THREADINFO_UPDATED:case os.EVENT_MESSAGE_REACTION_UPDATED:case os.EVENT_MESSAGE_FEEDBACK_ADDED:case os.EVENT_MESSAGE_FEEDBACK_UPDATED:case os.EVENT_MESSAGE_FEEDBACK_DELETED:case os.SYNC_MESSAGE_CHANGELOGS:d._updateMessagesToView(i,t);break;case os.EVENT_MESSAGE_SENT_PENDING:d._addMessagesToView(i,t);break;case os.EVENT_MESSAGE_RECEIVED:d.hasNext||d._addMessagesToView(i,t);break;case os.SYNC_MESSAGE_FILL:d._addMessagesToView(i,t)}a.length>0&&d._removeMessagesFromView(a,t)}d._postprocessMessageUpdateEvent(e,t)},onRemove:function(e,t){d._removeMessagesFromView(e,t),d._postprocessMessageRemoveEvent(e)},onRemoveUnsent:function(e,t){d._removeUnsentMessageFromView(e,t)},onPollChangeLogUpdate:function(e,t){d._updatePollsToView(e,t)},onPollUpdate:function(e,t){d._applyPollUpdateEventToView(e,t)},onPollVote:function(e,t){d._applyPollVoteEventToView(e,t)},onReactionUpdate:function(e,t){d._applyReactionEventToView(e,t)},onThreadInfoUpdate:function(e,t){d._applyThreadInfoEventToView(e,t)},onDeletedByRetentionPolicy:function(e,t,n){t===d.channel.url&&d._messageRetention(e,n)}});var f=ms.of(this._iid),p=f.cacheContext,m=f.dispatcher,g=f.messageBackgroundSyncThrottleController;this._channel._updateMessageCollectionLastAccessedAt(),m.dispatch(new wf({channels:[this._channel],context:{source:os.CHANNEL_LASTACCESSEDAT_UPDATED}})),this._backgroundSync=Ap.of(this._iid,this._channel),!c&&this._shouldStartBackgroundSync()&&this._backgroundSync.resume(this._startingPoint),this._changelogSync=Op.of(this._iid,this._channel,this.changelogIncludeParams),this._changelogSync.resume(),this._pollChangelogSync=kp.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new Hh(this._key,(function(e){return w(d,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return[4,g.run("message-fill-sync-".concat(o.url,"-prev"),(function(){return w(t,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return[4,this._getRemoteMessages(e,{prevLimit:this._prevResultLimit,source:os.SYNC_MESSAGE_FILL,checkingContinuousMessages:p.localCacheEnabled,sdkSource:ll.INTERNAL_FILL_GAP})];case 1:return t=l.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(i=Math.min.apply(Math,R([],O(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(i),r&&(null===(a=this._backgroundSync)||void 0===a||a.range.extends(i)),[2,{hasNext:n.length>=this._prevResultLimit&&this.viewTop<i,nextToken:this._syncRange.top}]):(p.localCacheEnabled&&h.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(o=null===(s=p.localCacheConfig)||void 0===s?void 0:s.maxSize)&&void 0!==o?o:0,use_local_cache:p.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}}))}))}))];case 1:return[2,n.sent()]}}))}))})),this._nextFill=new Hh(this._key,(function(e){return w(d,0,void 0,(function(){var t=this;return A(this,(function(n){switch(n.label){case 0:return[4,g.run("message-fill-sync-".concat(o.url,"-next"),(function(){return w(t,0,void 0,(function(){var t,n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return[4,this._getRemoteMessages(e,{nextLimit:this._nextResultLimit,source:os.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:p.localCacheEnabled,sdkSource:ll.INTERNAL_FILL_GAP})];case 1:return t=u.sent(),n=t.messages,r=t.isContinuousMessages,i=t.hasNext,n.length>0?(a=Math.max.apply(Math,R([],O(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(a),r&&(null===(s=this._backgroundSync)||void 0===s||s.range.extends(a)),[2,{hasNext:i,nextToken:this._syncRange.bottom}]):(p.localCacheEnabled&&h.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(l=null===(o=p.localCacheConfig)||void 0===o?void 0:o.maxSize)&&void 0!==l?l:0,use_local_cache:p.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}}))}))}))];case 1:return[2,n.sent()]}}))}))})),this._connectionEventContext=m.on((function(e){if(e instanceof Ki)switch(e.stateType){case ji.CONNECTED:Bi((function(){return w(d,0,void 0,(function(){return A(this,(function(e){return this._activate(),[2]}))}))}));break;case ji.LOGOUT:d.dispose();break;default:d._clearCheckMyMutedTimer(),d._prevFill.stop(),d._nextFill.stop()}}))}return e.prototype.keyOf=function(e){return 0},Object.defineProperty(e.prototype,"changelogIncludeParams",{get:function(){return{includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0}},enumerable:!1,configurable:!0}),e.prototype._postprocessChannelUpdateEvent=function(e,t){},e.prototype._postprocessChannelRemoveEvent=function(e){},e.prototype._postprocessMessageUpdateEvent=function(e,t){},e.prototype._postprocessMessageRemoveEvent=function(e){},Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return R([],O(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===_e.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===_e.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTop",{get:function(){return Math.min.apply(Math,R(R([],O(this._messages.map((function(e){return e.createdAt}))),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,R(R([],O(this._messages.map((function(e){return e.createdAt}))),!1),[0],!1))},enumerable:!1,configurable:!0}),e.prototype._activate=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return ms.of(this._iid).logger.debug("check huge gap"),this._checkHugeGap(),[4,this._refreshChannel(os.SYNC_CHANNEL_CHANGELOGS)];case 1:return e.sent(),[2]}}))}))},e.prototype._replaceChannelOfCollection=function(e){this._channel.isGroupChannel()?this._channel=e:this._channel.isFeedChannel()&&(this._channel._groupChannel=e._groupChannel)},e.prototype._shouldStartBackgroundSync=function(){var e=ms.of(this._iid).cacheContext;return this.channel.isGroupChannel()?e.localCacheEnabled&&!this.channel.isSuper:e.localCacheEnabled},e.prototype._setBaseMessageCollectionHandler=function(e){this._handler=e},e.prototype._filterUnderOffsetMessage=function(e){return e},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n instanceof Ho&&n.parentMessageId===e.messageId&&n.applyParentMessage(e)&&t.push(n)})),t},e.prototype._updatePollsToView=function(e,t){var n,r,i=this,a=[];try{for(var s=M(e),o=s.next();!o.done;o=s.next()){var l=o.value,u=Ip(this._messages,l.messageId);if(u>=0){var c=this._messages[u];c.isUserMessage()&&c.applyPoll(l),a.push(c)}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a.length>0&&_s(t)&&Fi((function(){return w(i,0,void 0,(function(){var e,n,r;return A(this,(function(i){return e={source:t},a.length>0&&(null===(r=(n=this._handler).onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,a)),[2]}))}))})),a},e.prototype._applyPollUpdateEventToView=function(e,t){var n=this,r=Ip(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&i.isUserMessage()&&i.poll&&i.poll.applyPollUpdateEvent(e)&&_s(t)&&Fi((function(){return w(n,0,void 0,(function(){var e,n,r;return A(this,(function(a){return e={source:t},null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))}))}},e.prototype._applyPollVoteEventToView=function(e,t){var n=this,r=Ip(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&i.isUserMessage()&&i.poll&&i.poll.applyPollVoteEvent(e)&&_s(t)&&Fi((function(){return w(n,0,void 0,(function(){var e,n,r;return A(this,(function(a){return e={source:t},null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))}))}},e.prototype._applyReactionEventToView=function(e,t){var n=this,r=Ip(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&(i.isUserMessage()||i.isFileMessage()||i.isMultipleFilesMessage())&&_s(t)&&(i.applyReactionEvent(e),Fi((function(){return w(n,0,void 0,(function(){var e,n,r;return A(this,(function(a){return e={source:t},null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))})))}},e.prototype._applyThreadInfoEventToView=function(e,t){var n=this,r=Ip(this._messages,e.targetMessageId);if(r>=0){var i=this._messages[r];i&&(i.isUserMessage()||i.isFileMessage()||i.isMultipleFilesMessage())&&_s(t)&&(i.applyThreadInfoUpdateEvent(e),Fi((function(){return w(n,0,void 0,(function(){var e,n,r;return A(this,(function(a){return e={source:t},null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))})))}},e.prototype._removeMessagesFromView=function(e,t){var n,r,i=this,a=[],s=[],o=function(e){var t=l._messages.findIndex((function(t){return i.keyOf(t)===e}));if(t>=0){var n=l._messages[t];a.push(l.keyOf(n)),s.push(n),l._messages.splice(t,1)}},l=this;try{for(var u=M(e),c=u.next();!c.done;c=u.next())o(c.value)}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return _s(t)&&s.length>0&&Fi((function(){return w(i,0,void 0,(function(){var e,n,r;return A(this,(function(i){return e={source:t},null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesDeleted)||void 0===r||r.call(n,e,this.channel,a,s),[2]}))}))})),a},e.prototype._messageRetention=function(e,t){var n,r,i=[];try{for(var a=M(this._messages),s=a.next();!s.done;s=a.next()){var o=s.value;o.createdAt<=e&&i.push(this.keyOf(o))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}i.length>0&&this._removeMessagesFromView(i,t)},e.prototype._removeUnsentMessageFromView=function(e,t){var n=this._unsentMessages.findIndex((function(t){return t.reqId===e}));n>=0&&this._unsentMessages.splice(n,1)},e.prototype._getLocalMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,i=t.nextLimit,a=void 0===i?0:i,s=t.inclusive,o=void 0===s||s;return w(this,0,void 0,(function(){var t,n,i,s,l;return A(this,(function(u){switch(u.label){case 0:return t=[],o?[4,this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url,e,this.filter)]:[3,2];case 1:t=u.sent(),u.label=2;case 2:return r>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,e,"prev",this.filter,r,!1)]:[3,4];case 3:return i=u.sent(),[3,5];case 4:i=[],u.label=5;case 5:return n=i,a>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,e,"next",this.filter,a,!1)]:[3,7];case 6:return l=u.sent(),[3,8];case 7:l=[],u.label=8;case 8:return s=l,[2,{messages:R(R(R([],O(t),!1),O(n),!1),O(s),!1).sort((function(e,t){return t.createdAt-e.createdAt})),prevMessagesCount:n.length,nextMessagesCount:s.length}]}}))}))},e.prototype._getRemoteMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,i=t.nextLimit,a=void 0===i?0:i,s=t.source,o=void 0===s?os.REQUEST_MESSAGE:s,l=t.reverse,u=void 0!==l&&l,c=t.checkingHasNext,d=void 0!==c&&c,h=t.checkingContinuousMessages,f=void 0!==h&&h,p=t.sdkSource;return w(this,0,void 0,(function(){var t,n;return A(this,(function(i){switch(i.label){case 0:return t=fh.of(this._iid),r>0||a>0?[4,t._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,e,Ae(S(S(S({},this.filter),Up),{isInclusive:!0,reverse:u,prevResultSize:r,nextResultSize:a})),o,d,f,p)]:[3,2];case 1:return n=i.sent(),[3,3];case 2:n={messages:[],isContinuousMessages:!1},i.label=3;case 3:return[2,n]}}))}))},e.prototype._checkHugeGap=function(){var e,t,n,r,i;return w(this,0,void 0,(function(){var a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,M,x,D,U,L=this;return A(this,(function(P){switch(P.label){case 0:return a=ms.of(this._iid),s=a.dispatcher,o=a.requestQueue,l=a.cacheContext,u=a.statManager,c=a.logger,this._messages.length>0?(d=this._syncRange.top,h=this.viewTop,f=this._syncRange.bottom,p=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,h,d)]):[3,8];case 1:return m=P.sent(),[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,f,p)];case 2:g=P.sent(),P.label=3;case 3:return P.trys.push([3,5,6,7]),[4,Aa((function(){return w(L,0,void 0,(function(){var e,t,n,r,i,a,u,c,_,v,E,y,b,C,N,T,I,M=this;return A(this,(function(k){switch(k.label){case 0:return e=new xp(S(S({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:h,prevEnd:d,prevCount:m,nextStart:f,nextEnd:p,nextCount:g,checkingContinuousMessages:l.localCacheEnabled},this.filter),Up)),[4,o.send(e)];case 1:return t=k.sent(),n=t.as(Dp),r=n.isHugeGap,i=n.prevMessages,a=void 0===i?[]:i,u=n.prevHasMore,c=n.isContinuousPrevMessages,_=n.nextMessages,v=void 0===_?[]:_,E=n.nextHasmore,y=n.isContinuousNextMessages,r?Fi((function(){return w(M,0,void 0,(function(){var e;return A(this,(function(t){return(null===(e=this._handler)||void 0===e?void 0:e.onHugeGapDetected)&&this._handler.onHugeGapDetected(),[2]}))}))})):(b=this.viewTop,C=this.viewBottom,N=Math.min.apply(Math,R([Number.MAX_SAFE_INTEGER,b],O(a.map((function(e){return e.createdAt}))),!1)),T=Math.max.apply(Math,R([0,C],O(v.map((function(e){return e.createdAt}))),!1)),s.dispatch(new vs({messages:a,source:os.SYNC_MESSAGE_FILL})),s.dispatch(new vs({messages:v,source:os.SYNC_MESSAGE_FILL})),this._syncRange.extends(N,T),(c||y)&&(null===(I=this._backgroundSync)||void 0===I||I.range.extends(N,T)),u&&this._prevFill.start(N),E&&this._nextFill.start(T)),[2]}}))}))}),1)];case 4:return P.sent(),[3,7];case 5:return _=P.sent(),c.debug("Failed HugeGap Check ",_),[3,7];case 6:return l.localCacheEnabled&&u.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(t=null===(e=l.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:l.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[3,13];case 8:v=Date.now(),P.label=9;case 9:return P.trys.push([9,11,12,13]),[4,this._getRemoteMessages(v,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,source:os.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:l.localCacheEnabled,sdkSource:ll.INTERNAL_FILL_GAP})];case 10:if(E=P.sent(),y=E.messages,b=E.isContinuousMessages,C=E.hasNext,y.length>0){for(N=y.map((function(e){return e.createdAt})),T=0,I=0,M=0;M<N.length;M++)(x=N[M])<=v?T++:x>=v&&I++;this._hasPrevious=T>=this._prevResultLimit,this._hasNext=null!=C?C:I>=this._nextResultLimit,(U=this._syncRange).extends.apply(U,R([],O(N),!1)),b&&(null===(n=this._backgroundSync)||void 0===n||n.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(y,os.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,13];case 11:return(D=P.sent())instanceof z&&D.code===k.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,13];case 12:return l.localCacheEnabled&&u.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(i=null===(r=l.localCacheConfig)||void 0===r?void 0:r.maxSize)&&void 0!==i?i:0,use_local_cache:l.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 13:return[2]}}))}))},e.prototype._loadUnsentMessages=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=this,[4,this._channelManager.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return e._unsentMessages=t.sent(),[2]}}))}))},e.prototype._hasPollMessage=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._channelManager.getPollMessagesFromCache(this._channel.url,Date.now()+6e5,this.filter,1)];case 1:return e.sent().length>0?[2,!0]:[2,!1]}}))}))},e.prototype._refreshChannel=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n,r,i=this;return A(this,(function(a){switch(a.label){case 0:n=ms.of(this._iid).logger,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._channelManager.refreshChannel(this.channel.url,!0,e,t)];case 2:return a.sent(),this.channel._runIfHandleableWithGroupChannel((function(e){e.myMutedState===ce.MUTED&&Bi((function(){return w(i,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))}))})),[3,4];case 3:return r=a.sent(),n.warn("Failed to refresh channel",r),[3,4];case 4:return[2]}}))}))},e.prototype._startCheckMyMutedTimer=function(e){var t=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout((function(){return w(t,0,void 0,(function(){var e,t,n,r=this;return A(this,(function(i){switch(i.label){case 0:this._checkMyMutedStateTimer=void 0,e=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return t=i.sent(),e=!t.isMuted,[3,5];case 3:return i.sent(),e=!0,[3,5];case 4:return e&&(n=ms.of(this._iid).sessionManager,this.channel._runIfHandleableWithGroupChannel((function(e){var t,i;e.myMutedState=ce.UNMUTED;var a={source:os.EVENT_CHANNEL_UNMUTED,user:n.currentUser};null===(i=null===(t=r._handler)||void 0===t?void 0:t.onChannelUpdated)||void 0===i||i.call(t,a,r.channel)}))),[7];case 5:return[2]}}))}))}),e+1e3)},e.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},e.prototype._setHasNextAndHasPrevious=function(e,t){for(var n=e.map((function(e){return e.createdAt})),r=0,i=0,a=0;a<n.length;a++){var s=n[a];s<this._startingPoint?r++:s>this._startingPoint&&i++}this._hasPrevious=r>=this._prevResultLimit,this._hasNext=null!=t?t:i>=this._nextResultLimit},e.prototype.initialize=function(e){var t=this,n=new Bp;this._messages=[],this._unsentMessages=[],this._syncRange=new bp({}),this._hasNext=!0,this._hasPrevious=!0;var r=[],i={messages:[],prevMessagesCount:0,nextMessagesCount:0};return Fi((function(){return w(t,0,void 0,(function(){var t,a,s,o,l,u=this;return A(this,(function(c){switch(c.label){case 0:return[4,null===(l=this._backgroundSync)||void 0===l?void 0:l.loadMetadata()];case 1:return t=c.sent(),a=ms.of(this._iid),s=a.cacheContext,o=a.statManager,e===Ep.CACHE_AND_REPLACE_BY_API&&this._getLocalMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit}).then((function(e){return w(u,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return i=e,r=this._filterUnderOffsetMessage(i.messages),this._addMessagesToView(r,os.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return t.sent(),n._invokeResponse("local",null,r),[2]}}))}))})).catch((function(e){if(G(e))throw e;n._invokeResponse("local",e,null)})).finally((function(){return w(u,0,void 0,(function(){var a,s,l,u,c,d,h,f=this;return A(this,(function(p){switch(p.label){case 0:return a=ms.of(this._iid).cacheContext,s=!0,l=!0,u=!1,a.localCacheEnabled&&r.length>0&&(c=t.range).includes.apply(c,R([],O(r.map((function(e){return e.createdAt}))),!1))&&(!t.previousComplete&&i.prevMessagesCount<this._prevResultLimit?l=!0:this._startingPoint>t.range.bottom||i.nextMessagesCount<this._nextResultLimit?u=!0:l=!1),[4,this._refreshChannel(os.REFRESH_CHANNEL,u)];case 1:return p.sent(),u&&this._channel._runIfHandleableWithGroupChannel((function(e){var t=Math.max.apply(Math,R([],O(r.map((function(e){return e.createdAt}))),!1));e._latestMessageInfo&&t>=e._latestMessageInfo.createdAt&&(l=!1)})),l?(s=!1,this._getRemoteMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:a.localCacheEnabled,sdkSource:ll.EXTERNAL_COLLECTION}).then((function(e){var t,r,i,a=e.messages,s=e.isContinuousMessages,o=e.hasNext,l=f._filterUnderOffsetMessage(a);f._messages=[],l.length>0?(f._setHasNextAndHasPrevious(l,o),(t=f._syncRange).extends.apply(t,R([],O(l.map((function(e){return e.createdAt}))),!1)),s&&(null===(r=f._backgroundSync)||void 0===r?void 0:r.range.overlap(f._syncRange))&&(null===(i=f._backgroundSync)||void 0===i||i.range.extends(f._syncRange.top,f._syncRange.bottom)),f._addMessagesToView(l,os.REQUEST_MESSAGE)):(f._hasPrevious=!1,f._hasNext=!1),n._invokeResponse("remote",null,l)})).catch((function(e){if(G(e))throw e;n._invokeResponse("remote",e,null)}))):(this._setHasNextAndHasPrevious(r),n._invokeResponse("remote",null,r)),a.localCacheEnabled&&o.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"initial_load",event:s?"cache_hit":"cache_miss",max_db_size:null!==(h=null===(d=a.localCacheConfig)||void 0===d?void 0:d.maxSize)&&void 0!==h?h:0,message_init_policy:e,use_local_cache:a.localCacheEnabled,collection_id:this._key}})),[2]}}))}))})),o.put(new $a({type:rt.FEATURE_LOCALCACHE,data:{use_local_cache:s.localCacheEnabled,collection_interface:{message_init_policy:e,message:!0}}})),[2]}}))}))})),n},e.prototype.loadPrevious=function(){var e,t,n;return w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d=this;return A(this,(function(h){switch(h.label){case 0:if(this._isDisposed)throw new z({code:k.COLLECTION_DISPOSED,message:"Collection has been disposed."});return r=ms.of(this._iid),i=r.cacheContext,a=r.statManager,s=r.logger,this._hasPrevious?this._isLoadingPrevious?(s.warn("Messages are already fetching."),[2,[]]):(this._isLoadingPrevious=!0,o=this.viewTop,l=[],[4,Bi((function(){return w(d,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,this._getLocalMessages(o,{prevLimit:this._prevResultLimit,inclusive:!1})];case 1:return e=t.sent(),l=this._filterUnderOffsetMessage(e.messages),[2]}}))}))}))]):[2,[]];case 1:return h.sent(),u=l.length>=this._prevResultLimit,i.localCacheEnabled&&a.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:u?"cache_hit":"cache_miss",max_db_size:null!==(t=null===(e=i.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:i.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),u&&(null===(n=this._backgroundSync)||void 0===n?void 0:n.isWrappingMessages(l))?[3,3]:(c=!1,[4,Bi((function(){return w(d,0,void 0,(function(){var e,t,n,r,i,s,u,d=this;return A(this,(function(h){switch(h.label){case 0:return e=ms.of(this._iid).cacheContext,[4,this._getRemoteMessages(o,{prevLimit:this._prevResultLimit,reverse:!0,checkingContinuousMessages:e.localCacheEnabled,sdkSource:ll.EXTERNAL_COLLECTION})];case 1:return t=h.sent(),(l=this._filterUnderOffsetMessage(t.messages)).length>0&&((n=this._syncRange).extends.apply(n,R([],O(l.map((function(e){return e.createdAt}))),!1)),(null===(r=this._backgroundSync)||void 0===r?void 0:r.range.overlap(this._syncRange))&&t.isContinuousMessages&&(c=!0,null===(i=this._backgroundSync)||void 0===i||i.range.extends(this._syncRange.top))),l=l.filter((function(e){return Tp(d._messages,e)<0})),this._hasPrevious=l.length>=this._prevResultLimit,c&&a.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:"cache_fetch",max_db_size:null!==(u=null===(s=e.localCacheConfig)||void 0===s?void 0:s.maxSize)&&void 0!==u?u:0,use_local_cache:e.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}}))}))}))]);case 2:return h.sent(),this._addMessagesToView(l,os.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=l.length>=this._prevResultLimit,l.length>0&&this._addMessagesToView(l,os.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingPrevious=!1,[2,l]}}))}))},e.prototype.loadNext=function(){var e,t,n;return w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d=this;return A(this,(function(h){switch(h.label){case 0:if(this._isDisposed)throw new z({code:k.COLLECTION_DISPOSED,message:"Collection has been disposed."});return r=ms.of(this._iid),i=r.cacheContext,a=r.statManager,s=r.logger,this._hasNext?this._isLoadingNext?(s.warn("Messages are already fetching."),[2,[]]):(this._isLoadingNext=!0,o=this.viewBottom,l=[],[4,Bi((function(){return w(d,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,this._getLocalMessages(o,{nextLimit:this._nextResultLimit,inclusive:!1})];case 1:return e=t.sent(),l=this._filterUnderOffsetMessage(e.messages),[2]}}))}))}))]):[2,[]];case 1:return h.sent(),u=l.length>=this._nextResultLimit,i.localCacheEnabled&&a.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:u?"cache_hit":"cache_miss",max_db_size:null!==(t=null===(e=i.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:i.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),u&&(null===(n=this._backgroundSync)||void 0===n?void 0:n.isWrappingMessages(l))?[3,3]:(c=!1,[4,Bi((function(){return w(d,0,void 0,(function(){var e,t,n,r,i,s,u,d,h=this;return A(this,(function(f){switch(f.label){case 0:return e=ms.of(this._iid).cacheContext,[4,this._getRemoteMessages(o,{nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:e.localCacheEnabled,sdkSource:ll.EXTERNAL_COLLECTION})];case 1:return t=f.sent(),(l=this._filterUnderOffsetMessage(t.messages)).length>0&&((n=this._syncRange).extends.apply(n,R([],O(l.map((function(e){return e.createdAt}))),!1)),(null===(r=this._backgroundSync)||void 0===r?void 0:r.range.overlap(this._syncRange))&&t.isContinuousMessages&&(c=!0,null===(i=this._backgroundSync)||void 0===i||i.range.extends(this._syncRange.bottom))),l=l.filter((function(e){return Tp(h._messages,e)<0})),this._hasNext=null!==(s=t.hasNext)&&void 0!==s?s:l.length>=this._nextResultLimit,c&&a.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:"cache_fetch",max_db_size:null!==(d=null===(u=e.localCacheConfig)||void 0===u?void 0:u.maxSize)&&void 0!==d?d:0,use_local_cache:e.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}}))}))}))]);case 2:return h.sent(),this._addMessagesToView(l,os.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=l.length>=this._nextResultLimit,l.length>0&&this._addMessagesToView(l,os.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingNext=!1,[2,l]}}))}))},e.prototype.removeFailedMessage=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:if(this._isDisposed)throw new z({code:k.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,this._channelManager.removeFailedMessageFromCache(e)];case 1:return n.sent(),(t=this._unsentMessages.findIndex((function(t){return t.reqId===e})))>-1&&this._unsentMessages.splice(t,1),[2]}}))}))},e.prototype.dispose=function(){var e,t,n,r=this;if(!this._isDisposed){this._isDisposed=!0;var i=ms.of(this._iid),a=i.cacheContext,s=i.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._runIfHandleableWithGroupChannel((function(e){e.myMemberState!==zh.NONE&&(r._channel._updateMessageCollectionLastAccessedAt(),s.dispatch(new wf({channels:[r._channel],context:{source:os.CHANNEL_LASTACCESSEDAT_UPDATED}})))})),a.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),null===(n=this._pollChangelogSync)||void 0===n||n.close(),this._channelManager.unsubscribeChannelEvent(this._key),this._channelManager.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},e}()),Hp={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},Gp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.token,a=t.limit,s=t.order,o=t.mutedMemberFilter,l=t.memberStateFilter,u=t.nicknameStartsWithFilter,c=t.operatorFilter;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/members"),n.params={token:i,limit:a,order:s,muted_member_filter:o,member_state_filter:l,nickname_startswith:u,operator_filter:c,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},n}return I(t,e),t}(it),zp=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.members=[];var i=n.next,a=n.members;return r.token=i,a&&a.length>0&&(r.members=a.map((function(e){return new cf(t,e)}))),r}return I(t,e),t}(at);!function(e){e.ALL="all",e.MUTED="muted",e.UNMUTED="unmuted"}(Lp||(Lp={})),function(e){e.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",e.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(Pp||(Pp={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Fp||(Fp={}));var Vp=function(e){function t(t,n,r){var i,a,s,o,l=this;return(l=e.call(this,t,n,le.GROUP,r)||this).mutedMemberFilter=Lp.ALL,l.memberStateFilter=Fp.ALL,l.nicknameStartsWithFilter=null,l.operatorFilter=of.ALL,l.order=Pp.MEMBER_NICKNAME_ALPHABETICAL,l.mutedMemberFilter=null!==(i=r.mutedMemberFilter)&&void 0!==i?i:Lp.ALL,l.memberStateFilter=null!==(a=r.memberStateFilter)&&void 0!==a?a:Fp.ALL,l.nicknameStartsWithFilter=null!==(s=r.nicknameStartsWithFilter)&&void 0!==s?s:null,l.order=null!==(o=r.order)&&void 0!==o?o:Pp.MEMBER_NICKNAME_ALPHABETICAL,l}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&Y(Lp,this.mutedMemberFilter)&&Y(Fp,this.memberStateFilter)&&(W("string",this.nicknameStartsWithFilter)||null===this.nicknameStartsWithFilter)&&Y(of,this.operatorFilter)&&Y(Pp,this.order)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Gp(Ae(S(S({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(zp),i=r.members,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),qp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.accessCode;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/accept"),n.params={user_id:i,access_code:a},n}return I(t,e),t}(it),Kp=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _m(t,n),r.channel.myMemberState=zh.JOINED,r}return I(t,e),t}(at),Wp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.isDistinct,a=t.isPublic,s=t.isDiscoverable,o=t.coverUrl,l=t.coverImage,u=t.accessCode,c=t.name,d=t.data,h=t.customType,f=t.operatorUserIds,p=t.messageSurvivalSeconds;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r)),n.params=we({is_distinct:i,is_public:a,is_discoverable:s,name:c,data:d,custom_type:h,cover_url:o,cover_file:l,access_code:u,operator_ids:f,message_survival_seconds:p}),n}return I(t,e),t}(it),Yp=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _m(t,n),r}return I(t,e),t}(at),Qp=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(De,"/").concat(encodeURIComponent(r)),n}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var Xp=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/hide"),n}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Zp=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=t.countPreference,a=e.call(this)||this;return a.method=Me.PUT,a.path="".concat(Re,"/").concat(encodeURIComponent(n),"/count_preference/").concat(encodeURIComponent(r)),a.params={count_preference:i},a}return I(t,e),t}(it),Jp=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.countPreference=n.count_preference,r}return I(t,e),t}(at),$p=function(e){function t(t){var n=this,r=t.channelUrl,i=t.locale;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(De,"/").concat(encodeURIComponent(r),"/reset_user_history"),n.params=we({locale:i}),n}return I(t,e),t}(it),em=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts_message_offset;return r.messageOffsetTimestamp=i,r}return I(t,e),t}(at),tm=S(S({},zl),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),nm=S(S({},ql),{scheduledAt:void 0}),rm=function(e){function t(t){var n,r,i=this;i=e.call(this)||this;var a=[];t.mentionType===pe.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map((function(e){return e.userId}))));var s=t.channelType,o=t.channelUrl,l=t.scheduledMessageId;return i.method=Me.PUT,i.path="".concat(Je(s),"/").concat(encodeURIComponent(o),"/scheduled_messages/").concat(encodeURIComponent(l)),i.params=we(Ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:fe.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:null===(n=t._thumbnails)||void 0===n?void 0:n.map((function(e){return io.payloadify(e)})),custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:a,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return vo.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption})),i}return I(t,e),t}(it),im=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new el(t,n),r}return I(t,e),t}(at),am=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===pe.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,s=t.channelUrl,o=t.scheduledMessageId;return r.method=Me.PUT,r.path="".concat(Je(a),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(o)),r.params=we(Ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:fe.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return vo.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?mo.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.message=new Yo(t,n),r}),e)}(at);var sm,om,lm=function(e){function t(t){var n=e.call(this)||this,r=t.channelType,i=t.channelUrl,a=t.scheduledMessageId;return n.method=Me.DELETE,n.path="".concat(Je(r),"/").concat(encodeURIComponent(i),"/scheduled_messages/").concat(encodeURIComponent(a)),n}return I(t,e),t}(it),um=function(e){function t(t){var n=e.call(this)||this,r=t.channelType,i=t.channelUrl,a=t.scheduledMessageId;return n.method=Me.POST,n.path="".concat(Je(r),"/").concat(encodeURIComponent(i),"/scheduled_messages/").concat(encodeURIComponent(a),"/send_now"),n}return I(t,e),t}(it),cm=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=t.pushTriggerOption,a=e.call(this)||this;return a.method=Me.PUT,a.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),a.params={push_trigger_option:i},a}return I(t,e),t}(it),dm=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return I(t,e),t}(at),hm=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=e.call(this)||this;return i.method=Me.GET,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),i}return I(t,e),t}(it),fm=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return I(t,e),t}(at),pm=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Je(i),"/").concat(encodeURIComponent(r),"/message_purge_offset"),n}return I(t,e),t}(it),mm=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.message_purge_offset;return r.messageDeletionTimestamp=i,r}return I(t,e),t}(at);!function(e){e.ALL="all",e.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",e.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",e.OFF="off"}(sm||(sm={})),function(e){e.UNHIDDEN="unhidden",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(om||(om={}));var gm,_m=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T=this;return(T=e.call(this,t,n)||this)._unreadMemberStateMap=new Map,T._undeliveredMemberStateMap=new Map,T._typingStatus=new Map,T._lastMemberCountUpdated=0,T._typingStarted=0,T._typingEnded=0,T._hasBotInfo={general:!1,ai:!1},T.isDistinct=!1,T.isSuper=!1,T.isBroadcast=!1,T.isExclusive=!1,T.isPublic=!1,T.isDiscoverable=!0,T.isChatNotification=!1,T.isAccessCodeRequired=!1,T.isPushEnabled=!1,T.unreadMessageCount=0,T.unreadMentionCount=0,T.totalUnreadReplyCount=0,T.members=[],T.memberCount=0,T.joinedMemberCount=0,T.hiddenState=om.UNHIDDEN,T.lastMessage=null,T.messageOffsetTimestamp=0,T.messageSurvivalSeconds=-1,T.myMemberState=zh.NONE,T.myRole=ue.NONE,T.myMutedState=ce.UNMUTED,T.myLastRead=0,T.myCountPreference=sm.ALL,T.myPushTriggerOption=P.DEFAULT,T.inviter=null,T.invitedAt=0,T.joinedAt=0,T.lastPinnedMessage=null,T._latestMessageInfo=null,T._pinnedMessagesUpdatedAt=0,T._myMutedRemainingTime=-1,T._messageDeletionTimestamp=0,T.channelType=le.GROUP,T.isDistinct=null!==(i=n.is_distinct)&&void 0!==i&&i,T.isSuper=null!==(a=n.is_super)&&void 0!==a&&a,T.isBroadcast=null!==(s=n.is_broadcast)&&void 0!==s&&s,T.isExclusive=null!==(o=n.is_exclusive)&&void 0!==o&&o,T.isPublic=null!==(l=n.is_public)&&void 0!==l&&l,T.isDiscoverable=null!==(u=n.is_discoverable)&&void 0!==u?u:T.isPublic,T.isChatNotification=null!==(c=n.is_chat_notification)&&void 0!==c&&c,T.isAccessCodeRequired=null!==(d=n.is_access_code_required)&&void 0!==d&&d,T.isPushEnabled=null!==(h=n.is_push_enabled)&&void 0!==h&&h,Array.isArray(n.members)&&(r=T.members).push.apply(r,R([],O(n.members.map((function(e){return new cf(T._iid,e)}))),!1)),T.memberCount=null!==(f=n.member_count)&&void 0!==f?f:0,T.joinedMemberCount=null!==(p=n.joined_member_count)&&void 0!==p?p:0,T.hiddenState=Y(om,n.hidden_state)?n.hidden_state:om.UNHIDDEN,T.messageOffsetTimestamp=null!==(m=n.ts_message_offset)&&void 0!==m?m:0,T.messageSurvivalSeconds=null!==(g=n.message_survival_seconds)&&void 0!==g?g:-1,T.lastMessage=n.last_message?$o(T._iid,S({channel_type:T.channelType},n.last_message)):null,n.read_receipt&&Object.keys(n.read_receipt).forEach((function(e){W("number",n.read_receipt[e])&&T._updateUnreadMemberState(e,n.read_receipt[e])})),n.delivery_receipt&&Object.keys(n.delivery_receipt).forEach((function(e){W("number",n.delivery_receipt[e])&&T._updateUndeliveredMemberState(e,n.delivery_receipt[e])})),T.myMemberState=Y(zh,n.member_state)?n.member_state:zh.NONE,T.myRole=Y(ue,n.my_role)?n.my_role:ue.NONE,Y(ce,n.is_muted)?T.myMutedState=n.is_muted:W("boolean",n.is_muted)?T.myMutedState=n.is_muted?ce.MUTED:ce.UNMUTED:T.myMutedState=ce.UNMUTED,T.myCountPreference=Y(sm,n.count_preference)?n.count_preference:sm.ALL,T.myPushTriggerOption=Y(P,n.push_trigger_option)?n.push_trigger_option:P.ALL,T.myLastRead=null!==(_=n.user_last_read)&&void 0!==_?_:0,T.inviter=n.inviter?new ga(T._iid,n.inviter):null,T.invitedAt=null!==(v=n.invited_at)&&void 0!==v?v:0,T.joinedAt=null!==(E=n.joined_ts)&&void 0!==E?E:0,T._updateUnreadCount(null!==(y=n.unread_message_count)&&void 0!==y?y:0,null!==(b=n.unread_mention_count)&&void 0!==b?b:0),T.totalUnreadReplyCount=null!==(C=n.total_unread_thread_message_count)&&void 0!==C?C:0,T.lastPinnedMessage=n.latest_pinned_message?$o(T._iid,S({channel_type:T.channelType},n.latest_pinned_message)):null,n.latest_message&&(T._latestMessageInfo={messageId:n.latest_message.message_id,createdAt:n.latest_message.created_at}),T._hasBotInfo={general:!!n.has_bot,ai:!!n.has_ai_bot},T._messageDeletionTimestamp=null!==(N=n.message_purge_offset)&&void 0!==N?N:0,T}return I(t,e),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.hiddenState!==om.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUnreadMemberState",{get:function(){var e,t,n={};try{for(var r=M(this._unreadMemberStateMap),i=r.next();!i.done;i=r.next()){var a=O(i.value,2),s=a[0],o=a[1];n[s]=o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUndeliveredMemberState",{get:function(){var e,t,n={};try{for(var r=M(this._undeliveredMemberStateMap),i=r.next();!i.done;i=r.next()){var a=O(i.value,2),s=a[0],o=a[1];n[s]=o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBot",{get:function(){return this._hasBotInfo.general},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasAiBot",{get:function(){return this._hasBotInfo.ai},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageDeletionTimestamp",{get:function(){return this._messageDeletionTimestamp},enumerable:!1,configurable:!0}),t.payloadify=function(t){return we(Ae(S(S({},e.payloadify.call(this,t)),{is_access_code_required:t.isAccessCodeRequired,is_distinct:t.isDistinct,is_super:t.isSuper,is_broadcast:t.isBroadcast,is_exclusive:t.isExclusive,is_public:t.isPublic,is_discoverable:t.isDiscoverable,is_muted:t.myMutedState,is_push_enabled:t.isPushEnabled,unread_message_count:t.unreadMessageCount,unread_mention_count:t.unreadMentionCount,total_unread_thread_message_count:t.totalUnreadReplyCount,push_trigger_option:t.myPushTriggerOption,count_preference:t.myCountPreference,hidden_state:t.hiddenState,member_count:t.memberCount,joined_member_count:t.joinedMemberCount,member_state:t.myMemberState,my_role:t.myRole,user_last_read:t.myLastRead,ts_message_offset:t.messageOffsetTimestamp,message_survival_seconds:t.messageSurvivalSeconds,read_receipt:t.cachedUnreadMemberState,delivery_receipt:t.cachedUndeliveredMemberState,members:t.members.map((function(e){return cf.payloadify(e)})),last_message:t.lastMessage?Jo(t.lastMessage):null,inviter:t.inviter?ga.payloadify(t.inviter):null,invited_at:t.invitedAt,joined_ts:t.joinedAt,latest_pinned_message:t.lastPinnedMessage?Jo(t.lastPinnedMessage):null,latest_message:t._latestMessageInfo?{message_id:t._latestMessageInfo.messageId,created_at:t._latestMessageInfo.createdAt}:null,has_bot:t.hasBot,has_ai_bot:t.hasAiBot,message_purge_offset:t.messageDeletionTimestamp})))},t.prototype._shouldUpdateLastMessageWith=function(e){if(e.silent)return!1;var t=ms.of(this._iid).appInfo;switch(null==t?void 0:t.lastMessageThreadingPolicy){case qi.NONE:case qi.INCLUDE_REPLY:break;case qi.EXCLUDE_REPLY:if(e.parentMessageId>0)return!1;break;case qi.INCLUDE_REPLY_TO_CHANNEL:if(e instanceof Go&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!this.lastMessage||this.lastMessage.createdAt<e.createdAt||this.lastMessage.createdAt===e.createdAt&&this.lastMessage.messageId===e.messageId&&this.lastMessage.updatedAt<e.updatedAt},t.prototype._tryUpdateLastMessageAndCallEvents=function(e,t){var n=ms.of(this._iid).dispatcher,r=Np.of(this._iid);this._updateLastMessage(t),r.handlers.map((function(t){t.onChannelChanged&&t.onChannelChanged(e)})),n.dispatch(new wf({channels:[e],context:{source:os.EVENT_MESSAGE_SENT}}))},t.prototype._shouldUpdateUnreadCountWith=function(e){var t=ms.of(this._iid).appInfo;switch(null==t?void 0:t.unreadCountThreadingPolicy){case Vi.NONE:case Vi.INCLUDE_REPLY:break;case Vi.EXCLUDE_REPLY:if(e.parentMessageId>0)return!1;break;case Vi.INCLUDE_REPLY_TO_CHANNEL:if(e instanceof Go&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},t.prototype._updateLastMessage=function(e){return!!this._shouldUpdateLastMessageWith(e)&&(this.lastMessage=e,!0)},t.prototype._updateUnreadCount=function(e,t){if("number"==typeof e&&e>=0)if(this.myCountPreference===sm.ALL||this.myCountPreference===sm.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var n=ms.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=n&&e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&(this.myCountPreference===sm.ALL||this.myCountPreference===sm.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=t:this.unreadMentionCount=0},t.prototype._updateUnreadMemberState=function(e,t){var n=this._unreadMemberStateMap.get(e);return(!n||n<t)&&(this._unreadMemberStateMap.set(e,t),ms.of(this._iid).sdkState.userId===e&&(this.myLastRead=t),!0)},t.prototype._updateUndeliveredMemberState=function(e,t){var n=this._undeliveredMemberStateMap.get(e);return(!n||n<t)&&(this._undeliveredMemberStateMap.set(e,t),!0)},t.prototype._updateTypingStatus=function(e,t){void 0===t&&(t=(new Date).getTime()),t>0?this._typingStatus.set(e.userId,{user:e,ts:t}):this._typingStatus.delete(e.userId)},t.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},t.prototype._setLatestMemberCount=function(e,t,n){var r=!1;return n>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=n,r=e!==this.memberCount||t!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=t),r},t.prototype.isReadMessage=function(e){var t=ms.of(this._iid).sdkState,n=this._unreadMemberStateMap.get(t.userId);return!!n&&n>=e.createdAt},t.prototype.serialize=function(){var e=this;return ha(this,(function(t){t.cachedUnreadMemberState=e.cachedUnreadMemberState,t.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState,Object.assign(t,e._serializeCachedMetaData())}))},t.prototype.createMessageCollection=function(e){return void 0===e&&(e={}),new jp(this._iid,S(S({},e),{channel:this}))},t.prototype.createMemberListQuery=function(e){return void 0===e&&(e={}),new Vp(this._iid,this.url,e)},t.prototype.createThreadedParentMessageListQuery=function(e){return void 0===e&&(e={}),new Th(this._iid,this.url,this.channelType,e)},t.prototype.addMember=function(e,t){if(void 0===t&&(t=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var n=this.members.findIndex((function(t){return t.userId===e.userId}));if(n>-1){var r=this.members[n];r.state===zh.JOINED&&(e.state=r.state),this.members.splice(n,1),this.memberCount--}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,t),this._updateUndeliveredMemberState(e.userId,t)}},t.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var t=e instanceof cf?e.userId:e,n=this.members.findIndex((function(e){return e.userId===t}));if(n>-1)return this.members.splice(n,1),this.memberCount--,!0}return!1},t.prototype.getUnreadMemberCount=function(e){var t,n;if(e instanceof Go&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=ms.of(this._iid).sdkState,i=e.createdAt,a=0;try{for(var s=M(this.members),o=s.next();!o.done;o=s.next()){var l=o.value;r.userId!==l.userId&&l.state===zh.JOINED&&e.sender.userId!==l.userId&&(this.cachedUnreadMemberState[l.userId]||0)<i&&a++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a}return 0},t.prototype.getUndeliveredMemberCount=function(e){var t,n;if(e instanceof Go&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=ms.of(this._iid).sdkState,i=e.createdAt,a=0;try{for(var s=M(this.members),o=s.next();!o.done;o=s.next()){var l=o.value;r.userId!==l.userId&&l.state===zh.JOINED&&e.sender.userId!==l.userId&&(this.cachedUndeliveredMemberState[l.userId]||0)<i&&a++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a}return 0},t.prototype.getReadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=ms.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var i=e instanceof Go?e.sender:null,a=[];return this.members.forEach((function(s){if(t||s.userId!==r.userId&&s.userId!==(null==i?void 0:i.userId)){var o=n._unreadMemberStateMap.get(s.userId);o&&o>=e.createdAt&&a.push(s)}})),a},t.prototype.getUnreadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=ms.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var i=e instanceof Go?e.sender:null,a=[];return this.members.forEach((function(s){if(t||s.userId!==r.userId&&s.userId!==(null==i?void 0:i.userId)){var o=n._unreadMemberStateMap.get(s.userId);o&&o<e.createdAt&&a.push(s)}})),a},t.prototype.getReadStatus=function(e){var t=this;void 0===e&&(e=!1);var n=ms.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(i){if(e||i.userId!==n.userId){var a=t._unreadMemberStateMap.get(i.userId);r[i.userId]=new bo(t._iid,{channel_url:t.url,channel_type:t.channelType,user:cf.payloadify(i),ts:null!=a?a:0})}})),r},t.prototype.getDeliveryStatus=function(e){var t=this;void 0===e&&(e=!0);var n=ms.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(i){if(e||i.userId!==n.userId){var a=t._undeliveredMemberStateMap.get(i.userId);r[i.userId]=new df(t._iid,{channel_url:t.url,channel_type:t.channelType,user:cf.payloadify(i),ts:null!=a?a:0})}})),r},t.prototype.getTypingUsers=function(){var e=[];return this._typingStatus.forEach((function(t){var n=t.user;e.push(n)})),e},t.prototype.invalidateTypingStatus=function(){var e=this,t=ms.of(this._iid).typingIndicatorInvalidateTime,n=Date.now(),r=!1;return this._typingStatus.forEach((function(i,a){var s=i.ts;n-s>=t&&(e._typingStatus.delete(a),r=!0)})),r},t.prototype.refresh=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return[2,this._refresh()]}))}))},t.prototype._refresh=function(e){return void 0===e&&(e=!1),w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return t=ms.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new xf({channelUrl:this.url}),[4,n.send(i)];case 1:return a=o.sent(),s=a.as(Df).channel,this._update(s),e||r.dispatch(new wf({channels:[s],context:{source:os.REFRESH_CHANNEL}})),[2,this]}}))}))},t.prototype.freeze=function(){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.prototype.freeze.call(this)];case 1:return t.sent(),ms.of(this._iid).dispatcher.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_FROZEN},isWebSocketEventComing:!0})),[2]}}))}))},t.prototype.unfreeze=function(){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.prototype.unfreeze.call(this)];case 1:return t.sent(),ms.of(this._iid).dispatcher.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_UNFROZEN},isWebSocketEventComing:!0})),[2]}}))}))},t.prototype.updateChannel=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return t=S(S({},Hp),e),pa((u=t,W("string",u.coverUrl,!0)&&($(u.coverImage)||W("string",u.coverImage,!0))&&W("boolean",u.isDistinct,!0)&&W("boolean",u.isPublic,!0)&&W("boolean",u.isDiscoverable,!0)&&W("string",u.accessCode,!0)&&W("string",u.name,!0)&&W("string",u.data,!0)&&W("string",u.customType,!0)&&X("string",u.operatorUserIds,!0)&&W("number",u.messageSurvivalSeconds,!0))).throw(z.invalidParameters),n=ms.of(this._iid),r=n.dispatcher,i=n.requestQueue,a=new Wp(S({channelUrl:this.url},t)),[4,i.send(a)];case 1:return s=l.sent(),o=s.as(Yp).channel,this._update(o),r.dispatch(new wf({channels:[o],context:{source:os.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,this]}var u}))}))},t.prototype.invite=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return pa(e.every((function(e){return e instanceof ga}))).throw(z.invalidParameters),[2,this.inviteWithUserIds(e.map((function(e){return e.userId})))]}))}))},t.prototype.inviteWithUserIds=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.dispatcher,r=t.requestQueue,i=t.sessionManager,a=new rp({channelUrl:this.url,userIds:e}),[4,r.send(a)];case 1:return s=l.sent(),o=s.as(ip).channel,this._update(o),n.dispatch(new wf({channels:[o],context:{source:os.EVENT_CHANNEL_INVITED,inviter:i.currentUser,invitees:[]},isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.join=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return pa(W("string",e,!0)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new Jf({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,i.send(a)];case 1:return s=l.sent(),(o=s.as($f).channel).myMemberState=this.myMemberState=zh.JOINED,this._update(o),n.dispatch(new wf({channels:[o],context:{source:os.EVENT_CHANNEL_JOINED,users:[]},isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.leave=function(e){return void 0===e&&(e=!1),w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new tp({channelUrl:this.url,userId:n.userId,shouldRemoveOperatorStatus:e}),[4,r.send(i)];case 1:return a.sent(),this.myMemberState=zh.NONE,[2]}}))}))},t.prototype.acceptInvitation=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return pa(W("string",e,!0)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new qp({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,i.send(a)];case 1:return s=l.sent(),(o=s.as(Kp).channel).myMemberState=this.myMemberState=zh.JOINED,this._update(o),n.dispatch(new wf({channels:[o],context:{source:os.EVENT_CHANNEL_ACCEPTED_INVITE},isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.declineInvitation=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new sp({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.myMemberState=zh.NONE,[2,this]}}))}))},t.prototype.sendUserMessage=function(t){var n=this,r=new Sl,i=ms.of(this._iid).dispatcher,a=kh.of(this._iid);return e.prototype.sendUserMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){a.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),Np.of(n._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new wf({channels:[n],context:{source:os.EVENT_MESSAGE_SENT}})),r._trigger(e)})),r},t.prototype.updateUserMessage=function(t,n){return w(this,0,void 0,(function(){var r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:return r=ms.of(this._iid).dispatcher,[4,e.prototype.updateUserMessage.call(this,t,n)];case 1:return i=l.sent(),a=this._updateLastMessage(i),s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&(Np.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)})),r.dispatch(new wf({channels:[this],context:{source:s?os.EVENT_PINNED_MESSAGE_UPDATED:os.EVENT_MESSAGE_UPDATED}}))),s&&Np.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(o)})),r.dispatch(new vs({messages:[i],source:os.EVENT_MESSAGE_UPDATED})),[2,i]}}))}))},t.prototype._autoResendUserMessage=function(t){var n=this,r=new Sl,i=ms.of(this._iid).dispatcher,a=kh.of(this._iid);return e.prototype._autoResendUserMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Np.of(n._iid);a.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new wf({channels:[n],context:{source:os.EVENT_MESSAGE_SENT}})),r._trigger(e)})),r},t.prototype.sendFileMessage=function(t){var n=this,r=new Sl,i=ms.of(this._iid).dispatcher,a=kh.of(this._iid);return e.prototype.sendFileMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Np.of(n._iid);a.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new wf({channels:[n],context:{source:os.EVENT_MESSAGE_SENT}})),r._trigger(e)})),r},t.prototype.sendMultipleFilesMessage=function(t){var n=this,r=new Cc,i=ms.of(this._iid).dispatcher;return e.prototype.sendMultipleFilesMessage.call(this,t).onPending((function(e){r._trigger(e)})).onFailed((function(e,t){r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Np.of(n._iid);n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new wf({channels:[n],context:{source:os.EVENT_MESSAGE_SENT}})),r._trigger(e)})).onFileUploaded((function(e,t,n,i){r._triggerOnFileUploaded(e,t,n,i)})),r},t.prototype.updateFileMessage=function(t,n){return w(this,0,void 0,(function(){var r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:return r=ms.of(this._iid).dispatcher,[4,e.prototype.updateFileMessage.call(this,t,n)];case 1:return i=l.sent(),a=this._updateLastMessage(i),s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&(Np.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)})),r.dispatch(new wf({channels:[this],context:{source:s?os.EVENT_PINNED_MESSAGE_UPDATED:os.EVENT_MESSAGE_UPDATED}}))),s&&Np.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(o)})),r.dispatch(new vs({messages:[i],source:os.EVENT_MESSAGE_UPDATED})),[2,i]}}))}))},t.prototype._autoResendFileMessage=function(t){var n=this,r=new Sl,i=ms.of(this._iid).dispatcher,a=kh.of(this._iid);return e.prototype._autoResendFileMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Np.of(n._iid);a.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new wf({channels:[n],context:{source:os.EVENT_MESSAGE_SENT}})),r._trigger(e)})),r},t.prototype.deleteMessage=function(t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,e.prototype.deleteMessage.call(this,t)];case 1:return n.sent(),0===t.messageId&&t instanceof Go&&ms.of(this._iid).dispatcher.dispatch(new Ns({reqId:t.reqId,source:os.EVENT_MESSAGE_DELETED})),[2]}}))}))},t.prototype.hide=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return t=S(S({},lp),e),pa((c=t,W("boolean",c.hidePreviousMessages,!0)&&W("boolean",c.allowAutoUnhide,!0))).throw(z.invalidParameters),n=ms.of(this._iid),r=n.dispatcher,i=n.sdkState,a=n.requestQueue,s=new up(S({channelUrl:this.url,userId:i.userId},t)),[4,a.send(s)];case 1:return o=u.sent(),l=o.as(cp).messageOffsetTimestamp,this.hiddenState=t.allowAutoUnhide?om.HIDDEN_ALLOW_AUTO_UNHIDE:om.HIDDEN_PREVENT_AUTO_UNHIDE,t.hidePreviousMessages&&this._updateUnreadCount(0,0),l&&(this.messageOffsetTimestamp=l),r.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_HIDDEN},isWebSocketEventComing:!0})),[2,this]}var c}))}))},t.prototype.unhide=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new Xp({channelUrl:this.url}),[4,n.send(r)];case 1:return i.sent(),this.hiddenState=om.UNHIDDEN,t.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_UNHIDDEN},isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.delete=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new Qp({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.markAsRead=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.dispatcher,r=e.requestQueue,i=new Co({channelUrl:this.url}),[4,r.send(i)];case 1:return a=l.sent(),s=a.as(No).readStatus,this._updateUnreadMemberState(t.userId,s.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),Np.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)}))),n.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_READ}})),[2]}}))}))},t.prototype.markAsDelivered=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new vp({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),[2]}}))}))},t.prototype.startTyping=function(){return w(this,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return e=ms.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingStarted>=n?(this._typingStarted=r,this._typingEnded=0,i=new hp({channelUrl:this.url,time:this._typingStarted}),[4,t.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},t.prototype.endTyping=function(){return w(this,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return e=ms.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingEnded>=n?(this._typingStarted=0,this._typingEnded=r,i=new pp({channelUrl:this.url,time:this._typingStarted}),[4,t.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},t.prototype.createScheduledUserMessage=function(e){e=S(S({},Qd),e),pa(function(e){return Dl(e)&&W("number",e.scheduledAt,!0)}(e)).throw(z.invalidParameters);var t=new Sl;return this._createScheduledUserMessage(e,t),t},t.prototype.updateScheduledUserMessage=function(e,t){return w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){switch(a.label){case 0:return n=S(S({},nm),t),pa((s=n,Kl(s)&&W("number",s.scheduledAt,!0))).throw(z.invalidParameters),r=ms.of(this._iid).requestQueue,i=new am(S({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,r.send(i)];case 1:return[2,a.sent().as(nc).message]}var s}))}))},t.prototype.createScheduledFileMessage=function(e){var t=this;e=S(S({},Xd),e),pa(function(e){return Al(e)&&W("number",e.scheduledAt)&&($(e.file)||W("string",e.fileUrl))&&W("string",e.fileName,!0)&&W("string",e.mimeType,!0)&&W("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return W("object",e)&&e.maxWidth>0&&e.maxHeight>0})))}(e)).throw(z.invalidParameters);var n=Date.now(),r=this._generateRequestId(),i=new Sl;return Sa(2).then((function(){var a=t._createPendingScheduledFileMessage(e,r,n);Fi((function(){return w(t,0,void 0,(function(){return A(this,(function(e){return[2,i._trigger(a)]}))}))}))})),$(e.file)?this._uploadFileAndUpdateParams(e).then((function(){return t._createScheduledFileMessage(e,i,r,n)})):this._createScheduledFileMessage(e,i,r,n),i},t.prototype.updateScheduledFileMessage=function(e,t){return w(this,0,void 0,(function(){var n,r;return A(this,(function(i){switch(i.label){case 0:return n=S(S({},tm),t),pa((a=n,Vl(a)&&W("number",a.scheduledAt,!0)&&($(a.file)||W("string",a.fileUrl))&&W("string",a.fileName,!0)&&W("string",a.mimeType,!0)&&W("number",a.fileSize,!0)&&(null===a.thumbnailSizes||void 0===a.thumbnailSizes||a.thumbnailSizes.every((function(e){return W("object",e)&&e.maxWidth>0&&e.maxHeight>0}))))).throw(z.invalidParameters),$(n.file)?[4,this._uploadFileAndUpdateParams(n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return r=new rm(S({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,ms.of(this._iid).requestQueue.send(r)];case 3:return[2,i.sent().as(im).message]}var a}))}))},t.prototype.cancelScheduledMessage=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=new lm({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,ms.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.sendScheduledMessageNow=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return t=new um({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,ms.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.getMyPushTriggerOption=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new hm({userId:t.userId,channelUrl:this.url}),[4,n.send(r)];case 1:return i=s.sent(),a=i.as(fm).pushTriggerOption,this.myPushTriggerOption=a,[2,a]}}))}))},t.prototype.setMyPushTriggerOption=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return pa(Y(P,e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new cm({userId:r.userId,channelUrl:this.url,pushTriggerOption:e}),[4,i.send(a)];case 1:return s=l.sent(),o=s.as(dm).pushTriggerOption,this.myPushTriggerOption=o,n.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,o]}}))}))},t.prototype.setMyCountPreference=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return pa(Y(sm,e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new Zp({channelUrl:this.url,userId:r.userId,countPreference:e}),[4,i.send(a)];case 1:return s=l.sent(),o=s.as(Jp).countPreference,this.myCountPreference=o,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),n.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,o]}}))}))},t.prototype.resetMyHistory=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return e=ms.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=e.sdkState,i=new $p({channelUrl:this.url,locale:r.localeForChatbot}),[4,n.send(i)];case 1:return a=o.sent(),s=a.as(em).messageOffsetTimestamp,this.messageOffsetTimestamp=s,this.lastMessage&&this.lastMessage.createdAt<s&&(this.lastMessage=null),this._updateUnreadCount(0,0),this.totalUnreadReplyCount=0,t.dispatch(new wf({channels:[this],context:{source:os.EVENT_CHANNEL_RESET_HISTORY},isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype._uploadFileAndUpdateParams=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c;return A(this,(function(d){switch(d.label){case 0:return $(e.file)?(t=ms.of(this._iid).requestQueue,n=new ao({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,t.send(n)]):[3,2];case 1:r=d.sent(),i=r.as(so),a=i.url,s=i.fileSize,o=void 0===s?e.fileSize:s,l=i.thumbnails,u=i.requireAuth,c=void 0!==u&&u,e.fileUrl=a,e.fileSize=o,e.requireAuth=c,e._thumbnails=l,d.label=2;case 2:return[2]}}))}))},t.prototype.resendMessage=function(e,t){var n,r=this;if(pa(e instanceof Go&&!e.scheduledInfo&&e.isResendable).throw(z.invalidParameters),e.isUserMessage()){var i=null!==(n=e.messageParams)&&void 0!==n?n:xl(e),a=new Sl;return this._sendUserMessage(i,Mc.RESEND,e.reqId).onPending((function(e){a._trigger(e)})).onFailed((function(e,t){a._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),a._trigger(e)})),a}if(e.isFileMessage()){var s=this._validateFailedFileMessageHasFile(e,t);pa(s).throw(z.invalidParameters),i=Hl(e,t);var o=new Sl;return this._sendFileMessage(i,Mc.RESEND,e.reqId).onPending((function(e){o._trigger(e)})).onFailed((function(e,t){o._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),o._trigger(e)})),o}if(e.isMultipleFilesMessage()){i=e.messageParams;var l=new Cc;return this._sendMultipleFilesMessage(i,Mc.RESEND,e.reqId).onPending((function(e){l._trigger(e)})).onFailed((function(e,t){l._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),l._trigger(e)})).onFileUploaded((function(e,t,n,r){l._triggerOnFileUploaded(e,t,n,r)})),l}},t.prototype.copyMessage=function(e,t){var n=this;if(pa(e instanceof Rc&&t instanceof Go&&t.sendingStatus===_e.SUCCEEDED&&this.url===t.channelUrl&&!t.scheduledInfo).throw(z.invalidParameters),t.isUserMessage()){pa(!t.poll).throw(z.notSupportedError);var r=Rl(t),i=new Sl;return e._sendUserMessage(r).onPending((function(e){i._trigger(e)})).onFailed((function(e,t){i._triggerFailed(e,t)})).onSucceeded((function(t){e.isGroupChannel()&&n._tryUpdateLastMessageAndCallEvents(e,t),i._trigger(t)})),i}if(t.isFileMessage()){r=Bl(t);var a=new Sl;return e._sendFileMessage(r).onPending((function(e){a._trigger(e)})).onFailed((function(e,t){a._triggerFailed(e,t)})).onSucceeded((function(t){e.isGroupChannel()&&n._tryUpdateLastMessageAndCallEvents(e,t),a._trigger(t)})),a}if(t.isMultipleFilesMessage()){if(e.isGroupChannel()){r=function(e){var t,n,r;return null!==(t=e.messageParams)&&void 0!==t?t:Ae(S(S({},e),{isReplyToChannel:!1,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),pushNotificationDeliveryOption:ge.DEFAULT,isPinnedMessage:!1,fileInfoList:e.fileInfoList.map((function(e){var t;return{fileUrl:e.plainUrl,fileName:e.fileName,fileSize:e.fileSize,mimeType:e.mimeType,thumbnailSizes:null===(t=e.thumbnails)||void 0===t?void 0:t.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),_thumbnails:e.thumbnails,_uploadedMetaData:{requireAuth:e._requireAuth,isUploaded:!0}}}))}))}(t);var s=new Cc;return e._sendMultipleFilesMessage(r,Mc.COPY).onPending((function(e){s._trigger(e)})).onFailed((function(e,t){s._triggerFailed(e,t)})).onSucceeded((function(t){n._tryUpdateLastMessageAndCallEvents(e,t),s._trigger(t)})).onFileUploaded((function(e,t,n,r){s._triggerOnFileUploaded(e,t,n,r)})),s}throw z.channelTypeNotSupportedError}},t.prototype.getMessageDeletionTimestamp=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return e=ms.of(this._iid),t=e.requestQueue,n=e.dispatcher,r=new pm({channelUrl:this.url,channelType:this.channelType}),[4,t.send(r)];case 1:return i=s.sent(),a=i.as(mm).messageDeletionTimestamp,this._messageDeletionTimestamp=a,n.dispatch(new Mf({channel:this})),[2,a]}}))}))},t}(Rc),vm=function(){this.onUserMuted=At,this.onUserUnmuted=At,this.onUserBanned=At,this.onUserUnbanned=At,this.onChannelChanged=At,this.onChannelDeleted=At,this.onChannelFrozen=At,this.onChannelUnfrozen=At,this.onOperatorUpdated=At,this.onChannelMemberCountChanged=At,this.onMetaDataCreated=At,this.onMetaDataUpdated=At,this.onMetaDataDeleted=At,this.onMetaCounterCreated=At,this.onMetaCounterUpdated=At,this.onMetaCounterDeleted=At,this.onMessageReceived=At,this.onMessageUpdated=At,this.onMessageDeleted=At,this.onMentionReceived=At,this.onReactionUpdated=At,this.onThreadInfoUpdated=At},Em={},ym=function(){function e(e){var t=e._iid,n=e.limit,r=void 0===n?100:n,i=this;this.ref=0,this._iid=t,this._limit=r;var a,s=ms.of(this._iid),o=s.sdkState,l=s.dispatcher,u=s.logger,c=s.cacheContext,d=s.statManager;this._metadataKey=(a=o.userId,"sendbird:".concat(a,"@groupchannel/sync.meta"));var h,f=(h=o.userId,"sendbird:".concat(h,"@groupchannel/sync"));this._sync=new Hh(f,(function(){return w(i,0,void 0,(function(){var e,t,n,r,i,a,s,l,h,f,p,m,g,_,v,E;return A(this,(function(y){switch(y.label){case 0:return e={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(y.sent(),u.debug("channel background sync from",null===(h=this._metadata)||void 0===h?void 0:h.token),null===(f=this._metadata)||void 0===f?void 0:f.completed)return[3,14];t={includeEmpty:!0,includeMetaData:!0,hiddenChannelFilter:sf.ALL,order:vh.CHRONOLOGICAL},y.label=2;case 2:if(y.trys.push([2,9,12,13]),t.order!==vh.LATEST_LAST_MESSAGE)return[3,6];y.label=3;case 3:return y.trys.push([3,5,,6]),[4,c.preference.get(Zi(o.appId))];case 4:return n=y.sent(),t.includeChatNotification=Boolean(n),[3,6];case 5:return y.sent(),t.includeChatNotification=!1,[3,6];case 6:return[4,Np.of(this._iid).getMyGroupChannels(null!==(m=null===(p=this._metadata)||void 0===p?void 0:p.token)&&void 0!==m?m:"",t,this._limit,os.SYNC_CHANNEL_BACKGROUND)];case 7:return r=y.sent(),i=r.channels,a=r.token,e.hasNext=i.length>=this._limit&&!!a,e.nextToken=a,this._metadata&&(this._metadata.token=a,(l=this._metadata.range).extends.apply(l,R([],O(i.map((function(e){return e.createdAt}))),!1)),this._metadata.completed=!e.hasNext),u.debug("channel background sync progress",e),[4,this.saveMetadata()];case 8:return y.sent(),[3,13];case 9:return s=y.sent(),u.debug("channel background sync error",s),s instanceof z&&s.isInvalidTokenError?[4,this.clearMetaData()]:[3,11];case 10:y.sent(),y.label=11;case 11:throw s;case 12:return d.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_back_sync",event:"cache_fetch",max_db_size:null!==(_=null===(g=c.localCacheConfig)||void 0===g?void 0:g.maxSize)&&void 0!==_?_:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:null!==(E=null===(v=t.order)||void 0===v?void 0:v.toString())&&void 0!==E?E:"",collection_id:o.userId}})),[7];case 13:return[3,15];case 14:e.hasNext=!1,e.nextToken="",y.label=15;case 15:return[2,e]}}))}))})),this._connectionEventContext=l.on((function(e){e instanceof Ki&&(e.stateType===ji.CONNECTED?i.resume():i.pause())}))}return e.of=function(t){return Em[t]||(Em[t]=new e({_iid:t})),Em[t].ref++,Em[t]},e.clear=function(e){Em[e]&&(Em[e].close(),delete Em[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new bp({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.completed)},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,ms.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata={token:e?e.token:"",range:new bp(e?e.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!e&&e.completed},t.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._metadata?[4,ms.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetaData=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,ms.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e,t,n=ms.of(this._iid),r=n.logger;n.sessionManager.session.hasSession&&(r.debug("channel background sync resume()"),this._sync.start(null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.token)&&void 0!==t?t:""))},e.prototype.pause=function(){ms.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Em[this._iid])},e}(),bm={},Cm=function(){function e(e){var t=e._iid,n=this;this.ref=0,this._iid=t;var r,i=ms.of(this._iid),a=i.logger,s=i.sdkState,o=i.dispatcher,l=i.cacheContext,u=i.statManager;this._metadataKey=(r=s.userId,"sendbird:".concat(r,"@groupchannel/changelogs.meta")),this._subscribers=new Te;var c,d=(c=s.userId,"sendbird:".concat(c,"@groupchannel/changelogs"));this._sync=new Hh(d,(function(){return w(n,0,void 0,(function(){var e,t,n,r,i,o,c,d,h,f,p,m;return A(this,(function(g){switch(g.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:g.sent(),a.debug("channel changelog sync from",null===(f=this._metadata)||void 0===f?void 0:f.token),g.label=2;case 2:g.trys.push([2,9,,12]),t={includeEmpty:!0,includeMetaData:!0},g.label=3;case 3:return g.trys.push([3,5,,6]),[4,l.preference.get(Zi(s.appId))];case 4:return n=g.sent(),t.includeChatNotification=Boolean(n),[3,6];case 5:return g.sent(),t.includeChatNotification=!1,[3,6];case 6:return[4,Np.of(this._iid).getMyGroupChannelChangeLogs(null!==(m=null===(p=this._metadata)||void 0===p?void 0:p.token)&&void 0!==m?m:"",t,os.SYNC_CHANNEL_CHANGELOGS)];case 7:return r=g.sent(),i=r.updatedChannels,o=r.deletedChannelUrls,c=r.hasMore,d=r.token,this._subscribers.dispatch("progress",{updatedChannels:i,deletedChannelUrls:o,hasMore:c,token:d}),e.hasNext=c,e.nextToken=d,this._metadata&&(this._metadata.token=d),a.debug("channel changelog sync progress",e),[4,this.saveMetadata()];case 8:return g.sent(),l.localCacheEnabled&&u.put(new Et({type:rt.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_change_log_sync",event:i.length>0||o.length>0?"cache_miss":"cache_hit",max_db_size:i.length,use_local_cache:l.localCacheEnabled,starting_point:0,message_init_policy:o.length.toString(),collection_id:s.userId}})),[3,12];case 9:return h=g.sent(),a.debug("channel changelog sync error",h),h instanceof z&&h.isInvalidTokenError?[4,this.clearMetadata()]:[3,11];case 10:g.sent(),g.label=11;case 11:throw h;case 12:return[2,e]}}))}))})),this._sync.on("stop",(function(){n._subscribers.dispatch("pause")})),this._connectionEventContext=o.on((function(e){e instanceof Ki&&(e.stateType===ji.CONNECTED?n.resume():n.pause())}))}return e.of=function(t){return bm[t]||(bm[t]=new e({_iid:t})),bm[t].ref++,bm[t]},e.clear=function(e){bm[e]&&(bm[e].close(),delete bm[e])},Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._sync.isRunning},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return this._metadata?[3,2]:(e=ms.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=i.sent(),this._metadata={token:r?r.token:n},i.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return this._metadata?[4,ms.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,ms.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.on=function(e,t){return this._subscribers.on(e,t)},e.prototype.resume=function(){ms.of(this._iid).sessionManager.session.hasSession&&this._sync.start(0)},e.prototype.pause=function(){this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete bm[this._iid])},e}(),Nm=function(e,t){return e.findIndex((function(e){return e.isIdentical(t)}))},Tm=function(e,t,n){if(e.length>0){for(var r=Nm(e,t),i=0,a=e.length-1,s=Math.floor((i+a)/2);i<a;){var o=Im(e[s],t,n);if(o>0)a=s,s=Math.floor((i+a)/2);else{if(!(o<0))return{place:s,oldPosition:r};i=s+1,s=Math.floor((i+a)/2)}}return{place:Im(e[s],t,n)>=0?s:s+1,oldPosition:r}}return{place:e.length,oldPosition:-1}},Im=function(e,t,n){switch(n){case vh.LATEST_LAST_MESSAGE:return e.lastMessage&&t.lastMessage?0==(r=t.lastMessage.createdAt-e.lastMessage.createdAt)?t.createdAt-e.createdAt:r:e.lastMessage?-1:t.lastMessage?1:t.createdAt-e.createdAt;case vh.CHRONOLOGICAL:return t.createdAt-e.createdAt;case vh.CHANNEL_NAME_ALPHABETICAL:var r;return 0===(r=e.name.localeCompare(t.name))?e.createdAt-t.createdAt:r;default:return 0}},Sm=function(){function e(e,t){var n=t.filter,r=void 0===n?new ff:n,i=t.order,a=void 0===i?vh.LATEST_LAST_MESSAGE:i,s=t.limit,o=void 0===s?100:s,l=t.includeChangesOnInitialLoad,u=void 0!==l&&l,c=this;this.channels=[],this._isInitialized=!1,this._iid=e,this._key="gcc-".concat(Ce()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this._includeChangesOnInitialLoad=u,this.filter=r,this.order=a,this._hasMore=!0,this._token="",this._limit=o;var d=ms.of(this._iid),h=d.sdkState,f=d.cacheContext,p=d.dispatcher;f.localCacheEnabled&&(this._backgroundSync=ym.of(e),this._backgroundSync.resume()),this._changelogSync=Cm.of(e),this._changelogSync.resume(),Np.of(this._iid).subscribeChannelEvent(this._key,{onUpdate:function(e,t){var n=t.source;if(Sf(n)){var r=e.filter((function(e){return c.filter.match(e,h.userId)})),i=e.filter((function(e){return!c.filter.match(e,h.userId)})).map((function(e){return e.url}));r.length>0&&c._addChannelsToView(r,t),i.length>0&&c._removeChannelsFromView(i,t)}},onRemove:function(e,t){c._removeChannelsFromView(e,t)}}),p.on((function(e){e instanceof Ki&&(e.stateType===ji.CONNECTED?c._isGetRemoteChannelsSucceeded||w(c,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._revokeLoadMore()];case 1:return e.sent(),[2]}}))})):e.stateType===ji.LOGOUT&&c.dispose())}))}return Object.defineProperty(e.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),e.prototype.setGroupChannelCollectionHandler=function(e){this._handler=e},e.prototype._addChannelsToView=function(e,t,n){var r,i,a,s,o=this;void 0===n&&(n=!1);var l=[],u=[],c=[];try{for(var d=M(e),h=d.next();!h.done;h=d.next()){var f=h.value,p=Nm(this.channels,f);p>=0&&this.channels.splice(p,1);var m=Tm(this.channels,f,this.order).place;if(p<0)m===this.channels.length?!n&&this._hasMore||(l.push(f),this.channels.push(f)):(l.push(f),this.channels.splice(m,0,f));else switch(t.source){case os.EVENT_CHANNEL_UPDATED:case os.EVENT_MESSAGE_RECEIVED:case os.SYNC_CHANNEL_CHANGELOGS:case os.EVENT_MESSAGE_SENT:this.order===vh.CHANNEL_NAME_ALPHABETICAL&&this._hasMore&&m===this.channels.length?c.push(f):(this.channels.splice(m,0,f),u.push(f));break;default:this.channels.splice(m,0,f),u.push(f)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(c.length>0)try{for(var g=M(c),_=g.next();!_.done;_=g.next()){f=_.value;var v=Nm(this.channels,f);-1!==v&&this.channels.splice(v,1)}}catch(e){a={error:e}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}Sf(t.source)&&Fi((function(){return w(o,0,void 0,(function(){var e,n,r;return A(this,(function(i){return l.length>0&&(null===(e=this._handler)||void 0===e?void 0:e.onChannelsAdded)&&this._handler.onChannelsAdded(t,l),u.length>0&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelsUpdated)&&this._handler.onChannelsUpdated(t,u),c.length>0&&(null===(r=this._handler)||void 0===r?void 0:r.onChannelsDeleted)&&this._handler.onChannelsDeleted(t,c.map((function(e){return e.url}))),[2]}))}))}))},e.prototype._removeChannelsFromView=function(e,t){var n,r,i=this,a=[],s=function(e){var t=o.channels.findIndex((function(t){return t.url===e}));t>=0&&(a.push(o.channels[t].url),o.channels.splice(t,1))},o=this;try{for(var l=M(e),u=l.next();!u.done;u=l.next())s(u.value)}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return Sf(t.source)&&a.length>0&&Fi((function(){return w(i,0,void 0,(function(){var e;return A(this,(function(n){return(null===(e=this._handler)||void 0===e?void 0:e.onChannelsDeleted)&&this._handler.onChannelsDeleted(t,a),[2]}))}))})),a},e.prototype._getLocalChannels=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=Np.of(this._iid),t=this.channels.length>0?function(e,t){var n,r,i,a;switch(t){case vh.LATEST_LAST_MESSAGE:return null!==(r=null===(n=e.lastMessage)||void 0===n?void 0:n.createdAt)&&void 0!==r?r:e.createdAt;case vh.CHRONOLOGICAL:return e.createdAt;case vh.CHANNEL_NAME_ALPHABETICAL:return e.name;default:return null!==(a=null===(i=e.lastMessage)||void 0===i?void 0:i.createdAt)&&void 0!==a?a:e.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,e.getChannelsFromCache(t,this.filter,this.order,this._limit,t?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,n.sent()]}}))}))},e.prototype._getRemoteChannels=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:return[4,Np.of(this._iid).getMyGroupChannels(this._token,Ae(S(S({},this.filter),{userIdsFilter:this.filter.userIdsFilter,searchFilter:this.filter.searchFilter,order:this.order})),this._limit)];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasMore=!!n,[2,t]}}))}))},e.prototype._revokeLoadMore=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:if(this._isDisposed)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return e=t.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(e,{source:os.REQUEST_CHANNEL},!0),[3,4];case 3:return t.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}}))}))},e.prototype.loadMore=function(){var e;return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y=this;return A(this,(function(b){switch(b.label){case 0:if(this._isDisposed)throw new z({code:k.COLLECTION_DISPOSED,message:"Collection has been disposed."});return t=null,this._includeChangesOnInitialLoad&&0===this.channels.length&&this._changelogSync.isRunning?[4,new Promise((function(e){y._changelogSyncSubscriberContext=y._changelogSync.on("progress",(function(t){return e(t)})).on("pause",(function(){return e(null)}))}))]:[3,2];case 1:t=b.sent(),null===(e=this._changelogSyncSubscriberContext)||void 0===e||e.close(),b.label=2;case 2:return n=ms.of(this._iid),r=n.cacheContext,i=n.connectionManager,a=n.statManager,this._isInitialized?[3,5]:(this._isInitialized=!0,r.localCacheEnabled?[4,this._backgroundSync.loadMetadata()]:[3,4]);case 3:b.sent(),b.label=4;case 4:a.put(new $a({type:rt.FEATURE_LOCALCACHE,data:{use_local_cache:r.localCacheEnabled,collection_interface:{group_channel:!0}}})),b.label=5;case 5:return s=[],this._hasMore?!r.localCacheEnabled||i.isConnected&&!this._backgroundSync.completed?[3,7]:[4,Bi((function(){return w(y,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._getLocalChannels()];case 1:return s=e.sent(),[2]}}))}))}))]:[3,11];case 6:return b.sent(),this._hasMore=s.length>=this._limit,[3,10];case 7:return b.trys.push([7,9,,10]),[4,this._getRemoteChannels()];case 8:return s=b.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,10];case 9:return b.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,10];case 10:this._addChannelsToView(s,{source:os.REQUEST_CHANNEL},!0),b.label=11;case 11:if(t){try{for(o=M(t.updatedChannels),l=o.next();!l.done;l=o.next())u=l.value,(m=Nm(s,u))>=0?s[m]=u:(c=Tm(s,u,this.order).place,s.splice(c,0,u))}catch(e){g={error:e}}finally{try{l&&!l.done&&(_=o.return)&&_.call(o)}finally{if(g)throw g.error}}d=s.map((function(e){return e.url}));try{for(h=M(t.deletedChannelUrls),f=h.next();!f.done;f=h.next())p=f.value,(m=d.indexOf(p))>=0&&(s.splice(m,1),d.splice(m,1))}catch(e){v={error:e}}finally{try{f&&!f.done&&(E=h.return)&&E.call(h)}finally{if(v)throw v.error}}}return[2,s]}}))}))},e.prototype.dispose=function(){var e,t,n;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),null===(n=this._changelogSyncSubscriberContext)||void 0===n||n.close(),Np.of(this._iid).unsubscribeChannelEvent(this._key))},e}(),wm=function(e){function t(t){var n=this,r=t.token,i=t.limit,a=t.order,s=t.includeEmpty,o=t.membershipFilter,l=t.channelNameContainsFilter,u=t.channelUrlsFilter,c=t.customTypesFilter,d=t.customTypeStartsWithFilter,h=t.superChannelFilter,f=t.metadataOrderKeyFilter,p=t.metadataKey,m=t.metadataValues,g=t.metadataValueStartsWith,_=t.includeFrozen,v=t.includeMetaData;return(n=e.call(this)||this).method=Me.GET,n.path=De,n.params=we(Ae({token:r,limit:i,order:a,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:s,public_mode:tf.PUBLIC,public_membership_mode:o,name_contains:l,channel_urls:u,custom_types:c,custom_type_startswith:d,super_mode:h,metadata_order_key:f,metadata_key:p,metadata_values:m,metadata_value_startswith:g,show_frozen:_,show_metadata:v})),n}return I(t,e),t}(it),Am=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,a=n.channels,s=n.ts;return r.token=i,a&&a.length>0&&(r.channels=a.map((function(e){return e.ts=s,new _m(t,e)}))),r.ts="number"==typeof s?s:0,r}return I(t,e),t}(at);!function(e){e.ALL="all",e.JOINED="joined"}(gm||(gm={}));var Mm=function(e){function t(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_=this;return(_=e.call(this,t,n)||this).includeEmpty=!1,_.includeFrozen=!0,_.includeMetaData=!0,_.channelUrlsFilter=null,_.customTypesFilter=null,_.customTypeStartsWithFilter=null,_.channelNameContainsFilter=null,_.membershipFilter=gm.ALL,_.superChannelFilter=rf.ALL,_.metadataKey=null,_.metadataValues=null,_.metadataOrderKeyFilter=null,_.metadataValueStartsWith=null,_.order=Eh.CHRONOLOGICAL,_.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,_.includeFrozen=null===(i=n.includeFrozen)||void 0===i||i,_.includeMetaData=null===(a=n.includeMetaData)||void 0===a||a,_.channelUrlsFilter=null!==(s=n.channelUrlsFilter)&&void 0!==s?s:null,_.customTypesFilter=null!==(o=n.customTypesFilter)&&void 0!==o?o:null,_.customTypeStartsWithFilter=null!==(l=n.customTypeStartsWithFilter)&&void 0!==l?l:null,_.channelNameContainsFilter=null!==(u=n.channelNameContainsFilter)&&void 0!==u?u:null,_.membershipFilter=null!==(c=n.membershipFilter)&&void 0!==c?c:gm.ALL,_.superChannelFilter=null!==(d=n.superChannelFilter)&&void 0!==d?d:rf.ALL,_.metadataKey=null!==(h=n.metadataKey)&&void 0!==h?h:null,_.metadataValues=null!==(f=n.metadataValues)&&void 0!==f?f:null,_.metadataOrderKeyFilter=null!==(p=n.metadataOrderKeyFilter)&&void 0!==p?p:null,_.metadataValueStartsWith=null!==(m=n.metadataValueStartsWith)&&void 0!==m?m:null,_.order=null!==(g=n.order)&&void 0!==g?g:Eh.CHRONOLOGICAL,_}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("boolean",this.includeEmpty)&&W("boolean",this.includeFrozen)&&W("boolean",this.includeMetaData)&&W("string",this.channelNameContainsFilter,!0)&&X("string",this.channelUrlsFilter,!0)&&X("string",this.customTypesFilter,!0)&&W("string",this.customTypeStartsWithFilter,!0)&&Y(gm,this.membershipFilter)&&Y(rf,this.superChannelFilter)&&Y(Eh,this.order)&&W("string",this.metadataOrderKeyFilter,!0)&&W("string",this.metadataKey,!0)&&X("string",this.metadataValues,!0)&&W("string",this.metadataValueStartsWith,!0)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=ms.of(this._iid).requestQueue,n=new wm(Ae(S(S({},this),{token:this._token}))),[4,t.send(n)]):[3,2]):[3,5];case 1:return r=o.sent(),i=r.as(Am),a=i.channels,s=i.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,a];case 2:return[2,e];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),Om=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return I(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserJoined=At,t.onUserLeft=At,t.onUserReceivedInvitation=At,t.onUserDeclinedInvitation=At,t.onChannelHidden=At,t.onUnreadMemberStatusUpdated=At,t.onUndeliveredMemberStatusUpdated=At,t.onTypingStatusUpdated=At,t.onPollUpdated=At,t.onPollVoted=At,t.onPollDeleted=At,t.onPinnedMessageUpdated=At,t}return I(t,e),t}(vm)),Rm=function(e){function t(t){var n=this,r=t.token,i=t.limit,a=t.order,s=t.reverse,o=t.channelUrl,l=t.messageTypeFilter,u=t.scheduledStatus;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(ze),n.params=we(Ae({token:r,limit:i,reverse:s,channel_url:o,order:a,message_type:l,status:u})),n}return I(t,e),t}(it),km=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.scheduledMessages=[];var i=n.next,a=n.scheduled_messages;return r.token=i,r.scheduledMessages=a.map((function(e){return $o(t,e)})),r}return I(t,e),t}(at),xm=function(e){function t(t,n){var r,i,a,s,o,l=this;return(l=e.call(this,t,n)||this).channelUrl=null,l.order=null,l.reverse=!1,l.scheduledStatus=null,l.messageTypeFilter=he.ALL,l.channelUrl=null!==(r=n.channelUrl)&&void 0!==r?r:null,l.order=null!==(i=n.order)&&void 0!==i?i:null,l.reverse=null!==(a=n.reverse)&&void 0!==a&&a,l.scheduledStatus=null!==(s=n.scheduledStatus)&&void 0!==s?s:null,l.messageTypeFilter=null!==(o=n.messageTypeFilter)&&void 0!==o?o:he.ALL,l}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("string",this.channelUrl,!0)&&(Y(yh,this.order)||null===this.order)&&W("boolean",this.reverse)&&(X(Uo,this.scheduledStatus)||null===this.scheduledStatus)&&Y(he,this.messageTypeFilter)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new Rm(Ae(S(S({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(km),i=r.scheduledMessages,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(xs),Dm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="groupChannel",t}return I(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,l=n.onlineDetector,u=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:l,cacheContext:u}),this._manager=new Np(t,{sdkState:r,cacheContext:u,dispatcher:i,sessionManager:a,requestQueue:s,logger:o})},t.prototype.createGroupChannelCollection=function(e){return void 0===e&&(e={}),new Sm(this._iid,e)},t.prototype.createMyGroupChannelListQuery=function(e){return void 0===e&&(e={}),new _p(this._iid,e)},t.prototype.createPublicGroupChannelListQuery=function(e){return void 0===e&&(e={}),new Mm(this._iid,e)},t.prototype.createScheduledMessageListQuery=function(e){return void 0===e&&(e={}),new xm(this._iid,e)},t.prototype.addGroupChannelHandler=function(e,t){pa(W("string",e)&&t instanceof Om).throw(z.invalidParameters),this._manager.addHandler(e,t)},t.prototype.removeGroupChannelHandler=function(e){pa(W("string",e)).throw(z.invalidParameters),this._manager.removeHandler(e)},t.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},t.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},t.prototype.getChannel=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return pa(W("string",e)).throw(z.invalidParameters),[2,this._manager.getChannel(e)]}))}))},t.prototype.getChannelWithoutCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return pa(W("string",e)).throw(z.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]}))}))},t.prototype.getMyGroupChannelChangeLogsByToken=function(e,t){return void 0===t&&(t={}),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},_f),t),pa(W("string",e)&&vf(n)).throw(z.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,t){return void 0===t&&(t={}),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:return n=S(S({},_f),t),pa(W("number",e)&&vf(n)).throw(z.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getGroupChannelCount=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},Ef),e),pa(yf(t)).throw(z.invalidParameters),[2,this._manager.getGroupChannelCount(t)]}))}))},t.prototype.getUnreadItemCount=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._manager.getUnreadItemCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getTotalUnreadChannelCount=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,e.sent()]}}))}))},t.prototype.getTotalUnreadMessageCount=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},t.prototype.createChannel=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},mf),e),pa(gf(t)).throw(z.invalidParameters),[2,this._manager.createChannel(t)]}))}))},t.prototype.createDistinctChannelIfNotExist=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},mf),e),pa(gf(t)).throw(z.invalidParameters),t&&(t.isDistinct=!0),[2,this.createChannel(t)]}))}))},t.prototype.createChannelWithUserIds=function(e,t,n,r,i,a){return void 0===t&&(t=!1),void 0===i&&(i=""),void 0===a&&(a=""),w(this,0,void 0,(function(){var s;return A(this,(function(o){return s=S(S({},mf),{invitedUserIds:e,isDistinct:t,name:n,data:i,customType:a}),"string"==typeof r?s.coverUrl=r:s.coverImage=r,[2,this.createChannel(s)]}))}))},t.prototype.markAsReadAll=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return this._manager.markAsReadAll(),[2]}))}))},t.prototype.markAsReadWithChannelUrls=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return pa(X("string",e)).throw(z.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]}))}))},t.prototype.markAsDelivered=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},t}(gs);const Um={collection:{groupChannel:{defaultLimit:20,defaultOrder:vh.LATEST_LAST_MESSAGE,defaultIncludeEmpty:!1},message:{defaultLimit:{next:25,prev:25},searchLimit:{next:10,prev:10}}}};var Lm=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};const Pm=(e,t)=>{Object(i.useEffect)(Bm(e),t)},Fm=e=>"function"==typeof e&&e(),Bm=e=>()=>{const t=Fm(e);return()=>{t&&(t instanceof Promise?Fm(()=>Lm(void 0,void 0,void 0,(function*(){const e=yield t;"function"==typeof e&&e()}))):"function"==typeof t&&Fm(t))}};let jm=0;const Hm=(e,t,n)=>{const r=Object(i.useRef)(t),a=Object(i.useState)(()=>""+jm++)[0];r.current=t,Object(i.useEffect)(()=>{var t;var n;return null===(t=null==e?void 0:e.groupChannel)||void 0===t||t.addGroupChannelHandler(a,(n=new Om,Object.keys(n).forEach(e=>{n[e]=(...t)=>{var n,i;return null===(i=null===(n=r.current)||void 0===n?void 0:n[e])||void 0===i?void 0:i.call(n,...t)}}),n)),()=>{var t;null===(t=null==e?void 0:e.groupChannel)||void 0===t||t.removeGroupChannelHandler(a)}},[null==e?void 0:e.groupChannel,a])};function Gm(e){const t=Object(i.useRef)(e);return t.current=e,Object(i.useCallback)((...e)=>t.current(...e),[t])}const zm=(e,t)=>{var n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,[]);const r=Vm(n.order);switch(t.type){case"update_refreshing":n.refreshing=t.value.status;break;case"update_initialized":n.initialized=t.value.status;break;case"update_channels":qm(t.value.channels).forEach(e=>{const t=n.groupChannels.findIndex(t=>t.url===e.url);t>-1&&(n.groupChannels[t]=e)}),r&&(n.groupChannels=n.groupChannels.sort(r));break;case"delete_channels":t.value.channelUrls.forEach(e=>{const t=n.groupChannels.findIndex(t=>t.url===e);t>-1&&n.groupChannels.splice(t,1)}),r&&(n.groupChannels=n.groupChannels.sort(r));break;case"append_channels":{const e=qm(t.value.channels);t.value.clearBeforeAction?n.groupChannels=e:n.groupChannels=function(e,t,n){const r=new Set(e.map(e=>e[n])),i=[...e];for(let e=0;e<t.length;e++)r.has(t[e][n])||(i.push(t[e]),r.add(t[e][n]));return i}(n.groupChannels,e,"url"),r&&(n.groupChannels=n.groupChannels.sort(r));break}case"update_order":{n.order=t.value.order;const e=Vm(n.order);e&&(n.groupChannels=n.groupChannels.sort(e));break}}return n},Vm=e=>{if(e)return(t,n)=>{switch(e){case"latest_last_message":return t.lastMessage&&n.lastMessage?n.lastMessage.createdAt-t.lastMessage.createdAt:t.lastMessage?-1:n.lastMessage?1:n.createdAt-t.createdAt;case"chronological":return n.createdAt-t.createdAt;case"channel_name_alphabetical":return t.name.localeCompare(n.name);default:return 0}}};function qm(e){return e.filter(e=>e.isGroupChannel())}var Km=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};const Wm=(e,t)=>{var n,r,a;const s=Boolean(null===(r=null===(n=e.appInfo)||void 0===n?void 0:n.premiumFeatureList)||void 0===r?void 0:r.includes(N)),o=Object(i.useRef)(),l=Object(i.useRef)(t);l.current=t;const{initialized:u,groupChannels:c,refreshing:d,appendChannels:h,deleteChannels:f,updateRefreshing:p,updateInitialized:m}=(e=>{const[{initialized:t,refreshing:n,groupChannels:r},a]=Object(i.useReducer)(zm,{initialized:!1,refreshing:!1,groupChannels:[],order:e});return{updateInitialized:e=>{a({type:"update_initialized",value:{status:e}})},updateRefreshing:e=>{a({type:"update_refreshing",value:{status:e}})},updateChannels:e=>{a({type:"update_channels",value:{channels:e}})},deleteChannels:e=>{a({type:"delete_channels",value:{channelUrls:e}})},appendChannels:(e,t)=>{a({type:"append_channels",value:{channels:e,clearBeforeAction:t}})},updateOrder:e=>{a({type:"update_order",value:{order:e}})},initialized:t,refreshing:n,groupChannels:r}})(),g=(e,t,n)=>{var r,i,a,u;const c=null!==(i=null===(r=o.current)||void 0===r?void 0:r.channels)&&void 0!==i?i:[];if(h(c,!0),e&&s)switch(t){case If.EVENT_MESSAGE_RECEIVED:case If.EVENT_MESSAGE_SENT:case If.SYNC_CHANNEL_BACKGROUND:case If.SYNC_CHANNEL_CHANGELOGS:case void 0:null===(u=null===(a=l.current)||void 0===a?void 0:a.markAsDelivered)||void 0===u||u.call(a,null!=n?n:c)}},_=Gm(n=>Km(void 0,void 0,void 0,(function*(){var r,i,a,s;o.current&&(null===(r=o.current)||void 0===r||r.dispose()),n&&(o.current=((e,t)=>{const n={includeEmpty:Um.collection.groupChannel.defaultIncludeEmpty,limit:Um.collection.groupChannel.defaultLimit,order:Um.collection.groupChannel.defaultOrder},r=null==t?void 0:t(n);return r||e.groupChannel.createGroupChannelCollection(Object.assign(Object.assign({},n),{filter:new ff(n)}))})(e,null==t?void 0:t.collectionCreator),null===(i=o.current)||void 0===i||i.setGroupChannelCollectionHandler({onChannelsAdded:(e,t)=>{var n,r;const i=t.filter(e=>e.isGroupChannel());g(!0,e.source,i),null===(r=null===(n=l.current)||void 0===n?void 0:n.onChannelsAdded)||void 0===r||r.call(n,i)},onChannelsUpdated:(e,t)=>{var n,r;const i=t.filter(e=>e.isGroupChannel());g(!0,e.source,i),null===(r=null===(n=l.current)||void 0===n?void 0:n.onChannelsUpdated)||void 0===r||r.call(n,i)},onChannelsDeleted:(e,t)=>{var n,r;g(!1),null===(r=null===(n=l.current)||void 0===n?void 0:n.onChannelsDeleted)||void 0===r||r.call(n,t)}}),(null===(a=o.current)||void 0===a?void 0:a.hasMore)&&(yield null===(s=o.current)||void 0===s?void 0:s.loadMore(),g(!0)))})));Object(i.useEffect)(()=>()=>{var e;o.current&&(null===(e=o.current)||void 0===e||e.dispose())},[]),Pm(()=>Km(void 0,void 0,void 0,(function*(){m(!1),e.currentUser&&(yield _(e.currentUser.userId),m(!0))})),[e,null===(a=e.currentUser)||void 0===a?void 0:a.userId]),Hm(e,{onUserBanned:(t,n)=>{var r,i,a;n.userId===(null===(r=e.currentUser)||void 0===r?void 0:r.userId)?(f([t.url]),null===(a=null===(i=l.current)||void 0===i?void 0:i.onChannelsDeleted)||void 0===a||a.call(i,[t.url])):g(!1)}});return{initialized:u,groupChannels:c,refresh:Gm(()=>Km(void 0,void 0,void 0,(function*(){e.currentUser&&(p(!0),yield _(e.currentUser.userId),p(!1))}))),refreshing:d,loadMore:Gm(()=>Km(void 0,void 0,void 0,(function*(){var e,t;(null===(e=o.current)||void 0===e?void 0:e.hasMore)&&(yield null===(t=o.current)||void 0===t?void 0:t.loadMore(),g(!0))})))}};var Ym=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="poll",t}return I(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,l=n.onlineDetector,u=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:l,cacheContext:u}),this._manager=new Zs(t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:l,cacheContext:u})},t.prototype.create=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},Vs),e),pa(qs(t)).throw(z.invalidParameters),[2,this._manager.create(t)]}))}))},t.prototype.get=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},Ys),e),pa(Qs(t)).throw(z.invalidParameters),[2,this._manager.get(t)]}))}))},t.prototype.getOption=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){return t=S(S({},Ks),e),pa(Ws(t)).throw(z.invalidParameters),[2,this._manager.getOption(t)]}))}))},t.prototype.buildPollFromSerializedData=function(e){return this._manager.buildPollFromSerializedData(e)},t}(gs),Qm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t}(Se),Xm=function(e){this.key=e.key,this.url=e.url},Zm=function(e){this.id=e.id,this.name=e.name,this.url=e.url,this.emojis=e.emojis?e.emojis.map((function(e){return new Xm(e)})):[]},Jm=function(e){this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((function(e){return new Zm(e)})):[]},$m={profileImage:void 0,profileUrl:void 0,nickname:void 0},eg=function(e){return{v2:function(){return w(void 0,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:_c,keyName:"url",index:[Mh(vh.LATEST_LAST_MESSAGE),Mh(vh.CHRONOLOGICAL),Mh(vh.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:vc,keyName:"messageId",index:[Yd(Vd.CHANNEL_LATEST),Yd(Vd.NEWEST_CHILD_MESSAGE)]},{collectionName:Zd,keyName:"reqId",index:[Yd(Vd.CHANNEL_LATEST),Yd(Vd.NEWEST_CHILD_MESSAGE)]},{collectionName:"Poll",keyName:"pollId"}])];case 1:return[2,t.sent()]}}))}))},v3:function(){return w(void 0,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:"FeedChannel",keyName:"url",index:[["-lastMessageUpdatedAt","-createdAt","syncIndex"]]}])];case 1:return[2,t.sent()]}}))}))},v4:function(){return w(void 0,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:Ec,keyName:"notificationId",index:[["channelUrl","-createdAt","-notificationId"]]}])];case 1:return[2,t.sent()]}}))}))},v5:function(){return w(void 0,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:yc,keyName:"userId",index:[["-userId","-updatedAt"]]}])];case 1:return[2,t.sent()]}}))}))}}},tg=function(e){var t=new qd;return function(n,r){return w(void 0,0,void 0,(function(){var i,a,s,o;return A(this,(function(l){switch(l.label){case 0:switch(n){case 1:case 2:case 3:case 4:return[3,1];case 5:return[3,2];case 6:return[3,4];case 7:return[3,11]}return[3,15];case 1:return r(),[3,16];case 2:return[4,e.reset()];case 3:return l.sent(),r(),[3,16];case 4:return l.trys.push([4,9,,10]),i=eg(e),a=i.v2,s=i.v3,o=i.v4,[4,a()];case 5:return l.sent(),[4,s()];case 6:return l.sent(),[4,o()];case 7:return l.sent(),[4,e.collection(vc).removeIf({where:{channelType:le.OPEN}})];case 8:return l.sent(),[3,10];case 9:return l.sent(),t.warn("Failed to migrate to v2, v3, v4"),[3,10];case 10:return r(),[3,16];case 11:return l.trys.push([11,13,,14]),[4,(0,eg(e).v5)()];case 12:return l.sent(),[3,14];case 13:return l.sent(),t.warn("Failed to migrate to v5"),[3,14];case 14:return r(),[3,16];case 15:r(),l.label=16;case 16:return[2]}}))}))}},ng=function(){return"undefined"!=typeof document?document.visibilityState:"visible"},rg=function(e){function t(t){var n=t.getVisibilityState,r=void 0===n?ng:n,i=t.initialState,a=void 0===i?"visible":i,s=t.isEnabled,o=void 0===s||s,l=t.pauseCheckDelay,u=void 0===l?3e4:l,c=e.call(this)||this;return c._pauseCheckDelay=3e4,c._currentState="visible",c._getVisibilityState=r,c._pauseCheckDelay=u,c._currentState=a,c._isEnabled=o,c._boundToggleState=c._toggleState.bind(c),c}return I(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:function(){return"undefined"!=typeof window&&!!window.addEventListener&&!!window.removeEventListener},enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,t=this._getVisibilityState();"hidden"!==t?"hidden"===this._currentState&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):"hidden"!==this._currentState&&(this._pauseDelayTimer=setTimeout((function(){e._pauseDelayTimer=void 0,e.dispatch("pause")}),this._pauseCheckDelay)),this._currentState=t},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},t}(Te),ig=function(){function e(e){var t=e.logger,n=e.connectionDelegate,r=void 0===n?null:n,i=this;this._onlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.reconnect()},this._offlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.disconnect()},this.unsubscribes=[],this._onlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("online",e),function(){return window.removeEventListener("online",e,!1)}},this._offlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("offline",e),function(){return window.removeEventListener("offline",e,!1)}},this.logger=t,r&&(this.connectionDelegate=r)}return Object.defineProperty(e.prototype,"isAvailableOnWeb",{get:function(){return"undefined"!=typeof window&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&void 0!==navigator.onLine},enumerable:!1,configurable:!0}),e.prototype.setOnlineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._onlineListener=e)},e.prototype.setOfflineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._offlineListener=e)},e.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},e.prototype.stop=function(){var e=this;this.unsubscribes.forEach((function(t){try{null==t||t()}catch(t){e.logger.warn(t.message)}})),this.unsubscribes=[]},e.prototype.isOnline=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise((function(e){fetch("https://www.google.com",{method:Me.GET,mode:"no-cors"}).then((function(){return e(!0)})).catch((function(){return e(!1)}))}))]}))}))},e}(),ag=function(e){function t(t){var n,r=this;return(r=e.call(this)||this).method=Me.GET,r.path=Ze,r.params=we(Ae({ts:"number"==typeof t.token?t.token:void 0,token:"string"==typeof t.token?t.token:void 0,limit:null!==(n=t.limit)&&void 0!==n?n:100})),r}return I(t,e),t}(it),sg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.configs=n.configs,r.hasMore=n.has_more,r.nextToken=n.next,r.ts=n.ts,r}return I(t,e),t}(at),og=function(e){function t(t){var n=t.userId,r=t.nickname,i=t.profileUrl,a=t.profileImage,s=t.preferredLanguages,o=e.call(this)||this;return o.method=Me.PUT,o.path="".concat(Re,"/").concat(encodeURIComponent(n)),o.params=we(Ae({nickname:r,profile_url:i,profile_file:a,preferred_languages:s})),o}return I(t,e),t}(it),lg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.user=new ga(t,S({},n)),r}return I(t,e),t}(at),ug=function(e){function t(t){var n=t.userId,r=t.token,i=t.deviceOS,a=t.deviceManufacturer,s=t.systemPushEnabled,o=e.call(this)||this;return o.method=Me.POST,o.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/apns"),o.params=we({apns_device_token:r,always_push:!0,device_os:i,device_manufacturer:a,system_push_enabled:s}),o}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?F[n.type.toLowerCase()]:F.UNKNOWN,r.user=new ga(t,n.user),r}),e)}(at);var cg=function(e){function t(t){var n=t.userId,r=t.token,i=t.deviceOS,a=t.deviceManufacturer,s=t.systemPushEnabled,o=e.call(this)||this;return o.method=Me.POST,o.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/gcm"),o.params=we({gcm_reg_token:r,always_push:!0,device_os:i,device_manufacturer:a,system_push_enabled:s}),o}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?F[n.type.toLowerCase()]:F.UNKNOWN,r.user=new ga(t,n.user),r}),e)}(at);var dg=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/apns/").concat(encodeURIComponent(r)),i}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new ga(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(at);var hg=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/gcm/").concat(encodeURIComponent(r)),i}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new ga(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(at);var fg=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.DELETE,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/apns"),r}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?F[n.type.toLowerCase()]:F.UNKNOWN,r.user=new ga(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(at);var pg=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.DELETE,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/gcm"),r}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?F[n.type.toLowerCase()]:F.UNKNOWN,r.user=new ga(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(at);var mg=function(e){function t(t){var n=t.userId,r=t.type,i=t.token,a=t.ts,s=e.call(this)||this;return s.method=Me.GET,s.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/").concat(encodeURIComponent(r),"/device_tokens"),s.params={created_ts:a,token:i},s}return I(t,e),t}(it),gg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTokens={type:n.type?F[n.type.toLowerCase()]:F.UNKNOWN,deviceTokens:n.device_tokens,hasMore:n.has_more,token:n.token},r}return I(t,e),t}(at),_g=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),r}return I(t,e),t}(it),vg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return I(t,e),t}(at),Eg=function(e){function t(t){var n=t.userId,r=t.willAutoAccept,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),i.params={auto_accept:r},i}return I(t,e),t}(it),yg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return I(t,e),t}(at),bg=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference"),r}return I(t,e),t}(it),Cg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return I(t,e),t}(at),Ng=function(e){function t(t){var n=t.userId,r=t.doNotDisturbOn,i=t.startHour,a=t.startMin,s=t.endHour,o=t.endMin,l=t.timezone,u=e.call(this)||this;return u.method=Me.PUT,u.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference"),u.params={do_not_disturb:r,start_hour:i,start_min:a,end_hour:s,end_min:o,timezone:l},u}return I(t,e),t}(it),Tg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return I(t,e),t}(at),Ig=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference"),r}return I(t,e),t}(it),Sg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return I(t,e),t}(at),wg=function(e){function t(t){var n=t.userId,r=t.snoozeOn,i=t.startTs,a=t.endTs,s=e.call(this)||this;return s.method=Me.PUT,s.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference"),s.params={snooze_enabled:r,snooze_start_ts:i,snooze_end_ts:a},s}return I(t,e),t}(it),Ag=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return I(t,e),t}(at),Mg=function(e){function t(t){var n=t.userId,r=t.blockedUserId,i=e.call(this)||this;return i.method=Me.POST,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/block"),i.params={target_id:r},i}return I(t,e),t}(it);!function(e){I((function(t,n){var r=e.call(this,t,n)||this;return r.user=new ga(t,n),r}),e)}(at);var Og=function(e){function t(t){var n=t.userId,r=t.unblockedUserId,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/block/").concat(encodeURIComponent(r)),i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Rg=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference"),r}return I(t,e),t}(it),kg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return I(t,e),t}(at),xg=function(e){function t(t){var n=t.userId,r=t.pushTriggerOption,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push_preference"),i.params={push_trigger_option:r},i}return I(t,e),t}(it),Dg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return I(t,e),t}(at),Ug=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/template"),r}return I(t,e),t}(it),Lg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return I(t,e),t}(at),Pg=function(e){function t(t){var n=t.userId,r=t.templateName,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/push/template"),i.params={name:r},i}return I(t,e),t}(it),Fg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return I(t,e),t}(at),Bg=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Me.GET,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/friends/changelogs"),i.params={token:r},i}return I(t,e),t}(it),jg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.changelogs={addedUsers:n.added.map((function(e){return new ga(t,e)})),updatedUsers:n.updated.map((function(e){return new ga(t,e)})),deletedUserIds:n.deleted,hasMore:n.has_more,token:n.next},r}return I(t,e),t}(at),Hg=function(e){function t(t){var n=t.userId,r=t.discoveries,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discoveries:r.map((function(e){return{friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName}}))},i}return I(t,e),t}(it),Gg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.friendDiscoveryRequestId=n.friend_discovery_request_id,r}return I(t,e),t}(at),zg=function(e){function t(t){var n=t.userId,r=t.discoveryKeys,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discovery_keys:r},i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Vg=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=Me.POST,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i}return I(t,e),t}(it),qg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new ga(t,e)})),r}return I(t,e),t}(at),Kg=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=Me.DELETE,i.path="".concat(Re,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Wg=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(Re,"/").concat(n,"/allow_friend_discovery"),r.params={},r}return I(t,e),t}(it),Yg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.allowFriendDiscovery=n.allow_friend_discovery,r}return I(t,e),t}(at),Qg=function(e){function t(t){var n=t.userId,r=t.allowFriendDiscovery,i=e.call(this)||this;return i.method=Me.PUT,i.path="".concat(Re,"/").concat(n,"/allow_friend_discovery"),i.params={allow_friend_discovery:r},i}return I(t,e),t}(it);!function(e){I((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(at);var Xg,Zg=function(e){function t(){var t=e.call(this)||this;return t.method=Me.GET,t.path=He,t}return I(t,e),t}(it),Jg=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiContainer=new Jm(n),r}return I(t,e),t}(at),$g=function(e){function t(t){var n=t.categoryId,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(He,"/").concat(n),r}return I(t,e),t}(it),e_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiCategory=new Zm(n),r}return I(t,e),t}(at),t_=function(e){function t(t){var n=t.key,r=e.call(this)||this;return r.method=Me.GET,r.path="".concat(je,"/").concat(n),r}return I(t,e),t}(it),n_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emoji=new Xm(n),r}return I(t,e),t}(at),r_=function(e){function t(){var t=e.call(this)||this;return t.method=Me.GET,t.path="".concat(Ve),t}return I(t,e),t}(it),i_=function(e){function t(t,n){var r,i=this,a=null!=n?n:{};return(i=e.call(this,t,n)||this).uikitConfiguration={string:JSON.stringify(a),json:a},i.updatedAt=null!==(r=null==n?void 0:n.updated_at)&&void 0!==r?r:0,i}return I(t,e),t}(at);!function(e){e.DELIVERED="DELIVERED",e.CLICKED="CLICKED"}(Xg||(Xg={}));var a_,s_=function(e){function t(t){var n=t.deviceToken,r=t.pushTrackingId,i=t.messageId,a=t.allowedPushNotification,s=t.channelKey,o=t.templateKey,l=t.eventType,u=t.notificationEventDeadline,c=e.call(this)||this;return c.method=Me.POST,c.path=Ye,c.params=we({device_token:n,push_tracking_id:r,message_id:i,allowed_push_notification:a,channel_key:s,template_key:o,event_type:l,notification_event_deadline:u}),c}return I(t,e),t}(it),o_=function(){function e(e,t,n){var r=this;this._storeInitialized=!1,this._iid=e,this.options=t;var i=ms.of(e),a=i.sdkState,s=i.cacheContext,o=i.dispatcher,l=i.sessionManager,u=i.requestQueue,c=i.logger,d=i.userEventHandlers,h=i.appStateToggleEnabled;this._onlineDetector=new ig({logger:c,connectionDelegate:{reconnect:function(){return w(r,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(l){switch(l.label){case 0:if(t=ms.of(e),n=t.sdkState,r=t.connectionManager,(i=t.sessionManager).session.hasSession)return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,r.connect(i.session.authToken)];case 2:return l.sent(),[3,4];case 3:if(a=l.sent(),G(a))throw a;return c.debug("connect failed by reconnect event = ",a),[3,4];case 4:return[3,9];case 5:if("foreground"!==n.appState)return[3,9];l.label=6;case 6:return l.trys.push([6,8,,9]),[4,r.resetAndReconnect()];case 7:return l.sent(),[3,9];case 8:if(s=l.sent(),G(s))throw s;return c.debug("resetAndReconnect failed by reconnect event = ",s),[3,9];case 9:return o.dispatch(new Qm),[2]}}))}))},disconnect:function(){Bi((function(){return w(r,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,ms.of(e).connectionManager.disconnect()];case 1:return t.sent(),[2]}}))}))}))}}});var f=new kh(e,{localCacheEnabled:s.localCacheEnabled,enableAutoResend:s.localCacheConfig.enableAutoResend,dispatcher:o,sdkState:a,logger:c});n.forEach((function(t){t.init(e,{sdkState:a,cacheContext:s,dispatcher:o,sessionManager:l,requestQueue:u,logger:c,onlineDetector:r._onlineDetector}),r[t.name]=t})),this._appStateChangeDetector=new rg({isEnabled:h}),this._appStateChangeDetector.on("resume",(function(){c.debug("the page resumes from freeze"),r.setForegroundState()})).on("pause",(function(){c.debug("the page freezes"),r.setBackgroundState()})),o.on((function(t){var n;if(t instanceof Ki)t.stateType===ji.CONNECTED&&f.processNonAutoResendRegisteredPendingMessages();else if(t instanceof lt){if("USEV"===t.code){var i=t.as(Fh).event;if(i.category===Ah.FRIEND_DISCOVERED){var o=Dh.getDataAsFriendDiscoveredEvent(e,i).friendDiscoveries;Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,d.forEach((function(e){e.onFriendsDiscovered&&e.onFriendsDiscovered(o)}))]}))}))}))}}}else if(t instanceof Gi){var l=ms.of(r._iid).subscribedUnreadMessageCount,u=!1,h=t.ts;"number"==typeof h&&h>l.ts&&(l.all!==t.all&&(u=!0),l.all=t.all>=0?t.all:0,t.customTypes&&Object.keys(t.customTypes).forEach((function(e){l.customTypes[e]!==t.customTypes[e]&&(u=!0),l.customTypes[e]=t.customTypes[e]})),u=u&&l.ts>0,l.ts=h),u&&Fi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,d.forEach((function(e){e.onTotalUnreadMessageCountChanged&&e.onTotalUnreadMessageCountChanged({groupChannelCount:l.all,feedChannelCount:l.feed,customTypeUnreadCount:l.customTypes}),e.onTotalUnreadMessageCountUpdated&&e.onTotalUnreadMessageCountUpdated(l.all,l.customTypes)}))]}))}))}))}else t instanceof _a?(s.preference.set(r._getUserProfileCacheKey(a.userId),va.payloadify(t.userProfile)),(null===(n=t.userProfile.appInfo.notificationInfo)||void 0===n?void 0:n.isEnabled)&&s.preference.set(Zi(r.appId),{value:!0})):t instanceof ya?t.configSyncNeeded&&Bi((function(){return w(r,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._getAppConfigsInfo()];case 1:return e.sent(),[2]}}))}))})):t instanceof Ph?s.preference.set(ra(r.appId),{configTs:t.configTs}):t instanceof ot&&t.error&&t.error.isSessionInvalidatedError&&(c.debug("session revoked."),r._internalDisconnect(t.error))}))}return e.init=function(t){var n=t.appId,r=t.appVersion,i=t.modules,a=void 0===i?[]:i,s=t.options,o=void 0===s?new te:s,l=t.debugMode,u=void 0!==l&&l,c=t.customApiHost,d=t.customWebSocketHost,h=t.newInstance,f=void 0!==h&&h,p=t.logLevel,m=t.localCacheEnabled,g=void 0!==m&&m,_=t.localCacheConfig,v=void 0===_?new oe:_,E=t.localCacheEncryption,y=t.useAsyncStorageStore,b=void 0===y?null:y,C=t.useMMKVStorageStore,N=void 0===C?null:C,T=t.appStateToggleEnabled,I=void 0===T||T;if(!a_||f){var S="su-".concat(Ce()),w=null!=E?E:{encrypt:function(e){return e},decrypt:function(e){return e}},A=new qd;A.level=null!=p?p:Gd.WARN;var M=new Pd({encryption:w});u||(yt()?N?M=new Hd({MMKV:N,encryption:w}):b&&(M=new jd({AsyncStorage:b,encryption:w}),A.warn("AsyncStorage store is deprecated due to the small size limit. Please use MMKVStorage store instead.")):M=new Bd({encryption:w})),new ms(S,{appId:n,appVersion:r,options:o,apiHost:null!=c?c:"https://api-".concat(n,".sendbird.com"),websocketHost:null!=d?d:"wss://ws-".concat(n,".sendbird.com"),store:M,encryption:w,logger:A,localCacheEnabled:g,localCacheConfig:v,debugMode:u,appStateToggleEnabled:I});var k=[new wh,new Ym],x=new e(S,o,R(R([],O(a),!1),O(k),!1));return a_||(a_=x),x}return a_},Object.defineProperty(e,"instance",{get:function(){return a_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return D},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return ms.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){var e=ms.of(this._iid).appInfo;return null!=e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){var e;return null!==(e=ms.of(this._iid).sdkState.appVersion)&&void 0!==e?e:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return!!ms.of(this._iid).debugMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return ms.of(this._iid).logger.level},set:function(e){ms.of(this._iid).logger.level=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return ms.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCacheConfig",{get:function(){var e=ms.of(this._iid).cacheContext;return e.localCacheEnabled?e.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ekey",{get:function(){return ms.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){var e;return null!==(e=ms.of(this._iid).sessionManager.currentUser)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionState",{get:function(){var e=ms.of(this._iid).connectionManager;return e.isConnected?Ui.OPEN:e.isConnecting?Ui.CONNECTING:Ui.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastConnectedAt",{get:function(){var e=ms.of(this._iid),t=e.connectedAt;return e.connectionManager.isConnected?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fcmPushToken",{get:function(){var e;return null!==(e=this._fcmPushToken)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apnsPushToken",{get:function(){var e;return null!==(e=this._apnsPushToken)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),e.prototype._getNestDBVersion=function(){return 8},e.prototype._getPreferenceVersion=function(){return 9},e.prototype._getPreferenceCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".pref")},e.prototype._getUserProfileCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".profile")},e.prototype._internalDisconnect=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=ms.of(this._iid),n=t.connectionManager,r=t.sdkState,i=t.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),i.cancelAll(),[4,n.logout(e)];case 1:return a.sent(),[4,this.clearCachedData()];case 2:return a.sent(),r.appState="foreground",[2]}}))}))},e.prototype._getAppConfigsInfo=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s,o,l=this;return A(this,(function(u){switch(u.label){case 0:return e=ms.of(this._iid),t=e.requestQueue,n=e.dispatcher,r=e.cacheContext,i=e.sdkState,a={},[4,r.preference.get(ra(i.appId))];case 1:return(o=u.sent())&&(s=o.configTs),new Hh("appConfigsInfo",(function(e){return w(l,0,void 0,(function(){var r,i,s,o,l,u,c,d;return A(this,(function(h){switch(h.label){case 0:return r={hasNext:!0,nextToken:e},i=new ag({token:e}),[4,t.send(i)];case 1:return s=h.sent(),o=s.as(sg),l=o.configs,u=o.hasMore,c=o.nextToken,d=o.ts,Object.keys(l).forEach((function(e){a[e]=l[e]})),r.hasNext=u,r.nextToken=c,u||n.dispatch(new Bh({appConfigsInfo:a,configTs:d})),[2,r]}}))}))})).start(s),[2]}}))}))},e.prototype.getMemoryStoreForDebugging=function(){var e=ms.of(this._iid),t=e.debugMode,n=e.cacheContext;if(t)return n.store instanceof Pd?n.store:null;throw z.debugModeRequired},e.prototype.addExtension=function(e,t){var n=ms.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(e)>-1&&n.extensions&&(n.extensions[e]=t)},e.prototype.addSendbirdExtensions=function(e,t,n){var r,i,a=ms.of(this._iid),s=a.logger,o=a.sdkState,l=new RegExp("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$");if(0===e.length)return s.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(e.find((function(e){return!l.test(e.version)})))return s.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(n)try{for(var u=M(Object.entries(n)),c=u.next();!c.done;c=u.next()){var d=O(c.value,2),h=d[0],f=d[1];if(/&|=/.test(h)||/&|=/.test(f))return s.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return o.sendbirdRuntimeEnvironment={sendbirdExtensions:e,deviceOS:t,customData:n},!0},e.prototype.setOnlineListener=function(e){this._onlineDetector.setOnlineListener(e)},e.prototype.setOfflineListener=function(e){this._onlineDetector.setOfflineListener(e)},e.prototype._safeInitializeStore=function(e){return w(this,0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:t=ms.of(this._iid).cacheContext,n.label=1;case 1:return n.trys.push([1,3,,5]),[4,t.store.init(e)];case 2:return n.sent(),this._storeInitialized=!0,[3,5];case 3:return n.sent(),t.replaceStore(new Pd),[4,this._safeInitializeStore(e)];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.setLocaleForChatbot=function(e){var t=ms.of(this._iid).sdkState,n=e.trim().replace(/[^a-zA-Z-_.]/g,"");n&&(t.localeForChatbot=n)},e.prototype.initializeCache=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u;return A(this,(function(c){switch(c.label){case 0:if(t=ms.of(this._iid),n=t.sdkState,r=t.cacheContext,i=t.dispatcher,a=t.logger,n.userId&&n.userId===e)return[3,13];s="sendbird@".concat(n.appId,"/").concat(e,".db"),c.label=1;case 1:return c.trys.push([1,9,11,13]),r.localCacheEnabled?r.nestdb&&r.nestdb.state!==Fd.CLOSED&&r.nestdb.name===s?[3,3]:(o="sendbird@".concat(n.appId,"/").concat(e,".db"),(l=r.nestdb=new zd({name:o,version:this._getNestDBVersion(),store:r.store,config:new qc({dbname:o,itemSizeLimit:61440})})).on("upgrade",tg(l)),l.on("storeReplaced",(function(e){r.replaceStore(e),r.localCacheEnabled=!1,l.on("upgrade",tg(l))})),[4,l.open()]):[3,6];case 2:return c.sent(),this._storeInitialized=!0,i.dispatch(new Uh(this._iid,{userId:e})),[3,5];case 3:return[4,this._safeInitializeStore(s)];case 4:c.sent(),c.label=5;case 5:return n.userId=e,[3,8];case 6:return[4,this._safeInitializeStore(s)];case 7:c.sent(),n.userId=e,c.label=8;case 8:return[3,13];case 9:return u=c.sent(),a.warn("Nest DB Open Failed. ",u),r.store instanceof Pd||(r.replaceStore(new Pd),r.localCacheEnabled=!1),[4,this._safeInitializeStore(s)];case 10:throw c.sent(),n.userId=e,z.databaseError;case 11:return[4,this._setupPreference(e)];case 12:return c.sent(),[7];case 13:return[2]}}))}))},e.prototype.getCacheDataSize=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return(e=ms.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.estimateUsage()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,0]}}))}))},e.prototype.clearCachedData=function(){return w(this,0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return(e=ms.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this._storeInitialized?[4,e.preference.clear()]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.clearCachedMessages=function(e){return w(this,0,void 0,(function(){var t,n,r=this;return A(this,(function(i){switch(i.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=th.of(this._iid),n=$d.of(this._iid),t&&n?[4,Promise.all(e.map((function(e){return w(r,0,void 0,(function(){return A(this,(function(r){switch(r.label){case 0:return[4,t.removeMessagesOfChannel(e)];case 1:return r.sent(),[4,n.removeMessagesOfChannel(e)];case 2:return r.sent(),[2]}}))}))})))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype._setupPreference=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return t=ms.of(this._iid),n=t.sdkState,r=t.cacheContext,i=t.statManager,[4,r.preference.init(this._getPreferenceCacheKey(e),this._getPreferenceVersion())];case 1:return s.sent(),[4,r.preference.get(this._getUserProfileCacheKey(e))];case 2:return(a=s.sent())&&new va(this._iid,a).apply(),[4,i.init("sendbird@".concat(n.appId,"/").concat(e,".statlog"))];case 3:return s.sent(),[2]}}))}))},e.prototype._ready=function(e,t,n){return void 0===n&&(n={}),w(this,0,void 0,(function(){var r,i,a,s,o,l;return A(this,(function(u){switch(u.label){case 0:return pa(W("string",e)&&W("string",t,!0)).throw(z.invalidParameters),r=ms.of(this._iid),i=r.sdkState,a=r.cacheContext,s=r.connectionManager,o=n.errorForOtherUser,i.userId&&i.userId!==e?o?[3,2]:[4,s.logout()]:[3,3];case 1:return u.sent(),[3,3];case 2:throw o;case 3:return u.trys.push([3,5,,6]),[4,this.initializeCache(e)];case 4:return u.sent(),ms.of(this._iid).dispatcher.dispatch(new Lh),[3,6];case 5:return u.sent(),l=ms.of(this._iid).logger,a.localCacheEnabled=!1,l.warn("Cache initialization failed - cache is not available."),[3,6];case 6:return[2]}}))}))},e.prototype.authenticateFeed=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this.authenticate(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.authenticate=function(e,t,n){var r;return void 0===n&&(n=B.SESSION_TOKEN),w(this,0,void 0,(function(){var i,a,s;return A(this,(function(o){switch(o.label){case 0:return i=ms.of(this._iid),a=i.sessionManager,s=i.connectionManager,[4,this._ready(e,t,{errorForOtherUser:s.isConnected?z.alreadyConnectedAsAnotherUser:void 0})];case 1:return o.sent(),(null===(r=a.session.services)||void 0===r?void 0:r.includes(ae.CHAT))?[3,3]:(a.handler||t&&n!==B.ACCESS_TOKEN||this.setSessionHandler(new xc),[4,a.authenticate(e,t)]);case 2:o.sent(),o.label=3;case 3:return[2,this.currentUser]}}))}))},e.prototype.connect=function(e,t){return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._ready(e,t)];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,,4,5]),[4,ms.of(this._iid).connectionManager.connect(t)];case 3:return n.sent(),[3,5];case 4:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 5:return[2,this.currentUser]}}))}))},e.prototype.reconnect=function(){var e=ms.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.sessionManager.session.hasSession;return r&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),t.resetAndReconnect().then((function(){n.appState="foreground"})).catch((function(){}))),r},e.prototype.disconnect=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,this._internalDisconnect()];case 1:return e.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:return e=ms.of(this._iid),t=e.connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.disconnectWebSocket(!0)];case 1:return r.sent(),[2]}}))}))},e.prototype.setBackgroundState=function(){var e=ms.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"foreground"===n.appState&&(n.appState="background",r.debug("going background state"),t.background().catch((function(e){r.debug("setBackgroundState error = ",e)})))},e.prototype.setForegroundState=function(){var e=ms.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.dispatcher,i=e.logger;"background"===n.appState&&(n.appState="foreground",i.debug("going foreground state"),t.resetAndReconnect().catch((function(e){i.debug("setForgroundState error = ",e)})),r.dispatch(new Qm))},e.prototype.setSessionHandler=function(e){pa(e instanceof xc).throw(z.invalidParameters),ms.of(this._iid).sessionManager.handler=e},e.prototype.addUserEventHandler=function(e,t){pa(W("string",e)&&t instanceof Dc).throw(z.invalidParameters),ms.of(this._iid).userEventHandlers.set(e,t)},e.prototype.removeUserEventHandler=function(e){ms.of(this._iid).userEventHandlers.delete(e)},e.prototype.removeAllUserEventHandler=function(){ms.of(this._iid).userEventHandlers.clear()},e.prototype.addConnectionHandler=function(e,t){pa(W("string",e)&&t instanceof kc).throw(z.invalidParameters),ms.of(this._iid).connectionHandlers.set(e,t)},e.prototype.removeConnectionHandler=function(e){ms.of(this._iid).connectionHandlers.delete(e)},e.prototype.removeAllConnectionHandler=function(){ms.of(this._iid).connectionHandlers.clear()},e.prototype.createApplicationUserListQuery=function(e){return void 0===e&&(e={}),new Pc(this._iid,e)},e.prototype.createBlockedUserListQuery=function(e){return void 0===e&&(e={}),new jc(this._iid,e)},e.prototype.createFriendListQuery=function(e){return void 0===e&&(e={}),new zc(this._iid,e)},e.prototype.createMessageSearchQuery=function(e){return new bh(this._iid,e)},e.prototype.createPollListQuery=function(e){return new eo(this._iid,S({},e))},e.prototype.createPollVoterListQuery=function(e){return new ro(this._iid,S({},e))},e.prototype.buildUserFromSerializedData=function(e){var t=fa(e);return new ga(this._iid,ga.payloadify(t))},e.prototype.updateCurrentUserInfo=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){var t,n,r,i,a,s,o;return A(this,(function(l){switch(l.label){case 0:return t=S(S({},$m),e),pa((u=t,$(u.profileImage,!0)&&W("string",u.profileUrl,!0)&&W("string",u.nickname,!0))).throw(z.invalidParameters),this.currentUser?(n=ms.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new og(S({userId:r.userId},t)),[4,i.send(a)]):[3,2];case 1:return s=l.sent(),o=s.as(lg).user,this.currentUser&&(t.nickname&&(this.currentUser.nickname=o.nickname),(t.profileUrl||t.profileImage)&&(this.currentUser.plainProfileUrl=o.profileUrl)),[2,o];case 2:throw z.connectionRequired}var u}))}))},e.prototype.updateCurrentUserInfoWithPreferredLanguages=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),this.currentUser?(t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new og({userId:n.userId,preferredLanguages:e}),[4,r.send(i)]):[3,2];case 1:return a=o.sent(),s=a.as(lg).user,this.currentUser&&(this.currentUser.preferredLanguages=s.preferredLanguages),[2,s];case 2:throw z.connectionRequired}}))}))},e.prototype.registerFCMPushTokenForCurrentUser=function(e,t){var n,r;return w(this,0,void 0,(function(){var i,a,s,o,l,u,c=this;return A(this,(function(d){switch(d.label){case 0:if(pa(W("string",e)&&W("string",null==t?void 0:t.deviceManufacturer,!0)).throw(z.invalidParameters),(null==t?void 0:t.deviceOS)&&pa(Y(vt,t.deviceOS.platform,!0)&&W("string",t.deviceOS.version,!0)).throw(z.invalidParameters),!this.currentUser)return[3,6];i={deviceOS:"".concat((null===(n=null==t?void 0:t.deviceOS)||void 0===n?void 0:n.platform)||vt.ANDROID,"-").concat((null===(r=null==t?void 0:t.deviceOS)||void 0===r?void 0:r.version)||"unknown"),deviceManufacturer:null==t?void 0:t.deviceManufacturer,systemPushEnabled:null==t?void 0:t.systemPushEnabled},d.label=1;case 1:return d.trys.push([1,4,,5]),a=ms.of(this._iid),s=a.sessionManager,o=a.sdkState,l=a.requestQueue,s.hasDeviceToken(F.FCM,e)?[2,L.SUCCESS]:(u=new cg({userId:o.userId,token:e,deviceOS:i.deviceOS,deviceManufacturer:i.deviceManufacturer,systemPushEnabled:i.systemPushEnabled}),[4,l.send(u)]);case 2:return d.sent(),[4,Bi((function(){return w(c,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return s.setDeviceToken(F.FCM,e,i),[4,s.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return d.sent(),this._fcmPushToken="",[2,L.SUCCESS];case 4:return d.sent(),[2,L.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,L.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterFCMPushTokenForCurrentUser=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:if(pa(W("string",e)).throw(z.invalidParameters),!this.currentUser)return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),t=ms.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new hg({userId:r.userId,token:e}),[4,i.send(a)];case 2:return s=l.sent().lastDeletedAt,[4,Bi((function(){return w(o,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return n.unsetDeviceToken(F.FCM,e),n.setDeviceTokenDeletedAt(s),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return l.sent(),this._fcmPushToken="",[2,L.SUCCESS];case 4:return l.sent(),[2,L.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,L.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return this.currentUser?(e=ms.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,i=new pg({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return a=o.sent().lastDeletedAt,[4,Bi((function(){return w(s,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return t.unsetDeviceTokens(F.FCM),t.setDeviceTokenDeletedAt(a),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},e.prototype.registerAPNSPushTokenForCurrentUser=function(e,t){var n,r;return w(this,0,void 0,(function(){var i,a,s,o,l,u,c=this;return A(this,(function(d){switch(d.label){case 0:if(pa(W("string",e)&&W("string",null==t?void 0:t.deviceManufacturer,!0)).throw(z.invalidParameters),(null==t?void 0:t.deviceOS)&&pa(Y(vt,t.deviceOS.platform,!0)&&W("string",t.deviceOS.version,!0)).throw(z.invalidParameters),!this.currentUser)return[3,6];i={deviceOS:"".concat((null===(n=null==t?void 0:t.deviceOS)||void 0===n?void 0:n.platform)||vt.IOS,"-").concat((null===(r=null==t?void 0:t.deviceOS)||void 0===r?void 0:r.version)||"unknown"),deviceManufacturer:null==t?void 0:t.deviceManufacturer,systemPushEnabled:null==t?void 0:t.systemPushEnabled},d.label=1;case 1:return d.trys.push([1,4,,5]),a=ms.of(this._iid),s=a.sessionManager,o=a.sdkState,l=a.requestQueue,s.hasDeviceToken(F.APNS,e)?[2,L.SUCCESS]:(u=new ug({userId:o.userId,token:e,deviceOS:i.deviceOS,deviceManufacturer:i.deviceManufacturer,systemPushEnabled:i.systemPushEnabled}),[4,l.send(u)]);case 2:return d.sent(),[4,Bi((function(){return w(c,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return s.setDeviceToken(F.APNS,e,i),[4,s.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return d.sent(),this._apnsPushToken="",[2,L.SUCCESS];case 4:return d.sent(),[2,L.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,L.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterAPNSPushTokenForCurrentUser=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o=this;return A(this,(function(l){switch(l.label){case 0:if(pa(W("string",e)).throw(z.invalidParameters),!this.currentUser)return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),t=ms.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new dg({userId:r.userId,token:e}),[4,i.send(a)];case 2:return s=l.sent().lastDeletedAt,[4,Bi((function(){return w(o,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return n.unsetDeviceToken(F.APNS,e),n.setDeviceTokenDeletedAt(s),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return l.sent(),this._apnsPushToken="",[2,L.SUCCESS];case 4:return l.sent(),[2,L.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,L.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return this.currentUser?(e=ms.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,i=new fg({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return a=o.sent().lastDeletedAt,[4,Bi((function(){return w(s,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return t.unsetDeviceTokens(F.APNS),t.setDeviceTokenDeletedAt(a),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},e.prototype.markPushNotificationAsDelivered=function(e,t){var n;return void 0===t&&(t=!0),w(this,0,void 0,(function(){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b;return A(this,(function(C){switch(C.label){case 0:if(r=ms.of(this._iid),i=r.logger,a=r.sessionManager,s=r.requestQueue,o=r.pushNotificationAckManager,i.debug("markPushNotificationAsDelivered:",e),l=Xg.DELIVERED,u=o.parseData(e),c=u.pushTrackingId,d=u.sessionTopics,h=u.sessionKey,f=u.messageId,p=u.channelKey,m=u.templateKey,g=u.notificationEventDeadline,!h)throw i.info("Can't use markPushNotificationAsDelivered() feature."),z.malformedDataError;if(!d.includes(Za.PUSH_ACKNOWLEDGEMENT))throw i.info("Can't use markPushNotificationAsDelivered() feature."),z.malformedDataError;if(o.isAcked(c,l))return i.info("already delivered push notification:",c),[2];_=Boolean(p),v=t&&_,E=null===(n=a.deviceTokens[0])||void 0===n?void 0:n.token,y=new s_({deviceToken:null!=E?E:"",pushTrackingId:c,eventType:l,messageId:f,channelKey:p,templateKey:m,notificationEventDeadline:g,allowedPushNotification:v}),h&&(y.headers["Session-Key"]=h),C.label=1;case 1:return C.trys.push([1,3,,4]),[4,s.send(y)];case 2:return C.sent(),o.markAsAcked(c,l),[3,4];case 3:throw b=C.sent(),i.debug("failed to mark push notification as delivered. push tracking id: ".concat(c,". error: ").concat(b)),b;case 4:return[2]}}))}))},e.prototype.markPushNotificationAsClicked=function(e){var t;return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v;return A(this,(function(E){switch(E.label){case 0:if(n=ms.of(this._iid),r=n.logger,i=n.sessionManager,a=n.requestQueue,s=n.pushNotificationAckManager,r.debug("markPushNotificationAsClicked:",e),o=Xg.CLICKED,l=s.parseData(e),u=l.pushTrackingId,c=l.sessionTopics,d=l.sessionKey,h=l.messageId,f=l.channelKey,p=l.templateKey,m=l.notificationEventDeadline,!d)throw r.info("Can't use markPushNotificationAsClicked() feature."),z.malformedDataError;if(!c.includes(Za.PUSH_ACKNOWLEDGEMENT))throw r.info("Can't use markPushNotificationAsClicked() feature."),z.malformedDataError;if(s.isAcked(u,o))return r.info("already clicked push notification:",u),[2];g=null===(t=i.deviceTokens[0])||void 0===t?void 0:t.token,_=new s_({deviceToken:null!=g?g:"",pushTrackingId:u,eventType:o,messageId:h,channelKey:f,templateKey:p,notificationEventDeadline:m}),d&&(_.headers["Session-Key"]=d),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,a.send(_)];case 2:return E.sent(),s.markAsAcked(u,o),[3,4];case 3:throw v=E.sent(),r.debug("failed to mark push notification as clicked. push tracking id: ".concat(u,". error: ").concat(v)),v;case 4:return[2]}}))}))},e.prototype.getChannelInvitationPreference=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new _g({userId:t.userId}),[4,n.send(r)];case 1:return[2,{autoAccept:i.sent().as(vg).autoAccept}]}}))}))},e.prototype.setChannelInvitationPreference=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("boolean",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Eg({userId:n.userId,willAutoAccept:e}),[4,r.send(i)];case 1:return[2,{autoAccept:a.sent().as(yg).autoAccept}]}}))}))},e.prototype.getDoNotDisturb=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new bg({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Cg).preference]}}))}))},e.prototype.setDoNotDisturb=function(e,t,n,r,i,a){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=""),w(this,0,void 0,(function(){var s,o,l,u;return A(this,(function(c){switch(c.label){case 0:return pa(W("boolean",e)&&W("number",t)&&W("number",n)&&W("number",r)&&W("number",i)&&W("string",a)).throw(z.invalidParameters),s=ms.of(this._iid),o=s.sdkState,l=s.requestQueue,u=new Ng({userId:o.userId,doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:i,timezone:a}),[4,l.send(u)];case 1:return[2,c.sent().as(Tg).preference]}}))}))},e.prototype.getSnoozePeriod=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Ig({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Sg).snoozePeriod]}}))}))},e.prototype.setSnoozePeriod=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),w(this,0,void 0,(function(){var r,i,a,s;return A(this,(function(o){switch(o.label){case 0:return pa(W("boolean",e)&&W("number",t)&&W("number",n)).throw(z.invalidParameters),r=ms.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new wg({userId:i.userId,snoozeOn:e,startTs:t,endTs:n}),[4,a.send(s)];case 1:return[2,o.sent().as(Ag).snoozePeriod]}}))}))},e.prototype.getMyPushTokensByToken=function(e,t){return w(this,0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f;return A(this,(function(p){switch(p.label){case 0:return pa(W("string",e)&&Y(F,t)).throw(z.invalidParameters),n=ms.of(this._iid),r=n.sdkState,i=n.requestQueue,a=n.sessionManager,s=new mg({userId:r.userId,type:t,token:e}),[4,i.send(s)];case 1:o=p.sent(),l=o.as(gg).pushTokens;try{for(u=M(l.deviceTokens),c=u.next();!c.done;c=u.next())d=c.value,a.setDeviceToken(l.type,d)}catch(e){h={error:e}}finally{try{c&&!c.done&&(f=u.return)&&f.call(u)}finally{if(h)throw h.error}}return[4,a.saveDeviceToken()];case 2:return p.sent(),[2,l]}}))}))},e.prototype.getPushTriggerOption=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Rg({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(kg).pushTriggerOption]}}))}))},e.prototype.setPushTriggerOption=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(Y(P,e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new xg({userId:n.userId,pushTriggerOption:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Dg).pushTriggerOption]}}))}))},e.prototype.getPushTemplate=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Ug({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Lg).name]}}))}))},e.prototype.setPushTemplate=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(Y(j,e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Pg({userId:n.userId,templateName:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Fg).name]}}))}))},e.prototype.blockUser=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(e instanceof ga||W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Mg({userId:n.userId,blockedUserId:e instanceof ga?e.userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.blockUserWithUserId=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this.blockUser(e)]}))}))},e.prototype.unblockUser=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(e instanceof ga||W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Og({userId:n.userId,unblockedUserId:e instanceof ga?e.userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.unblockUserWithUserId=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this.unblockUser(e)]}))}))},e.prototype.getFriendChangeLogsByToken=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Bg({userId:n.userId,token:e}),[4,r.send(i)];case 1:return[2,a.sent().as(jg).changelogs]}}))}))},e.prototype.getAllowFriendDiscovery=function(){return w(this,0,void 0,(function(){var e,t,n,r;return A(this,(function(i){switch(i.label){case 0:return e=ms.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Wg({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Yg).allowFriendDiscovery]}}))}))},e.prototype.setAllowFriendDiscovery=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("boolean",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Qg({userId:n.userId,allowFriendDiscovery:e}),[4,r.send(i)];case 1:return a.sent(),[2,e]}}))}))},e.prototype.uploadFriendDiscoveries=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Hg({userId:n.userId,discoveries:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Gg).friendDiscoveryRequestId]}}))}))},e.prototype.deleteFriendDiscovery=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this.deleteFriendDiscoveries([e])]}))}))},e.prototype.deleteFriendDiscoveries=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new zg({userId:n.userId,discoveryKeys:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.addFriends=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Vg({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return[2,a.sent().as(qg).users]}}))}))},e.prototype.deleteFriend=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this.deleteFriends([e])]}))}))},e.prototype.deleteFriends=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(X("string",e)).throw(z.invalidParameters),t=ms.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Kg({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.getAllEmoji=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new Zg,[4,e.send(t)];case 1:return[2,n.sent().as(Jg).emojiContainer]}}))}))},e.prototype.getEmojiCategory=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=ms.of(this._iid).requestQueue,n=new $g({categoryId:e}),[4,t.send(n)];case 1:return[2,r.sent().as(e_).emojiCategory]}}))}))},e.prototype.getEmoji=function(e){return w(this,0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:return t=ms.of(this._iid).requestQueue,n=new t_({key:e}),[4,t.send(n)];case 1:return[2,r.sent().as(n_).emoji]}}))}))},e.prototype.getUIKitConfiguration=function(){return w(this,0,void 0,(function(){var e,t,n;return A(this,(function(r){switch(r.label){case 0:return e=ms.of(this._iid),pa(e.hasExtension("sb_uikit")).throw(z.notSupportedError),t=e.requestQueue,n=new r_,[4,t.send(n)];case 1:return[2,r.sent().as(i_).uikitConfiguration]}}))}))},e.prototype.getReportCategoryInfoList=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,ms.of(this._iid).reportCategoryManager.categories()];case 1:return[2,e.sent()]}}))}))},e}();function l_(e){return null!=e&&"sendingStatus"in e}function u_(e,t="##__USER_ID_IS_NOT_PROVIDED__##"){var n;return!!l_(e)&&(null===(n=e.sender)||void 0===n?void 0:n.userId)===t}function c_(e){return"sendingStatus"in e?"succeeded"===e.sendingStatus?String(e.messageId):e.reqId:String(e.messageId)}function d_(e){return"boolean"==typeof e}function h_(e,t){return t.includes(e)}function f_(e){return!(!e||!Array.isArray(e))&&0!==e.length}function p_(e,t){return e.reduce((e,n)=>(e[t(n)]=n,e),{})}const m_=(e,t)=>{var n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,[]);switch(t.type){case"update_initialized":return n.initialized=t.value.status,n;case"update_refreshing":return n.refreshing=t.value.status,n;case"update_loading":return n.loading=t.value.status,n;case"update_messages":if(t.value.clearBeforeAction)n.messageMap=g_(t.value.messages);else{const e=Object.assign({},n.messageMap),r=[],i=[];t.value.messages.forEach(t=>{[l_(t)?t.reqId:void 0,t.messageId||void 0].forEach(n=>{if(!n)return;const a=e[n];__(a,t)&&(a&&r.push(a),i.push(t))})}),r.forEach(t=>{l_(t)&&delete e[t.reqId],delete e[t.messageId]}),i.forEach(t=>{l_(t)&&(e[t.reqId]=t),e[t.messageId]=t}),n.messageMap=e}return n;case"update_new_messages":{const e=t.value.currentUserId,r=t.value.messages.filter(t=>{return!u_(n=t,e)&&!n.isAdminMessage()&&0===n.updatedAt;var n});if(t.value.clearBeforeAction)n.newMessageMap=p_(r,c_);else{r.map(e=>e.messageId).forEach(e=>delete n.newMessageMap[e]),n.newMessageMap=Object.assign(Object.assign({},n.newMessageMap),p_(r,c_))}return n}case"delete_messages":case"delete_new_messages":{const e="delete_messages"===t.type?"messageMap":"newMessageMap";return n[e]=Object.assign({},n[e]),t.value.messageIds.forEach(t=>{const r=n[e][t];r&&(l_(r)&&delete n[e][r.reqId],delete n[e][r.messageId])}),t.value.reqIds.forEach(t=>{const r=n[e][t];r&&(l_(r)&&delete n[e][r.reqId],delete n[e][r.messageId])}),n}}},g_=e=>e.reduce((e,t)=>(l_(t)?(e[t.reqId]=t,t.sendingStatus===_e.SUCCEEDED&&(e[t.messageId]=t)):e[t.messageId]=t,e),{}),__=(e,t)=>!l_(e)||!l_(t)||(e.sendingStatus===_e.SUCCEEDED?t.sendingStatus===_e.SUCCEEDED:e.sendingStatus!==t.sendingStatus),v_=(e=y_)=>{const[{initialized:t,loading:n,refreshing:r,messageMap:a,newMessageMap:s},o]=Object(i.useReducer)(m_,{initialized:!1,loading:!0,refreshing:!1,messageMap:{},newMessageMap:{}}),l=Object.values(s);return{updateInitialized:e=>{o({type:"update_initialized",value:{status:e}})},updateLoading:e=>{o({type:"update_loading",value:{status:e}})},updateRefreshing:e=>{o({type:"update_refreshing",value:{status:e}})},updateMessages:(e,t,n)=>{o({type:"update_messages",value:{messages:e,clearBeforeAction:t,currentUserId:n}})},deleteMessages:(e,t)=>{o({type:"delete_messages",value:{messageIds:e,reqIds:t}})},initialized:t,loading:n,refreshing:r,messages:Object(i.useMemo)(()=>Array.from(new Set(Object.values(a))).sort(e),[a]),newMessages:l,updateNewMessages:(e,t,n)=>{o({type:"update_new_messages",value:{messages:e,clearBeforeAction:t,currentUserId:n}})},deleteNewMessages:(e,t)=>{o({type:"delete_new_messages",value:{messageIds:e,reqIds:t}})}}},E_=Math.floor(Number.MAX_SAFE_INTEGER/10);function y_(e,t){let n=0,r=0;return l_(e)&&"succeeded"!==e.sendingStatus&&(n=E_),l_(t)&&"succeeded"!==t.sendingStatus&&(r=E_),e.createdAt+n-(t.createdAt+r)}var b_=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};function C_(e){return e<Date.now()?Um.collection.message.searchLimit:Um.collection.message.defaultLimit}const N_=(e,t,n={})=>{var r,a,s;const o=Object(i.useRef)(n);o.current=n;const l=Object(i.useRef)(t);l.current=t;const u=o.current.logger,c=null!==(r=o.current.startingPoint)&&void 0!==r?r:Number.MAX_SAFE_INTEGER,d=C_(c),h=Object(i.useRef)({prev:!1,next:!1}),f=(()=>{const[,e]=Object(i.useState)(0);return Object(i.useCallback)(()=>e(e=>e+1),[])})(),p=Object(i.useRef)({initialized:!1,apiInitialized:!1,instance:null}),{initialized:m,loading:g,refreshing:_,messages:v,newMessages:E,updateMessages:y,updateNewMessages:b,deleteNewMessages:C,deleteMessages:N,updateInitialized:T,updateLoading:I,updateRefreshing:S}=v_(null==n?void 0:n.sortComparator),w=Gm(e=>{var t,n,r,i;if(!l.current||!l.current.url)return null===(t=null==u?void 0:u.error)||void 0===t?void 0:t.call(u,"[useGroupChannelMessages] channel is required");try{switch(e){case os.EVENT_MESSAGE_RECEIVED:case os.EVENT_MESSAGE_SENT_SUCCESS:case os.SYNC_MESSAGE_FILL:case void 0:null===(r=(n=o.current).markAsRead)||void 0===r||r.call(n,[l.current])}}catch(e){null===(i=null==u?void 0:u.warn)||void 0===i||i.call(u,"[useGroupChannelMessages/markAsReadBySource]",e)}}),A=Gm((t,n)=>{var r,i,a,s,l;const u=n.filter(t=>{var n;return!u_(t,null===(n=e.currentUser)||void 0===n?void 0:n.userId)});if(u.length>0)switch(t){case os.EVENT_MESSAGE_RECEIVED:case os.SYNC_MESSAGE_FILL:(null===(i=(r=o.current).shouldCountNewMessages)||void 0===i?void 0:i.call(r))&&b(u,!1,null===(a=e.currentUser)||void 0===a?void 0:a.userId),null===(l=(s=o.current).onMessagesReceived)||void 0===l||l.call(s,u)}}),M=Gm((t,n)=>b_(void 0,void 0,void 0,(function*(){return new Promise(r=>{var i,a;if(!l.current||!l.current.url)return null===(i=null==u?void 0:u.error)||void 0===i?void 0:i.call(u,"[useGroupChannelMessages] channel is required");p.current.instance&&p.current.instance.dispose(),w(),b([],!0,null===(a=e.currentUser)||void 0===a?void 0:a.userId);const s=()=>{var t,n,r;const{pendingMessages:i,failedMessages:a}=null!==(t=p.current.instance)&&void 0!==t?t:{};f_(i)&&y(i,!1,null===(n=e.currentUser)||void 0===n?void 0:n.userId),f_(a)&&y(a,!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId)},c=((e,t,n)=>{var r;const i={prevResultLimit:t.prev,nextResultLimit:t.next,startingPoint:null==n?void 0:n.startingPoint,replyType:null==n?void 0:n.replyType},a=null===(r=null==n?void 0:n.collectionCreator)||void 0===r?void 0:r.call(n,i);return a||e.createMessageCollection(Object.assign(Object.assign({},i),{filter:new Kd(i)}))})(l.current,n,Object.assign(Object.assign({},o.current),{startingPoint:t}));p.current={apiInitialized:!1,initialized:!1,instance:c},c.setMessageCollectionHandler({onMessagesAdded:(t,n,r)=>{var i;w(t.source),A(t.source,r),y(r,!1,null===(i=e.currentUser)||void 0===i?void 0:i.userId)},onMessagesUpdated:(t,n,r)=>{var i,a,s;w(t.source),A(t.source,r),y(r,!1,null===(i=e.currentUser)||void 0===i?void 0:i.userId),t.source===os.EVENT_MESSAGE_UPDATED&&(null===(s=(a=o.current).onMessagesUpdated)||void 0===s||s.call(a,r))},onMessagesDeleted:(e,t,n,r)=>{const i=r.map(e=>e.messageId),a=r.filter(l_).map(e=>e.reqId);N(i,a),C(i,a)},onChannelDeleted:(e,t)=>{var n,r;null===(r=(n=o.current).onChannelDeleted)||void 0===r||r.call(n,t)},onChannelUpdated:(e,t)=>{var n,r;f(),null===(r=(n=o.current).onChannelUpdated)||void 0===r||r.call(n,t)},onHugeGapDetected:()=>{M(Number.MAX_SAFE_INTEGER,Um.collection.message.defaultLimit)}}),c.initialize(Ep.CACHE_AND_REPLACE_BY_API).onCacheResult((t,n)=>{var i,a,o;t?e.isCacheEnabled&&(null===(i=null==u?void 0:u.error)||void 0===i||i.call(u,"[useGroupChannelMessages/onCacheResult]",t)):n&&(null===(a=null==u?void 0:u.debug)||void 0===a||a.call(u,"[useGroupChannelMessages/onCacheResult]","message length:",n.length),y(n,!0,null===(o=e.currentUser)||void 0===o?void 0:o.userId),s(),n.length>0&&(p.current.initialized=!0,r()))}).onApiResult((t,n)=>{var i,a,l,c,d;t?null===(i=null==u?void 0:u.warn)||void 0===i||i.call(u,"[useGroupChannelMessages/onApiResult]",t):n&&(null===(a=null==u?void 0:u.debug)||void 0===a||a.call(u,"[useGroupChannelMessages/onApiResult]","message length:",n.length),y(n,!0,null===(l=e.currentUser)||void 0===l?void 0:l.userId),o.current.startingPoint||null===(d=(c=o.current).onMessagesReceived)||void 0===d||d.call(c,n),e.isCacheEnabled&&s()),p.current.initialized=!0,p.current.apiInitialized=!0,r()})})})));Hm(e,{onUserBanned(t,n){var r,i,a,s,u;t.isGroupChannel()&&(s=t,u=l.current,s&&u&&s.url===u.url)&&(n.userId===(null===(r=e.currentUser)||void 0===r?void 0:r.userId)?null===(a=(i=o.current).onCurrentUserBanned)||void 0===a||a.call(i):f())}}),Object(i.useLayoutEffect)(()=>{const t=setTimeout(()=>b_(void 0,void 0,void 0,(function*(){e.currentUser&&l.current&&(T(!1),I(!0),yield M(c,d),I(!1),T(!0))})));return()=>clearTimeout(t)},[e,null===(a=e.currentUser)||void 0===a?void 0:a.userId,null===(s=l.current)||void 0===s?void 0:s.url,o.current.replyType]),Object(i.useEffect)(()=>()=>{p.current.instance&&p.current.instance.dispose()},[]);const O=Gm(()=>b_(void 0,void 0,void 0,(function*(){e.currentUser&&l.current&&(S(!0),yield M(Number.MAX_SAFE_INTEGER,Um.collection.message.defaultLimit),S(!1))}))),R=Gm(()=>b_(void 0,void 0,void 0,(function*(){var t;const n=p.current.instance;if((null==n?void 0:n.hasPrevious)&&!h.current.prev)try{h.current.prev=!0;const r=yield n.loadPrevious();y(r,!1,null===(t=e.currentUser)||void 0===t?void 0:t.userId)}catch(e){}finally{h.current.prev=!1}}))),k=Gm(()=>{const{initialized:e,instance:t}=p.current;return!(!e||!t)&&t.hasPrevious}),x=Gm(()=>b_(void 0,void 0,void 0,(function*(){var t;const n=p.current.instance;if((null==n?void 0:n.hasNext)&&!h.current.next)try{h.current.next=!0;const r=yield n.loadNext();y(r,!1,null===(t=e.currentUser)||void 0===t?void 0:t.userId)}catch(e){}finally{h.current.next=!1}}))),D=Gm(()=>{const{initialized:e,apiInitialized:t,instance:n}=p.current;return!!(t&&e&&n)&&n.hasNext}),U=Gm((t,n)=>{var r;if(!l.current||!l.current.url)throw null===(r=null==u?void 0:u.error)||void 0===r||r.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((r,i)=>{l.current.sendUserMessage(t).onPending(t=>{var r;t.channelUrl===l.current.url&&y([t],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),null==n||n(t)}).onSucceeded(t=>{var n;t.channelUrl===l.current.url&&y([t],!1,null===(n=e.currentUser)||void 0===n?void 0:n.userId),r(t)}).onFailed((t,n)=>{var r;n&&n.channelUrl===l.current.url&&y([n],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),i(t)})})}),L=Gm((t,n)=>{var r;if(!l.current||!l.current.url)throw null===(r=null==u?void 0:u.error)||void 0===r||r.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((r,i)=>{l.current.sendFileMessage(t).onPending(t=>{var r;t.channelUrl===l.current.url&&y([t],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),null==n||n(t)}).onSucceeded(t=>{var n;t.channelUrl===l.current.url&&y([t],!1,null===(n=e.currentUser)||void 0===n?void 0:n.userId),r(t)}).onFailed((t,n)=>{var r;n&&n.channelUrl===l.current.url&&y([n],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),i(t)})})}),P=Gm((t,n)=>b_(void 0,void 0,void 0,(function*(){var r;if(!l.current||!l.current.url)throw null===(r=null==u?void 0:u.error)||void 0===r||r.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise(r=>{const i=[];l.current.sendFileMessages(t).onPending(t=>{var r;t.channelUrl===l.current.url&&y([t],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),null==n||n(t)}).onSucceeded(n=>{var a;n.isFileMessage()&&n.channelUrl===l.current.url&&(y([n],!1,null===(a=e.currentUser)||void 0===a?void 0:a.userId),i.push(n)),i.length===t.length&&r(i)}).onFailed((n,a)=>{var s;a&&a.channelUrl===l.current.url?(y([a],!1,null===(s=e.currentUser)||void 0===s?void 0:s.userId),i.push(a)):i.push(null),i.length===t.length&&r(i)})})}))),F=Gm((t,n)=>{var r;if(!l.current||!l.current.url)throw null===(r=null==u?void 0:u.error)||void 0===r||r.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((r,i)=>{l.current.sendMultipleFilesMessage(t).onPending(t=>{var r;t.channelUrl===l.current.url&&y([t],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),null==n||n(t)}).onFileUploaded(()=>{f()}).onSucceeded(t=>{var n;t.channelUrl===l.current.url&&y([t],!1,null===(n=e.currentUser)||void 0===n?void 0:n.userId),r(t)}).onFailed((t,n)=>{var r;n&&n.channelUrl===l.current.url&&y([n],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),i(t)})})}),B=Gm((t,n)=>b_(void 0,void 0,void 0,(function*(){var r,i;if(!l.current||!l.current.url)throw null===(r=null==u?void 0:u.error)||void 0===r||r.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");const a=yield l.current.updateUserMessage(t,n);return a.channelUrl===l.current.url&&y([a],!1,null===(i=e.currentUser)||void 0===i?void 0:i.userId),a}))),j=Gm((t,n)=>b_(void 0,void 0,void 0,(function*(){var r,i;if(!l.current||!l.current.url)throw null===(r=null==u?void 0:u.error)||void 0===r||r.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");const a=yield l.current.updateFileMessage(t,n);return a.channelUrl===l.current.url&&y([a],!1,null===(i=e.currentUser)||void 0===i?void 0:i.userId),a}))),H=Gm(t=>b_(void 0,void 0,void 0,(function*(){var n;if(!l.current||!l.current.url)throw null===(n=null==u?void 0:u.error)||void 0===n||n.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((n,r)=>{let i=void 0;t.isUserMessage()&&(i=l.current.resendMessage(t)),t.isFileMessage()&&(i=l.current.resendMessage(t)),t.isMultipleFilesMessage()&&(i=l.current.resendMessage(t)),i&&("onPending"in i&&i.onPending(t=>{var n;t.channelUrl===l.current.url&&y([t],!1,null===(n=e.currentUser)||void 0===n?void 0:n.userId)}),"onFileUploaded"in i&&i.onFileUploaded(()=>{f()}),"onSucceeded"in i&&i.onSucceeded(t=>{var r;t.channelUrl===l.current.url&&y([t],!1,null===(r=e.currentUser)||void 0===r?void 0:r.userId),n(t)}),"onFailed"in i&&i.onFailed((t,n)=>{var i;n&&n.channelUrl===l.current.url&&y([n],!1,null===(i=e.currentUser)||void 0===i?void 0:i.userId),r(t)}))})}))),G=Gm(e=>b_(void 0,void 0,void 0,(function*(){var t,n;if(!l.current||!l.current.url)throw null===(t=null==u?void 0:u.error)||void 0===t||t.call(u,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");if("succeeded"===e.sendingStatus)e.isUserMessage()&&(yield l.current.deleteMessage(e)),e.isFileMessage()&&(yield l.current.deleteMessage(e)),e.isMultipleFilesMessage()&&(yield l.current.deleteMessage(e));else try{yield null===(n=p.current.instance)||void 0===n?void 0:n.removeFailedMessage(e.reqId)}finally{N([e.messageId],[e.reqId])}})));return{initialized:m,loading:g,refreshing:_,messages:v,newMessages:E,resetNewMessages:Gm(()=>{var t;b([],!0,null===(t=e.currentUser)||void 0===t?void 0:t.userId)}),refresh:O,loadPrevious:R,hasPrevious:k,loadNext:x,hasNext:D,sendUserMessage:U,sendFileMessage:L,sendFileMessages:P,sendMultipleFilesMessage:F,updateUserMessage:B,updateFileMessage:j,resendMessage:H,deleteMessage:G,resetWithStartingPoint:Gm(t=>b_(void 0,void 0,void 0,(function*(){var n;if(e.currentUser&&l.current){const r=C_(t);I(!0),y([],!0,null===(n=e.currentUser)||void 0===n?void 0:n.userId),yield M(t,r),I(!1)}}))),_dangerous_reducer_updateMessages:y,_dangerous_reducer_deleteMessages:N}},T_=e=>I_(e),I_=e=>"function"==typeof e&&e();function S_(e,t){const n=Object.assign({},e);return Object.keys(t).forEach(e=>{var r,i;Object.prototype.hasOwnProperty.call(n,e)&&(r=n[e],i=t[e],Object.prototype.toString.call(r)===Object.prototype.toString.call(i))&&("object"!=typeof t[e]||Array.isArray(t[e])?n[e]=t[e]:n[e]=S_(n[e],t[e]))}),n}const w_=()=>({common:{enableUsingDefaultUserProfile:!1},groupChannel:{channel:{enableMention:!1,enableOgtag:!0,enableReactions:!0,enableReactionsSupergroup:!1,enableTypingIndicator:!0,enableVoiceMessage:!1,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}},replyType:"quote_reply",threadReplySelectType:"thread",typingIndicatorTypes:new Set(["text"]),enableFeedback:!1,enableSuggestedReplies:!1,showSuggestedRepliesFor:"last_message_only",suggestedRepliesDirection:"vertical",enableMarkdownForUserMessage:!1,enableFormTypeMessage:!1},channelList:{enableMessageReceiptStatus:!1,enableTypingIndicator:!1},setting:{enableMessageSearch:!1}},openChannel:{channel:{enableOgtag:!0,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}}}}});const A_=()=>function(e){return delete e.groupChannel.channel.typingIndicatorTypes,delete e.groupChannel.channel.enableFeedback,delete e.groupChannel.channel.enableSuggestedReplies,delete e.groupChannel.channel.showSuggestedRepliesFor,delete e.groupChannel.channel.suggestedRepliesDirection,delete e.groupChannel.channel.enableMarkdownForUserMessage,delete e.groupChannel.channel.enableFormTypeMessage,e}(w_()),M_=w_(),O_=A_();var R_=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};const k_={items:{},getItem(e){var t;return R_(this,void 0,void 0,(function*(){return null!==(t=k_.items[e])&&void 0!==t?t:null}))},setItem(e,t){return R_(this,void 0,void 0,(function*(){k_.items[e]=t}))}};class x_{constructor(e){this.storage=null!=e?e:k_}init(e){return this.key=`sbu@${e}.uikitConfiguration`,this.get()}get safeKey(){if(!this.key)throw new Error("Please UIKitConfigManager.init() first");return this.key}update(e){return R_(this,void 0,void 0,(function*(){const t=yield this.get(),n={updatedAt:e.updatedAt,configuration:S_(t.configuration,e.configuration)};return yield this.storage.setItem(this.safeKey,JSON.stringify(n)),n}))}get(){return R_(this,void 0,void 0,(function*(){const e={updatedAt:0,configuration:O_};try{const t=yield this.storage.getItem(this.safeKey);return t?JSON.parse(t):e}catch(t){return e}}))}}function D_(e,t,n){!function(e,t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,S,w,A,M,O,R,k,x,D,U,L,P,F,B,j,H,G,z,V,q,K,W,Y,Q,X,Z,J,$,ee,te,ne,re,ie,ae,se,oe,le,ue,ce,de,he,fe,pe,me,ge,_e,ve,Ee,ye,be,Ce,Ne,Te,Ie,Se,we,Ae,Me,Oe,Re,ke,xe,De,Ue,Le,Pe,Fe,Be,je,He,Ge,ze,Ve,qe,Ke,We,Ye,Qe,Xe,Ze,Je,$e,et,tt,nt,rt,it,at;(null===(r=n.groupChannel)||void 0===r?void 0:r.channel)&&d_(null===(a=null===(i=n.groupChannel)||void 0===i?void 0:i.channel)||void 0===a?void 0:a.enableOgtag)&&(e.channel.enableOgtag=n.groupChannel.channel.enableOgtag);(null===(s=t.groupChannel)||void 0===s?void 0:s.channel)&&d_(null===(l=null===(o=t.groupChannel)||void 0===o?void 0:o.channel)||void 0===l?void 0:l.enableOgtag)&&(e.channel.enableOgtag=null===(c=null===(u=t.groupChannel)||void 0===u?void 0:u.channel)||void 0===c?void 0:c.enableOgtag);(null===(d=n.groupChannel)||void 0===d?void 0:d.channel)&&d_(null===(f=null===(h=n.groupChannel)||void 0===h?void 0:h.channel)||void 0===f?void 0:f.enableTypingIndicator)&&(e.channel.enableTypingIndicator=null===(m=null===(p=n.groupChannel)||void 0===p?void 0:p.channel)||void 0===m?void 0:m.enableTypingIndicator);(null===(g=t.groupChannel)||void 0===g?void 0:g.channel)&&d_(null===(v=null===(_=t.groupChannel)||void 0===_?void 0:_.channel)||void 0===v?void 0:v.enableTypingIndicator)&&(e.channel.enableTypingIndicator=null===(y=null===(E=t.groupChannel)||void 0===E?void 0:E.channel)||void 0===y?void 0:y.enableTypingIndicator);(null===(b=n.groupChannel)||void 0===b?void 0:b.channel)&&d_(null===(N=null===(C=n.groupChannel)||void 0===C?void 0:C.channel)||void 0===N?void 0:N.enableReactions)&&(e.channel.enableReactions=null===(I=null===(T=n.groupChannel)||void 0===T?void 0:T.channel)||void 0===I?void 0:I.enableReactions);(null===(S=t.groupChannel)||void 0===S?void 0:S.channel)&&d_(null===(A=null===(w=t.groupChannel)||void 0===w?void 0:w.channel)||void 0===A?void 0:A.enableReactions)&&(e.channel.enableReactions=null===(O=null===(M=t.groupChannel)||void 0===M?void 0:M.channel)||void 0===O?void 0:O.enableReactions);(null===(R=n.groupChannel)||void 0===R?void 0:R.channel)&&d_(null===(x=null===(k=n.groupChannel)||void 0===k?void 0:k.channel)||void 0===x?void 0:x.enableReactionsSupergroup)&&(e.channel.enableReactionsSupergroup=null===(U=null===(D=n.groupChannel)||void 0===D?void 0:D.channel)||void 0===U?void 0:U.enableReactionsSupergroup);(null===(L=t.groupChannel)||void 0===L?void 0:L.channel)&&d_(null===(F=null===(P=t.groupChannel)||void 0===P?void 0:P.channel)||void 0===F?void 0:F.enableReactionsSupergroup)&&console.warn("Currently, EnableReactionsSupergroup feature is turned off by default. If you wish to use this feature, contact us: https://dashboard.sendbird.com/settings/contact_us?category=feedback_and_feature_requests&product=UIKit");(null===(B=n.groupChannel)||void 0===B?void 0:B.channel)&&d_(null===(H=null===(j=n.groupChannel)||void 0===j?void 0:j.channel)||void 0===H?void 0:H.enableMention)&&(e.channel.enableMention=null===(z=null===(G=n.groupChannel)||void 0===G?void 0:G.channel)||void 0===z?void 0:z.enableMention);(null===(V=t.groupChannel)||void 0===V?void 0:V.channel)&&d_(null===(K=null===(q=t.groupChannel)||void 0===q?void 0:q.channel)||void 0===K?void 0:K.enableMention)&&(e.channel.enableMention=null===(Y=null===(W=t.groupChannel)||void 0===W?void 0:W.channel)||void 0===Y?void 0:Y.enableMention);(null===(Q=n.groupChannel)||void 0===Q?void 0:Q.channel)&&h_(null===(Z=null===(X=n.groupChannel)||void 0===X?void 0:X.channel)||void 0===Z?void 0:Z.replyType,["none","quote_reply","thread"])&&(e.channel.replyType=null===($=null===(J=n.groupChannel)||void 0===J?void 0:J.channel)||void 0===$?void 0:$.replyType);(null===(ee=t.groupChannel)||void 0===ee?void 0:ee.channel)&&h_(null===(ne=null===(te=t.groupChannel)||void 0===te?void 0:te.channel)||void 0===ne?void 0:ne.replyType,["none","quote_reply","thread"])&&(e.channel.replyType=null===(ie=null===(re=t.groupChannel)||void 0===re?void 0:re.channel)||void 0===ie?void 0:ie.replyType);(null===(ae=n.groupChannel)||void 0===ae?void 0:ae.channel)&&h_(null===(oe=null===(se=n.groupChannel)||void 0===se?void 0:se.channel)||void 0===oe?void 0:oe.threadReplySelectType,["thread","parent"])&&(e.channel.threadReplySelectType=null===(ue=null===(le=n.groupChannel)||void 0===le?void 0:le.channel)||void 0===ue?void 0:ue.threadReplySelectType);(null===(ce=t.groupChannel)||void 0===ce?void 0:ce.channel)&&h_(null===(he=null===(de=t.groupChannel)||void 0===de?void 0:de.channel)||void 0===he?void 0:he.threadReplySelectType,["thread","parent"])&&(e.channel.threadReplySelectType=null===(pe=null===(fe=t.groupChannel)||void 0===fe?void 0:fe.channel)||void 0===pe?void 0:pe.threadReplySelectType);(null===(me=n.groupChannel)||void 0===me?void 0:me.channel)&&d_(null===(_e=null===(ge=n.groupChannel)||void 0===ge?void 0:ge.channel)||void 0===_e?void 0:_e.enableVoiceMessage)&&(e.channel.enableVoiceMessage=null===(Ee=null===(ve=n.groupChannel)||void 0===ve?void 0:ve.channel)||void 0===Ee?void 0:Ee.enableVoiceMessage);(null===(ye=t.groupChannel)||void 0===ye?void 0:ye.channel)&&d_(null===(Ce=null===(be=t.groupChannel)||void 0===be?void 0:be.channel)||void 0===Ce?void 0:Ce.enableVoiceMessage)&&(e.channel.enableVoiceMessage=null===(Te=null===(Ne=t.groupChannel)||void 0===Ne?void 0:Ne.channel)||void 0===Te?void 0:Te.enableVoiceMessage);(null===(Ie=t.groupChannel)||void 0===Ie?void 0:Ie.channel)&&(st=null===(we=null===(Se=t.groupChannel)||void 0===Se?void 0:Se.channel)||void 0===we?void 0:we.typingIndicatorTypes,st instanceof Set)&&(e.channel.typingIndicatorTypes=null===(Me=null===(Ae=t.groupChannel)||void 0===Ae?void 0:Ae.channel)||void 0===Me?void 0:Me.typingIndicatorTypes);var st;(null===(Oe=t.groupChannel)||void 0===Oe?void 0:Oe.channel)&&d_(null===(ke=null===(Re=t.groupChannel)||void 0===Re?void 0:Re.channel)||void 0===ke?void 0:ke.enableFeedback)&&(e.channel.enableFeedback=null===(De=null===(xe=t.groupChannel)||void 0===xe?void 0:xe.channel)||void 0===De?void 0:De.enableFeedback);(null===(Ue=t.groupChannel)||void 0===Ue?void 0:Ue.channel)&&d_(null===(Pe=null===(Le=t.groupChannel)||void 0===Le?void 0:Le.channel)||void 0===Pe?void 0:Pe.enableSuggestedReplies)&&(e.channel.enableSuggestedReplies=null===(Be=null===(Fe=t.groupChannel)||void 0===Fe?void 0:Fe.channel)||void 0===Be?void 0:Be.enableSuggestedReplies);(null===(je=t.groupChannel)||void 0===je?void 0:je.channel)&&h_(null===(Ge=null===(He=t.groupChannel)||void 0===He?void 0:He.channel)||void 0===Ge?void 0:Ge.showSuggestedRepliesFor,["all_messages","last_message_only"])&&(e.channel.showSuggestedRepliesFor=null===(Ve=null===(ze=t.groupChannel)||void 0===ze?void 0:ze.channel)||void 0===Ve?void 0:Ve.showSuggestedRepliesFor);(null===(qe=t.groupChannel)||void 0===qe?void 0:qe.channel)&&h_(null===(We=null===(Ke=t.groupChannel)||void 0===Ke?void 0:Ke.channel)||void 0===We?void 0:We.suggestedRepliesDirection,["vertical","horizontal"])&&(e.channel.suggestedRepliesDirection=null===(Qe=null===(Ye=t.groupChannel)||void 0===Ye?void 0:Ye.channel)||void 0===Qe?void 0:Qe.suggestedRepliesDirection);(null===(Xe=t.groupChannel)||void 0===Xe?void 0:Xe.channel)&&d_(null===(Je=null===(Ze=t.groupChannel)||void 0===Ze?void 0:Ze.channel)||void 0===Je?void 0:Je.enableMarkdownForUserMessage)&&(e.channel.enableMarkdownForUserMessage=null===(et=null===($e=t.groupChannel)||void 0===$e?void 0:$e.channel)||void 0===et?void 0:et.enableMarkdownForUserMessage);(null===(tt=t.groupChannel)||void 0===tt?void 0:tt.channel)&&d_(null===(rt=null===(nt=t.groupChannel)||void 0===nt?void 0:nt.channel)||void 0===rt?void 0:rt.enableFormTypeMessage)&&(e.channel.enableFormTypeMessage=null===(at=null===(it=t.groupChannel)||void 0===it?void 0:it.channel)||void 0===at?void 0:at.enableFormTypeMessage)}(e,t,n),function(e,t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,S,w,A,M,O,R,k,x,D,U,L,P,F,B,j,H,G,z,V,q,K,W,Y,Q,X,Z,J,$,ee,te,ne,re,ie,ae,se,oe,le,ue,ce,de,he,fe,pe,me,ge,_e,ve,Ee,ye,be,Ce,Ne,Te,Ie,Se,we,Ae,Me,Oe,Re,ke,xe,De,Ue,Le,Pe,Fe,Be,je,He,Ge,ze,Ve,qe,Ke,We,Ye,Qe,Xe,Ze,Je;(null===(i=null===(r=n.groupChannel)||void 0===r?void 0:r.channel)||void 0===i?void 0:i.input)&&d_(null===(o=null===(s=null===(a=n.groupChannel)||void 0===a?void 0:a.channel)||void 0===s?void 0:s.input)||void 0===o?void 0:o.enableDocument)&&(e.channel.input.enableDocument=null===(c=null===(u=null===(l=n.groupChannel)||void 0===l?void 0:l.channel)||void 0===u?void 0:u.input)||void 0===c?void 0:c.enableDocument);(null===(h=null===(d=t.groupChannel)||void 0===d?void 0:d.channel)||void 0===h?void 0:h.input)&&d_(null===(m=null===(p=null===(f=t.groupChannel)||void 0===f?void 0:f.channel)||void 0===p?void 0:p.input)||void 0===m?void 0:m.enableDocument)&&(e.channel.input.enableDocument=null===(v=null===(_=null===(g=t.groupChannel)||void 0===g?void 0:g.channel)||void 0===_?void 0:_.input)||void 0===v?void 0:v.enableDocument);(null===(b=null===(y=null===(E=n.groupChannel)||void 0===E?void 0:E.channel)||void 0===y?void 0:y.input)||void 0===b?void 0:b.camera)&&d_(null===(I=null===(T=null===(N=null===(C=n.groupChannel)||void 0===C?void 0:C.channel)||void 0===N?void 0:N.input)||void 0===T?void 0:T.camera)||void 0===I?void 0:I.enablePhoto)&&(e.channel.input.camera.enablePhoto=null===(M=null===(A=null===(w=null===(S=n.groupChannel)||void 0===S?void 0:S.channel)||void 0===w?void 0:w.input)||void 0===A?void 0:A.camera)||void 0===M?void 0:M.enablePhoto);(null===(k=null===(R=null===(O=t.groupChannel)||void 0===O?void 0:O.channel)||void 0===R?void 0:R.input)||void 0===k?void 0:k.camera)&&d_(null===(L=null===(U=null===(D=null===(x=t.groupChannel)||void 0===x?void 0:x.channel)||void 0===D?void 0:D.input)||void 0===U?void 0:U.camera)||void 0===L?void 0:L.enablePhoto)&&(e.channel.input.camera.enablePhoto=null===(j=null===(B=null===(F=null===(P=t.groupChannel)||void 0===P?void 0:P.channel)||void 0===F?void 0:F.input)||void 0===B?void 0:B.camera)||void 0===j?void 0:j.enablePhoto);(null===(z=null===(G=null===(H=n.groupChannel)||void 0===H?void 0:H.channel)||void 0===G?void 0:G.input)||void 0===z?void 0:z.camera)&&d_(null===(W=null===(K=null===(q=null===(V=n.groupChannel)||void 0===V?void 0:V.channel)||void 0===q?void 0:q.input)||void 0===K?void 0:K.camera)||void 0===W?void 0:W.enableVideo)&&(e.channel.input.camera.enableVideo=null===(Z=null===(X=null===(Q=null===(Y=n.groupChannel)||void 0===Y?void 0:Y.channel)||void 0===Q?void 0:Q.input)||void 0===X?void 0:X.camera)||void 0===Z?void 0:Z.enableVideo);(null===(ee=null===($=null===(J=t.groupChannel)||void 0===J?void 0:J.channel)||void 0===$?void 0:$.input)||void 0===ee?void 0:ee.camera)&&d_(null===(ie=null===(re=null===(ne=null===(te=t.groupChannel)||void 0===te?void 0:te.channel)||void 0===ne?void 0:ne.input)||void 0===re?void 0:re.camera)||void 0===ie?void 0:ie.enableVideo)&&(e.channel.input.camera.enableVideo=null===(le=null===(oe=null===(se=null===(ae=t.groupChannel)||void 0===ae?void 0:ae.channel)||void 0===se?void 0:se.input)||void 0===oe?void 0:oe.camera)||void 0===le?void 0:le.enableVideo);(null===(de=null===(ce=null===(ue=n.groupChannel)||void 0===ue?void 0:ue.channel)||void 0===ce?void 0:ce.input)||void 0===de?void 0:de.gallery)&&d_(null===(me=null===(pe=null===(fe=null===(he=n.groupChannel)||void 0===he?void 0:he.channel)||void 0===fe?void 0:fe.input)||void 0===pe?void 0:pe.gallery)||void 0===me?void 0:me.enablePhoto)&&(e.channel.input.gallery.enablePhoto=null===(Ee=null===(ve=null===(_e=null===(ge=n.groupChannel)||void 0===ge?void 0:ge.channel)||void 0===_e?void 0:_e.input)||void 0===ve?void 0:ve.gallery)||void 0===Ee?void 0:Ee.enablePhoto);(null===(Ce=null===(be=null===(ye=t.groupChannel)||void 0===ye?void 0:ye.channel)||void 0===be?void 0:be.input)||void 0===Ce?void 0:Ce.gallery)&&d_(null===(Se=null===(Ie=null===(Te=null===(Ne=t.groupChannel)||void 0===Ne?void 0:Ne.channel)||void 0===Te?void 0:Te.input)||void 0===Ie?void 0:Ie.gallery)||void 0===Se?void 0:Se.enablePhoto)&&(e.channel.input.gallery.enablePhoto=null===(Oe=null===(Me=null===(Ae=null===(we=t.groupChannel)||void 0===we?void 0:we.channel)||void 0===Ae?void 0:Ae.input)||void 0===Me?void 0:Me.gallery)||void 0===Oe?void 0:Oe.enablePhoto);(null===(xe=null===(ke=null===(Re=n.groupChannel)||void 0===Re?void 0:Re.channel)||void 0===ke?void 0:ke.input)||void 0===xe?void 0:xe.gallery)&&d_(null===(Pe=null===(Le=null===(Ue=null===(De=n.groupChannel)||void 0===De?void 0:De.channel)||void 0===Ue?void 0:Ue.input)||void 0===Le?void 0:Le.gallery)||void 0===Pe?void 0:Pe.enableVideo)&&(e.channel.input.gallery.enableVideo=null===(He=null===(je=null===(Be=null===(Fe=n.groupChannel)||void 0===Fe?void 0:Fe.channel)||void 0===Be?void 0:Be.input)||void 0===je?void 0:je.gallery)||void 0===He?void 0:He.enableVideo);(null===(Ve=null===(ze=null===(Ge=t.groupChannel)||void 0===Ge?void 0:Ge.channel)||void 0===ze?void 0:ze.input)||void 0===Ve?void 0:Ve.gallery)&&d_(null===(Ye=null===(We=null===(Ke=null===(qe=t.groupChannel)||void 0===qe?void 0:qe.channel)||void 0===Ke?void 0:Ke.input)||void 0===We?void 0:We.gallery)||void 0===Ye?void 0:Ye.enableVideo)&&(e.channel.input.gallery.enableVideo=null===(Je=null===(Ze=null===(Xe=null===(Qe=t.groupChannel)||void 0===Qe?void 0:Qe.channel)||void 0===Xe?void 0:Xe.input)||void 0===Ze?void 0:Ze.gallery)||void 0===Je?void 0:Je.enableVideo)}(e,t,n),function(e,t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y;(null===(r=n.groupChannel)||void 0===r?void 0:r.channelList)&&d_(null===(a=null===(i=n.groupChannel)||void 0===i?void 0:i.channelList)||void 0===a?void 0:a.enableTypingIndicator)&&(e.channelList.enableTypingIndicator=n.groupChannel.channelList.enableTypingIndicator);(null===(s=t.groupChannel)||void 0===s?void 0:s.channelList)&&d_(null===(l=null===(o=t.groupChannel)||void 0===o?void 0:o.channelList)||void 0===l?void 0:l.enableTypingIndicator)&&(e.channelList.enableTypingIndicator=null===(c=null===(u=t.groupChannel)||void 0===u?void 0:u.channelList)||void 0===c?void 0:c.enableTypingIndicator);(null===(d=n.groupChannel)||void 0===d?void 0:d.channelList)&&d_(null===(f=null===(h=n.groupChannel)||void 0===h?void 0:h.channelList)||void 0===f?void 0:f.enableMessageReceiptStatus)&&(e.channelList.enableMessageReceiptStatus=null===(m=null===(p=n.groupChannel)||void 0===p?void 0:p.channelList)||void 0===m?void 0:m.enableMessageReceiptStatus);(null===(g=t.groupChannel)||void 0===g?void 0:g.channelList)&&d_(null===(v=null===(_=t.groupChannel)||void 0===_?void 0:_.channelList)||void 0===v?void 0:v.enableMessageReceiptStatus)&&(e.channelList.enableMessageReceiptStatus=null===(y=null===(E=t.groupChannel)||void 0===E?void 0:E.channelList)||void 0===y?void 0:y.enableMessageReceiptStatus)}(e,t,n),function(e,t,n){var r,i,a,s,o,l,u,c;(null===(r=n.groupChannel)||void 0===r?void 0:r.setting)&&d_(null===(a=null===(i=n.groupChannel)||void 0===i?void 0:i.setting)||void 0===a?void 0:a.enableMessageSearch)&&(e.setting.enableMessageSearch=n.groupChannel.setting.enableMessageSearch);(null===(s=t.groupChannel)||void 0===s?void 0:s.setting)&&d_(null===(l=null===(o=t.groupChannel)||void 0===o?void 0:o.setting)||void 0===l?void 0:l.enableMessageSearch)&&(e.setting.enableMessageSearch=null===(c=null===(u=t.groupChannel)||void 0===u?void 0:u.setting)||void 0===c?void 0:c.enableMessageSearch)}(e,t,n)}function U_(e,t,n){!function(e,t,n){var r,i,a,s,o,l,u,c;(null===(r=n.openChannel)||void 0===r?void 0:r.channel)&&d_(null===(a=null===(i=n.openChannel)||void 0===i?void 0:i.channel)||void 0===a?void 0:a.enableOgtag)&&(e.channel.enableOgtag=n.openChannel.channel.enableOgtag);(null===(s=t.openChannel)||void 0===s?void 0:s.channel)&&d_(null===(l=null===(o=t.openChannel)||void 0===o?void 0:o.channel)||void 0===l?void 0:l.enableOgtag)&&(e.channel.enableOgtag=null===(c=null===(u=t.openChannel)||void 0===u?void 0:u.channel)||void 0===c?void 0:c.enableOgtag)}(e,t,n),function(e,t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,S,w,A,M,O,R,k,x,D,U,L,P,F,B,j,H,G,z,V,q,K,W,Y,Q,X,Z,J,$,ee,te,ne,re,ie,ae,se,oe,le,ue,ce,de,he,fe,pe,me,ge,_e,ve,Ee,ye,be,Ce,Ne,Te,Ie,Se,we,Ae,Me,Oe,Re,ke,xe,De,Ue,Le,Pe,Fe,Be,je,He,Ge,ze,Ve,qe,Ke,We,Ye,Qe,Xe,Ze,Je;(null===(i=null===(r=n.openChannel)||void 0===r?void 0:r.channel)||void 0===i?void 0:i.input)&&d_(null===(o=null===(s=null===(a=n.openChannel)||void 0===a?void 0:a.channel)||void 0===s?void 0:s.input)||void 0===o?void 0:o.enableDocument)&&(e.channel.input.enableDocument=null===(c=null===(u=null===(l=n.openChannel)||void 0===l?void 0:l.channel)||void 0===u?void 0:u.input)||void 0===c?void 0:c.enableDocument);(null===(h=null===(d=t.openChannel)||void 0===d?void 0:d.channel)||void 0===h?void 0:h.input)&&d_(null===(m=null===(p=null===(f=t.openChannel)||void 0===f?void 0:f.channel)||void 0===p?void 0:p.input)||void 0===m?void 0:m.enableDocument)&&(e.channel.input.enableDocument=null===(v=null===(_=null===(g=t.openChannel)||void 0===g?void 0:g.channel)||void 0===_?void 0:_.input)||void 0===v?void 0:v.enableDocument);(null===(b=null===(y=null===(E=n.openChannel)||void 0===E?void 0:E.channel)||void 0===y?void 0:y.input)||void 0===b?void 0:b.camera)&&d_(null===(I=null===(T=null===(N=null===(C=n.openChannel)||void 0===C?void 0:C.channel)||void 0===N?void 0:N.input)||void 0===T?void 0:T.camera)||void 0===I?void 0:I.enablePhoto)&&(e.channel.input.camera.enablePhoto=null===(M=null===(A=null===(w=null===(S=n.openChannel)||void 0===S?void 0:S.channel)||void 0===w?void 0:w.input)||void 0===A?void 0:A.camera)||void 0===M?void 0:M.enablePhoto);(null===(k=null===(R=null===(O=t.openChannel)||void 0===O?void 0:O.channel)||void 0===R?void 0:R.input)||void 0===k?void 0:k.camera)&&d_(null===(L=null===(U=null===(D=null===(x=t.openChannel)||void 0===x?void 0:x.channel)||void 0===D?void 0:D.input)||void 0===U?void 0:U.camera)||void 0===L?void 0:L.enablePhoto)&&(e.channel.input.camera.enablePhoto=null===(j=null===(B=null===(F=null===(P=t.openChannel)||void 0===P?void 0:P.channel)||void 0===F?void 0:F.input)||void 0===B?void 0:B.camera)||void 0===j?void 0:j.enablePhoto);(null===(z=null===(G=null===(H=n.openChannel)||void 0===H?void 0:H.channel)||void 0===G?void 0:G.input)||void 0===z?void 0:z.camera)&&d_(null===(W=null===(K=null===(q=null===(V=n.openChannel)||void 0===V?void 0:V.channel)||void 0===q?void 0:q.input)||void 0===K?void 0:K.camera)||void 0===W?void 0:W.enableVideo)&&(e.channel.input.camera.enableVideo=null===(Z=null===(X=null===(Q=null===(Y=n.openChannel)||void 0===Y?void 0:Y.channel)||void 0===Q?void 0:Q.input)||void 0===X?void 0:X.camera)||void 0===Z?void 0:Z.enableVideo);(null===(ee=null===($=null===(J=t.openChannel)||void 0===J?void 0:J.channel)||void 0===$?void 0:$.input)||void 0===ee?void 0:ee.camera)&&d_(null===(ie=null===(re=null===(ne=null===(te=t.openChannel)||void 0===te?void 0:te.channel)||void 0===ne?void 0:ne.input)||void 0===re?void 0:re.camera)||void 0===ie?void 0:ie.enableVideo)&&(e.channel.input.camera.enableVideo=null===(le=null===(oe=null===(se=null===(ae=t.openChannel)||void 0===ae?void 0:ae.channel)||void 0===se?void 0:se.input)||void 0===oe?void 0:oe.camera)||void 0===le?void 0:le.enableVideo);(null===(de=null===(ce=null===(ue=n.openChannel)||void 0===ue?void 0:ue.channel)||void 0===ce?void 0:ce.input)||void 0===de?void 0:de.gallery)&&d_(null===(me=null===(pe=null===(fe=null===(he=n.openChannel)||void 0===he?void 0:he.channel)||void 0===fe?void 0:fe.input)||void 0===pe?void 0:pe.gallery)||void 0===me?void 0:me.enablePhoto)&&(e.channel.input.gallery.enablePhoto=null===(Ee=null===(ve=null===(_e=null===(ge=n.openChannel)||void 0===ge?void 0:ge.channel)||void 0===_e?void 0:_e.input)||void 0===ve?void 0:ve.gallery)||void 0===Ee?void 0:Ee.enablePhoto);(null===(Ce=null===(be=null===(ye=t.openChannel)||void 0===ye?void 0:ye.channel)||void 0===be?void 0:be.input)||void 0===Ce?void 0:Ce.gallery)&&d_(null===(Se=null===(Ie=null===(Te=null===(Ne=t.openChannel)||void 0===Ne?void 0:Ne.channel)||void 0===Te?void 0:Te.input)||void 0===Ie?void 0:Ie.gallery)||void 0===Se?void 0:Se.enablePhoto)&&(e.channel.input.gallery.enablePhoto=null===(Oe=null===(Me=null===(Ae=null===(we=t.openChannel)||void 0===we?void 0:we.channel)||void 0===Ae?void 0:Ae.input)||void 0===Me?void 0:Me.gallery)||void 0===Oe?void 0:Oe.enablePhoto);(null===(xe=null===(ke=null===(Re=n.openChannel)||void 0===Re?void 0:Re.channel)||void 0===ke?void 0:ke.input)||void 0===xe?void 0:xe.gallery)&&d_(null===(Pe=null===(Le=null===(Ue=null===(De=n.openChannel)||void 0===De?void 0:De.channel)||void 0===Ue?void 0:Ue.input)||void 0===Le?void 0:Le.gallery)||void 0===Pe?void 0:Pe.enableVideo)&&(e.channel.input.gallery.enableVideo=null===(He=null===(je=null===(Be=null===(Fe=n.openChannel)||void 0===Fe?void 0:Fe.channel)||void 0===Be?void 0:Be.input)||void 0===je?void 0:je.gallery)||void 0===He?void 0:He.enableVideo);(null===(Ve=null===(ze=null===(Ge=t.openChannel)||void 0===Ge?void 0:Ge.channel)||void 0===ze?void 0:ze.input)||void 0===Ve?void 0:Ve.gallery)&&d_(null===(Ye=null===(We=null===(Ke=null===(qe=t.openChannel)||void 0===qe?void 0:qe.channel)||void 0===Ke?void 0:Ke.input)||void 0===We?void 0:We.gallery)||void 0===Ye?void 0:Ye.enableVideo)&&(e.channel.input.gallery.enableVideo=null===(Je=null===(Ze=null===(Xe=null===(Qe=t.openChannel)||void 0===Qe?void 0:Qe.channel)||void 0===Xe?void 0:Xe.input)||void 0===Ze?void 0:Ze.gallery)||void 0===Je?void 0:Je.enableVideo)}(e,t,n)}function L_(e,t){const n=w_();var r,i,a,s,o;return r=n.common,i=e,(a=t).common&&d_(null===(s=a.common)||void 0===s?void 0:s.enableUsingDefaultUserProfile)&&(r.enableUsingDefaultUserProfile=a.common.enableUsingDefaultUserProfile),i.common&&d_(null===(o=i.common)||void 0===o?void 0:o.enableUsingDefaultUserProfile)&&(r.enableUsingDefaultUserProfile=i.common.enableUsingDefaultUserProfile),D_(n.groupChannel,e,t),U_(n.openChannel,e,t),n}var P_=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};function F_(e){var t,n;return null!==(n=null===(t=e.appInfo)||void 0===t?void 0:t.applicationAttributes)&&void 0!==n?n:[]}const B_=Object(i.createContext)({initDashboardConfigs:()=>Promise.resolve(),configs:M_,configsWithAppAttr:()=>M_}),j_=({storage:e,children:t,localConfigs:n={}})=>{const[r,s]=Object(i.useState)(A_),[o]=Object(i.useState)(()=>new x_(e)),l=Object(i.useCallback)(e=>P_(void 0,void 0,void 0,(function*(){const t=yield o.init(e.appId);if(e.appInfo&&e.appInfo.uikitConfigInfo.lastUpdatedAt===t.updatedAt)s(t.configuration);else try{const t=yield e.getUIKitConfiguration();if("object"==typeof(n=t.json)&&"configuration"in n&&"updated_at"in n){const e=function e(t){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))return t.map(t=>e(t));const n={};return Object.keys(t).forEach(r=>{const i=r.replace(/_\w/g,e=>e[1].toUpperCase());n[i]=e(t[r])}),n}(t.json),n=yield o.update(e);s(n.configuration)}}catch(e){s(t.configuration)}var n})),[o]),u=L_(n,r),c=Gm(e=>({groupChannel:{channel:{get enableReactions(){return u.groupChannel.channel.enableReactions&&F_(e).includes(y)},get enableReactionsSupergroup(){return u.groupChannel.channel.enableReactionsSupergroup&&F_(e).includes(y)},get enableOgtag(){return u.groupChannel.channel.enableOgtag&&F_(e).includes(C)}},setting:{get enableMessageSearch(){return u.groupChannel.setting.enableMessageSearch&&F_(e).includes(b)}}},openChannel:{channel:{get enableOgtag(){return u.openChannel.channel.enableOgtag&&F_(e).includes(C)}}}}));return a.a.createElement(B_.Provider,{value:{initDashboardConfigs:l,configs:u,configsWithAppAttr:c}},t)};function H_(e){return{lowerCase:e.toLowerCase(),upperCase:e.toUpperCase()}}var G_=11025,z_=["audio/webm","audio/mp4","audio/mpeg","audio/ogg"],V_="sendbird-voice-player-provider-root",q_=function(e){return!function(e){return/Chrome/i.test(e)}(e)&&/Safari/i.test(e)},K_=function(e){return function(e){return/iPhone|iPad|iPod/i.test(e)}(e)&&(function(e){return/WebKit/i.test(e)}(e)||q_(e))},W_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function Y_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Q_,X_={exports:{}},Z_={};X_.exports=function(){if(Q_)return Z_;Q_=1;var e=a.a,t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useState,r=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function o(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!t(e,r)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),l=n({inst:{value:a,getSnapshot:t}}),u=l[0].inst,c=l[1];return i((function(){u.value=a,u.getSnapshot=t,o(u)&&c({inst:u})}),[e,a,t]),r((function(){return o(u)&&c({inst:u}),e((function(){o(u)&&c({inst:u})}))}),[e]),s(a),a};return Z_.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,Z_}();var J_=X_.exports;var $_=function(){this.__data__=[],this.size=0};var ev=function(e,t){return e===t||e!=e&&t!=t},tv=ev;var nv=function(e,t){for(var n=e.length;n--;)if(tv(e[n][0],t))return n;return-1},rv=nv,iv=Array.prototype.splice;var av=nv;var sv=nv;var ov=nv;var lv=$_,uv=function(e){var t=this.__data__,n=rv(t,e);return!(n<0)&&(n==t.length-1?t.pop():iv.call(t,n,1),--this.size,!0)},cv=function(e){var t=this.__data__,n=av(t,e);return n<0?void 0:t[n][1]},dv=function(e){return sv(this.__data__,e)>-1},hv=function(e,t){var n=this.__data__,r=ov(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function fv(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}fv.prototype.clear=lv,fv.prototype.delete=uv,fv.prototype.get=cv,fv.prototype.has=dv,fv.prototype.set=hv;var pv=fv,mv=pv;var gv=function(){this.__data__=new mv,this.size=0};var _v=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var vv=function(e){return this.__data__.get(e)};var Ev=function(e){return this.__data__.has(e)},yv="object"==typeof W_&&W_&&W_.Object===Object&&W_,bv=yv,Cv="object"==typeof self&&self&&self.Object===Object&&self,Nv=bv||Cv||Function("return this")(),Tv=Nv.Symbol,Iv=Tv,Sv=Object.prototype,wv=Sv.hasOwnProperty,Av=Sv.toString,Mv=Iv?Iv.toStringTag:void 0;var Ov=function(e){var t=wv.call(e,Mv),n=e[Mv];try{e[Mv]=void 0;var r=!0}catch(e){}var i=Av.call(e);return r&&(t?e[Mv]=n:delete e[Mv]),i},Rv=Object.prototype.toString;var kv=Ov,xv=function(e){return Rv.call(e)},Dv=Tv?Tv.toStringTag:void 0;var Uv=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Dv&&Dv in Object(e)?kv(e):xv(e)};var Lv=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Pv=Uv,Fv=Lv;var Bv,jv=function(e){if(!Fv(e))return!1;var t=Pv(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Hv=Nv["__core-js_shared__"],Gv=(Bv=/[^.]+$/.exec(Hv&&Hv.keys&&Hv.keys.IE_PROTO||""))?"Symbol(src)_1."+Bv:"";var zv=function(e){return!!Gv&&Gv in e},Vv=Function.prototype.toString;var qv=function(e){if(null!=e){try{return Vv.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Kv=jv,Wv=zv,Yv=Lv,Qv=qv,Xv=/^\[object .+?Constructor\]$/,Zv=Function.prototype,Jv=Object.prototype,$v=Zv.toString,eE=Jv.hasOwnProperty,tE=RegExp("^"+$v.call(eE).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var nE=function(e){return!(!Yv(e)||Wv(e))&&(Kv(e)?tE:Xv).test(Qv(e))},rE=function(e,t){return null==e?void 0:e[t]};var iE=function(e,t){var n=rE(e,t);return nE(n)?n:void 0},aE=iE(Nv,"Map"),sE=iE(Object,"create"),oE=sE;var lE=function(){this.__data__=oE?oE(null):{},this.size=0};var uE=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},cE=sE,dE=Object.prototype.hasOwnProperty;var hE=function(e){var t=this.__data__;if(cE){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return dE.call(t,e)?t[e]:void 0},fE=sE,pE=Object.prototype.hasOwnProperty;var mE=sE;var gE=lE,_E=uE,vE=hE,EE=function(e){var t=this.__data__;return fE?void 0!==t[e]:pE.call(t,e)},yE=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=mE&&void 0===t?"__lodash_hash_undefined__":t,this};function bE(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}bE.prototype.clear=gE,bE.prototype.delete=_E,bE.prototype.get=vE,bE.prototype.has=EE,bE.prototype.set=yE;var CE=bE,NE=pv,TE=aE;var IE=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var SE=function(e,t){var n=e.__data__;return IE(t)?n["string"==typeof t?"string":"hash"]:n.map},wE=SE;var AE=SE;var ME=SE;var OE=SE;var RE=function(){this.size=0,this.__data__={hash:new CE,map:new(TE||NE),string:new CE}},kE=function(e){var t=wE(this,e).delete(e);return this.size-=t?1:0,t},xE=function(e){return AE(this,e).get(e)},DE=function(e){return ME(this,e).has(e)},UE=function(e,t){var n=OE(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function LE(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}LE.prototype.clear=RE,LE.prototype.delete=kE,LE.prototype.get=xE,LE.prototype.has=DE,LE.prototype.set=UE;var PE=LE,FE=pv,BE=aE,jE=PE;var HE=pv,GE=gv,zE=_v,VE=vv,qE=Ev,KE=function(e,t){var n=this.__data__;if(n instanceof FE){var r=n.__data__;if(!BE||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new jE(r)}return n.set(e,t),this.size=n.size,this};function WE(e){var t=this.__data__=new HE(e);this.size=t.size}WE.prototype.clear=GE,WE.prototype.delete=zE,WE.prototype.get=VE,WE.prototype.has=qE,WE.prototype.set=KE;var YE=WE;var QE=PE,XE=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ZE=function(e){return this.__data__.has(e)};function JE(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new QE;++t<n;)this.add(e[t])}JE.prototype.add=JE.prototype.push=XE,JE.prototype.has=ZE;var $E=JE,ey=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},ty=function(e,t){return e.has(t)};var ny=function(e,t,n,r,i,a){var s=1&n,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var u=a.get(e),c=a.get(t);if(u&&c)return u==t&&c==e;var d=-1,h=!0,f=2&n?new $E:void 0;for(a.set(e,t),a.set(t,e);++d<o;){var p=e[d],m=t[d];if(r)var g=s?r(m,p,d,t,e,a):r(p,m,d,e,t,a);if(void 0!==g){if(g)continue;h=!1;break}if(f){if(!ey(t,(function(e,t){if(!ty(f,t)&&(p===e||i(p,e,n,r,a)))return f.push(t)}))){h=!1;break}}else if(p!==m&&!i(p,m,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h};var ry=Nv.Uint8Array,iy=ev,ay=ny,sy=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},oy=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},ly=Tv?Tv.prototype:void 0,uy=ly?ly.valueOf:void 0;var cy=function(e,t,n,r,i,a,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new ry(e),new ry(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return iy(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=sy;case"[object Set]":var l=1&r;if(o||(o=oy),e.size!=t.size&&!l)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var c=ay(o(e),o(t),r,i,a,s);return s.delete(e),c;case"[object Symbol]":if(uy)return uy.call(e)==uy.call(t)}return!1};var dy=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},hy=Array.isArray,fy=dy,py=hy;var my=function(e,t,n){var r=t(e);return py(e)?r:fy(r,n(e))};var gy=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var s=e[n];t(s,n,e)&&(a[i++]=s)}return a},_y=function(){return[]},vy=Object.prototype.propertyIsEnumerable,Ey=Object.getOwnPropertySymbols,yy=Ey?function(e){return null==e?[]:(e=Object(e),gy(Ey(e),(function(t){return vy.call(e,t)})))}:_y;var by=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var Cy=function(e){return null!=e&&"object"==typeof e},Ny=Uv,Ty=Cy;var Iy=function(e){return Ty(e)&&"[object Arguments]"==Ny(e)},Sy=Cy,wy=Object.prototype,Ay=wy.hasOwnProperty,My=wy.propertyIsEnumerable,Oy=Iy(function(){return arguments}())?Iy:function(e){return Sy(e)&&Ay.call(e,"callee")&&!My.call(e,"callee")},Ry={exports:{}};var ky=function(){return!1};!function(e,t){var n=Nv,r=ky,i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i?n.Buffer:void 0,o=(s?s.isBuffer:void 0)||r;e.exports=o}(Ry,Ry.exports);var xy=Ry.exports,Dy=/^(?:0|[1-9]\d*)$/;var Uy=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Dy.test(e))&&e>-1&&e%1==0&&e<t};var Ly=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Py=Uv,Fy=Ly,By=Cy,jy={};jy["[object Float32Array]"]=jy["[object Float64Array]"]=jy["[object Int8Array]"]=jy["[object Int16Array]"]=jy["[object Int32Array]"]=jy["[object Uint8Array]"]=jy["[object Uint8ClampedArray]"]=jy["[object Uint16Array]"]=jy["[object Uint32Array]"]=!0,jy["[object Arguments]"]=jy["[object Array]"]=jy["[object ArrayBuffer]"]=jy["[object Boolean]"]=jy["[object DataView]"]=jy["[object Date]"]=jy["[object Error]"]=jy["[object Function]"]=jy["[object Map]"]=jy["[object Number]"]=jy["[object Object]"]=jy["[object RegExp]"]=jy["[object Set]"]=jy["[object String]"]=jy["[object WeakMap]"]=!1;var Hy=function(e){return By(e)&&Fy(e.length)&&!!jy[Py(e)]};var Gy=function(e){return function(t){return e(t)}},zy={exports:{}};!function(e,t){var n=yv,r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,a=i&&i.exports===r&&n.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}(zy,zy.exports);var Vy=zy.exports,qy=Hy,Ky=Gy,Wy=Vy&&Vy.isTypedArray,Yy=Wy?Ky(Wy):qy,Qy=by,Xy=Oy,Zy=hy,Jy=xy,$y=Uy,eb=Yy,tb=Object.prototype.hasOwnProperty;var nb=function(e,t){var n=Zy(e),r=!n&&Xy(e),i=!n&&!r&&Jy(e),a=!n&&!r&&!i&&eb(e),s=n||r||i||a,o=s?Qy(e.length,String):[],l=o.length;for(var u in e)!t&&!tb.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||$y(u,l))||o.push(u);return o},rb=Object.prototype;var ib=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||rb)};var ab=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),sb=ib,ob=ab,lb=Object.prototype.hasOwnProperty;var ub=jv,cb=Ly;var db=nb,hb=function(e){if(!sb(e))return ob(e);var t=[];for(var n in Object(e))lb.call(e,n)&&"constructor"!=n&&t.push(n);return t},fb=function(e){return null!=e&&cb(e.length)&&!ub(e)};var pb=my,mb=yy,gb=function(e){return fb(e)?db(e):hb(e)};var _b=function(e){return pb(e,gb,mb)},vb=Object.prototype.hasOwnProperty;var Eb=function(e,t,n,r,i,a){var s=1&n,o=_b(e),l=o.length;if(l!=_b(t).length&&!s)return!1;for(var u=l;u--;){var c=o[u];if(!(s?c in t:vb.call(t,c)))return!1}var d=a.get(e),h=a.get(t);if(d&&h)return d==t&&h==e;var f=!0;a.set(e,t),a.set(t,e);for(var p=s;++u<l;){var m=e[c=o[u]],g=t[c];if(r)var _=s?r(g,m,c,t,e,a):r(m,g,c,e,t,a);if(!(void 0===_?m===g||i(m,g,n,r,a):_)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var v=e.constructor,E=t.constructor;v==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof E&&E instanceof E||(f=!1)}return a.delete(e),a.delete(t),f},yb=iE(Nv,"DataView"),bb=aE,Cb=iE(Nv,"Promise"),Nb=iE(Nv,"Set"),Tb=iE(Nv,"WeakMap"),Ib=Uv,Sb=qv,wb=Sb(yb),Ab=Sb(bb),Mb=Sb(Cb),Ob=Sb(Nb),Rb=Sb(Tb),kb=Ib;(yb&&"[object DataView]"!=kb(new yb(new ArrayBuffer(1)))||bb&&"[object Map]"!=kb(new bb)||Cb&&"[object Promise]"!=kb(Cb.resolve())||Nb&&"[object Set]"!=kb(new Nb)||Tb&&"[object WeakMap]"!=kb(new Tb))&&(kb=function(e){var t=Ib(e),n="[object Object]"==t?e.constructor:void 0,r=n?Sb(n):"";if(r)switch(r){case wb:return"[object DataView]";case Ab:return"[object Map]";case Mb:return"[object Promise]";case Ob:return"[object Set]";case Rb:return"[object WeakMap]"}return t});var xb=YE,Db=ny,Ub=cy,Lb=Eb,Pb=kb,Fb=hy,Bb=xy,jb=Yy,Hb="[object Object]",Gb=Object.prototype.hasOwnProperty;var zb=function(e,t,n,r,i,a){var s=Fb(e),o=Fb(t),l=s?"[object Array]":Pb(e),u=o?"[object Array]":Pb(t),c=(l="[object Arguments]"==l?Hb:l)==Hb,d=(u="[object Arguments]"==u?Hb:u)==Hb,h=l==u;if(h&&Bb(e)){if(!Bb(t))return!1;s=!0,c=!1}if(h&&!c)return a||(a=new xb),s||jb(e)?Db(e,t,n,r,i,a):Ub(e,t,l,n,r,i,a);if(!(1&n)){var f=c&&Gb.call(e,"__wrapped__"),p=d&&Gb.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,g=p?t.value():t;return a||(a=new xb),i(m,g,n,r,a)}}return!!h&&(a||(a=new xb),Lb(e,t,n,r,i,a))},Vb=Cy;var qb=function e(t,n,r,i,a){return t===n||(null==t||null==n||!Vb(t)&&!Vb(n)?t!=t&&n!=n:zb(t,n,r,i,e,a))};var Kb=Y_((function(e,t){return qb(e,t)}));function Wb(e,t){return Object.entries(t).some((function(t){var n=t[0],r=t[1];return("function"!=typeof e[n]||"function"!=typeof r)&&!Kb(e[n],r)}))}function Yb(e){var t=m({},e),n=new Set,r=!1;return{getState:function(){return t},setState:function(e,i){if(!r)try{r=!0;var a="function"==typeof e?e(t):e,s=Wb(t,a);(i||s)&&(t=m(m({},t),a),n.forEach((function(e){return e()})))}finally{r=!1}},subscribe:function(e){return n.add(e),function(){return n.delete(e)}}}}var Qb={config:m(m({},{onUserProfileMessage:void 0,disableUserProfile:!1,isReactionEnabled:!0,isMentionEnabled:!1,isVoiceMessageEnabled:!0,replyType:"NONE",showSearchIcon:!0,isTypingIndicatorEnabledOnChannelList:!1,isMessageReceiptStatusEnabledOnChannelList:!1,setCurrenttheme:function(){}}),{appId:"",userId:"",accessToken:void 0,theme:"light",isOnline:!1,allowProfileEdit:!0,forceLeftToRightMessageLayout:!1,disableMarkAsDelivered:!1,isMultipleFilesMessageEnabled:!1,htmlTextDirection:"ltr",uikitUploadSizeLimit:26214400,uikitMultipleFilesMessageLimit:10,imageCompression:void 0,voiceRecord:void 0,userMention:void 0,renderUserProfile:void 0,onStartDirectMessage:void 0,setCurrentTheme:void 0,userListQuery:void 0,pubSub:void 0,logger:void 0,markAsReadScheduler:void 0,markAsDeliveredScheduler:void 0,common:{enableUsingDefaultUserProfile:!1},groupChannel:{enableOgtag:!0,enableTypingIndicator:!0,enableReactions:!0,enableMention:!1,replyType:"none",threadReplySelectType:"thread",enableVoiceMessage:!0,typingIndicatorTypes:void 0,enableDocument:!1,enableFeedback:!1,enableSuggestedReplies:!1,showSuggestedRepliesFor:"all_messages",suggestedRepliesDirection:"vertical",enableMarkdownForUserMessage:!1,enableFormTypeMessage:!1,enableReactionsSupergroup:void 0},groupChannelList:{enableTypingIndicator:!1,enableMessageReceiptStatus:!1},groupChannelSettings:{enableMessageSearch:!1},openChannel:{enableOgtag:!0,enableDocument:!1}}),stores:{sdkStore:{sdk:{},initialized:!1,loading:!1,error:void 0},userStore:{user:{},initialized:!1,loading:!1},appInfoStore:{messageTemplatesInfo:void 0,waitingTemplateKeysMap:{}}},emojiManager:void 0,eventHandlers:{reaction:{onPressUserProfile:function(){}},connection:{onConnected:function(){},onFailed:function(){}},modal:{onMounted:function(){}},message:{onSendMessageFailed:function(){},onUpdateMessageFailed:function(){},onFileUploadFailed:function(){}}},utils:{updateMessageTemplatesInfo:function(){return new Promise((function(){}))},getCachedTemplate:function(){return null}}};function Xb(e,t,n){var r=Object(i.useContext)(e);if(!r)throw new Error("useStore must be used within a StoreProvider");var a=Object(i.useRef)(t);a.current=t;var s=J_.useSyncExternalStore(r.subscribe,(function(){return a.current(r.getState())}),(function(){return a.current(n)})),o=Object(i.useCallback)((function(e){Wb(r.getState(),e)&&r.setState((function(t){return m(m({},t),e)}))}),[r]);return Object(i.useMemo)((function(){return{state:s,updateState:o}}),[s,o])}var Zb,Jb=a.a.createContext(null),$b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._channels=new Map,t._enteredChannelUrls=[],t}return I(t,e),Object.defineProperty(t.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map((function(t){return e._channels.get(t)})).filter((function(e){return!!e}))},enumerable:!1,configurable:!0}),t.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e)},t.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e)},t.prototype.exit=function(e){var t=this._enteredChannelUrls.indexOf(e);t>=0&&this._enteredChannelUrls.splice(t,1)},t.prototype.exitAll=function(){this._enteredChannelUrls=[]},t.prototype.get=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this._channels.get(e)]}))}))},t.prototype.upsert=function(e){return w(this,0,void 0,(function(){var t,n=this;return A(this,(function(r){return t=[],e.forEach((function(e){if(n._channels.has(e.url)){var r=n._channels.get(e.url);Object.assign(r,e),t.push(r)}else n._channels.set(e.url,e),t.push(e)})),[2,t]}))}))},t.prototype.remove=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return this._channels.delete(e),this.exit(e),[2]}))}))},t.prototype.clear=function(){return w(this,0,void 0,(function(){return A(this,(function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2]}))}))},t}(ia),eC={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},tC=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,i=e.call(this)||this;return i.method=Me.GET,i.path="".concat(r?Pe:Le,"/").concat(encodeURIComponent(n)),i.params={show_pinned_messages:!0},i}return I(t,e),t}(it),nC=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _C(t,n),r}return I(t,e),t}(at),rC=function(e){function t(t){var n=this,r=t.channelUrl,i=t.coverUrlOrImage,a=t.name,s=t.data,o=t.customType,l=t.operatorUserIds,u=t.isEphemeral;return(n=e.call(this)||this).method=Me.POST,n.path=Le,n.params=we(Ae({channel_url:r,cover_url:W("string",i)?i:null,cover_file:$(i)?i:null,name:a,data:s,custom_type:o,operators:l,is_ephemeral:u})),n}return I(t,e),t}(it);I((function(e,t){var n=Zb.call(this,e,t)||this;return n.channel=new _C(e,t),n}),Zb=at);var iC=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"ENTR",payload:{channel_url:n},ackRequired:!0})||this}return I(t,e),t}(ut),aC=function(e){function t(t,n,r){var i,a,s=this;return s=e.call(this,t,"SYEV",r)||this,r.data&&(s.participantCount=null!==(i=r.data.participant_count)&&void 0!==i?i:0,s.user=new ga(t,r.data),s.ts=null!==(a=r.data.edge_ts)&&void 0!==a?a:0),s}return I(t,e),t}(qh),sC=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"EXIT",payload:{channel_url:n},ackRequired:!0})||this}return I(t,e),t}(ut),oC=function(e){function t(t,n,r){var i,a,s=this;return s=e.call(this,t,"EXIT",r)||this,r.data&&(s.participantCount=null!==(i=r.data.participant_count)&&void 0!==i?i:0,s.user=new ga(t,r.data),s.ts=null!==(a=r.data.edge_ts)&&void 0!==a?a:0),s}return I(t,e),t}(qh),lC={},uC=function(e){function t(t,n){var r=e.call(this,t,S(S({},n),{channelType:le.OPEN}))||this;return r.subscribeChannelEvent=At,r.unsubscribeChannelEvent=At,r.refreshChannel=function(){return w(r,0,void 0,(function(){return A(this,(function(e){return[2,void 0]}))}))},r._openChannelCache=new $b(t),r._openChannelHandlers=new Map,r._dispatcher.on((function(e){var t,n;if(e instanceof lt)r._handleEvent(e).catch((function(e){if(G(e)&&"foreground"===r._sdkState.appState)throw e}));else if(e instanceof Ki&&e.stateType===ji.CONNECTED){var i=r._openChannelCache.enteredChannels;try{for(var a=M(i),s=a.next();!s.done;s=a.next())s.value.enter()}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}})),lC[t]||(lC[t]=r),r}return I(t,e),t.of=function(e){return lC[e]},t.prototype.buildOpenChannelFromSerializedData=function(e){var t=fa(e);return new _C(this._iid,_C.payloadify(t))},t.prototype.getChannelFromCache=function(e){var t;return w(this,0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,this._openChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.upsertChannelsToCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this._openChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.removeChannelsFromCache=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s;return A(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=M(e),n=t.next(),o.label=1;case 1:return n.done?[3,4]:(r=n.value,[4,this._openChannelCache.remove(r)]);case 2:o.sent(),o.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),a={error:i},[3,7];case 6:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url)},t.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url)},Object.defineProperty(t.prototype,"handlers",{get:function(){return R([],O(this._openChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype._handleEvent=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y,b,C,N,T,I,S,O,R,k,x,D,U,L,P,F,B,j,H,z,V,q,K,W,Y,Q,X,Z,J,$,ee,te,ne,re,ie,ae,se,oe,ue,ce,de,he,fe,pe,me,ge,_e,ve,Ee,ye,be,Ce,Ne,Te,Ie,Se=this;return A(this,(function(we){switch(we.label){case 0:switch(we.trys.push([0,59,,60]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"MRCT":return[3,10];case"MTHD":return[3,13];case"MCNT":return[3,16];case"PEDI":return[3,27];case"VOTE":return[3,30];case"SYEV":return[3,33]}return[3,58];case 1:return i=null,"MESG"===e.code?i=e.as(Vu):"FILE"===e.code?i=e.as(il):"ADMM"!==e.code&&"BRDM"!=e.code||(i=e.as(Qh)),i?(t=i.message,n=i.isMentioned,t.channelType!==le.OPEN?[3,3]:[4,this.getChannel(t.channelUrl,!0)]):[3,3];case 2:r=we.sent(),Fi((function(){return w(Se,0,void 0,(function(){var e,i,a,s,o;return A(this,(function(l){try{for(e=M(this._openChannelHandlers.values()),i=e.next();!i.done;i=e.next())a=i.value,this._openChannelCache.isEnteredChannel(r.url)&&(a.onMessageReceived&&a.onMessageReceived(r,t),n&&a.onMentionReceived&&a.onMentionReceived(r,t))}catch(e){s={error:e}}finally{try{i&&!i.done&&(o=e.return)&&o.call(e)}finally{if(s)throw s.error}}return[2]}))}))})),we.label=3;case 3:return[3,58];case 4:return i=null,"MEDI"===e.code?i=e.as(Ku):"FEDI"===e.code?i=e.as(Yu):"AEDI"===e.code&&(i=e.as(Xh)),i?(a=i.message,s=i.mentionCountChange,a.channelType!==le.OPEN?[3,6]:[4,this.getChannel(a.channelUrl,!0)]):[3,6];case 5:o=we.sent(),l=!1,o.lastPinnedMessage&&o.lastPinnedMessage.messageId===a.messageId&&o.lastPinnedMessage.updatedAt<a.updatedAt&&(o.lastPinnedMessage=a,l=!0),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i,u,c;return A(this,(function(d){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(o.url)&&(l&&(null===(u=n.onPinnedMessageUpdated)||void 0===u||u.call(n,o),null===(c=n.onChannelChanged)||void 0===c||c.call(n,o)),n.onMessageUpdated&&n.onMessageUpdated(o,a),s>0&&n.onMentionReceived&&n.onMentionReceived(o,a))}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),we.label=6;case 6:return[3,58];case 7:return u=e.as(St),U=u.channelUrl,L=u.channelType,c=u.messageId,L!==le.OPEN?[3,9]:[4,this.getChannel(U,!0)];case 8:d=we.sent(),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(d.url)&&n.onMessageDeleted&&n.onMessageDeleted(d,c)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),we.label=9;case 9:return[3,58];case 10:return h=e.as(Zh),U=h.channelUrl,L=h.channelType,f=h.event,L!==le.OPEN?[3,12]:[4,this.getChannel(U,!0)];case 11:p=we.sent(),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(p.url)&&n.onReactionUpdated&&n.onReactionUpdated(p,f)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),we.label=12;case 12:return[3,58];case 13:return(m=e.as(Jh).event).channelType!==le.OPEN?[3,15]:[4,this.getChannel(m.channelUrl,!0)];case 14:g=we.sent(),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(g.url)&&n.onThreadInfoUpdated&&n.onThreadInfoUpdated(g,m)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),we.label=15;case 15:return[3,58];case 16:_=e.as($h).openChannelMemberCounts,v=[],we.label=17;case 17:we.trys.push([17,22,23,24]),E=M(_),y=E.next(),we.label=18;case 18:return y.done?[3,21]:(b=y.value,U=b.channelUrl,K=b.participantCount,C=b.updatedAt,[4,this.getChannelFromCache(U)]);case 19:(N=we.sent())&&N._updateParticipantCount(K,C)&&v.push(N),we.label=20;case 20:return y=E.next(),[3,18];case 21:return[3,24];case 22:return T=we.sent(),Te={error:T},[3,24];case 23:try{y&&!y.done&&(Ie=E.return)&&Ie.call(E)}finally{if(Te)throw Te.error}return[7];case 24:return v.length>0?[4,this.upsertChannelsToCache(v)]:[3,26];case 25:I=we.sent(),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(I)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),we.label=26;case 26:return[3,58];case 27:return S=e.as(ef),O=S.event,R=S.status,U=S.channelUrl,L=S.channelType,U&&L===le.OPEN?[4,this.getChannel(U,!0)]:[3,29];case 28:k=we.sent(),this._dispatcher.dispatch(new Is({event:O,source:os.EVENT_POLL_UPDATED})),Fi(R===As?function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(k,O.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(k,O)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),we.label=29;case 29:return[3,58];case 30:return x=e.as(gc),D=x.event,U=x.channelUrl,L=x.channelType,U&&L===le.OPEN?[4,this.getChannel(U,!0)]:[3,32];case 31:P=we.sent(),this._dispatcher.dispatch(new Ss({event:D,source:os.EVENT_POLL_VOTED})),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(P,D)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),we.label=32;case 32:return[3,58];case 33:if(!(F=e.as(qh).event).isOpenChannelEvent)return[3,57];switch(F.category){case jh.CHANNEL_ENTER:return[3,34];case jh.CHANNEL_EXIT:return[3,36];case jh.CHANNEL_OPERATOR_UPDATE:return[3,38];case jh.USER_CHANNEL_MUTE:case jh.USER_CHANNEL_UNMUTE:return[3,40];case jh.USER_CHANNEL_BAN:case jh.USER_CHANNEL_UNBAN:return[3,42];case jh.CHANNEL_FREEZE:case jh.CHANNEL_UNFREEZE:return[3,44];case jh.CHANNEL_DELETED:return[3,46];case jh.CHANNEL_PROP_CHANGED:return[3,49];case jh.CHANNEL_META_DATA_CHANGED:return[3,51];case jh.CHANNEL_META_COUNTERS_CHANGED:return[3,53];case jh.PINNED_MESSAGE_CHANGED:return[3,55]}return[3,57];case 34:return[4,this.getChannel(F.channelUrl,!0)];case 35:return B=we.sent(),j=e.as(aC),K=j.participantCount,H=j.user,z=B._updateParticipantCount(K,F.ts),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserEntered&&e.onUserEntered(B,H),z&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(B)})),[2]}))}))})),[3,57];case 36:return[4,this.getChannel(F.channelUrl,!0)];case 37:return V=we.sent(),q=e.as(oC),K=q.participantCount,W=q.user,Y=V._updateParticipantCount(K,F.ts),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserExited&&e.onUserExited(V,W),Y&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(V)})),[2]}))}))})),[3,57];case 38:return[4,this.getChannel(F.channelUrl,!0)];case 39:return Q=we.sent(),X=e.as(Kh).operators,Q.operators=X,this.upsertChannelsToCache([Q]),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(Q,X)})),[2]}))}))})),[3,57];case 40:return[4,this.getChannel(F.channelUrl,!0)];case 41:return Z=we.sent(),J=F.category===jh.USER_CHANNEL_MUTE,$=e.as(J?Mu:Ru).user,Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){J?e.onUserMuted&&e.onUserMuted(Z,$):e.onUserUnmuted&&e.onUserUnmuted(Z,$)})),[2]}))}))})),[3,57];case 42:return[4,this.getChannel(F.channelUrl,!0)];case 43:return ee=we.sent(),te=F.category===jh.USER_CHANNEL_BAN,ne=e.as(te?xu:Uu).user,Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){te?e.onUserBanned&&e.onUserBanned(ee,ne):e.onUserUnbanned&&e.onUserUnbanned(ee,ne)})),[2]}))}))})),[3,57];case 44:return[4,this.getChannel(F.channelUrl,!0)];case 45:return re=we.sent(),ie=e.as(Pu).freeze,re.isFrozen=ie,this.upsertChannelsToCache([re]),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){ie?e.onChannelFrozen&&e.onChannelFrozen(re):e.onChannelUnfrozen&&e.onChannelUnfrozen(re)})),[2]}))}))})),[3,57];case 46:return[4,this.getChannel(F.channelUrl,!0)];case 47:return ae=we.sent(),[4,this.removeChannelsFromCache([ae.url])];case 48:return we.sent(),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(ae.url,ae.channelType)})),[2]}))}))})),[3,57];case 49:return[4,this.getChannelWithoutCache(F.channelUrl,!0)];case 50:return se=we.sent(),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(se)})),[2]}))}))})),[3,57];case 51:return[4,this.getChannel(F.channelUrl,!0)];case 52:return oe=we.sent(),ue=e.as(pu),ce=ue.created,de=ue.updated,he=ue.deleted,ce&&oe._upsertCachedMetaData(ce,F.ts),de&&oe._upsertCachedMetaData(de,F.ts),he&&oe._removeFromCachedMetaData(he,F.ts),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){ce&&e.onMetaDataCreated&&e.onMetaDataCreated(oe,ce),de&&e.onMetaDataUpdated&&e.onMetaDataUpdated(oe,de),he&&e.onMetaDataDeleted&&e.onMetaDataDeleted(oe,he)})),[2]}))}))})),[3,57];case 53:return[4,this.getChannel(F.channelUrl,!0)];case 54:return fe=we.sent(),pe=e.as(Iu),me=pe.created,ge=pe.updated,_e=pe.deleted,Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){me&&e.onMetaCounterCreated&&e.onMetaCounterCreated(fe,me),ge&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(fe,ge),_e&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(fe,_e)})),[2]}))}))})),[3,57];case 55:return[4,this.getChannel(F.channelUrl,!0)];case 56:return ve=we.sent(),Ee=e.as(Wh),ye=Ee.pinnedMessageIds,be=Ee.latestPinnedMessage,(Ce=Ee.ts)>ve._pinnedMessagesUpdatedAt&&(ve.pinnedMessageIds=ye,ve.lastPinnedMessage=be,ve._pinnedMessagesUpdatedAt=Ce,this.upsertChannelsToCache([ve]),Fi((function(){return w(Se,0,void 0,(function(){var e,t,n,r,i;return A(this,(function(a){try{for(e=M(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(ve)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Fi((function(){return w(Se,0,void 0,(function(){return A(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(ve)})),[2]}))}))}))),[3,57];case 57:return[3,58];case 58:return[3,60];case 59:if(Ne=we.sent(),G(Ne))throw Ne;return[3,60];case 60:return[2]}}))}))},t.prototype.addHandler=function(e,t){this._openChannelHandlers.set(e,t)},t.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._openChannelHandlers.clear()},t.prototype.getChannel=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n;return A(this,(function(r){switch(r.label){case 0:pa(W("string",e)).throw(z.invalidParameters),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(n=r.sent())?[2,n]:[3,4];case 3:return r.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,t)];case 5:return[2,r.sent()]}}))}))},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),w(this,0,void 0,(function(){var n,r,i;return A(this,(function(a){switch(a.label){case 0:return pa(W("string",e)).throw(z.invalidParameters),n=new tC({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),i=r.as(nC).channel,[4,this.upsertChannelsToCache([i])];case 2:return[2,a.sent()[0]]}}))}))},t.prototype.createChannel=function(e){return w(this,0,void 0,(function(){var t,n,r,i;return A(this,(function(a){switch(a.label){case 0:return t=S(S({},eC),e),pa((s=t,X("string",s.operatorUserIds,!0)&&(W("string",s.coverUrlOrImage,!0)||$(s.coverUrlOrImage,!0))&&W("string",s.name,!0)&&W("string",s.data,!0)&&W("string",s.customType,!0)&&(W("string",s.channelUrl)&&/^\w+$/.test(s.channelUrl)||null===s.channelUrl||void 0===s.channelUrl)&&W("boolean",s.isEphemeral,!0))).throw(z.invalidParameters),n=new rC(t),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),i=r.as(nC).channel,this.upsertChannelsToCache([i]),[2,i]}var s}))}))},t}(Yh),cC={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},dC=function(e){function t(t){var n=this,r=t.channelUrl,i=t.token,a=t.limit;return(n=e.call(this)||this).method=Me.GET,n.path="".concat(Le,"/").concat(encodeURIComponent(r),"/participants"),n.params={token:i,limit:a},n}return I(t,e),t}(it),hC=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.participants=[];var i=n.next,a=n.participants;return r.token=i,r.participants=a.map((function(e){return new Il(t,e)})),r}return I(t,e),t}(at),fC=function(e){function t(t,n,r){return e.call(this,t,n,le.OPEN,r)||this}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new dC(S(S({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(hC),i=r.participants,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw z.queryInProgress;case 4:return[3,6];case 5:throw z.invalidParameters;case 6:return[2]}}))}))},t}(Ds),pC=function(e){function t(t){var n=this,r=t.channelUrl,i=t.coverUrlOrImage,a=t.name,s=t.data,o=t.customType,l=t.operatorUserIds;return(n=e.call(this)||this).method=Me.PUT,n.path="".concat(Le,"/").concat(encodeURIComponent(r)),n.params=we(Ae({cover_url:W("string",i)?i:null,cover_file:$(i)?i:null,name:a,data:s,custom_type:o,operators:l})),n}return I(t,e),t}(it),mC=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new _C(t,n),r}return I(t,e),t}(at),gC=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Me.DELETE,n.path="".concat(Le,"/").concat(encodeURIComponent(r)),n}return I(t,e),t}(it);!function(e){I((function(t,n){return e.call(this,t,n)||this}),e)}(at);var _C=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this)._lastParticipantCountUpdated=0,i.participantCount=0,i.operators=[],i.lastPinnedMessage=null,i._pinnedMessagesUpdatedAt=0,i.channelType=le.OPEN,i.participantCount=null!==(r=n.participant_count)&&void 0!==r?r:0,i.operators=Array.isArray(n.operators)?n.operators.map((function(e){return new ga(t,e)})):[],i.lastPinnedMessage=n.latest_pinned_message?$o(i._iid,S({channel_type:i.channelType},n.latest_pinned_message)):null,i}return I(t,e),t.payloadify=function(e){return we(Ae(S(S({},Rc.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map((function(e){return ga.payloadify(e)})),latest_pinned_message:e.lastPinnedMessage?Jo(e.lastPinnedMessage):null})))},t.prototype.serialize=function(){return ha(this)},t.prototype.isOperator=function(e){return e instanceof ga?this.isOperator(e.userId):this.operators.some((function(t){return t.userId===e}))},t.prototype._updateParticipantCount=function(e,t){return t>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=t,!0)},t.prototype.createParticipantListQuery=function(e){return new fC(this._iid,this.url,e)},t.prototype.refresh=function(){return w(this,0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,uC.of(this._iid).getChannelWithoutCache(this.url)];case 1:return[2,e.sent()]}}))}))},t.prototype.enter=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return e=ms.of(this._iid).requestQueue,t=new iC({channelUrl:this.url}),[4,e.send(t)];case 1:return n=s.sent(),r=n.as(aC),i=r.participantCount,a=r.ts,this._updateParticipantCount(i,a),uC.of(this._iid).setEnteredToCache(this),[2]}}))}))},t.prototype.exit=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return e=ms.of(this._iid).requestQueue,t=new sC({channelUrl:this.url}),[4,e.send(t)];case 1:return n=s.sent(),r=n.as(oC),i=r.participantCount,a=r.ts,this._updateParticipantCount(i,a),uC.of(this._iid).setExitedToCache(this),fh.of(this._iid).fileMessageQueue.cancel(this),[2]}}))}))},t.prototype.updateChannel=function(e){return w(this,0,void 0,(function(){var t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return t=S(S({},cC),e),pa((o=t,X("string",o.operatorUserIds,!0)&&(W("string",o.coverUrlOrImage,!0)||$(o.coverUrlOrImage,!0))&&W("string",o.name,!0)&&W("string",o.data,!0)&&W("string",o.customType,!0))).throw(z.invalidParameters),n=ms.of(this._iid).requestQueue,r=new pC(S({channelUrl:this.url},t)),[4,n.send(r)];case 1:return i=s.sent(),a=i.as(mC).channel,this._update(a),[4,uC.of(this._iid).upsertChannelsToCache([a])];case 2:return s.sent(),[2,this]}var o}))}))},t.prototype.updateChannelWithOperatorUserIds=function(e,t,n,r,i){return w(this,0,void 0,(function(){var a;return A(this,(function(s){return a=S(S({},cC),{name:e,coverUrlOrImage:t,data:n,operatorUserIds:r,customType:i}),[2,this.updateChannel(a)]}))}))},t.prototype.delete=function(){return w(this,0,void 0,(function(){var e,t;return A(this,(function(n){switch(n.label){case 0:return e=ms.of(this._iid).requestQueue,t=new gC({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[4,uC.of(this._iid).removeChannelsFromCache([this.url])];case 2:return n.sent(),[2]}}))}))},t.prototype.updateUserMessage=function(t,n){return w(this,0,void 0,(function(){var r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return[4,e.prototype.updateUserMessage.call(this,t,n)];case 1:return r=o.sent(),i=!1,a=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===r.messageId&&(this.lastPinnedMessage=r,i=!0,a=!0),i&&uC.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(s)})),a&&uC.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(s)})),[2,r]}}))}))},t.prototype.updateFileMessage=function(t,n){return w(this,0,void 0,(function(){var r,i,a,s=this;return A(this,(function(o){switch(o.label){case 0:return[4,e.prototype.updateFileMessage.call(this,t,n)];case 1:return r=o.sent(),i=!1,a=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===r.messageId&&(this.lastPinnedMessage=r,i=!0,a=!0),i&&uC.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(s)})),a&&uC.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(s)})),[2,r]}}))}))},t}(Rc);!function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}I(t,e)}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserEntered=At,t.onUserExited=At,t.onChannelParticipantCountChanged=At,t.onPollUpdated=At,t.onPollVoted=At,t.onPollDeleted=At,t.onPinnedMessageUpdated=At,t}return I(t,e),t}(vm));var vC=function(e){function t(t){var n=this,r=t.token,i=t.limit,a=t.nameKeyword,s=t.urlKeyword,o=t.customTypes,l=t.includeFrozen,u=t.includeMetaData;return(n=e.call(this)||this).method=Me.GET,n.path=Le,n.params=we({token:r,limit:i,name_contains:a,url_contains:s,custom_types:o,show_frozen:l,show_metadata:u,show_pinned_messages:!0}),n}return I(t,e),t}(it),EC=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,a=n.channels,s=n.ts;return r.token=i,a&&a.length>0&&(r.channels=a.map((function(e){return new _C(t,e)}))),r.ts="number"==typeof s?s:null,r}return I(t,e),t}(at),yC=function(e){function t(t,n){var r,i,a,s,o,l=this;return(l=e.call(this,t,n)||this).includeFrozen=!0,l.includeMetaData=!0,l.nameKeyword=null,l.urlKeyword=null,l.customTypes=null,l.includeFrozen=null===(r=n.includeFrozen)||void 0===r||r,l.includeMetaData=null===(i=n.includeMetaData)||void 0===i||i,l.nameKeyword=null!==(a=n.nameKeyword)&&void 0!==a?a:null,l.urlKeyword=null!==(s=n.urlKeyword)&&void 0!==s?s:null,l.customTypes=null!==(o=n.customTypes)&&void 0!==o?o:null,l}return I(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&W("boolean",this.includeFrozen)&&W("boolean",this.includeMetaData)&&W("string",this.nameKeyword,!0)&&W("string",this.urlKeyword,!0)&&X("string",this.customTypes,!0)},t.prototype.next=function(){return w(this,0,void 0,(function(){var e,t,n,r,i,a;return A(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=ms.of(this._iid).requestQueue,t=new vC(Ae(S(S({},this),{token:this._token}))),[4,e.send(t)]):[3,3]:[3,6];case 1:return n=s.sent(),r=n.as(EC),i=r.channels,a=r.token,this._token=a,this._hasNext=!!a,[4,uC.of(this._iid).upsertChannelsToCache(i)];case 2:return s.sent(),this._isLoading=!1,[2,i];case 3:return[2,[]];case 4:throw z.queryInProgress;case 5:return[3,7];case 6:throw z.invalidParameters;case 7:return[2]}}))}))},t}(xs),bC=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="openChannel",t}return I(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,l=n.onlineDetector,u=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:l,cacheContext:u}),this._manager=new uC(t,{sdkState:r,dispatcher:i,requestQueue:s,logger:o,cacheContext:u,sessionManager:a})},t.prototype.createOpenChannelListQuery=function(e){return void 0===e&&(e={}),new yC(this._iid,e)},t.prototype.addOpenChannelHandler=function(e,t){this._manager.addHandler(e,t)},t.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e)},t.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e)},t.prototype.getChannel=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this._manager.getChannel(e)]}))}))},t.prototype.getChannelWithoutCache=function(e){return w(this,0,void 0,(function(){return A(this,(function(t){return[2,this._manager.getChannelWithoutCache(e)]}))}))},t.prototype.createChannel=function(e){return void 0===e&&(e={}),w(this,0,void 0,(function(){return A(this,(function(t){return[2,this._manager.createChannel(e)]}))}))},t.prototype.createChannelWithOperatorUserIds=function(e,t,n,r,i){return w(this,0,void 0,(function(){var a;return A(this,(function(s){return(a=S({},eC)).name=e,a.coverUrlOrImage=t,a.data=n,a.operatorUserIds=r,a.customType=i,[2,this._manager.createChannel(a)]}))}))},t}(gs),CC=function(e,t){return m(m({},e),{stores:m(m({},e.stores),{appInfoStore:m(m({},e.stores.appInfoStore),t)})})},NC=function(e,t){return m(m({},e),{stores:m(m({},e.stores),{sdkStore:m(m({},e.stores.sdkStore),t)})})},TC=function(e,t){return m(m({},e),{stores:m(m({},e.stores),{userStore:m(m({},e.stores.userStore),t)})})};var IC=function(){var e=Object(i.useContext)(Jb);if(!e)throw new Error("No sendbird state value available. Make sure you are rendering `<SendbirdProvider>` at the top of your app.");var t=J_.useSyncExternalStore(e.subscribe,e.getState),n=Object(i.useMemo)((function(){return{initMessageTemplateInfo:function(t){var n=t.payload;e.setState((function(e){return CC(e,{messageTemplatesInfo:n,waitingTemplateKeysMap:{}})}))},upsertMessageTemplates:function(n){var r=n.payload,i=t.stores.appInfoStore,a=i.messageTemplatesInfo;if(!a)return t;var s=m({},i.waitingTemplateKeysMap);r.forEach((function(e){var t=e.key,n=e.template;a.templatesMap[t]=n,delete s[t]})),e.setState((function(e){return CC(e,{waitingTemplateKeysMap:s,messageTemplatesInfo:a})}))},upsertWaitingTemplateKeys:function(n){var r=n.payload,i=t.stores.appInfoStore,a=r.keys,s=r.requestedAt,o=m({},i.waitingTemplateKeysMap);a.forEach((function(e){var t,n;o[e]={erroredMessageIds:null!==(n=null===(t=o[e])||void 0===t?void 0:t.erroredMessageIds)&&void 0!==n?n:[],requestedAt:s}})),e.setState((function(e){return CC(e,{waitingTemplateKeysMap:o})}))},markErrorWaitingTemplateKeys:function(n){var r=n.payload,i=t.stores.appInfoStore,a=r.keys,s=r.messageId,o=m({},i.waitingTemplateKeysMap);a.forEach((function(e){var t=o[e];t&&-1===t.erroredMessageIds.indexOf(s)&&t.erroredMessageIds.push(s)})),e.setState((function(e){return CC(e,{waitingTemplateKeysMap:o})}))},setSdkLoading:function(t){e.setState((function(e){return NC(e,{initialized:!1,loading:t})}))},sdkError:function(){e.setState((function(e){return NC(e,{initialized:!1,loading:!1,error:!0})}))},initSdk:function(t){e.setState((function(e){return NC(e,{sdk:t,initialized:!0,loading:!1,error:!1})}))},resetSdk:function(){e.setState((function(e){return NC(e,{sdk:{},initialized:!1,loading:!1,error:!1})}))},initUser:function(t){e.setState((function(e){return TC(e,{initialized:!0,loading:!1,user:t})}))},resetUser:function(){e.setState((function(e){return TC(e,{initialized:!1,loading:!1,user:{}})}))},updateUserInfo:function(t){e.setState((function(e){return TC(e,{user:t})}))},connect:function(e){return _(void 0,void 0,void 0,(function(){var t,r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,E,y,b,C,N,T,I,S;return v(this,(function(v){switch(v.label){case 0:return t=e.logger,r=e.userId,i=e.appId,a=e.accessToken,s=e.nickname,o=e.profileUrl,l=e.isMobile,u=e.sdkInitParams,c=e.customApiHost,d=e.customWebSocketHost,h=e.customExtensionParams,f=e.eventHandlers,p=e.initializeMessageTemplatesInfo,m=e.configureSession,g=e.initDashboardConfigs,[4,n.disconnect({logger:t})];case 1:v.sent(),function(e,t){var n,r,i=t.logger,a=t.sessionHandler,s=t.isMobile,o=t.customExtensionParams;null===(n=i.info)||void 0===n||n.call(i,"SendbirdProvider | useConnect/setupConnection/setVersion",{version:"3.16.2"}),e.addExtension("sb_uikit","3.16.2"),e.addSendbirdExtensions([{product:gt.UIKIT_CHAT,version:"3.16.2",platform:null==_t?void 0:_t.JS}],{platform:s?vt.MOBILE_WEB:vt.WEB},o),a&&(null===(r=i.info)||void 0===r||r.call(i,"SendbirdProvider | useConnect/setupConnection/configureSession",a),e.setSessionHandler(a))}(_=function(e){var t=e.appId,n=e.customApiHost,r=e.customWebSocketHost,i=e.sdkInitParams,a=void 0===i?{}:i,s=Object.assign(a,{appId:t,modules:[new Dm,new bC],localCacheEnabled:!0});return n&&(s.customApiHost=n),r&&(s.customWebSocketHost=r),o_.init(s)}({appId:i,customApiHost:c,customWebSocketHost:d,sdkInitParams:u}),{logger:t,isMobile:l,customExtensionParams:h,sessionHandler:m?m(_):void 0}),n.setSdkLoading(!0),v.label=2;case 2:return v.trys.push([2,8,,9]),[4,_.connect(r,a)];case 3:return E=v.sent(),n.initUser(E),s||o?[4,_.updateCurrentUserInfo({nickname:s||E.nickname||"",profileUrl:o||E.profileUrl})]:[3,5];case 4:v.sent(),v.label=5;case 5:return[4,null==p?void 0:p(_)];case 6:return v.sent(),[4,null==g?void 0:g(_)];case 7:return v.sent(),n.initSdk(_),null===(N=null===(C=null==f?void 0:f.connection)||void 0===C?void 0:C.onConnected)||void 0===N||N.call(C,E),[3,9];case 8:return y=v.sent(),b=y,n.resetSdk(),n.resetUser(),null===(T=t.error)||void 0===T||T.call(t,"SendbirdProvider | useSendbird/connect failed",b),null===(S=null===(I=null==f?void 0:f.connection)||void 0===I?void 0:I.onFailed)||void 0===S||S.call(I,b),[3,9];case 9:return[2]}}))}))},disconnect:function(e){return _(void 0,[e],void 0,(function(e){var r,i,a=e.logger;return v(this,(function(e){switch(e.label){case 0:return n.setSdkLoading(!0),(null==(r=t.stores.sdkStore.sdk)?void 0:r.disconnectWebSocket)?[4,r.disconnectWebSocket()]:[3,2];case 1:e.sent(),e.label=2;case 2:return n.resetSdk(),n.resetUser(),null===(i=a.info)||void 0===i||i.call(a,"SendbirdProvider | useSendbird/disconnect completed"),[2]}}))}))}}}),[e,t.stores.appInfoStore]);return{state:t,actions:n}},SC="IDLE",wC="PREPARING",AC="PLAYING",MC="PAUSED",OC=function(){return{audioFile:null,playbackTime:0,duration:1e3,playingStatus:SC}},RC={currentPlayer:null,currentGroupKey:"",audioStorage:{}};function kC(e,t){var n,r,i,a,s,o,l,u,c;switch(t.type){case"INITIALIZE_AUDIO_UNIT":var d=t.payload.groupKey;return(y=(null===(o=e.audioStorage)||void 0===o?void 0:o[d])?e.audioStorage[d]:OC()).playingStatus=wC,m(m({},e),{audioStorage:m(m({},e.audioStorage),(n={},n[d]=y,n))});case"RESET_AUDIO_UNIT":d=t.payload.groupKey;return m(m({},e),{audioStorage:m(m({},e.audioStorage),(r={},r[d]=OC(),r))});case"SET_CURRENT_PLAYER":var h=t.payload,f=h.audioPlayer;d=h.groupKey;return m(m({},e),{currentPlayer:f,currentGroupKey:d});case"ON_VOICE_PLAYER_PLAY":var p=t.payload,g=(d=p.groupKey,p.audioFile);return(y=(null===(l=e.audioStorage)||void 0===l?void 0:l[d])?e.audioStorage[d]:OC()).audioFile=g,y.playingStatus=AC,m(m({},e),{audioStorage:m(m({},e.audioStorage),(i={},i[d]=y,i))});case"ON_VOICE_PLAYER_PAUSE":var _=t.payload,v=(d=_.groupKey,_.duration),E=_.currentTime;return(y=(null===(u=e.audioStorage)||void 0===u?void 0:u[d])?e.audioStorage[d]:OC()).playingStatus=MC,v===E&&(y.playbackTime=0),m(m({},e),{audioStorage:m(m({},e.audioStorage),(a={},a[d]=y,a))});case"ON_CURRENT_TIME_UPDATE":d=t.payload.groupKey;var y,b=e.currentPlayer;E=b.currentTime,v=b.duration;return(y=(null===(c=e.audioStorage)||void 0===c?void 0:c[d])?e.audioStorage[d]:OC()).playbackTime===y.duration&&y.playingStatus===MC?y.playbackTime=0:E>0&&v>0&&(y.playbackTime=E,y.duration=v),m(m({},e),{audioStorage:m(m({},e.audioStorage),(s={},s[d]=y,s))});default:return e}}var xC=function(e){return q_(navigator.userAgent)&&e.includes("m4a")?{name:"Voice_message.m4a",mimeType:"audio/x-m4a;sbu_type=voice"}:{name:"Voice_message.mp3",mimeType:"audio/mp3;sbu_type=voice"}},DC=function(){},UC=Object(i.createContext)({play:DC,pause:DC,stop:DC,voicePlayerStore:{currentGroupKey:"",currentPlayer:null,audioStorage:{}}}),LC=function(e){var t=e.children,n=Object(i.useReducer)(kC,RC),r=n[0],s=n[1],o=r.currentGroupKey,l=r.currentPlayer,u=r.audioStorage,c=IC().state.config.logger,d=function(e){l?e===o?(c.info("VoicePlayer: Pause playing(by group key)."),l.pause()):"ALL"===e&&(c.info("VoicePlayer: Pause playing(all)."),l.pause()):c.warning("VoicePlayer: No currentPlayer to pause.")};return a.a.createElement(UC.Provider,{value:{play:function(e){var t=e.groupKey,n=e.audioFile,r=e.audioFileUrl,i=void 0===r?"":r,a=e.audioFileMimeType,l=void 0===a?"audio/mp3;sbu_type=voice":a;t!==o&&d(o);var h=document.getElementById(V_),f=document.getElementById("sendbird-global-audio-player-id");h&&f&&h.removeChild(f),c.info("VoicePlayer: Start getting audio file."),new Promise((function(e,r){var a;if(s({type:"INITIALIZE_AUDIO_UNIT",payload:{groupKey:t}}),n)return c.info("VoicePlayer: Use the audioFile instance."),void e(n);var o=null===(a=null==u?void 0:u[t])||void 0===a?void 0:a.audioFile;if(o)return c.info("VoicePlayer: Get from the audioStorage."),void e(o);fetch(i).then((function(e){return e.blob()})).then((function(t){var n=new File([t],xC(l).name,{lastModified:(new Date).getTime(),type:xC(l).mimeType});e(n),c.info("VoicePlayer: Get the audioFile from URL.")})).catch(r)})).then((function(e){var n,r=document.getElementById(V_);c.info("VoicePlayer: Succeeded getting audio file.",{audioFile:e});var i=u[t]||OC(),a=new Audio(null===(n=null===URL||void 0===URL?void 0:URL.createObjectURL)||void 0===n?void 0:n.call(URL,e));a.id="sendbird-global-audio-player-id",a.currentTime=i.playbackTime,a.volume=1,a.loop=!1,a.onplaying=function(){c.info("VoicePlayer: OnPlaying event is called from audioPlayer",{groupKey:t,audioPlayer:a}),s({type:"ON_VOICE_PLAYER_PLAY",payload:{groupKey:t,audioFile:e}})},a.onpause=function(){c.info("VoicePlayer: OnPause event is called from audioPlayer",{groupKey:t,audioPlayer:a}),s({type:"ON_VOICE_PLAYER_PAUSE",payload:{groupKey:t,duration:a.duration,currentTime:a.currentTime}})},a.ontimeupdate=function(){s({type:"ON_CURRENT_TIME_UPDATE",payload:{groupKey:t}})},a.onerror=function(e){c.error("VoicePlayer: Failed to load the audioFile on the audio player.",e),s({type:"RESET_AUDIO_UNIT",payload:{groupKey:t}})},a.dataset.sbGroupId=t;try{null==r||r.childNodes.forEach((function(e){var n,i,a=e;(null===(n=a.dataset)||void 0===n?void 0:n.sbGroupKey)!==t&&(null===(i=null==a?void 0:a.pause)||void 0===i||i.call(a),r.removeChild(a),c.info("VoicePlayer: Removed other player.",{element:a}))}))}finally{null==a||a.play(),null==r||r.appendChild(a),s({type:"SET_CURRENT_PLAYER",payload:{groupKey:t,audioPlayer:a}}),c.info("VoicePlayer: Succeeded playing audio player.",{groupKey:t,audioPlayer:a})}})).catch((function(e){c.warning("VoicePlayer: Failed loading audio file with URL.",e),s({type:"RESET_AUDIO_UNIT",payload:{groupKey:t}})}))},pause:d,stop:function(e){void 0===e&&(e=""),o.includes(e)&&(c.info("VoicePlayer: Pause playing(by text)."),d(o))},voicePlayerStore:r}},a.a.createElement("div",{id:V_,style:{display:"none"}}),t)},PC={en:{MESSAGE_STATUS__YESTERDAY:"Yesterday",CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE:"new message(s) since",CHANNEL__MESSAGE_LIST__NOTIFICATION__ON:"on",CHANNEL_PREVIEW_MOBILE_LEAVE:"Leave channel",CHANNEL_SETTING__HEADER__TITLE:"Channel information",CHANNEL_SETTING__PROFILE__EDIT:"Edit",CHANNEL_SETTING__MEMBERS__TITLE:"Members",CHANNEL_SETTING__MEMBERS__SEE_ALL_MEMBERS:"All members",CHANNEL_SETTING__MEMBERS__INVITE_MEMBER:"Invite users",CHANNEL_SETTING__MEMBERS__YOU:" (You)",CHANNEL_SETTING__MEMBERS__SELECT_TITLE:"Select members",CHANNEL_SETTING__MEMBERS__OPERATOR:"Operator",CHANNEL_SETTING__LEAVE_CHANNEL__TITLE:"Leave channel",CHANNEL_SETTING__OPERATORS__TITLE:"Operators",CHANNEL_SETTING__OPERATORS__TITLE_ALL:"All operators",CHANNEL_SETTING__OPERATORS__TITLE_ADD:"Add operator",CHANNEL_SETTING__OPERATORS__ADD_BUTTON:"Add",CHANNEL_SETTING__MUTED_MEMBERS__TITLE:"Muted members",CHANNEL_SETTING__MUTED_MEMBERS__TITLE_ALL:"All muted members",CHANNEL_SETTING__NO_UNMUTED:"No muted members yet",CHANNEL_SETTING__BANNED_MEMBERS__TITLE:"Banned users",CHANNEL_SETTING__FREEZE_CHANNEL:"Freeze Channel",CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR:"Register as operator",CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR:"Unregister operator",CHANNEL_SETTING__MODERATION__MUTE:"Mute",CHANNEL_SETTING__MODERATION__UNMUTE:"Unmute",CHANNEL_SETTING__MODERATION__BAN:"Ban",CHANNEL_SETTING__MODERATION__UNBAN:"Unban",CHANNEL_SETTING__MODERATION__EMPTY_BAN:"No banned members yet",CHANNEL_SETTING__MODERATION__ALL_BAN:"All banned members",OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS:"participants",OPEN_CHANNEL_CONVERSATION__SELECT_PARTICIPANTS:"Select participants",OPEN_CHANNEL_LIST__TITLE:"Channels",CREATE_OPEN_CHANNEL_LIST__TITLE:"New channel profile",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_SECTION:"Channel image",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_UPLOAD:"Upload",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_SECTION:"Channel name",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_PLACE_HOLDER:"Enter channel name",CREATE_OPEN_CHANNEL_LIST__SUBMIT:"Create",OPEN_CHANNEL_SETTINGS__OPERATOR_TITLE:"Channel Information",OPEN_CHANNEL_SETTINGS__OPERATOR_URL:"URL",OPEN_CHANNEL_SETTINGS__PARTICIPANTS_ACCORDION_TITLE:"Participants",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_PANEL:"Delete channel",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_TITLE:"Delete channel?",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_CONTEXT:"Once deleted, this channel can't be restored.",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_SUBMIT:"Delete",OPEN_CHANNEL_SETTINGS__OPERATORS_TITLE:"Operators",OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ADD:"Add operator",OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ALL:"All operators",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE:"Muted participants",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE_ALL:"All muted participants",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__NO_ONE:"No muted participants yet",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE:"Banned users",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE_ALL:"All banned users",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__NO_ONE:"No banned users yet",OPEN_CHANNEL_SETTINGS__MEMBERS__YOU:" (You)",OPEN_CHANNEL_SETTINGS__MEMBERS__OPERATOR:"Operator",OPEN_CHANNEL_SETTINGS__PARTICIPANTS_TITLE:"Participants",OPEN_CHANNEL_SETTINGS__EMPTY_LIST:"No participants yet",OPEN_CHANNEL_SETTINGS__SEE_ALL:"See all participants",OPEN_CHANNEL_SETTINGS__ALL_PARTICIPANTS_TITLE:"All participants",OPEN_CHANNEL_SETTINGS__NO_TITLE:"(No title)",OPEN_CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR:"Register as operator",OPEN_CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR:"Unregister operator",OPEN_CHANNEL_SETTING__MODERATION__MUTE:"Mute",OPEN_CHANNEL_SETTING__MODERATION__UNMUTE:"Unmute",OPEN_CHANNEL_SETTING__MODERATION__BAN:"Ban",OPEN_CHANNEL_SETTING__MODERATION__UNBAN:"Unban",TRYING_TO_CONNECT:"Trying to connect",TYPING_INDICATOR__IS_TYPING:"is typing...",TYPING_INDICATOR__AND:"and",TYPING_INDICATOR__ARE_TYPING:"are typing...",TYPING_INDICATOR__MULTIPLE_TYPING:"Several people are typing...",CHANNEL_FROZEN:"Channel frozen",PLACE_HOLDER__NO_CHANNEL:"No channels",PLACE_HOLDER__WRONG:"Something went wrong",PLACE_HOLDER__RETRY_TO_CONNECT:"Retry",PLACE_HOLDER__NO_MESSAGES:"No messages",TOOLTIP__AND_YOU:", and you",TOOLTIP__YOU:"you",TOOLTIP__UNKNOWN_USER:"(no name)",UNKNOWN__UNKNOWN_MESSAGE_TYPE:"(Unknown message type)",UNKNOWN__CANNOT_READ_MESSAGE:"Cannot read this message.",UNKNOWN__TEMPLATE_ERROR:"(Template error)",FORM_VERSION_ERROR:"Form type messages are not available in this version.",UNKNOWN__CANNOT_READ_TEMPLATE:"Cannot read this template.",MESSAGE_EDITED:"(edited)",MODAL__DELETE_MESSAGE__TITLE:"Delete this message?",MODAL__CHANNEL_INFORMATION__TITLE:"Edit channel information",MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE:"Channel image",MODAL__CHANNEL_INFORMATION__UPLOAD:"Upload",MODAL__CHANNEL_INFORMATION__CHANNEL_NAME:"Channel name",MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER:"Enter name",MODAL__INVITE_MEMBER__TITLE:"Invite member",MODAL__INVITE_MEMBER__SELECTED:"selected",MODAL__CHOOSE_CHANNEL_TYPE__TITLE:"New channel",MODAL__CHOOSE_CHANNEL_TYPE__GROUP:"Group",MODAL__CHOOSE_CHANNEL_TYPE__SUPER_GROUP:"Super group",MODAL__CHOOSE_CHANNEL_TYPE__BROADCAST:"Broadcast",MODAL__CREATE_CHANNEL__TITLE:"New channel",MODAL__CREATE_CHANNEL__GROUP:"Group",MODAL__CREATE_CHANNEL__SUPER:"Super group",MODAL__CREATE_CHANNEL__BROADCAST:"Broadcast",MODAL__CREATE_CHANNEL__SELECTED:"selected",MODAL__LEAVE_CHANNEL__TITLE:"Leave this channel?",MODAL__LEAVE_CHANNEL__FOOTER:"Leave",MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED:"You're muted by the operator.",MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN:"Channel is frozen.",USER_PROFILE__MESSAGE:"Message",USER_PROFILE__USER_ID:"User ID",EDIT_PROFILE__TITLE:"My profile",EDIT_PROFILE__IMAGE_LABEL:"Profile image",EDIT_PROFILE__IMAGE_UPLOAD:"Upload",EDIT_PROFILE__NICKNAME_LABEL:"Nickname",EDIT_PROFILE__NICKNAME_PLACEHOLDER:"Enter your nickname",EDIT_PROFILE__USERID_LABEL:"User ID",EDIT_PROFILE__THEME_LABEL:"Dark theme",MESSAGE_INPUT__PLACE_HOLDER:"Enter message",MESSAGE_INPUT__PLACE_HOLDER__DISABLED:"Chat is unavailable in this channel",MESSAGE_INPUT__PLACE_HOLDER__SUGGESTED_REPLIES:"Please choose one from above",MESSAGE_INPUT__PLACE_HOLDER__MESSAGE_FORM:"Please fill out the message form.",MESSAGE_INPUT__PLACE_HOLDER__FROZEN:"Chat is unavailable in this channel",MESSAGE_INPUT__PLACE_HOLDER__MUTED:"Chat is unavailable because you're muted",MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT:"You're muted",MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER:"Reply to message",BUTTON__SUBMIT:"Submit",BUTTON__CANCEL:"Cancel",BUTTON__DELETE:"Delete",BUTTON__SAVE:"Save",BUTTON__CREATE:"Create",BUTTON__INVITE:"Invite",BUTTON__OK:"OK",BADGE__OVER:"+",NO_TITLE:"No title",NO_NAME:"(No name)",NO_MEMBERS:"(No members)",LABEL__OPERATOR:"Operator",MESSAGE_MENU__COPY:"Copy",MESSAGE_MENU__REPLY:"Reply",MESSAGE_MENU__THREAD:"Reply in thread",MESSAGE_MENU__OPEN_IN_CHANNEL:"Open in channel",MESSAGE_MENU__EDIT:"Edit",MESSAGE_MENU__RESEND:"Resend",MESSAGE_MENU__DELETE:"Delete",MESSAGE_MENU__SAVE:"Save",CONTEXT_MENU_DROPDOWN__COPY:"Copy",CONTEXT_MENU_DROPDOWN__EDIT:"Edit",CONTEXT_MENU_DROPDOWN__RESEND:"Resend",CONTEXT_MENU_DROPDOWN__DELETE:"Delete",CONTEXT_MENU_DROPDOWN__SAVE:"Save",SEARCH:"Search",SEARCH_IN_CHANNEL:"Search in channel",SEARCH_IN:"Search in",SEARCHING:"Searching for messages...",NO_SEARCHED_MESSAGE:"No results found.",QUOTE_MESSAGE_INPUT__REPLY_TO:"Reply to",QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE:"Photo",QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF:"GIF",QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO:"Video",QUOTED_MESSAGE__REPLIED_TO:"replied to",QUOTED_MESSAGE__CURRENT_USER:"You",QUOTED_MESSAGE__UNAVAILABLE:"Message unavailable",THREAD__HEADER_TITLE:"Thread",CHANNEL__THREAD_REPLY:"reply",CHANNEL__THREAD_REPLIES:"replies",CHANNEL__THREAD_OVER_MAX:"99+",THREAD__THREAD_REPLY:"reply",THREAD__THREAD_REPLIES:"replies",THREAD__INPUT__REPLY_TO_THREAD:"Reply to thread",THREAD__INPUT__REPLY_IN_THREAD:"Reply in thread",MENTION_NAME__NO_NAME:"(No name)",MENTION_COUNT__OVER_LIMIT:"You can mention up to %d times at a time.",UI__FILE_VIEWER__UNSUPPORT:"Unsupported message",VOICE_RECORDING_PERMISSION_DENIED:"You cannot record the voice since\n        voice recording is not permitted in your device system setting",VOICE_MESSAGE:"Voice Message",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GIF:"GIF",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO:"Photo",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VIDEO:"Video",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_AUDIO:"Audio",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VOICE_MESSAGE:"Voice message",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GENERAL:"File",CHANNEL_PREVIEW_LAST_MESSAGE_TEMPLATE_MESSAGE:"Message",DATE_FORMAT__MESSAGE_LIST__NOTIFICATION__UNREAD_SINCE:"p 'on' MMM dd",DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR:"MMMM dd, yyyy",DATE_FORMAT__THREAD_LIST__DATE_SEPARATOR:"MMM dd, yyyy",DATE_FORMAT__MESSAGE_CREATED_AT:"p",DATE_FORMAT__UNREAD_SINCE:"p MMM dd",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__TODAY:"p",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__THIS_YEAR:"MMM d",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__PREVIOUS_YEAR:"yyyy/M/d",FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT:"Up to %d files can be attached.",FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT:"The maximum size per file is %d MB.",FEEDBACK_LIKE:"Like",FEEDBACK_DISLIKE:"Dislike",EDIT_COMMENT:"Edit comment",REMOVE_FEEDBACK:"Remove Feedback",FEEDBACK_MODAL_TITLE:"Provide additional feedback (optional)",FEEDBACK_CONTENT_PLACEHOLDER:"Leave a comment",BUTTON__REMOVE_FEEDBACK:"Remove feedback",FEEDBACK_FAILED_SUBMIT:"Couldnt submit. Try again.",FEEDBACK_FAILED_SAVE:"Couldnt save. Try again.",FEEDBACK_FAILED_DELETE:"Couldnt delete. Try again.",FORM_ITEM_REQUIRED:"This field is required",FORM_ITEM_INVALID:"Please check the value",FORM_ITEM_OPTIONAL_EMPTY:"No Response"}},FC=function(e){return PC[e]},BC={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function jC(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}var HC={date:jC({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:jC({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:jC({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},GC={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function zC(e){return function(t,n){var r;if("formatting"===(null!=n&&n.context?String(n.context):"standalone")&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,a=null!=n&&n.width?String(n.width):i;r=e.formattingValues[a]||e.formattingValues[i]}else{var s=e.defaultWidth,o=null!=n&&n.width?String(n.width):e.defaultWidth;r=e.values[o]||e.values[s]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function VC(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=t.match(i);if(!a)return null;var s,o=a[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?KC(l,(function(e){return e.test(o)})):qC(l,(function(e){return e.test(o)}));s=e.valueCallback?e.valueCallback(u):u,s=n.valueCallback?n.valueCallback(s):s;var c=t.slice(o.length);return{value:s,rest:c}}}function qC(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function KC(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}var WC,YC={code:"en-US",formatDistance:function(e,t,n){var r,i=BC[e];return r="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:HC,formatRelative:function(e,t,n,r){return GC[e]},localize:{ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:zC({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:zC({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:zC({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:zC({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:zC({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(WC={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(WC.matchPattern);if(!n)return null;var r=n[0],i=e.match(WC.parsePattern);if(!i)return null;var a=WC.valueCallback?WC.valueCallback(i[0]):i[0];a=t.valueCallback?t.valueCallback(a):a;var s=e.slice(r.length);return{value:a,rest:s}}),era:VC({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:VC({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:VC({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:VC({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:VC({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},QC={stringSet:FC("en"),dateLocale:YC},XC=a.a.createContext(QC),ZC=function(e){var t=e.children;return a.a.createElement(XC.Provider,{value:m(m({},QC),e)},t)},JC=function(){var e=a.a.useContext(XC);if(!e)throw new Error("`useLocalization` hook must be used within `SendbirdProvider` that includes `LocalizationProvider`.");return e},$C=function(){},eN=function(e){var t={};return Object.entries(e).forEach((function(e){var n=e[0],r=e[1];null!=r&&(t[n]=r)})),t};function tN(e){var t=e;t&&(t.startsWith("http://")||t.startsWith("https://")||(t="https://"+t),window.open(t,"_blank","noopener,noreferrer"))}function nN(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(Boolean).join(" ")}var rN=a.a.createContext({breakpoint:!1,isMobile:!1}),iN=function(){try{var e=document.querySelector("body");null==e||e.classList.add("sendbird--mobile-mode")}catch(e){}},aN=function(){try{var e=document.querySelector("body");null==e||e.classList.remove("sendbird--mobile-mode")}catch(e){}},sN=function(e){var t=e.children,n=e.logger,r=(null==e?void 0:e.breakpoint)||!1,s=Object(i.useState)(!1),o=s[0],l=s[1];return Object(i.useEffect)((function(){var e,t=function(){var e;if("boolean"==typeof r)l(r),r?iN():aN();else{var t=window.matchMedia("(max-width: ".concat(r,")"));null===(e=null==n?void 0:n.info)||void 0===e||e.call(n,"MediaQueryProvider: Screensize updated to ".concat(r)),t.matches?(l(!0),iN()):(l(!1),aN())}};return t(),window.addEventListener("resize",t),null===(e=null==n?void 0:n.info)||void 0===e||e.call(n,"MediaQueryProvider: addEventListener",{updateSize:t}),function(){var e;window.removeEventListener("resize",t),null===(e=null==n?void 0:n.info)||void 0===e||e.call(n,"MediaQueryProvider: removeEventListener",{updateSize:t})}}),[r]),a.a.createElement(rN.Provider,{value:{breakpoint:r,isMobile:o}},t)},oN=function(){return a.a.useContext(rN)},lN=a.a.forwardRef((function(e,t){var n=e.className,r=void 0===n?"":n,s=e.children,o=e.disabled,l=void 0!==o&&o,u=e.width,c=void 0===u?"56px":u,d=e.height,h=void 0===d?"56px":d,f=e.type,p=void 0===f?"button":f,g=e.style,_=void 0===g?{}:g,v=e.onBlur,y=void 0===v?function(){}:v,b=e.onClick,C=void 0===b?function(){}:b,N=e.testID,T=Object(i.useState)(!1),I=T[0],S=T[1];return a.a.createElement("button",{"data-testid":N,className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-iconbutton",I?"sendbird-iconbutton--pressed":""],!1).join(" "),disabled:l,ref:t,type:p,style:m(m({},_),{height:h,width:c}),onClick:function(e){l||(S(!0),null==C||C(e))},onBlur:function(e){S(!1),null==y||y(e)}},a.a.createElement("span",{className:"sendbird-iconbutton__inner"},s))})),uN={H_1:"H_1",H_2:"H_2",SUBTITLE_1:"SUBTITLE_1",SUBTITLE_2:"SUBTITLE_2",BODY_1:"BODY_1",BODY_2:"BODY_2",BUTTON_1:"BUTTON_1",BUTTON_2:"BUTTON_2",BUTTON_3:"BUTTON_3",CAPTION_1:"CAPTION_1",CAPTION_2:"CAPTION_2",CAPTION_3:"CAPTION_3"},cN={ONBACKGROUND_1:"ONBACKGROUND_1",ONBACKGROUND_2:"ONBACKGROUND_2",ONBACKGROUND_3:"ONBACKGROUND_3",ONBACKGROUND_4:"ONBACKGROUND_4",ONCONTENT_1:"ONCONTENT_1",ONCONTENT_2:"ONCONTENT_2",ONCONTENT_3:"ONCONTENT_3",ONCONTENT_INVERSE_1:"ONCONTENT_INVERSE_1",ONCONTENT_INVERSE_3:"ONCONTENT_INVERSE_3",PRIMARY:"PRIMARY",ERROR:"ERROR",SECONDARY_3:"SECONDARY_3"};function dN(e){switch(e){case uN.H_1:return"sendbird-label--h-1";case uN.H_2:return"sendbird-label--h-2";case uN.SUBTITLE_1:return"sendbird-label--subtitle-1";case uN.SUBTITLE_2:return"sendbird-label--subtitle-2";case uN.BODY_1:return"sendbird-label--body-1";case uN.BODY_2:return"sendbird-label--body-2";case uN.BUTTON_1:return"sendbird-label--button-1";case uN.BUTTON_2:return"sendbird-label--button-2";case uN.BUTTON_3:return"sendbird-label--button-3";case uN.CAPTION_1:return"sendbird-label--caption-1";case uN.CAPTION_2:return"sendbird-label--caption-2";case uN.CAPTION_3:return"sendbird-label--caption-3";default:return""}}function hN(e){switch(e){case cN.ONBACKGROUND_1:return"sendbird-label--color-onbackground-1";case cN.ONBACKGROUND_2:return"sendbird-label--color-onbackground-2";case cN.ONBACKGROUND_3:return"sendbird-label--color-onbackground-3";case cN.ONBACKGROUND_4:return"sendbird-label--color-onbackground-4";case cN.ONCONTENT_1:return"sendbird-label--color-oncontent-1";case cN.ONCONTENT_2:return"sendbird-label--color-oncontent-2";case cN.ONCONTENT_3:return"sendbird-label--color-oncontent-3";case cN.ONCONTENT_INVERSE_1:return"sendbird-label--color-oncontent-inverse-1";case cN.ONCONTENT_INVERSE_3:return"sendbird-label--color-oncontent-inverse-3";case cN.PRIMARY:return"sendbird-label--color-primary";case cN.ERROR:return"sendbird-label--color-error";case cN.SECONDARY_3:return"sendbird-label--color-secondary-3";default:return""}}var fN,pN,mN,gN,_N=Object(i.forwardRef)((function(e,t){var n=e.className,r=void 0===n?[]:n,i=e.type,s=e.color,o=e.children,l=void 0===o?null:o,u=e.testID;return a.a.createElement("span",{className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-label",dN(i),hN(s)],!1).join(" "),ref:t,"data-testid":u},l)})),vN=uN,EN=cN,yN=FC("en");function bN(e){switch(e){case fN.PRIMARY:return"sendbird-button--primary";case fN.SECONDARY:return"sendbird-button--secondary";case fN.DANGER:return"sendbird-button--danger";case fN.DISABLED:return"sendbird-button--disabled";case fN.WARNING:return"sendbird-button--warning";default:return""}}function CN(e){switch(e){case mN.BIG:return"sendbird-button--big";case mN.SMALL:return"sendbird-button--small";default:return""}}function NN(e){var t=e.className,n=e.type,r=void 0===n?fN.PRIMARY:n,i=e.size,s=void 0===i?mN.BIG:i,o=e.children,l=void 0===o?"Button":o,u=e.disabled,c=void 0!==u&&u,d=e.onClick,h=void 0===d?function(){}:d,f=e.labelType,p=void 0===f?vN.BUTTON_1:f,m=e.labelColor,g=void 0===m?EN.ONCONTENT_1:m,_=E(E([],Array.isArray(t)?t:[t],!0),["sendbird-button",c?"sendbird-button__disabled":"",bN(r),CN(s)],!1).join(" ");return a.a.createElement("button",{className:_,type:"button",onClick:h,disabled:c},a.a.createElement(_N,{className:"sendbird-button__text",type:p,color:g},l))}(pN=fN||(fN={})).PRIMARY="PRIMARY",pN.SECONDARY="SECONDARY",pN.DANGER="DANGER",pN.DISABLED="DISABLED",pN.WARNING="WARNING",(gN=mN||(mN={})).BIG="BIG",gN.SMALL="SMALL";var TN,IN={ADD:"ADD",ARROW_LEFT:"ARROW_LEFT",ATTACH:"ATTACH",AUDIO_ON_LINED:"AUDIO_ON_LINED",BAN:"BAN",BROADCAST:"BROADCAST",CAMERA:"CAMERA",CHANNELS:"CHANNELS",CHAT:"CHAT",CHAT_FILLED:"CHAT_FILLED",CHEVRON_DOWN:"CHEVRON_DOWN",CHEVRON_RIGHT:"CHEVRON_RIGHT",CLOSE:"CLOSE",COLLAPSE:"COLLAPSE",COPY:"COPY",CREATE:"CREATE",DELETE:"DELETE",DISCONNECTED:"DISCONNECTED",DOCUMENT:"DOCUMENT",DONE:"DONE",DONE_ALL:"DONE_ALL",DOWNLOAD:"DOWNLOAD",EDIT:"EDIT",EMOJI_MORE:"EMOJI_MORE",ERROR:"ERROR",EXPAND:"EXPAND",FILE_AUDIO:"FILE_AUDIO",FILE_DOCUMENT:"FILE_DOCUMENT",FREEZE:"FREEZE",GIF:"GIF",INFO:"INFO",LEAVE:"LEAVE",MEMBERS:"MEMBERS",MESSAGE:"MESSAGE",MODERATIONS:"MODERATIONS",MORE:"MORE",MUTE:"MUTE",NOTIFICATIONS:"NOTIFICATIONS",NOTIFICATIONS_OFF_FILLED:"NOTIFICATIONS_OFF_FILLED",OPERATOR:"OPERATOR",PHOTO:"PHOTO",PLAY:"PLAY",PLUS:"PLUS",QUESTION:"QUESTION",REFRESH:"REFRESH",REPLY:"REPLY",REMOVE:"REMOVE",SEARCH:"SEARCH",SEND:"SEND",SETTINGS_FILLED:"SETTINGS_FILLED",SLIDE_LEFT:"SLIDE_LEFT",SPINNER:"SPINNER",SUPERGROUP:"SUPERGROUP",THREAD:"THREAD",THUMBNAIL_NONE:"THUMBNAIL_NONE",TOGGLE_OFF:"TOGGLE_OFF",TOGGLE_ON:"TOGGLE_ON",USER:"USER",FEEDBACK_LIKE:"FEEDBACK_LIKE",FEEDBACK_DISLIKE:"FEEDBACK_DISLIKE"},SN={DEFAULT:"DEFAULT",PRIMARY:"PRIMARY",PRIMARY_2:"PRIMARY_2",SECONDARY:"SECONDARY",SECONDARY_2:"SECONDARY_2",CONTENT:"CONTENT",CONTENT_INVERSE:"CONTENT_INVERSE",CONTENT_INVERSE_3:"CONTENT_INVERSE_3",WHITE:"WHITE",GRAY:"GRAY",THUMBNAIL_ICON:"THUMBNAIL_ICON",SENT:"SENT",READ:"READ",ON_BACKGROUND_1:"ON_BACKGROUND_1",ON_BACKGROUND_2:"ON_BACKGROUND_2",ON_BACKGROUND_3:"ON_BACKGROUND_3",ON_BACKGROUND_4:"ON_BACKGROUND_4",BACKGROUND_3:"BACKGROUND_3",ERROR:"ERROR"};function wN(e){switch(e){case SN.PRIMARY:return"sendbird-icon-color--primary";case SN.PRIMARY_2:return"sendbird-icon-color--primary-2";case SN.SECONDARY:return"sendbird-icon-color--secondary";case SN.SECONDARY_2:return"sendbird-icon-color--secondary-2";case SN.CONTENT:return"sendbird-icon-color--content";case SN.CONTENT_INVERSE:return"sendbird-icon-color--content-inverse";case SN.CONTENT_INVERSE_3:return"sendbird-icon-color--content-inverse-3";case SN.WHITE:return"sendbird-icon-color--white";case SN.GRAY:return"sendbird-icon-color--gray";case SN.THUMBNAIL_ICON:return"sendbird-icon-color--thumbnail-icon";case SN.SENT:return"sendbird-icon-color--sent";case SN.READ:return"sendbird-icon-color--read";case SN.ON_BACKGROUND_1:return"sendbird-icon-color--on-background-1";case SN.ON_BACKGROUND_2:return"sendbird-icon-color--on-background-2";case SN.ON_BACKGROUND_3:return"sendbird-icon-color--on-background-3";case SN.ON_BACKGROUND_4:return"sendbird-icon-color--on-background-4";case SN.BACKGROUND_3:return"sendbird-icon-color--background-3";case SN.ERROR:return"sendbird-icon-color--error";default:return""}}function AN(e){switch(e){case IN.ADD:return"sendbird-icon-add";case IN.ARROW_LEFT:return"sendbird-icon-arrow-left";case IN.ATTACH:return"sendbird-icon-attach";case IN.AUDIO_ON_LINED:return"sendbird-icon-audio-on-lined";case IN.BAN:return"sendbird-icon-ban";case IN.BROADCAST:return"sendbird-icon-broadcast";case IN.CAMERA:return"sendbird-icon-camera";case IN.CHANNELS:return"sendbird-icon-channels";case IN.CHAT:return"sendbird-icon-chat";case IN.CHAT_FILLED:return"sendbird-icon-chat-filled";case IN.CHEVRON_DOWN:return"sendbird-icon-chevron-down";case IN.CHEVRON_RIGHT:return"sendbird-icon-chevron-right";case IN.CLOSE:return"sendbird-icon-close";case IN.COLLAPSE:return"sendbird-icon-collapse";case IN.COPY:return"sendbird-icon-copy";case IN.CREATE:return"sendbird-icon-create";case IN.DELETE:return"sendbird-icon-delete";case IN.DISCONNECTED:return"sendbird-icon-disconnected";case IN.DOCUMENT:return"sendbird-icon-document";case IN.DONE:return"sendbird-icon-done";case IN.DONE_ALL:return"sendbird-icon-done-all";case IN.DOWNLOAD:return"sendbird-icon-down-load";case IN.EDIT:return"sendbird-icon-edit";case IN.EMOJI_MORE:return"sendbird-icon-emoji-more";case IN.ERROR:return"sendbird-icon-error";case IN.EXPAND:return"sendbird-icon-expand";case IN.FILE_AUDIO:return"sendbird-icon-file-audio";case IN.FILE_DOCUMENT:return"sendbird-icon-file-document";case IN.FREEZE:return"sendbird-icon-freeze";case IN.GIF:return"sendbird-icon-gif";case IN.INFO:return"sendbird-icon-info";case IN.LEAVE:return"sendbird-icon-leave";case IN.MEMBERS:return"sendbird-icon-members";case IN.MESSAGE:return"sendbird-icon-message";case IN.MODERATIONS:return"sendbird-icon-moderations";case IN.MORE:return"sendbird-icon-more";case IN.MUTE:return"sendbird-icon-mute";case IN.NOTIFICATIONS:return"sendbird-icon-notifications";case IN.NOTIFICATIONS_OFF_FILLED:return"sendbird-icon-notifications-off-filled";case IN.OPERATOR:return"sendbird-icon-operator";case IN.PHOTO:return"sendbird-icon-photo";case IN.PLAY:return"sendbird-icon-play";case IN.PLUS:return"sendbird-iconn-plus";case IN.QUESTION:return"sendbird-icon-question";case IN.REFRESH:return"sendbird-icon-refresh";case IN.REMOVE:return"sendbird-icon-remove";case IN.REPLY:return"sendbird-icon-reply";case IN.SEARCH:return"sendbird-icon-search";case IN.SEND:return"sendbird-icon-send";case IN.SETTINGS_FILLED:return"sendbird-icon-settings-filled";case IN.SPINNER:return"sendbird-icon-spinner";case IN.SUPERGROUP:return"sendbird-icon-supergroup";case IN.THREAD:return"sendbird-icon-thread";case IN.THUMBNAIL_NONE:return"sendbird-icon-thumbnail-none";case IN.TOGGLE_OFF:return"sendbird-icon-toggle-off";case IN.TOGGLE_ON:return"sendbird-icon-toggle-on";case IN.USER:return"sendbird-icon-user";case IN.FEEDBACK_LIKE:return"sendbird-icon-feedback-like";case IN.FEEDBACK_DISLIKE:return"sendbird-icon-feedback-dislike";default:return"sendbird-icon-unknown"}}function MN(){return(MN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const ON=e=>i.createElement("svg",MN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),TN||(TN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M50.667 5.333a8 8 0 0 1 8 8v37.334a8 8 0 0 1-8 8H13.333a8 8 0 0 1-8-8V13.333a8 8 0 0 1 8-8zm0 5.334H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334a2.667 2.667 0 0 0 2.666 2.666h37.334a2.667 2.667 0 0 0 2.666-2.666V13.333a2.667 2.667 0 0 0-2.666-2.666m-18.667 8a2.667 2.667 0 0 1 2.649 2.355l.018.311v8h8a2.667 2.667 0 0 1 .311 5.316l-.311.018h-8v8a2.667 2.667 0 0 1-5.316.311l-.018-.311v-8h-8a2.667 2.667 0 0 1-.311-5.316l.311-.018h8v-8A2.667 2.667 0 0 1 32 18.667",className:"icon-add_svg__fill"})));var RN;function kN(){return(kN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const xN=e=>i.createElement("svg",kN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),RN||(RN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M33.886 8.781a2.67 2.67 0 0 1 .221 3.52l-.221.251-16.78 16.781H56a2.667 2.667 0 0 1 .311 5.316l-.311.018-38.895-.001 16.78 16.782a2.666 2.666 0 0 1 .222 3.52l-.221.251a2.67 2.67 0 0 1-3.52.222l-.252-.222L8.781 33.886a2.67 2.67 0 0 1-.222-3.52l.222-.252L30.114 8.781a2.67 2.67 0 0 1 3.772 0",className:"icon-arrow-left_svg__fill"})));var DN;function UN(){return(UN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const LN=e=>i.createElement("svg",UN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),DN||(DN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m55.334 28.926-24.506 23.34c-5.222 4.973-13.74 4.973-18.962 0-5.149-4.903-5.149-12.797 0-17.7l24.506-23.34c3.138-2.988 8.278-2.988 11.416 0 3.064 2.919 3.064 7.594 0 10.513L23.255 45.077c-1.055 1.005-2.815 1.005-3.87.001-.98-.933-.98-2.39 0-3.325l22.64-21.535a2.667 2.667 0 0 0-3.676-3.864L15.709 37.89a7.58 7.58 0 0 0-.001 11.05c3.113 2.966 8.11 2.966 11.224 0l24.533-23.338c5.272-5.021 5.272-13.217 0-18.238-5.197-4.95-13.573-4.95-18.77 0L8.187 30.704c-7.356 7.005-7.356 18.419 0 25.424 7.281 6.935 19.036 6.935 26.318 0l24.506-23.34a2.666 2.666 0 1 0-3.678-3.862z",className:"icon-attach_svg__fill"})));var PN,FN;function BN(){return(BN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const jN=e=>i.createElement("svg",BN({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 64 64"},e),PN||(PN=i.createElement("g",{clipPath:"url(#icon-audio-on-lined_svg__a)"},i.createElement("path",{d:"M32 0C26.11 0 21.333 4.776 21.333 10.667V32c0 5.891 4.776 10.667 10.667 10.667S42.667 37.89 42.667 32V10.667C42.667 4.776 37.89 0 32 0m-5.333 10.667a5.333 5.333 0 0 1 10.666 0V32a5.333 5.333 0 0 1-10.666 0z",className:"icon-audio-on-lined_svg__fill",clipRule:"evenodd"}),i.createElement("path",{d:"M16 26.667a2.667 2.667 0 1 0-5.333 0V32c0 10.879 8.143 19.856 18.666 21.168v5.499h-8a2.667 2.667 0 0 0 0 5.333h21.334a2.667 2.667 0 1 0 0-5.333h-8v-5.499C45.19 51.856 53.333 42.88 53.333 32v-5.333a2.667 2.667 0 1 0-5.333 0V32c0 8.837-7.163 16-16 16s-16-7.163-16-16z",className:"icon-audio-on-lined_svg__fill"}))),FN||(FN=i.createElement("defs",null,i.createElement("clipPath",{id:"icon-audio-on-lined_svg__a"},i.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"})))));var HN;function GN(){return(GN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const zN=e=>i.createElement("svg",GN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),HN||(HN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8m12.333 21.333a1 1 0 0 1 1 1v3.334a1 1 0 0 1-1 1H19.667a1 1 0 0 1-1-1v-3.334a1 1 0 0 1 1-1z",className:"icon-ban_svg__fill"})));var VN;function qN(){return(qN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const KN=e=>i.createElement("svg",qN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),VN||(VN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M58.545 5.498q.121.389.122.796v46.079a2.666 2.666 0 0 1-3.462 2.546l-17.951-5.61c-.645 5.273-5.14 9.358-10.587 9.358C20.776 58.667 16 53.89 16 48v-5.334h-5.333a8 8 0 0 1-7.997-7.75l-.003-.25V24a8 8 0 0 1 8-8H16L55.205 3.749a2.665 2.665 0 0 1 3.34 1.75zM21.333 44.587V48a5.333 5.333 0 0 0 10.652.398L32 47.92zm32-34.667-32 9.997v18.83l32 9.997zM16 21.333h-5.333a2.67 2.67 0 0 0-2.65 2.356L8 24v10.667a2.667 2.667 0 0 0 2.667 2.666H16z",className:"icon-broadcast_svg__fill"})));var WN;function YN(){return(YN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const QN=e=>i.createElement("svg",YN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),WN||(WN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M40 5.333c.892 0 1.724.446 2.219 1.188l4.541 6.812H56a8 8 0 0 1 7.986 7.53l.014.47v29.334a8 8 0 0 1-8 8H8a8 8 0 0 1-8-8V21.333a8 8 0 0 1 8-8h9.237l4.544-6.812a2.67 2.67 0 0 1 1.888-1.167l.331-.02zm-1.43 5.334H25.428l-4.542 6.812a2.66 2.66 0 0 1-1.887 1.167l-.331.02H8a2.67 2.67 0 0 0-2.667 2.667v29.334A2.667 2.667 0 0 0 8 53.333h48a2.667 2.667 0 0 0 2.667-2.666V21.333A2.667 2.667 0 0 0 56 18.667H45.333a2.67 2.67 0 0 1-2.218-1.188zM32 21.333c7.364 0 13.333 5.97 13.333 13.334S39.363 48 32 48s-13.333-5.97-13.333-13.333S24.637 21.333 32 21.333m0 5.334a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-camera_svg__fill"})));var XN;function ZN(){return(ZN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const JN=e=>i.createElement("svg",ZN({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),XN||(XN=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m42.65 5.333.311.017a2.666 2.666 0 0 1 2.373 2.633l-.017.311-1.45 13.04h9.466a2.667 2.667 0 0 1 .311 5.315l-.31.018H43.271l-1.184 10.666h11.245a2.667 2.667 0 0 1 .312 5.316l-.31.018H41.495l-1.512 13.627a2.667 2.667 0 0 1-5.318-.277l.017-.311 1.448-13.04H25.496l-1.512 13.628a2.667 2.667 0 0 1-5.318-.277l.017-.311 1.448-13.04h-9.464a2.667 2.667 0 0 1-.311-5.315l.31-.018h10.057l1.186-10.667H10.667a2.667 2.667 0 0 1-.311-5.315l.31-.018h11.835l1.515-13.627a2.67 2.67 0 0 1 2.634-2.373l.311.017a2.666 2.666 0 0 1 2.373 2.633l-.017.311-1.45 13.04H38.5l1.515-13.628a2.67 2.67 0 0 1 2.634-2.373zm-5.927 32 1.186-10.667H27.272l-1.184 10.667z",className:"icon-channels_svg__fill"})));var $N;function eT(){return(eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const tT=e=>i.createElement("svg",eT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),$N||($N=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8",className:"icon-chat_svg__fill"})));var nT;function rT(){return(rT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const iT=e=>i.createElement("svg",rT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),nT||(nT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667",className:"icon-chat-filled_svg__fill"})));var aT;function sT(){return(sT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const oT=e=>i.createElement("svg",sT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),aT||(aT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16.121 21.879a3 3 0 0 0-4.242 0 3 3 0 0 0 0 4.242l18 18a3 3 0 0 0 4.242 0l18-18a3 3 0 0 0 0-4.242 3 3 0 0 0-4.242 0L32 37.757z",className:"icon-chevron-down_svg__fill"})));var lT;function uT(){return(uT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const cT=e=>i.createElement("svg",uT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),lT||(lT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M22.114 46.114a2.668 2.668 0 0 0 3.772 3.772l16-16a2.67 2.67 0 0 0 0-3.772l-16-16a2.668 2.668 0 0 0-3.772 3.772L36.23 32z",className:"icon-chevron-right_svg__fill"})));var dT;function hT(){return(hT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const fT=e=>i.createElement("svg",hT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),dT||(dT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M52.552 11.448a2.666 2.666 0 0 1 .222 3.52l-.222.251-16.781 16.78 16.781 16.782a2.665 2.665 0 0 1 0 3.771 2.666 2.666 0 0 1-3.52.222l-.251-.222L32 35.771 15.219 52.552a2.665 2.665 0 0 1-3.771 0 2.666 2.666 0 0 1-.222-3.52l.222-.251L28.228 32l-16.78-16.781a2.665 2.665 0 0 1 0-3.771 2.666 2.666 0 0 1 3.52-.222l.251.222 16.78 16.78 16.782-16.78a2.665 2.665 0 0 1 3.771 0",className:"icon-close_svg__fill"})));var pT;function mT(){return(mT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const gT=e=>i.createElement("svg",mT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),pT||(pT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16 8a2.667 2.667 0 0 0-2.649 2.356l-.018.31v42.667a2.667 2.667 0 0 0 5.316.311l.018-.31V34.666h25.56l-6.113 6.114a2.67 2.67 0 0 0-.221 3.52l.221.251a2.666 2.666 0 0 0 3.52.222l.252-.222 10.666-10.666a2.666 2.666 0 0 0 .222-3.52l-.222-.252-10.666-10.666a2.666 2.666 0 0 0-3.993 3.52l.221.251 6.113 6.114h-25.56V10.667A2.667 2.667 0 0 0 16 8",className:"icon-collapse_svg__fill"})));var _T;function vT(){return(vT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const ET=e=>i.createElement("svg",vT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),_T||(_T=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M53.333 21.333a8 8 0 0 1 8 8v24a8 8 0 0 1-8 8h-24a8 8 0 0 1-8-8v-24a8 8 0 0 1 8-8zm0 5.334h-24a2.667 2.667 0 0 0-2.666 2.666v24A2.667 2.667 0 0 0 29.333 56h24A2.667 2.667 0 0 0 56 53.333v-24a2.667 2.667 0 0 0-2.667-2.666m-18.666-24a8 8 0 0 1 7.986 7.53l.014.47v2.666a2.667 2.667 0 0 1-5.316.311l-.018-.31v-2.667a2.67 2.67 0 0 0-2.355-2.65L34.667 8h-24a2.67 2.67 0 0 0-2.65 2.356l-.017.31v24a2.67 2.67 0 0 0 2.356 2.65l.31.017h2.667a2.667 2.667 0 0 1 .311 5.316l-.31.018h-2.667a8 8 0 0 1-7.987-7.53l-.013-.47v-24c0-4.26 3.33-7.743 7.53-7.987l.47-.013z",className:"icon-copy_svg__fill"})));var yT;function bT(){return(bT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const CT=e=>i.createElement("svg",bT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),yT||(yT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8m2.667 16v5.333H40c3.556 0 3.556 5.334 0 5.334h-5.333V40c0 3.556-5.334 3.556-5.334 0v-5.333H24c-3.556 0-3.556-5.334 0-5.334h5.333V24c0-3.556 5.334-3.556 5.334 0",className:"icon-create_svg__fill"})));var NT;function TT(){return(TT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const IT=e=>i.createElement("svg",TT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),NT||(NT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M37.333 2.667c4.26 0 7.743 3.33 7.987 7.53l.013.47v2.666H56a2.667 2.667 0 0 1 .311 5.316l-.311.018h-2.668l.001 34.666c0 4.26-3.33 7.743-7.53 7.987l-.47.013H18.667a8 8 0 0 1-7.987-7.53l-.013-.47V18.667H8a2.667 2.667 0 0 1-.311-5.316L8 13.333h10.666v-2.666a8 8 0 0 1 7.53-7.987l.47-.013zm10.666 16H16v34.666a2.67 2.67 0 0 0 2.356 2.65l.31.017h26.667a2.67 2.67 0 0 0 2.65-2.356l.017-.31zm-21.332 8a2.667 2.667 0 0 1 2.648 2.355l.018.311v16a2.667 2.667 0 0 1-5.316.311l-.017-.31v-16a2.667 2.667 0 0 1 2.667-2.667m10.666 0a2.67 2.67 0 0 1 2.65 2.355l.017.311v16a2.667 2.667 0 0 1-5.315.311l-.018-.31v-16a2.667 2.667 0 0 1 2.666-2.667m0-18.667H26.667a2.67 2.67 0 0 0-2.65 2.356l-.017.31v2.667h16v-2.666a2.67 2.67 0 0 0-2.356-2.65L37.334 8z",className:"icon-delete_svg__fill"})));var ST;function wT(){return(wT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const AT=e=>i.createElement("svg",wT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),ST||(ST=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m54.534 6.069-.248.217-9.736 9.735-.04.04-9.573 9.573q-.226.178-.405.404L6.286 54.286a2.423 2.423 0 0 0 3.18 3.645l.248-.217 13.374-13.373a2.42 2.42 0 0 0 1.88-.401 12.12 12.12 0 0 1 14.04 0 2.424 2.424 0 1 0 2.808-3.952 16.95 16.95 0 0 0-11.303-3.072l6.743-6.744a24.1 24.1 0 0 1 10.159 5.021 2.424 2.424 0 0 0 3.11-3.719 29 29 0 0 0-9.34-5.23l5.633-5.634a36.2 36.2 0 0 1 9.225 5.934 2.425 2.425 0 0 0 3.211-3.633 41 41 0 0 0-8.796-5.941l7.256-7.256a2.423 2.423 0 0 0-3.18-3.645m-35.04 21.474a29 29 0 0 0-6.032 3.942 2.424 2.424 0 0 0 3.137 3.697 24 24 0 0 1 5.022-3.282 2.425 2.425 0 0 0-2.127-4.357M4.748 22.909a2.424 2.424 0 0 0 3.207 3.636 36.36 36.36 0 0 1 26.978-8.977 2.424 2.424 0 0 0 .389-4.832A41.2 41.2 0 0 0 4.748 22.909",className:"icon-disconnected_svg__fill"})));var MT;function OT(){return(OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const RT=e=>i.createElement("svg",OT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),MT||(MT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M37.333 2.667a3 3 0 0 1 .274.014l.085.01.058.008q.07.01.141.026l.029.007q.075.016.146.037l.034.01q.357.107.663.303l.034.022q.053.034.104.072l.057.043q.045.033.085.068.091.075.176.16l-.126-.117q.075.065.143.135L55.21 19.438q.07.07.134.143l.035.04q.04.047.076.096l.04.054.07.1.024.038c.16.253.279.535.347.836l.01.048q.014.064.024.13l.006.048.007.051.004.041q.014.135.014.27v32a8 8 0 0 1-8 8H16a8 8 0 0 1-8-8V10.667a8 8 0 0 1 8-8zM34.666 8H16a2.667 2.667 0 0 0-2.667 2.667v42.666A2.667 2.667 0 0 0 16 56h32a2.667 2.667 0 0 0 2.667-2.667L50.666 24H37.333a2.667 2.667 0 0 1-2.648-2.356l-.018-.31zm12.227 10.667-6.894-6.894.001 6.894z",className:"icon-document_svg__fill"})));var kT;function xT(){return(xT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const DT=e=>i.createElement("svg",xT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),kT||(kT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M12.552 31.448a2.665 2.665 0 1 0-3.771 3.771l13.333 13.333a2.666 2.666 0 0 0 3.772 0L55.219 19.22a2.667 2.667 0 0 0-3.771-3.771L24 42.895z",className:"icon-done_svg__fill"})));var UT;function LT(){return(LT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const PT=e=>i.createElement("svg",LT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),UT||(UT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M5.886 31.448 19.219 44.78a2.667 2.667 0 0 1-3.771 3.771L2.114 35.22a2.667 2.667 0 0 1 3.772-3.771zm52.228-16a2.666 2.666 0 1 1 3.772 3.771L32.552 48.552a2.665 2.665 0 0 1-3.771 0L15.448 35.22a2.665 2.665 0 0 1 0-3.771 2.665 2.665 0 0 1 3.771 0l11.448 11.447zm-9.562 0a2.665 2.665 0 0 1 0 3.771L32.556 35.215a2.665 2.665 0 0 1-3.771 0 2.664 2.664 0 0 1 0-3.77L44.78 15.447a2.665 2.665 0 0 1 3.771 0z",className:"icon-done-all_svg__fill"})));var FT;function BT(){return(BT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const jT=e=>i.createElement("svg",BT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),FT||(FT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M56 42.667a2.667 2.667 0 0 1 2.649 2.355l.018.311v8c0 4.26-3.33 7.743-7.53 7.987l-.47.013H13.333a8 8 0 0 1-7.986-7.53l-.014-.47v-8a2.667 2.667 0 0 1 5.316-.311l.018.311v8a2.67 2.67 0 0 0 2.355 2.65l.311.017h37.334a2.667 2.667 0 0 0 2.648-2.356l.018-.31v-8A2.667 2.667 0 0 1 56 42.667m-36.552-8.781a2.666 2.666 0 0 1 3.52-3.993l.251.221 6.114 6.114V5.333a2.667 2.667 0 0 1 5.316-.311l.018.311v30.894l6.114-6.113a2.67 2.67 0 0 1 3.52-.221l.251.221a2.666 2.666 0 0 1 .222 3.52l-.222.252-10.658 10.657a2 2 0 0 1-.135.128l.127-.119a3 3 0 0 1-.195.176l-.056.045-.086.064-.056.04-.086.056-.06.036-.081.046-.079.04a3 3 0 0 1-.14.065l-.09.036q-.034.014-.067.025l-.09.03-.063.019q-.064.018-.13.034l-.013.003-.144.028-.064.01q-.045.008-.092.012l-.084.008-.103.006-.069.002h-.095q-.042 0-.082-.003l.139.003q-.126 0-.249-.011l-.061-.007-.092-.012-.09-.015-.118-.025-.04-.01a3 3 0 0 1-.34-.11l-.015-.006q-.074-.03-.145-.063l-.042-.02L30.71 45l-.067-.039q-.045-.026-.087-.054l-.062-.041q-.045-.03-.088-.063l-.04-.03-.008-.007a3 3 0 0 1-.251-.223z",className:"icon-download_svg__fill"})));var HT;function GT(){return(GT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const zT=e=>i.createElement("svg",GT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 65 65"},e),HT||(HT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M56 56a2.667 2.667 0 0 1 .311 5.315l-.311.018H8a2.667 2.667 0 0 1-.311-5.316L8 56zM35.448 3.448a2.665 2.665 0 0 1 3.771 0l10.667 10.666a2.67 2.67 0 0 1 0 3.772L20.552 47.219c-.5.5-1.178.781-1.885.781H8a2.667 2.667 0 0 1-2.667-2.667V34.667c0-.708.281-1.386.781-1.886zm1.885 5.659L10.667 35.77v6.896h6.89L44.227 16z",className:"icon-edit_svg__fill"})));var VT;function qT(){return(qT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const KT=e=>i.createElement("svg",qT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),VT||(VT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32.097 3.22c2.65 0 5.255.357 7.763 1.054a2.134 2.134 0 0 1-1.144 4.111 24.7 24.7 0 0 0-6.619-.899c-13.603 0-24.63 11.027-24.63 24.63s11.027 24.63 24.63 24.63 24.63-11.027 24.63-24.63c0-2.227-.295-4.413-.87-6.518a2.13 2.13 0 0 1 1.494-2.62 2.13 2.13 0 0 1 2.62 1.494 29 29 0 0 1 1.023 7.644c0 15.96-12.938 28.897-28.897 28.897-15.96 0-28.897-12.937-28.897-28.897S16.138 3.22 32.097 3.22m10.705 34.792a2.133 2.133 0 0 1 2.024 2.808c-1.873 5.623-6.937 9.488-12.729 9.488s-10.856-3.865-12.73-9.488a2.134 2.134 0 0 1 1.875-2.803l.15-.005zm-3.477 4.266H24.867l.294.382c1.539 1.887 3.718 3.113 6.115 3.342l.314.024.507.015c2.617 0 5.037-1.188 6.743-3.151l.193-.23zM21.392 21.954c1.087 0 1.985.814 2.116 1.866l.017.267v5.353a2.133 2.133 0 0 1-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.134-2.133m21.41 0c1.088 0 1.985.814 2.117 1.866l.017.267v5.353a2.133 2.133 0 0 1-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.133-2.133M54.853 0a.8.8 0 0 1 .8.8v7.786h7.76a.8.8 0 0 1 .8.8v2.667a.8.8 0 0 1-.8.8h-7.76v7.758a.8.8 0 0 1-.8.8h-2.666a.8.8 0 0 1-.8-.8v-7.758h-7.785a.8.8 0 0 1-.8-.8V9.387a.8.8 0 0 1 .8-.8l7.784-.001V.8a.8.8 0 0 1 .8-.8z",className:"icon-emoji-more_svg__fill"})));var WT;function YT(){return(YT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const QT=e=>i.createElement("svg",YT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),WT||(WT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 5.06a8 8 0 0 1 6.561 3.424l.287.439 22.608 37.744a8 8 0 0 1 .022 7.962 8 8 0 0 1-6.356 4.014l-.535.024H9.384a8 8 0 0 1-6.862-4.038 8.01 8.01 0 0 1-.226-7.493l.27-.506L25.16 8.91A8 8 0 0 1 32 5.06m0 5.333c-.816 0-1.58.372-2.076.99l-.196.28-22.565 37.67a2.67 2.67 0 0 0 1.909 3.973l.341.027h45.144a2.67 2.67 0 0 0 2.45-3.659l-.148-.304L34.28 11.676A2.67 2.67 0 0 0 32 10.393m0 32.274A2.667 2.667 0 1 1 32 48a2.667 2.667 0 0 1 0-5.333m0-21.334a2.667 2.667 0 0 1 2.649 2.356l.018.311v10.667a2.667 2.667 0 0 1-5.316.311l-.018-.311V24A2.667 2.667 0 0 1 32 21.333",className:"icon-error_svg__fill"})));var XT;function ZT(){return(ZT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const JT=e=>i.createElement("svg",ZT({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),XT||(XT=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M48 8a2.667 2.667 0 0 1 2.649 2.356l.018.31V32l-.001.027v21.306a2.667 2.667 0 0 1-5.315.311l-.018-.31V34.665H19.772l6.114 6.115a2.67 2.67 0 0 1 .221 3.52l-.221.251a2.666 2.666 0 0 1-3.52.222l-.252-.222-10.666-10.666a2.666 2.666 0 0 1-.222-3.52l.222-.252 10.666-10.666a2.666 2.666 0 0 1 3.993 3.52l-.221.251-6.113 6.114h25.56V10.667A2.667 2.667 0 0 1 48 8",className:"icon-expand_svg__fill"})));var $T;function eI(){return(eI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const tI=e=>i.createElement("svg",eI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),$T||($T=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M30.52 12.51c1.685-1.226 4.139-.103 4.139 1.893v35.194c0 1.996-2.454 3.119-4.138 1.893l-12.45-9.909H7.898c-1.416 0-2.564-1.074-2.564-2.399V24.818c0-1.325 1.148-2.4 2.564-2.4h10.175zm20.427.163c10.293 10.667 10.293 27.987 0 38.654a2.137 2.137 0 0 1-3.156-.047c-.86-.942-.84-2.448.044-3.364 8.49-8.799 8.49-23.033 0-31.832-.884-.916-.904-2.422-.044-3.364a2.137 2.137 0 0 1 3.156-.047m-8.492 8.799c5.597 5.8 5.597 15.231 0 21.031a2.136 2.136 0 0 1-3.156-.046c-.86-.942-.84-2.448.044-3.364 3.794-3.932 3.794-10.279 0-14.211-.884-.916-.904-2.422-.044-3.363a2.136 2.136 0 0 1 3.156-.047",className:"icon-file-audio_svg__fill"})));var nI;function rI(){return(rI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const iI=e=>i.createElement("svg",rI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),nI||(nI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M39.414 6.4a2.4 2.4 0 0 1 1.71.701l12.642 12.75c.407.41.634.953.634 1.516v29.765c0 3.542-4.342 6.468-8 6.468H16.16c-3.658 0-6.4-2.926-6.4-6.468L9.6 12.868c0-3.542 2.902-6.468 6.56-6.468zm3.331 35.173-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16m0-8.533-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16m-11.807-8.507h-9.6l-.153.006a2.15 2.15 0 0 0-1.985 2.154c0 1.193.957 2.16 2.138 2.16h9.6l.152-.005a2.15 2.15 0 0 0 1.985-2.155c0-1.193-.957-2.16-2.137-2.16",className:"icon-file-document_svg__fill"})));var aI;function sI(){return(sI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const oI=e=>i.createElement("svg",sI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),aI||(aI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m41.636 3.226.251.222a2.67 2.67 0 0 1 .222 3.52l-.222.251-7.219 7.218V27.38l11.209-6.472 2.643-9.86a2.667 2.667 0 0 1 5.218 1.051l-.067.329-2.237 8.35 8.352 2.24a2.67 2.67 0 0 1 1.952 2.938l-.067.328a2.67 2.67 0 0 1-2.937 1.952l-.329-.066-9.861-2.643L37.334 32l11.209 6.47 9.862-2.64.329-.067a2.67 2.67 0 0 1 2.937 1.952l.067.328a2.67 2.67 0 0 1-1.952 2.938l-8.353 2.237 2.238 8.353.067.329a2.666 2.666 0 0 1-5.218 1.052l-2.643-9.861-11.209-6.472v12.944l7.219 7.218a2.667 2.667 0 0 1-3.52 3.993l-.251-.222L32 54.437l-6.114 6.115a2.666 2.666 0 0 1-3.52.222l-.251-.222a2.666 2.666 0 0 1-.222-3.52l.222-.251 7.218-7.22V36.62l-11.209 6.47-2.642 9.863a2.666 2.666 0 0 1-5.218-1.052l.067-.329 2.236-8.351-8.35-2.24a2.665 2.665 0 0 1-1.953-2.937l.067-.328a2.665 2.665 0 0 1 2.937-1.952l.329.066 9.861 2.642L26.667 32l-11.209-6.472-9.86 2.643-.329.066a2.665 2.665 0 0 1-2.937-1.952l-.067-.328a2.67 2.67 0 0 1 1.952-2.938l8.35-2.239-2.235-8.351-.067-.329a2.667 2.667 0 0 1 5.218-1.052l2.642 9.862 11.209 6.47V14.439L22.116 7.22a2.665 2.665 0 0 1 0-3.771 2.666 2.666 0 0 1 3.52-.222l.251.222 6.114 6.112 6.115-6.112a2.666 2.666 0 0 1 3.52-.222z",className:"icon-freeze_svg__fill"})));var lI;function uI(){return(uI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const cI=e=>i.createElement("svg",uI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),lI||(lI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16.664 45.333q3.233 0 5.89-.953 2.658-.954 4.113-2.683V31.34h-10.29v3.94h4.902v4.474q-1.292 1.284-4.327 1.283-3.017 0-4.58-2.085-1.561-2.085-1.562-6.168v-1.657q.018-4.047 1.455-6.097t4.184-2.05q2.155 0 3.385 1.034t1.59 3.262h5.243q-.486-4.206-3.107-6.408t-7.273-2.201q-3.34 0-5.827 1.506t-3.807 4.35q-1.32 2.843-1.32 6.728v1.765q.036 3.78 1.428 6.578 1.392 2.797 3.95 4.269 2.56 1.47 5.953 1.47m20.67 0V18.667H32v26.666h5.333zm10.396 0V34.436h9.721v-4.432H47.73v-6.887h10.937v-4.45h-16v26.666z",className:"icon-gif_svg__fill"})));var dI;function hI(){return(hI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const fI=e=>i.createElement("svg",hI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),dI||(dI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8m1.667 21.333a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-3.334a1 1 0 0 1-1-1v-14a1 1 0 0 1 1-1zm-1.667-8a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334",className:"icon-info_svg__fill"})));var pI;function mI(){return(mI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const gI=e=>i.createElement("svg",mI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),pI||(pI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 5.333a2.667 2.667 0 0 1 .311 5.316l-.311.018H10.667a2.67 2.67 0 0 0-2.65 2.355L8 13.333v37.334a2.667 2.667 0 0 0 2.356 2.648l.31.018H32a2.667 2.667 0 0 1 .311 5.316l-.311.018H10.667a8 8 0 0 1-7.987-7.53l-.013-.47V13.333a8 8 0 0 1 7.53-7.986l.47-.014zm17.634 13.893.252.222 10.666 10.666a2.666 2.666 0 0 1 .222 3.52l-.222.252-10.666 10.666a2.666 2.666 0 0 1-3.993-3.52l.221-.251 4.78-4.782L20 36a2.667 2.667 0 0 1-.311-5.315l.311-.018h33.56l-7.446-7.448a2.67 2.67 0 0 1-.221-3.52l.221-.251a2.666 2.666 0 0 1 3.52-.222",className:"icon-leave_svg__fill"})));var _I;function vI(){return(vI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const EI=e=>i.createElement("svg",vI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),_I||(_I=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L42.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H13.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.316.311L0 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013zM54 37.765a13.33 13.33 0 0 1 9.986 12.297l.014.605V56a2.667 2.667 0 0 1-5.315.311L58.667 56v-5.331a8 8 0 0 0-6-7.74A2.667 2.667 0 1 1 54 37.765M24 5.333c7.364 0 13.333 5.97 13.333 13.334S31.363 32 24 32s-13.333-5.97-13.333-13.333S16.637 5.333 24 5.333m19.328.43a13.333 13.333 0 0 1 0 25.834 2.667 2.667 0 1 1-1.323-5.167 8 8 0 0 0 0-15.5 2.667 2.667 0 1 1 1.323-5.167M24 10.667a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-members_svg__fill"})));var yI;function bI(){return(bI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const CI=e=>i.createElement("svg",bI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),yI||(yI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8M18.667 29.333a2.667 2.667 0 1 1-.001 5.333 2.667 2.667 0 0 1 .001-5.333m13.333 0a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334m13.333 0a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334",className:"icon-message_svg__fill"})));var NI;function TI(){return(TI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const II=e=>i.createElement("svg",TI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),NI||(NI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M18.667 34.667a2.667 2.667 0 0 1 .311 5.316l-.311.017h-5.334v16a2.667 2.667 0 0 1-5.316.311L8 56V40H2.667a2.667 2.667 0 0 1-.311-5.315l.31-.018h16zM32 29.333a2.667 2.667 0 0 1 2.649 2.356l.018.311v24a2.667 2.667 0 0 1-5.316.311L29.333 56V32A2.667 2.667 0 0 1 32 29.333M61.333 40a2.667 2.667 0 0 1 .311 5.315l-.31.018h-5.335L56 56a2.667 2.667 0 0 1-5.315.311L50.667 56l-.001-10.668-5.333.001a2.667 2.667 0 0 1-.311-5.316l.311-.017zm-8-34.667a2.67 2.67 0 0 1 2.65 2.356L56 8v24a2.667 2.667 0 0 1-5.315.311L50.667 32V8a2.667 2.667 0 0 1 2.666-2.667m-42.666 0a2.667 2.667 0 0 1 2.648 2.356l.018.311v18.667a2.667 2.667 0 0 1-5.316.311L8 26.667V8a2.667 2.667 0 0 1 2.667-2.667m21.333 0a2.667 2.667 0 0 1 2.649 2.356l.018.311-.001 10.666H40a2.668 2.668 0 0 1 .311 5.317L40 24H24a2.667 2.667 0 0 1-.311-5.315l.311-.018h5.333V8A2.667 2.667 0 0 1 32 5.333",className:"icon-moderations_svg__fill"})));var SI;function wI(){return(wI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const AI=e=>i.createElement("svg",wI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),SI||(SI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 45.333a5.333 5.333 0 1 1 0 10.666 5.333 5.333 0 0 1 0-10.666M32 28a5.333 5.333 0 1 1 0 10.668A5.333 5.333 0 0 1 32 28m0-17.333c2.946 0 5.333 2.387 5.333 5.333S34.946 21.333 32 21.333 26.667 18.946 26.667 16s2.387-5.333 5.333-5.333",className:"icon-more_svg__fill"})));var MI;function OI(){return(OI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const RI=e=>i.createElement("svg",OI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),MI||(MI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m55.62 19.616.067.123A26.55 26.55 0 0 1 58.667 32c0 4.326-1.03 8.41-2.864 12.025q-1.518 4.089-.67 6.363 1.066 2.855 2.662 4.758 2.31 2.379-1.506 3.33-3.135.782-10.879-1.646l-.488-.155-1.594-.527A26.6 26.6 0 0 1 32 58.667a26.55 26.55 0 0 1-12.326-3.014l-.059-.03 4-4A21.2 21.2 0 0 0 32 53.333c2.993 0 5.89-.614 8.562-1.786l.498-.226 1.925-.905 3.613 1.196.695.219q1.093.337 2.054.595l.472.125.485.121-.167-.42-.2-.594c-.814-2.685-.484-5.681.713-9.065l.154-.425.106-.284.528-1.084a21.2 21.2 0 0 0 1.895-8.8 21.2 21.2 0 0 0-1.71-8.385zm2.266-13.502a2.67 2.67 0 0 1 .221 3.52l-.221.252-48 48a2.668 2.668 0 0 1-3.993-3.52l.221-.252 5.238-5.237a26.56 26.56 0 0 1-6.015-16.412L5.333 32C5.333 17.272 17.273 5.333 32 5.333a26.55 26.55 0 0 1 16.877 6.02l5.237-5.239a2.67 2.67 0 0 1 3.772 0M32 10.667c-11.782 0-21.333 9.55-21.333 21.333 0 4.836 1.614 9.401 4.48 13.084l29.936-29.938A21.25 21.25 0 0 0 32 10.666z",className:"icon-mute_svg__fill"})));var kI;function xI(){return(xI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const DI=e=>i.createElement("svg",xI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),kI||(kI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 0 1-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017zM32 2.667c11.56 0 20.972 9.194 21.323 20.669l.01.664v13.333a5.334 5.334 0 0 0 4.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H5.333l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 0 0 4.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333M32 8c-8.636 0-15.674 6.842-15.989 15.4L16 24v13.333c0 1.562-.336 3.046-.939 4.383l-.275.564-.218.387h34.861l-.215-.387a10.6 10.6 0 0 1-1.146-3.74l-.055-.674-.013-.533V24c0-8.837-7.163-16-16-16",className:"icon-notifications_svg__fill"})));var UI;function LI(){return(LI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const PI=e=>i.createElement("svg",LI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),UI||(UI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 0 1-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017zM32 2.667c7.173 0 13.52 3.54 17.387 8.97l5.686-5.687a2.105 2.105 0 0 1 2.85-.117l.127.117a2.105 2.105 0 0 1 0 2.977L8.927 58.05c-.78.781-2.023.82-2.85.117l-.127-.117a2.105 2.105 0 0 1 0-2.977L13.023 48h-7.69l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 0 0 4.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333m20.85 16.795c.271 1.253.433 2.548.473 3.874l.01.664v13.333a5.334 5.334 0 0 0 4.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H24.31z",className:"icon-notifications-off-filled_svg__fill"})));var FI;function BI(){return(BI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const jI=e=>i.createElement("svg",BI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),FI||(FI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M29.83 6.45a2.667 2.667 0 0 1 4.34 0l11.697 16.374L57 13.918c1.88-1.504 4.573.054 4.32 2.35l-.047.29-8 37.334A2.666 2.666 0 0 1 50.666 56H13.333a2.666 2.666 0 0 1-2.607-2.108l-8-37.333c-.525-2.452 2.315-4.207 4.273-2.641l11.132 8.906zM32 12.587l-11.163 15.63a2.667 2.667 0 0 1-3.836.532l-7.497-5.997 5.984 27.915h33.021l5.984-27.915L47 28.749a2.667 2.667 0 0 1-3.632-.281l-.204-.251zM32 32a5.333 5.333 0 1 1 0 10.668A5.333 5.333 0 0 1 32 32",className:"icon-operator_svg__fill"})));var HI;function GI(){return(GI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const zI=e=>i.createElement("svg",GI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),HI||(HI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M50.667 5.333a8 8 0 0 1 8 8v37.334a8 8 0 0 1-8 8H13.333a8 8 0 0 1-8-8V13.333a8 8 0 0 1 8-8zm-8 25.107L19.77 53.332l30.896.001a2.667 2.667 0 0 0 2.661-2.498l.005-.168v-9.564L42.666 30.44zm8-19.773H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334c0 1.143.72 2.119 1.731 2.498L40.781 24.78a2.67 2.67 0 0 1 3.52-.222l.251.222 8.78 8.78.001-20.228a2.667 2.667 0 0 0-2.498-2.661zm-28 5.333a6.666 6.666 0 1 1 0 13.333 6.666 6.666 0 0 1 0-13.333m0 5.333a1.334 1.334 0 1 0 0 2.667 1.334 1.334 0 0 0 0-2.667",className:"icon-photo_svg__fill"})));var VI;function qI(){return(qI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const KI=e=>i.createElement("svg",qI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),VI||(VI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M51.908 34.75c1.9-1.233 1.896-3.26.013-4.514L19.376 8.577c-1.893-1.26-3.404-.391-3.376 1.968l.522 42.888c.028 2.347 1.596 3.247 3.493 2.016z",className:"icon-play_svg__fill"})));var WI;function YI(){return(YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const QI=e=>i.createElement("svg",YI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),WI||(WI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 29.333h18.666c3.556 0 3.556 5.334 0 5.334H34.667v18.666c0 3.556-5.334 3.556-5.334 0V34.667H10.667c-3.556 0-3.556-5.334 0-5.334h18.666V10.667c0-3.556 5.334-3.556 5.334 0z",className:"icon-plus_svg__fill"})));var XI;function ZI(){return(ZI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const JI=e=>i.createElement("svg",ZI({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),XI||(XI=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 61.333C15.8 61.333 2.667 48.2 2.667 32S15.8 2.667 32 2.667 61.333 15.8 61.333 32 48.2 61.333 32 61.333M32 56c13.255 0 24-10.745 24-24S45.255 8 32 8 8 18.745 8 32s10.745 24 24 24m2.213-18.63a2.667 2.667 0 1 1-5.333 0v-2.69c0-1.148.734-2.168 1.823-2.53.173-.058.532-.195 1.01-.407.809-.36 1.616-.79 2.354-1.282 1.835-1.223 2.813-2.528 2.813-3.786a5.333 5.333 0 0 0-10.364-1.777 2.667 2.667 0 0 1-5.032-1.77 10.668 10.668 0 0 1 20.729 3.551c0 3.413-2.022 6.109-5.187 8.22a21 21 0 0 1-2.813 1.578zm-5.333 7.523a2.667 2.667 0 1 1 5.333 0v.44a2.667 2.667 0 1 1-5.333 0v-.44",className:"icon-question_svg__fill"})));var $I;function eS(){return(eS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const tS=e=>i.createElement("svg",eS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),$I||($I=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m46.14 14.43.562.537 6.631 6.167v-7.8a2.67 2.67 0 0 1 2.356-2.65l.311-.017a2.667 2.667 0 0 1 2.649 2.355l.018.311v16a2.67 2.67 0 0 1-2.356 2.65L56 32H40a2.667 2.667 0 0 1-.311-5.315l.311-.018h11.452l-8.44-7.85c-5.964-5.893-15.168-7.182-22.563-3.156-7.38 4.018-11.172 12.357-9.314 20.455 1.859 8.107 8.935 14.032 17.362 14.518 8.43.487 16.162-4.585 18.967-12.426a2.667 2.667 0 0 1 5.022 1.797C48.88 50.082 38.973 56.582 28.19 55.959c-10.785-.623-19.862-8.222-22.254-18.65C3.542 26.872 8.426 16.135 17.9 10.977c9.227-5.024 20.65-3.579 28.241 3.453z",className:"icon-refresh_svg__fill"})));var nS;function rS(){return(rS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const iS=e=>i.createElement("svg",rS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),nS||(nS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667m9.886 19.447a2.67 2.67 0 0 0-3.772 0L32 28.23l-6.114-6.115-.134-.124a2.667 2.667 0 0 0-3.638.124l-.124.134a2.667 2.667 0 0 0 .124 3.638L28.23 32l-6.115 6.114-.124.134a2.667 2.667 0 0 0 .124 3.638l.134.124a2.667 2.667 0 0 0 3.638-.124L32 35.77l6.114 6.115.134.124a2.667 2.667 0 0 0 3.638-.124l.124-.134a2.667 2.667 0 0 0-.124-3.638L35.77 32l6.115-6.114.124-.134a2.667 2.667 0 0 0-.124-3.638z",className:"icon-remove_svg__fill"})));var aS;function sS(){return(sS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const oS=e=>i.createElement("svg",sS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12"},e),aS||(aS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M11.774 10.5c.062 0 .12-.025.164-.07a.22.22 0 0 0 .062-.164c-.069-1.447-.495-2.678-1.268-3.66-.618-.785-1.455-1.409-2.49-1.855a9.3 9.3 0 0 0-2.406-.655 10 10 0 0 0-.862-.078V2.225a.23.23 0 0 0-.128-.203.23.23 0 0 0-.24.028L.084 5.692A.22.22 0 0 0 0 5.865c0 .068.03.132.082.175l4.523 3.737c.067.056.16.068.24.03a.22.22 0 0 0 .13-.202v-1.95c1.134-.08 2.178.003 3.107.25a6.4 6.4 0 0 1 2.087.96c1.018.724 1.398 1.5 1.401 1.507a.23.23 0 0 0 .204.128",className:"icon-reply-filled_svg__fill"})));var lS;function uS(){return(uS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const cS=e=>i.createElement("svg",uS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),lS||(lS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M26.667 48C14.885 48 5.333 38.449 5.333 26.667S14.885 5.333 26.667 5.333 48 14.885 48 26.667c0 4.93-1.672 9.469-4.48 13.081l13.67 13.67a2.668 2.668 0 0 1-3.772 3.772l-13.67-13.67A21.24 21.24 0 0 1 26.667 48m0-5.333c8.836 0 16-7.164 16-16s-7.164-16-16-16-16 7.163-16 16 7.163 16 16 16",className:"icon-search_svg__fill"})));var dS;function hS(){return(hS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const fS=e=>i.createElement("svg",hS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),dS||(dS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M59.795 29.43 7.329 2.979C4.691 1.802 1.76 4.153 2.932 6.798l6.925 18.609a2 2 0 0 0 1.544 1.275l32.273 5.394L11.4 37.47a2 2 0 0 0-1.544 1.275L2.932 57.353c-.879 2.645 1.76 4.997 4.397 3.527l52.466-26.453c2.051-.882 2.051-3.82 0-4.996z",className:"icon-send_svg__fill"})));var pS;function mS(){return(mS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const gS=e=>i.createElement("svg",mS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),pS||(pS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667A5.33 5.33 0 0 1 37.333 8v.24A4.4 4.4 0 0 0 40 12.267a4.4 4.4 0 0 0 4.853-.88l.16-.16a5.33 5.33 0 0 1 7.547 0 5.333 5.333 0 0 1 0 7.546l-.16.16a4.4 4.4 0 0 0-.88 4.854V24a4.4 4.4 0 0 0 4.027 2.667H56c2.946 0 5.333 2.387 5.333 5.333S58.946 37.333 56 37.333h-.24A4.4 4.4 0 0 0 51.733 40a4.4 4.4 0 0 0 .88 4.853l.16.16a5.33 5.33 0 0 1 0 7.547 5.333 5.333 0 0 1-7.546 0l-.16-.16a4.4 4.4 0 0 0-4.854-.88 4.4 4.4 0 0 0-2.666 4.027V56a5.333 5.333 0 0 1-10.667 0v-.24A4.4 4.4 0 0 0 24 51.733a4.4 4.4 0 0 0-4.853.88l-.16.16a5.33 5.33 0 0 1-7.547 0 5.333 5.333 0 0 1 0-7.546l.16-.16a4.4 4.4 0 0 0 .88-4.854 4.4 4.4 0 0 0-4.027-2.666H8A5.333 5.333 0 0 1 8 26.88h.24A4.4 4.4 0 0 0 12.267 24a4.4 4.4 0 0 0-.88-4.853l-.16-.16a5.33 5.33 0 0 1 0-7.547 5.333 5.333 0 0 1 7.546 0l.16.16a4.4 4.4 0 0 0 4.854.88H24a4.4 4.4 0 0 0 2.667-4.027V8A5.33 5.33 0 0 1 32 2.667M32 24a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-settings-filled_svg__fill"})));var _S;function vS(){return(vS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const ES=e=>i.createElement("svg",vS({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 32"},e),_S||(_S=i.createElement("path",{d:"M21.943 24.39a1.333 1.333 0 0 1-1.886 1.886l-9.333-9.333a1.333 1.333 0 0 1 0-1.886l9.333-9.333a1.333 1.333 0 1 1 1.886 1.885L13.553 16z",className:"icon-slide-left_svg__fill",clipRule:"evenodd"})));var yS;function bS(){return(bS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const CS=e=>i.createElement("svg",bS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),yS||(yS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 61.333C48.2 61.333 61.333 48.2 61.333 32S48.2 2.667 32 2.667 2.667 15.8 2.667 32a2.838 2.838 0 1 0 5.678 0C8.344 18.935 18.934 8.344 32 8.344c13.065 0 23.656 10.591 23.656 23.656S45.065 55.656 32 55.656a2.838 2.838 0 1 0 0 5.677",className:"icon-spinner_svg__fill"})));var NS;function TS(){return(TS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const IS=e=>i.createElement("svg",TS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),NS||(NS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.889 43.013c6.608 0 12.121 4.685 12.43 10.734l.014.537V58a2.667 2.667 0 0 1-5.316.311L44 58v-3.716c0-3.07-2.87-5.718-6.636-5.925l-.475-.013H27.11c-3.838 0-6.86 2.525-7.096 5.557l-.015.381V58a2.667 2.667 0 0 1-5.315.311L14.667 58v-3.716c0-6.126 5.324-10.986 11.864-11.26l.58-.011zm18.578-17.291q.401 0 .784.118c4.632 1.426 7.518 4.801 7.736 9.688l.013.594v12.8a2.667 2.667 0 0 1-5.315.311l-.018-.311V36.124c-.002-2.595-1.163-4.171-3.528-5.034l-.104-.037-2.502.002a2.667 2.667 0 0 1-2.648-2.356l-.018-.31a2.67 2.67 0 0 1 2.355-2.65l.311-.017zm-44 0 .31.018a2.666 2.666 0 0 1 2.356 2.648l-.018.311a2.666 2.666 0 0 1-2.648 2.356l-2.51-.002-.119.042c-2.246.85-3.503 2.574-3.505 5.147v12.68l-.018.31A2.666 2.666 0 0 1 0 48.922V36.24l.014-.591c.225-4.874 3.203-8.415 7.712-9.809q.384-.117.788-.118zM32 19.958c5.512 0 10 4.409 10 9.871s-4.488 9.872-10 9.872-10-4.41-10-9.872 4.488-9.871 10-9.871m0 5.333c-2.588 0-4.667 2.043-4.667 4.538s2.08 4.538 4.667 4.538c2.588 0 4.667-2.042 4.667-4.538 0-2.495-2.08-4.538-4.667-4.538M17.333 2.667c5.513 0 10 4.409 10 9.871s-4.487 9.871-10 9.871c-5.512 0-10-4.409-10-9.871s4.488-9.871 10-9.871m29.334 0c5.512 0 10 4.409 10 9.871s-4.488 9.871-10 9.871c-5.513 0-10-4.409-10-9.871s4.487-9.871 10-9.871M17.333 8c-2.587 0-4.666 2.042-4.666 4.538s2.079 4.538 4.666 4.538S22 15.034 22 12.538 19.921 8 17.333 8m29.334 0C44.079 8 42 10.042 42 12.538s2.079 4.538 4.667 4.538 4.666-2.042 4.666-4.538S49.254 8 46.667 8",className:"icon-supergroup_svg__fill"})));var SS,wS;function AS(){return(AS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const MS=e=>i.createElement("svg",AS({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 64 64"},e),SS||(SS=i.createElement("path",{d:"M38.824 25.895a2.95 2.95 0 0 1 4.16-.074L57.1 39.378a2.92 2.92 0 0 1 .002 4.213L42.985 57.177a2.95 2.95 0 0 1-4.158-.07 2.92 2.92 0 0 1 .07-4.14l11.928-11.48-11.926-11.451a2.92 2.92 0 0 1-.075-4.14",className:"icon-thread_svg__fill",clipRule:"evenodd"})),wS||(wS=i.createElement("path",{d:"M8.866 6c1.583 0 2.866 1.216 2.866 2.716V25.5c0 7.672 6.846 14.068 15.475 14.068h22.927c1.583 0 2.866 1.216 2.866 2.716S51.717 45 50.134 45H27.207C15.604 45 6 36.35 6 25.5V8.716C6 7.216 7.283 6 8.866 6",className:"icon-thread_svg__fill",clipRule:"evenodd"})));var OS;function RS(){return(RS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const kS=e=>i.createElement("svg",RS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),OS||(OS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 5.333a2.667 2.667 0 0 1 0 5.334H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334c0 1.143.72 2.118 1.73 2.497l28.384-28.383a2.667 2.667 0 0 1 3.771 0l8.781 8.78v-4.228a2.667 2.667 0 0 1 2.498-2.661l.169-.005a2.667 2.667 0 0 1 2.667 2.666v21.334a8 8 0 0 1-8 8H13.33a8 8 0 0 1-7.998-8V13.333a8 8 0 0 1 8-8zm8 25.105L19.77 53.333h30.897a2.667 2.667 0 0 0 2.661-2.498l.005-.168v-9.563zM22.667 16a6.666 6.666 0 1 1 0 13.333 6.666 6.666 0 0 1 0-13.333m0 5.333a1.334 1.334 0 1 0 0 2.667 1.334 1.334 0 0 0 0-2.667M56.78 3.448a2.665 2.665 0 0 1 3.771 0 2.665 2.665 0 0 1 0 3.771l-4.782 4.78 4.782 4.782c.998.998 1.04 2.59.125 3.638l-.125.133a2.665 2.665 0 0 1-3.771 0l-4.782-4.781-4.78 4.781a2.667 2.667 0 0 1-3.638.125l-.133-.125a2.665 2.665 0 0 1 0-3.771L48.228 12l-4.78-4.781a2.667 2.667 0 0 1-.125-3.638l.125-.133a2.665 2.665 0 0 1 3.771 0l4.78 4.78z",className:"icon-thumbnail-none_svg__fill"})));var xS;function DS(){return(DS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const US=e=>i.createElement("svg",DS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 88 48"},e),xS||(xS=i.createElement("g",{fill:"none",fillRule:"evenodd"},i.createElement("rect",{width:80,height:40,x:4,y:4,fill:"#000",className:"icon-toggleoff_svg__fill",rx:20}),i.createElement("circle",{cx:24,cy:24,r:12,fill:"#FFF"}),i.createElement("path",{fill:"#FFF",d:"M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992z"}),i.createElement("path",{fill:"#000",d:"M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0m0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4z",className:"icon-toggleoff_svg__fill"}))));var LS;function PS(){return(PS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const FS=e=>i.createElement("svg",PS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 88 48"},e),LS||(LS=i.createElement("g",{fill:"none",fillRule:"evenodd"},i.createElement("rect",{width:80,height:40,x:4,y:4,fill:"#000",className:"icon-toggleon_svg__fill",rx:20}),i.createElement("circle",{cx:64,cy:24,r:12,fill:"#FFF"}),i.createElement("path",{fill:"#FFF",d:"M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992z"}),i.createElement("path",{fill:"#000",d:"M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0m0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4z",className:"icon-toggleon_svg__fill"}))));var BS;function jS(){return(jS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const HS=e=>i.createElement("svg",jS({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},e),BS||(BS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M42.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L50.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H21.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.316.311L8 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013zM32 5.333c7.364 0 13.333 5.97 13.333 13.334S39.363 32 32 32s-13.333-5.97-13.333-13.333S24.637 5.333 32 5.333m0 5.334a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-user_svg__fill"})));var GS;function zS(){return(zS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const VS=e=>i.createElement("svg",zS({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},e),GS||(GS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M12.346 5.336v-.001c.405-.523 1.182-.524 1.58-.037.162.2.25.443.25.69v3.678c0 .518.42.938.938.938H18.6c.359 0 .7.179.911.488l.001.001.369.548.003.004c.174.256.226.583.134.895l-1.532 5.316c-.131.459-.559.782-1.044.782h-7.075c-.3 0-.593-.127-.8-.345l-1.13-1.222v-6.647zm-4.73 3.078 3.245-4.223.002-.002c1.125-1.456 3.339-1.521 4.517-.075.421.52.671 1.177.671 1.874v2.74h2.55c.99 0 1.908.496 2.462 1.31l.002.004.368.547.002.002a2.93 2.93 0 0 1 .382 2.475v.003l-1.528 5.302a2.96 2.96 0 0 1-2.847 2.142h-7.075a2.99 2.99 0 0 1-2.166-.935l-.007-.007-.066-.072a2.13 2.13 0 0 1-1.821 1.025H4.192a2.13 2.13 0 0 1-2.13-2.13v-8.3a2.13 2.13 0 0 1 2.13-2.13h2.115c.493 0 .948.168 1.31.45m-3.678 1.68c0-.141.114-.255.254-.255h2.115c.14 0 .254.114.254.255v8.3c0 .14-.114.255-.254.255H4.192a.255.255 0 0 1-.255-.255z",clipRule:"evenodd"})));var qS;function KS(){return(KS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}const WS=e=>i.createElement("svg",KS({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},e),qS||(qS=i.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M11.654 18.664v.001c-.405.523-1.182.524-1.58.037-.162-.2-.25-.444-.25-.69v-3.678a.94.94 0 0 0-.938-.938H5.4c-.359 0-.7-.179-.911-.488l-.001-.001-.369-.548-.003-.004a1.05 1.05 0 0 1-.134-.895l1.532-5.316c.131-.459.559-.782 1.044-.782h7.075c.3 0 .593.127.8.345l1.13 1.222v6.647zm4.73-3.078-3.245 4.223-.002.002c-1.125 1.456-3.339 1.521-4.517.075a2.98 2.98 0 0 1-.671-1.874v-2.74h-2.55c-.99 0-1.908-.496-2.462-1.31l-.002-.004-.368-.547-.002-.002a2.93 2.93 0 0 1-.382-2.475v-.003L3.711 5.63a2.96 2.96 0 0 1 2.847-2.142h7.075c.823 0 1.608.345 2.166.935l.007.007.066.072a2.13 2.13 0 0 1 1.821-1.025h2.115a2.13 2.13 0 0 1 2.13 2.13v8.3a2.13 2.13 0 0 1-2.13 2.13h-2.115a2.12 2.12 0 0 1-1.31-.45m3.678-1.68c0 .141-.114.255-.254.255h-2.115a.255.255 0 0 1-.255-.255v-8.3c0-.14.115-.255.255-.255h2.115c.14 0 .255.114.255.255z",clipRule:"evenodd"})));function YS(e){var t=e.className,n=void 0===t?"":t,r=e.type,i=e.fillColor,s=void 0===i?SN.DEFAULT:i,o=e.width,l=void 0===o?26:o,u=e.height,c=void 0===u?26:u,d=e.onClick,h=void 0===d?$C:d,f=e.children,p=void 0===f?null:f,m=e.testID,g={width:"string"==typeof l?l:"".concat(l,"px"),minWidth:"string"==typeof l?l:"".concat(l,"px"),height:"string"==typeof c?c:"".concat(c,"px"),minHeight:"string"==typeof c?c:"".concat(c,"px")};return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-icon",AN(r),wN(s)],!1).join(" "),"data-testid":m,role:"button",onClick:h,onKeyDown:h,tabIndex:0,style:g},p||function(e){switch(e){case IN.ADD:return a.a.createElement(ON,null);case IN.ARROW_LEFT:return a.a.createElement(xN,null);case IN.ATTACH:return a.a.createElement(LN,null);case IN.AUDIO_ON_LINED:return a.a.createElement(jN,null);case IN.BAN:return a.a.createElement(zN,null);case IN.BROADCAST:return a.a.createElement(KN,null);case IN.CAMERA:return a.a.createElement(QN,null);case IN.CHANNELS:return a.a.createElement(JN,null);case IN.CHAT:return a.a.createElement(tT,null);case IN.CHAT_FILLED:return a.a.createElement(iT,null);case IN.CHEVRON_DOWN:return a.a.createElement(oT,null);case IN.CHEVRON_RIGHT:return a.a.createElement(cT,null);case IN.CLOSE:return a.a.createElement(fT,null);case IN.COLLAPSE:return a.a.createElement(gT,null);case IN.COPY:return a.a.createElement(ET,null);case IN.CREATE:return a.a.createElement(CT,null);case IN.DELETE:return a.a.createElement(IT,null);case IN.DISCONNECTED:return a.a.createElement(AT,null);case IN.DOCUMENT:return a.a.createElement(RT,null);case IN.DONE:return a.a.createElement(DT,null);case IN.DONE_ALL:return a.a.createElement(PT,null);case IN.DOWNLOAD:return a.a.createElement(jT,null);case IN.EDIT:return a.a.createElement(zT,null);case IN.EMOJI_MORE:return a.a.createElement(KT,null);case IN.ERROR:return a.a.createElement(QT,null);case IN.EXPAND:return a.a.createElement(JT,null);case IN.FILE_AUDIO:return a.a.createElement(tI,null);case IN.FILE_DOCUMENT:return a.a.createElement(iI,null);case IN.FREEZE:return a.a.createElement(oI,null);case IN.GIF:return a.a.createElement(cI,null);case IN.INFO:return a.a.createElement(fI,null);case IN.LEAVE:return a.a.createElement(gI,null);case IN.MEMBERS:return a.a.createElement(EI,null);case IN.MESSAGE:return a.a.createElement(CI,null);case IN.MODERATIONS:return a.a.createElement(II,null);case IN.MORE:return a.a.createElement(AI,null);case IN.MUTE:return a.a.createElement(RI,null);case IN.NOTIFICATIONS:return a.a.createElement(DI,null);case IN.NOTIFICATIONS_OFF_FILLED:return a.a.createElement(PI,null);case IN.OPERATOR:return a.a.createElement(jI,null);case IN.PHOTO:return a.a.createElement(zI,null);case IN.PLAY:return a.a.createElement(KI,null);case IN.PLUS:return a.a.createElement(QI,null);case IN.QUESTION:return a.a.createElement(JI,null);case IN.REFRESH:return a.a.createElement(tS,null);case IN.REMOVE:return a.a.createElement(iS,null);case IN.REPLY:return a.a.createElement(oS,null);case IN.SEARCH:return a.a.createElement(cS,null);case IN.SEND:return a.a.createElement(fS,null);case IN.SETTINGS_FILLED:return a.a.createElement(gS,null);case IN.SLIDE_LEFT:return a.a.createElement(ES,null);case IN.SPINNER:return a.a.createElement(CS,null);case IN.SUPERGROUP:return a.a.createElement(IS,null);case IN.THREAD:return a.a.createElement(MS,null);case IN.THUMBNAIL_NONE:return a.a.createElement(kS,null);case IN.TOGGLE_OFF:return a.a.createElement(US,null);case IN.TOGGLE_ON:return a.a.createElement(FS,null);case IN.USER:return a.a.createElement(HS,null);case IN.FEEDBACK_LIKE:return a.a.createElement(VS,null);case IN.FEEDBACK_DISLIKE:return a.a.createElement(WS,null);default:return"icon"}}(r))}var QS=IN,XS=SN,ZS=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},JS="sendbird-modal-root",$S=function(){return a.a.createElement("div",{id:JS,className:JS})},ew=function(e){var t=e.titleText,n=e.onCloseClick;return a.a.createElement("div",{className:"sendbird-modal__header"},a.a.createElement(_N,{type:vN.H_1,color:EN.ONBACKGROUND_1},t),a.a.createElement("div",{className:"sendbird-modal__close"},a.a.createElement(lN,{width:"32px",height:"32px",onClick:n},a.a.createElement(YS,{type:QS.CLOSE,fillColor:XS.DEFAULT,width:"24px",height:"24px"}))))},tw=function(e){var t=e.children;return a.a.createElement("div",{className:"sendbird-modal__body"},a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_2},t))},nw=function(e){var t=e.submitText,n=e.disabled,r=void 0!==n&&n,s=e.hideCancelButton,o=void 0!==s&&s,l=e.type,u=void 0===l?fN.DANGER:l,c=e.onSubmit,d=e.onCancel,h=Object(i.useContext)(XC).stringSet;return a.a.createElement("div",{className:"sendbird-modal__footer"},!o&&a.a.createElement(NN,{type:fN.SECONDARY,onClick:d},a.a.createElement(_N,{type:vN.BUTTON_1,color:EN.ONBACKGROUND_1},h.BUTTON__CANCEL)),a.a.createElement(NN,{type:u,disabled:r,onClick:c},t))};function rw(e){var t,n=e.children,r=void 0===n?null:n,o=e.className,l=void 0===o?"":o,u=e.contentClassName,c=void 0===u?"":u,d=e.isCloseOnClickOutside,h=void 0!==d&&d,f=e.isFullScreenOnMobile,p=void 0!==f&&f,m=e.titleText,g=e.submitText,_=e.disabled,v=void 0!==_&&_,y=e.hideFooter,b=void 0!==y&&y,C=e.type,N=void 0===C?fN.DANGER:C,T=e.renderHeader,I=e.onSubmit,S=void 0===I?$C:I,w=e.onClose,A=e.onCancel,M=e.customFooter,O=null!==(t=null!=w?w:A)&&void 0!==t?t:$C,R=IC().state.eventHandlers,k=Object(i.useState)((function(){return"sbu-modal-".concat(ZS())}))[0];Object(i.useEffect)((function(){var e,t;return null===(t=null===(e=null==R?void 0:R.modal)||void 0===e?void 0:e.onMounted)||void 0===t?void 0:t.call(e,{close:O,id:k})}),[]);var x=oN().isMobile;return Object(s.createPortal)(a.a.createElement("div",{className:nN("sendbird-modal",l,p&&x&&"sendbird-modal--full-mobile")},a.a.createElement("div",{className:nN.apply(void 0,E(["sendbird-modal__content"],Array.isArray(c)?c:[c],!1))},(null==T?void 0:T())||a.a.createElement(ew,{titleText:null!=m?m:"",onCloseClick:O}),a.a.createElement(tw,null,r),!b&&(null!=M?M:a.a.createElement(nw,{disabled:v,onCancel:O,onSubmit:S,submitText:null!=g?g:"",type:N}))),a.a.createElement("div",{className:nN("sendbird-modal__backdrop",h&&"sendbird-modal__backdrop--clickoutside"),onClick:function(e){null==e||e.stopPropagation(),h&&O()}})),document.getElementById(JS))}var iw=Object(i.createContext)({start:$C,stop:$C,isRecordable:!1}),aw=function(e){var t,r=e.children,s=IC().state.config,o=s.logger,l=s.groupChannel,u=Object(i.useState)(null),c=u[0],d=u[1],h=Object(i.useState)(!1),f=h[0],p=h[1],m=Object(i.useState)(!1),g=m[0],_=m[1],v=JC().stringSet,E=l.enableVoiceMessage,y=Object(i.useState)(null),b=y[0],C=y[1],N=null!==(t=z_.find((function(e){return MediaRecorder.isTypeSupported(e)})))&&void 0!==t?t:"";E&&!N&&o.error("VoiceRecorder: Browser does not support mimeType",{mimmeTypes:z_}),Object(i.useEffect)((function(){E&&!b&&n.e(12).then(n.bind(null,38)).then((function(e){return C(e)}))}),[E,b]);var T=Object(i.useCallback)((function(e){var t,n;if(!E||b){o.info("VoiceRecorder: Start recording."),c&&(I(),o.info("VoiceRecorder: Previous mediaRecorder is stopped.")),function(){try{navigator.permissions.query({name:"microphone"}).then((function(e){"denied"===e.state&&(o.warning("VoiceRecorder: Permission denied."),_(!0))}))}catch(e){o.warning("VoiceRecorder: Failed to check permission.",e)}}(),null===(n=null===(t=null===navigator||void 0===navigator?void 0:navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia)||void 0===n||n.call(t,{audio:!0}).then((function(t){var n;o.info("VoiceRecorder: Succeeded getting media stream.",t),p(!0);var r=new MediaRecorder(t,{mimeType:N,audioBitsPerSecond:12e3});r.ondataavailable=function(n){o.info("VoiceRecorder: Succeeded getting an available data.",n.data);var r=new File([n.data],"Voice_message.mp3",{lastModified:(new Date).getTime(),type:"audio/mp3;sbu_type=voice"});null==b||b.downsampleToWav(r,(function(t){var n,r=null==b?void 0:b.encodeMp3(t),i=new Blob(r,{type:"audio/mp3;sbu_type=voice"}),a=new File([i],"Voice_message.mp3",{lastModified:(new Date).getTime(),type:"audio/mp3;sbu_type=voice"});null===(n=null==e?void 0:e.onRecordingEnded)||void 0===n||n.call(e,a),o.info("VoiceRecorder: Succeeded converting audio file.",a)})),t.getAudioTracks().forEach((function(e){return e.stop()})),p(!1)},r.onstart=null!==(n=null==e?void 0:e.onRecordingStarted)&&void 0!==n?n:$C,null==r||r.start(),d(r)})).catch((function(e){o.error("VoiceRecorder: Failed getting media stream.",e),d(null)}))}else o.error("VoiceRecorder: Recording audio processor is being loaded.")}),[c,b]),I=Object(i.useCallback)((function(){null==c||c.stop(),d(null),p(!1),o.info("VoiceRecorder: Stop recording.")}),[c]);return a.a.createElement(iw.Provider,{value:{start:T,stop:I,isRecordable:f}},r,g&&a.a.createElement(rw,{hideFooter:!0,onClose:function(){return _(!1)}},a.a.createElement(a.a.Fragment,null,v.VOICE_RECORDING_PERMISSION_DENIED)))},sw=function(){return Object(i.useContext)(iw)},ow=Symbol("@ts-pattern/matcher"),lw="@ts-pattern/anonymous-select-key",uw=function(e){return Boolean(e&&"object"==typeof e)},cw=function(e){return e&&!!e[ow]},dw=function e(t,n,r){if(uw(t)){if(cw(t)){var i=t[ow]().match(n),a=i.matched,s=i.selections;return a&&s&&Object.keys(s).forEach((function(e){return r(e,s[e])})),a}if(!uw(n))return!1;if(Array.isArray(t))return!!Array.isArray(n)&&t.length===n.length&&t.every((function(t,i){return e(t,n[i],r)}));if(t instanceof Map)return n instanceof Map&&Array.from(t.keys()).every((function(i){return e(t.get(i),n.get(i),r)}));if(t instanceof Set){if(!(n instanceof Set))return!1;if(0===t.size)return 0===n.size;if(1===t.size){var o=Array.from(t.values())[0];return cw(o)?Array.from(n.values()).every((function(t){return e(o,t,r)})):n.has(o)}return Array.from(t.values()).every((function(e){return n.has(e)}))}return Object.keys(t).every((function(i){var a,s=t[i];return(i in n||cw(a=s)&&"optional"===a[ow]().matcherType)&&e(s,n[i],r)}))}return Object.is(n,t)};function hw(e){var t;return(t={})[ow]=function(){return{match:function(t){return{matched:Boolean(e(t))}}}},t}function fw(e){return new pw(e,[])}hw((function(e){return!0})),hw((function(e){return"string"==typeof e})),hw((function(e){return"number"==typeof e})),hw((function(e){return"boolean"==typeof e})),hw((function(e){return"bigint"==typeof e})),hw((function(e){return"symbol"==typeof e})),hw((function(e){return null==e}));var pw=function(){function e(e,t){this.value=void 0,this.cases=void 0,this.value=e,this.cases=t}var t=e.prototype;return t.with=function(){var t=[].slice.call(arguments),n=t[t.length-1],r=[t[0]],i=[];return 3===t.length&&"function"==typeof t[1]?(r.push(t[0]),i.push(t[1])):t.length>2&&r.push.apply(r,t.slice(1,t.length-1)),new e(this.value,this.cases.concat([{match:function(e){var t={},n=Boolean(r.some((function(n){return dw(n,e,(function(e,n){t[e]=n}))}))&&i.every((function(t){return t(e)})));return{matched:n,value:n&&Object.keys(t).length?lw in t?t[lw]:t:e}},handler:n}]))},t.when=function(t,n){return new e(this.value,this.cases.concat([{match:function(e){return{matched:Boolean(t(e)),value:e}},handler:n}]))},t.otherwise=function(t){return new e(this.value,this.cases.concat([{match:function(e){return{matched:!0,value:e}},handler:t}])).run()},t.exhaustive=function(){return this.run()},t.run=function(){for(var e=this.value,t=void 0,n=0;n<this.cases.length;n++){var r=this.cases[n],i=r.match(this.value);if(i.matched){e=i.value,t=r.handler;break}}if(!t){var a;try{a=JSON.stringify(this.value)}catch(e){a=this.value}throw new Error("Pattern matching error: no pattern matches value "+a)}return t(e,this.value)},e}(),mw=Object(i.createContext)({openModal:$C}),gw=function(e){var t=e.children,n=Object(i.useState)([]),r=n[0],s=n[1],o=Object(i.useCallback)((function(e){s((function(t){return E(E([],t,!0),[e],!1)}))}),[]),l=Object(i.useCallback)((function(){s((function(e){return e.slice(1)}))}),[]),u=Object(i.useMemo)((function(){return function(){return fw(r).when((function(e){return 0===e.length}),(function(){return a.a.createElement(a.a.Fragment,null)})).otherwise((function(){var e=r[0],t=e.modalProps,n=e.childElement;return a.a.createElement(rw,m({},t,{className:nN("sendbird-global-modal",null==t?void 0:t.className),onClose:function(){var e;null===(e=null==t?void 0:t.onClose)||void 0===e||e.call(t),l()}}),n({closeModal:l}))}))}}),[r]);return a.a.createElement(mw.Provider,{value:{openModal:o}},a.a.createElement(u,null),t)},_w=function(){return Object(i.useContext)(mw)},vw=function(e){var t={};return{__getTopics:function(){return t},subscribe:function(e,n){var r;return null!==(r=t[e])&&void 0!==r||(t[e]=new Set),t[e].add(n),{remove:function(){t[e].delete(n)}}},publish:function(n,r){t[n]&&t[n].forEach((function(t){(null==e?void 0:e.publishSynchronous)?t(void 0!==r?r:{}):setTimeout((function(){return t(void 0!==r?r:{})}),0)}))}}},Ew=function(){function e(e){var t,n=this,r=e.sdk,i=e.logger;null===(t=null==r?void 0:r.getAllEmoji)||void 0===t||t.call(r).then((function(e){n._emojiContainer=e,null==i||i.info("EmojiManager | Succeeded getting all emojis. ",e)})).catch((function(){null==i||i.warning("EmojiManager | Failed getting all emojis.")}))}return Object.defineProperty(e.prototype,"AllEmojisAsArray",{get:function(){return this._emojiContainer.emojiCategories.flatMap((function(e){return e.emojis}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AllEmojisAsMap",{get:function(){return this._emojiContainer.emojiCategories.flatMap((function(e){return e.emojis})).reduce((function(e,t){return e.set(t.key,t.url),e}),new Map)},enumerable:!1,configurable:!0}),e.prototype.getAllEmojis=function(e){var t=this;return fw(e).when((function(e){return["array","arr"].includes(e)}),(function(){return t.AllEmojisAsArray})).when((function(e){return["map"].includes(e)}),(function(){return t.AllEmojisAsMap})).otherwise((function(){return t.AllEmojisAsArray}))},e.prototype.getEmojiUrl=function(e){var t,n;return null!==(n=null===(t=this.AllEmojisAsArray.find((function(t){return t.key===e})))||void 0===t?void 0:t.url)&&void 0!==n?n:""},Object.defineProperty(e.prototype,"emojiContainer",{get:function(){return this._emojiContainer},enumerable:!1,configurable:!0}),e}(),yw={100:"extra-light",200:"light",300:"main",400:"dark",500:"extra-dark","overlay-01":"overlay-dark","overlay-02":"overlay-light","onlight-01":"onlight-text-high-emphasis","onlight-02":"onlight-text-mid-emphasis","onlight-03":"onlight-text-low-emphasis","onlight-04":"onlight-text-disabled","ondark-01":"ondark-text-high-emphasis","ondark-02":"ondark-text-mid-emphasis","ondark-03":"ondark-text-low-emphasis","ondark-04":"ondark-text-disabled"},bw=Object.values(yw).sort((function(e,t){return t.length-e.length})),Cw=new Map(Object.entries(yw).map((function(e){var t=e[0];return[e[1],t]})));
/*!
 * css-vars-ponyfill
 * v2.4.9
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */
function Nw(){return(Nw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}
/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Tw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={mimeType:t.mimeType||null,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},r=Array.isArray(e)?e:[e],i=Array.apply(null,Array(r.length)).map((function(e){return null}));function a(e){var t="string"==typeof e,n=t&&"<"===e.trim().charAt(0);return t&&!n}function s(e,t){n.onError(e,r[t],t)}function o(e,t){var a=n.onSuccess(e,r[t],t);e=!1===a?"":a||e,i[t]=e,-1===i.indexOf(null)&&n.onComplete(i)}var l=document.createElement("a");r.forEach((function(e,t){if(l.setAttribute("href",e),l.href=String(l.href),Boolean(document.all&&!window.atob)&&l.host.split(":")[0]!==location.host.split(":")[0]){if(l.protocol===location.protocol){var r=new XDomainRequest;r.open("GET",e),r.timeout=0,r.onprogress=Function.prototype,r.ontimeout=Function.prototype,r.onload=function(){var e=r.responseText;a(e)?o(e,t):s(r,t)},r.onerror=function(e){s(r,t)},setTimeout((function(){r.send()}),0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(e,")")),s(null,t)}else{var i=new XMLHttpRequest;i.open("GET",e),n.mimeType&&i.overrideMimeType&&i.overrideMimeType(n.mimeType),n.onBeforeSend(i,e,t),i.onreadystatechange=function(){if(4===i.readyState){var e=i.responseText;i.status<400&&a(e)||0===i.status&&a(e)?o(e,t):s(i,t)}},i.send()}}))}
/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function Iw(e){var t=/\/\*[\s\S]+?\*\//g,n=/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g,r={rootElement:e.rootElement||document,include:e.include||'style,link[rel="stylesheet"]',exclude:e.exclude||null,filter:e.filter||null,skipDisabled:!1!==e.skipDisabled,useCSSOM:e.useCSSOM||!1,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},i=Array.apply(null,r.rootElement.querySelectorAll(r.include)).filter((function(e){return t=e,n=r.exclude,!(t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector).call(t,n);var t,n})),a=Array.apply(null,Array(i.length)).map((function(e){return null}));function s(){if(-1===a.indexOf(null)){a.reduce((function(e,t,n){return""===t&&e.push(n),e}),[]).reverse().forEach((function(e){return[i,a].forEach((function(t){return t.splice(e,1)}))}));var e=a.join("");r.onComplete(e,a,i)}}function o(e,t,n,i){var o=r.onSuccess(e,n,i);(function e(t,n,i,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=l(t,i,o);u.rules.length?Tw(u.absoluteUrls,{onBeforeSend:function(e,t,i){r.onBeforeSend(e,n,t)},onSuccess:function(e,t,i){var a=r.onSuccess(e,n,t),s=l(e=!1===a?"":a||e,t,o);return s.rules.forEach((function(t,n){e=e.replace(t,s.absoluteRules[n])})),e},onError:function(r,l,c){s.push({xhr:r,url:l}),o.push(u.rules[c]),e(t,n,i,a,s,o)},onComplete:function(r){r.forEach((function(e,n){t=t.replace(u.rules[n],e)})),e(t,n,i,a,s,o)}}):a(t,s)})(e=void 0!==o&&!1===Boolean(o)?"":o||e,n,i,(function(e,i){null===a[t]&&(i.forEach((function(e){return r.onError(e.xhr,n,e.url)})),!r.filter||r.filter.test(e)?a[t]=e:a[t]="",s())}))}function l(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={};return a.rules=(e.replace(t,"").match(n)||[]).filter((function(e){return-1===i.indexOf(e)})),a.urls=a.rules.map((function(e){return e.replace(n,"$1")})),a.absoluteUrls=a.urls.map((function(e){return Sw(e,r)})),a.absoluteRules=a.rules.map((function(e,t){var n=a.urls[t],i=Sw(a.absoluteUrls[t],r);return e.replace(n,i)})),a}i.length?i.forEach((function(e,t){var n=e.getAttribute("href"),i=e.getAttribute("rel"),l="link"===e.nodeName.toLowerCase()&&n&&i&&-1!==i.toLowerCase().indexOf("stylesheet"),u=!1!==r.skipDisabled&&e.disabled,c="style"===e.nodeName.toLowerCase();if(l&&!u)if(-1!==n.indexOf("data:text/css")){var d=decodeURIComponent(n.substring(n.indexOf(",")+1));r.useCSSOM&&(d=Array.apply(null,e.sheet.cssRules).map((function(e){return e.cssText})).join("")),o(d,t,e,location.href)}else Tw(n,{mimeType:"text/css",onBeforeSend:function(t,n,i){r.onBeforeSend(t,e,n)},onSuccess:function(r,i,a){var s=Sw(n);o(r,t,e,s)},onError:function(n,i,o){a[t]="",r.onError(n,e,i),s()}});else if(c&&!u){var h=e.textContent;r.useCSSOM&&(h=Array.apply(null,e.sheet.cssRules).map((function(e){return e.cssText})).join("")),o(h,t,e,location.href)}else a[t]="",s()})):r.onComplete("",[])}function Sw(e,t){var n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),r.href=t||document.baseURI||(document.querySelector("base")||{}).href||location.href,i.href=e,i.href}var ww=Aw;function Aw(e,t,n){e instanceof RegExp&&(e=Mw(e,n)),t instanceof RegExp&&(t=Mw(t,n));var r=Ow(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function Mw(e,t){var n=t.match(e);return n?n[0]:null}function Ow(e,t,n){var r,i,a,s,o,l=n.indexOf(e),u=n.indexOf(t,l+1),c=l;if(l>=0&&u>0){if(e===t)return[l,u];for(r=[],a=n.length;c>=0&&!o;)c==l?(r.push(c),l=n.indexOf(e,c+1)):1==r.length?o=[r.pop(),u]:((i=r.pop())<a&&(a=i,s=u),u=n.indexOf(t,c+1)),c=l<u&&l>=0?l:u;r.length&&(o=[a,s])}return o}function Rw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,removeComments:!1},r=Nw({},n,t),i=[];function a(e){throw new Error("CSS parse error: ".concat(e))}function s(t){var n=t.exec(e);if(n)return e=e.slice(n[0].length),n}function o(){return s(/^{\s*/)}function l(){return s(/^}/)}function u(){s(/^\s*/)}function c(){if(u(),"/"===e[0]&&"*"===e[1]){for(var t=2;e[t]&&("*"!==e[t]||"/"!==e[t+1]);)t++;if(!e[t])return a("end of comment is missing");var n=e.slice(2,t);return e=e.slice(t+2),{type:"comment",comment:n}}}function d(){for(var e,t=[];e=c();)t.push(e);return r.removeComments?[]:t}function h(){for(u();"}"===e[0];)a("extra closing bracket");var t=s(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(t){var n,r=t[0].trim();/\/\*/.test(r)&&(r=r.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var i=/["']\w*,\w*["']/.test(r);return i&&(r=r.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,(function(e){return e.replace(/,/g,"")}))),n=/,/.test(r)?r.split(/\s*(?![^(]*\)),\s*/):[r],i&&(n=n.map((function(e){return e.replace(/\u200C/g,",")}))),n}}function f(){if("@"===e[0])return S();s(/^([;\s]*)+/);var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=s(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(n){if(n=n[0].trim(),!s(/^:\s*/))return a("property missing ':'");var r=s(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),i={type:"declaration",property:n.replace(t,""),value:r?r[0].replace(t,"").trim():""};return s(/^[;\s]*/),i}}function p(){if(!o())return a("missing '{'");for(var e,t=d();e=f();)t.push(e),t=t.concat(d());return l()?t:a("missing '}'")}function m(){u();for(var e,t=[];e=s(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),s(/^,\s*/);if(t.length)return{type:"keyframe",values:t,declarations:p()}}function g(){var e=s(/^@([-\w]+)?keyframes\s*/);if(e){var t=e[1];if(!(e=s(/^([-\w]+)\s*/)))return a("@keyframes missing name");var n,r=e[1];if(!o())return a("@keyframes missing '{'");for(var i=d();n=m();)i.push(n),i=i.concat(d());return l()?{type:"keyframes",name:r,vendor:t,keyframes:i}:a("@keyframes missing '}'")}}function _(){if(s(/^@page */))return{type:"page",selectors:h()||[],declarations:p()}}function v(){var e=s(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(e)return{type:"page-margin-box",name:"".concat(e[1],"-").concat(e[2])+(e[3]?"-".concat(e[3]):""),declarations:p()}}function E(){if(s(/^@font-face\s*/))return{type:"font-face",declarations:p()}}function y(){var e=s(/^@supports *([^{]+)/);if(e)return{type:"supports",supports:e[1].trim(),rules:A()}}function b(){if(s(/^@host\s*/))return{type:"host",rules:A()}}function C(){var e=s(/^@media([^{]+)*/);if(e)return{type:"media",media:(e[1]||"").trim(),rules:A()}}function N(){var e=s(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(e)return{type:"custom-media",name:e[1].trim(),media:e[2].trim()}}function T(){var e=s(/^@([-\w]+)?document *([^{]+)/);if(e)return{type:"document",document:e[2].trim(),vendor:e[1]?e[1].trim():null,rules:A()}}function I(){var e=s(/^@(import|charset|namespace)\s*([^;]+);/);if(e)return{type:e[1],name:e[2].trim()}}function S(){if(u(),"@"===e[0]){var t=I()||E()||C()||g()||y()||T()||N()||b()||_()||v();if(t&&!r.preserveStatic){var n=!1;if(t.declarations)n=t.declarations.some((function(e){return/var\(/.test(e.value)}));else n=(t.keyframes||t.rules||[]).some((function(e){return(e.declarations||[]).some((function(e){return/var\(/.test(e.value)}))}));return n?t:{}}return t}}function w(){if(!r.preserveStatic){var t=ww("{","}",e);if(t){var n=/:(?:root|host)(?![.:#(])/.test(t.pre)&&/--\S*\s*:/.test(t.body),i=/var\(/.test(t.body);if(!n&&!i)return e=e.slice(t.end+1),{}}}var s=h()||[],o=r.preserveStatic?p():p().filter((function(e){var t=s.some((function(e){return/:(?:root|host)(?![.:#(])/.test(e)}))&&/^--\S/.test(e.property),n=/var\(/.test(e.value);return t||n}));return s.length||a("selector missing"),{type:"rule",selectors:s,declarations:o}}function A(t){if(!t&&!o())return a("missing '{'");for(var n,r=d();e.length&&(t||"}"!==e[0])&&(n=S()||w());)n.type&&r.push(n),r=r.concat(d());return t||l()?r:a("missing '}'")}return{type:"stylesheet",stylesheet:{rules:A(!0),errors:i}}}function kw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={parseHost:!1,store:{},onWarning:function(){}},r=Nw({},n,t),i=new RegExp(":".concat(r.parseHost?"host":"root","$"));return"string"==typeof e&&(e=Rw(e,r)),e.stylesheet.rules.forEach((function(e){"rule"===e.type&&e.selectors.some((function(e){return i.test(e)}))&&e.declarations.forEach((function(e,t){var n=e.property,i=e.value;n&&0===n.indexOf("--")&&(r.store[n]=i)}))})),r.store}function xw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r={charset:function(e){return"@charset "+e.name+";"},comment:function(e){return 0===e.comment.indexOf("__CSSVARSPONYFILL")?"/*"+e.comment+"*/":""},"custom-media":function(e){return"@custom-media "+e.name+" "+e.media+";"},declaration:function(e){return e.property+":"+e.value+";"},document:function(e){return"@"+(e.vendor||"")+"document "+e.document+"{"+i(e.rules)+"}"},"font-face":function(e){return"@font-face{"+i(e.declarations)+"}"},host:function(e){return"@host{"+i(e.rules)+"}"},import:function(e){return"@import "+e.name+";"},keyframe:function(e){return e.values.join(",")+"{"+i(e.declarations)+"}"},keyframes:function(e){return"@"+(e.vendor||"")+"keyframes "+e.name+"{"+i(e.keyframes)+"}"},media:function(e){return"@media "+e.media+"{"+i(e.rules)+"}"},namespace:function(e){return"@namespace "+e.name+";"},page:function(e){return"@page "+(e.selectors.length?e.selectors.join(", "):"")+"{"+i(e.declarations)+"}"},"page-margin-box":function(e){return"@"+e.name+"{"+i(e.declarations)+"}"},rule:function(e){var t=e.declarations;if(t.length)return e.selectors.join(",")+"{"+i(t)+"}"},supports:function(e){return"@supports "+e.supports+"{"+i(e.rules)+"}"}};function i(e){for(var i="",a=0;a<e.length;a++){var s=e[a];n&&n(s);var o=r[s.type](s);o&&(i+=o,o.length&&s.selectors&&(i+=t))}return i}return i(e.stylesheet.rules)}function Dw(e,t){e.rules.forEach((function(n){n.rules?Dw(n,t):n.keyframes?n.keyframes.forEach((function(e){"keyframe"===e.type&&t(e.declarations,n)})):n.declarations&&t(n.declarations,e)}))}Aw.range=Ow;function Uw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},r=Nw({},n,t);return"string"==typeof e&&(e=Rw(e,r)),Dw(e.stylesheet,(function(e,t){for(var n=0;n<e.length;n++){var i=e[n],a=i.type,s=i.property,o=i.value;if("declaration"===a)if(r.preserveVars||!s||0!==s.indexOf("--")){if(-1!==o.indexOf("var(")){var l=Pw(o,r);l!==i.value&&(l=Lw(l),r.preserveVars?(e.splice(n,0,{type:a,property:s,value:l}),n++):i.value=l)}}else e.splice(n,1),n--}})),xw(e)}function Lw(e){return(e.match(/calc\(([^)]+)\)/g)||[]).forEach((function(t){var n="calc".concat(t.split("calc").join(""));e=e.replace(t,n)})),e}function Pw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(-1===e.indexOf("var("))return e;var r=ww("(",")",e);function i(e){var r=e.split(",")[0].replace(/[\s\n\t]/g,""),i=(e.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],a=Object.prototype.hasOwnProperty.call(t.variables,r)?String(t.variables[r]):void 0,s=a||(i?String(i):void 0),o=n||e;return a||t.onWarning('variable "'.concat(r,'" is undefined')),s&&"undefined"!==s&&s.length>0?Pw(s,t,o):"var(".concat(o,")")}if(r){if("var"===r.pre.slice(-3)){var a=0===r.body.trim().length;return a?(t.onWarning("var() must contain a non-whitespace string"),e):r.pre.slice(0,-3)+i(r.body)+Pw(r.post,t)}return r.pre+"(".concat(Pw(r.body,t),")")+Pw(r.post,t)}return-1!==e.indexOf("var(")&&t.onWarning('missing closing ")" in the value "'.concat(e,'"')),e}var Fw="undefined"!=typeof window,Bw=Fw&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),jw={group:0,job:0},Hw={rootElement:Fw?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},Gw={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},zw={dom:{},job:{},user:{}},Vw=!1,qw=null,Kw=0,Ww=null,Yw=!1;
/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */
function Qw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="cssVars(): ",n=Nw({},Hw,e);function r(e,r,i,a){!n.silent&&window.console&&console.error("".concat(t).concat(e,"\n"),r),n.onError(e,r,i,a)}function i(e){!n.silent&&window.console&&console.warn("".concat(t).concat(e)),n.onWarning(e)}function a(e){n.onFinally(Boolean(e),Bw,nA()-n.__benchmark)}if(Fw){if(n.watch)return n.watch=Hw.watch,Xw(n),void Qw(n);if(!1===n.watch&&qw&&(qw.disconnect(),qw=null),!n.__benchmark){if(Vw===n.rootElement)return void Zw(e);var s=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(n.__benchmark=nA(),n.exclude=[qw?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",n.exclude].filter((function(e){return e})).join(","),n.variables=eA(n.variables),s.forEach((function(e){var t="style"===e.nodeName.toLowerCase()&&e.__cssVars.text,n=t&&e.textContent!==e.__cssVars.text;t&&n&&(e.sheet&&(e.sheet.disabled=!1),e.setAttribute("data-cssvars",""))})),!qw){var o=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars="out"]'));o.forEach((function(e){var t=e.getAttribute("data-cssvars-group");(t?n.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(t,'"]')):null)||e.parentNode.removeChild(e)})),Kw&&s.length<Kw&&(Kw=s.length,zw.dom={})}}if("loading"!==document.readyState)if(Bw&&n.onlyLegacy){var l=!1;if(n.updateDOM){var u=n.rootElement.host||(n.rootElement===document?document.documentElement:n.rootElement);Object.keys(n.variables).forEach((function(e){var t=n.variables[e];l=l||t!==getComputedStyle(u).getPropertyValue(e),u.style.setProperty(e,t)}))}a(l)}else!Yw&&(n.shadowDOM||n.rootElement.shadowRoot||n.rootElement.host)?Iw({rootElement:Hw.rootElement,include:Hw.include,exclude:n.exclude,skipDisabled:!1,onSuccess:function(e,t,n){return!((t.sheet||{}).disabled&&!t.__cssVars)&&((e=((e=e.replace(Gw.cssComments,"").replace(Gw.cssMediaQueries,"")).match(Gw.cssVarDeclRules)||[]).join(""))||!1)},onComplete:function(e,t,r){kw(e,{store:zw.dom,onWarning:i}),Yw=!0,Qw(n)}}):(Vw=n.rootElement,Iw({rootElement:n.rootElement,include:n.include,exclude:n.exclude,skipDisabled:!1,onBeforeSend:n.onBeforeSend,onError:function(e,t,n){var i=e.responseURL||tA(n,location.href),a=e.statusText?"(".concat(e.statusText,")"):"Unspecified Error"+(0===e.status?" (possibly CORS related)":"");r("CSS XHR Error: ".concat(i," ").concat(e.status," ").concat(a),t,e,i)},onSuccess:function(e,t,r){if((t.sheet||{}).disabled&&!t.__cssVars)return!1;var i="link"===t.nodeName.toLowerCase(),a="style"===t.nodeName.toLowerCase()&&e!==t.textContent,s=n.onSuccess(e,t,r);return e=void 0!==s&&!1===Boolean(s)?"":s||e,n.updateURLs&&(i||a)&&(e=$w(e,r)),e},onComplete:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=Nw({},zw.dom,zw.user);if(zw.job={},s.forEach((function(e,a){var s=t[a];if(e.__cssVars=e.__cssVars||{},e.__cssVars.text=s,Gw.cssVars.test(s))try{var o=Rw(s,{preserveStatic:n.preserveStatic,removeComments:!0});kw(o,{parseHost:Boolean(n.rootElement.host),store:zw.dom,onWarning:i}),e.__cssVars.tree=o}catch(t){r(t.message,e)}})),Nw(zw.job,zw.dom),n.updateDOM?(Nw(zw.user,n.variables),Nw(zw.job,zw.user)):(Nw(zw.job,zw.user,n.variables),Nw(o,n.variables)),jw.job>0&&Boolean(Object.keys(zw.job).length>Object.keys(o).length||Boolean(Object.keys(o).length&&Object.keys(zw.job).some((function(e){return zw.job[e]!==o[e]})))))rA(n.rootElement),Qw(n);else{var l=[],u=[],c=!1;if(n.updateDOM&&jw.job++,s.forEach((function(e,a){var s=!e.__cssVars.tree;if(e.__cssVars.tree)try{Uw(e.__cssVars.tree,Nw({},n,{variables:zw.job,onWarning:i}));var o=xw(e.__cssVars.tree);if(n.updateDOM){var d=t[a],h=Gw.cssVarFunc.test(d);if(e.getAttribute("data-cssvars")||e.setAttribute("data-cssvars","src"),o.length&&h){var f=e.getAttribute("data-cssvars-group")||++jw.group,p=o.replace(/\s/g,""),m=n.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(f,'"]'))||document.createElement("style");c=c||Gw.cssKeyframes.test(o),n.preserveStatic&&e.sheet&&(e.sheet.disabled=!0),m.hasAttribute("data-cssvars")||m.setAttribute("data-cssvars","out"),p===e.textContent.replace(/\s/g,"")?(s=!0,m&&m.parentNode&&(e.removeAttribute("data-cssvars-group"),m.parentNode.removeChild(m))):p!==m.textContent.replace(/\s/g,"")&&([e,m].forEach((function(e){e.setAttribute("data-cssvars-job",jw.job),e.setAttribute("data-cssvars-group",f)})),m.textContent=o,l.push(o),u.push(m),m.parentNode||e.parentNode.insertBefore(m,e.nextSibling))}}else e.textContent.replace(/\s/g,"")!==o&&l.push(o)}catch(t){r(t.message,e)}s&&e.setAttribute("data-cssvars","skip"),e.hasAttribute("data-cssvars-job")||e.setAttribute("data-cssvars-job",jw.job)})),Kw=n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,n.shadowDOM)for(var d,h=[].concat(n.rootElement).concat([].slice.call(n.rootElement.querySelectorAll("*"))),f=0;d=h[f];++f)if(d.shadowRoot&&d.shadowRoot.querySelector("style")){var p=Nw({},n,{rootElement:d.shadowRoot});Qw(p)}n.updateDOM&&c&&Jw(n.rootElement),Vw=!1,n.onComplete(l.join(""),u,JSON.parse(JSON.stringify(zw.job)),nA()-n.__benchmark),a(u.length)}}}));else document.addEventListener("DOMContentLoaded",(function t(n){Qw(e),document.removeEventListener("DOMContentLoaded",t)}))}}function Xw(e){function t(e){var t=n(e)&&e.hasAttribute("disabled"),r=(e.sheet||{}).disabled;return t||r}function n(e){return"link"===e.nodeName.toLowerCase()&&-1!==(e.getAttribute("rel")||"").indexOf("stylesheet")}function r(e){return"style"===e.nodeName.toLowerCase()}window.MutationObserver&&(qw&&(qw.disconnect(),qw=null),(qw=new MutationObserver((function(i){i.some((function(i){return function(r){var i=!1;if("attributes"===r.type&&n(r.target)&&!t(r.target)){var a="disabled"===r.attributeName,s="href"===r.attributeName,o="skip"===r.target.getAttribute("data-cssvars"),l="src"===r.target.getAttribute("data-cssvars");a?i=!o&&!l:s&&(o?r.target.setAttribute("data-cssvars",""):l&&rA(e.rootElement,!0),i=!0)}return i}(i)||function(e){var t=!1;if("childList"===e.type){var n=r(e.target),i="out"===e.target.getAttribute("data-cssvars");t=n&&!i}return t}(i)||function(e){var i=!1;return"childList"===e.type&&(i=[].slice.call(e.addedNodes).some((function(e){var i=1===e.nodeType&&e.hasAttribute("data-cssvars"),a=r(e)&&Gw.cssVars.test(e.textContent);return!i&&(n(e)||a)&&!t(e)}))),i}(i)||function(t){var n=!1;return"childList"===t.type&&(n=[].slice.call(t.removedNodes).some((function(t){var n=1===t.nodeType,r=n&&"out"===t.getAttribute("data-cssvars"),i=n&&"src"===t.getAttribute("data-cssvars"),a=i;if(i||r){var s=t.getAttribute("data-cssvars-group"),o=e.rootElement.querySelector('[data-cssvars-group="'.concat(s,'"]'));i&&rA(e.rootElement,!0),o&&o.parentNode.removeChild(o)}return a}))),n}(i)}))&&Qw(e)}))).observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function Zw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;clearTimeout(Ww),Ww=setTimeout((function(){e.__benchmark=null,Qw(e)}),t)}function Jw(e){var t=["animation-name","-moz-animation-name","-webkit-animation-name"].filter((function(e){return getComputedStyle(document.body)[e]}))[0];if(t){for(var n=[].slice.call(e.querySelectorAll("*")),r=[],i=0,a=n.length;i<a;i++){var s=n[i];"none"!==getComputedStyle(s)[t]&&(s.style[t]+="__CSSVARSPONYFILL-KEYFRAMES__",r.push(s))}document.body.offsetHeight;for(var o=0,l=r.length;o<l;o++){var u=r[o].style;u[t]=u[t].replace("__CSSVARSPONYFILL-KEYFRAMES__","")}}}function $w(e,t){return(e.replace(Gw.cssComments,"").match(Gw.cssUrls)||[]).forEach((function(n){var r=n.replace(Gw.cssUrls,"$1"),i=tA(r,t);e=e.replace(n,n.replace(r,i))})),e}function eA(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=/^-{2}/;return Object.keys(e).reduce((function(n,r){return n[t.test(r)?r:"--".concat(r.replace(/^-+/,""))]=e[r],n}),{})}function tA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.href,n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),r.href=t,i.href=e,i.href}function nA(){return Fw&&(window.performance||{}).now?window.performance.now():(new Date).getTime()}function rA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[].slice.call(e.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));n.forEach((function(e){return e.setAttribute("data-cssvars","")})),t&&(zw.dom={})}function iA(e,t){void 0===t&&(t=[]),Object(i.useLayoutEffect)((function(){return function(){e()}}),t)}function aA(e,t){var n,r,a=Object(i.useState)("undefined"==typeof window||(null===(r=null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.onLine)||void 0===r||r)),s=a[0],o=a[1];return Object(i.useEffect)((function(){var n=ZS();try{t.warning("sdk changed",n);var r=new kc({onDisconnected:function(){o(!1),t.warning("onDisconnected",{isOnline:s})},onReconnectStarted:function(){o(!1),t.warning("onReconnectStarted",{isOnline:s})},onReconnectSucceeded:function(){o(!0),t.warning("onReconnectSucceeded",{isOnline:s})},onReconnectFailed:function(){e.reconnect(),t.warning("onReconnectFailed")}});(null==e?void 0:e.addConnectionHandler)&&(e.addConnectionHandler(n,r),t.info("Added ConnectionHandler",n))}catch(e){}return function(){try{e.removeConnectionHandler(n),t.info("Removed ConnectionHandler",n)}catch(e){}}}),[e]),Object(i.useEffect)((function(){var n=function(){try{t.warning("Try reconnecting SDK"),"OPEN"!==e.connectionState&&e.reconnect()}catch(e){}};return window.addEventListener("online",n),function(){window.removeEventListener("online",n)}}),[e]),Object(i.useEffect)((function(){var n=document.querySelector("body");if(s||(null==e?void 0:e.isCacheEnabled))try{null==n||n.classList.remove("sendbird__offline"),t.info("Removed class sendbird__offline from body")}catch(e){}else try{null==n||n.classList.add("sendbird__offline"),t.info("Added class sendbird__offline to body")}catch(e){}}),[s,null==e?void 0:e.isCacheEnabled]),s}Qw.reset=function(){for(var e in jw.job=0,jw.group=0,Vw=!1,qw&&(qw.disconnect(),qw=null),Kw=0,Ww=null,Yw=!1,zw)zw[e]={}};function sA(e){var t=e.logger,n=e.timeout,r=e.cb,i=[],a=null;return{push:function(e){if(i.find((function(t){return t.url===e.url}))?t.info("Channel: Mark as read already in queue",{channel:e}):i.push(e),!a){var s=i.shift();s&&r(s),a=setInterval((function(){if(0===i.length&&a)return clearInterval(a),void(a=null);var e=i.shift();e&&r(e)}),n||2e3)}},clear:function(){i=[],a&&(clearInterval(a),a=null)},getQueue:function(){return i}}}function oA(e,t){var n=this,r=e.isConnected,a=t.logger,s=Object(i.useMemo)((function(){return sA({logger:a,cb:function(e){return _(n,void 0,void 0,(function(){var t;return v(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.markAsDelivered()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),null==a||a.warning("Channel: Mark as delivered failed",{channel:e,error:t}),[3,3];case 3:return[2]}}))}))}})}),[]);return Object(i.useEffect)((function(){r||s.clear()}),[r]),iA((function(){s.clear()})),s}var lA,uA;function cA(e){var t=e.className,n=void 0===t?"":t,r=e.maxItemCount,i=e.itemWidth,s=e.itemHeight,o=e.children;if(Array.isArray(o)&&o.length>r){for(var l=[],u=0;u<o.length;u+=r)l.push(a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-sort-by-row"],!1).join(" "),key:ZS(),style:{width:i*r,height:s}},o.slice(u,u+r)));return a.a.createElement(a.a.Fragment,null,l)}return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-sort-by-row"],!1).join(" "),style:{width:i*(Array.isArray(o)?o.length:1),height:s}},o)}(uA=lA||(lA={})).NONE="NONE",uA.PENDING="PENDING",uA.SENT="SENT",uA.FAILED="FAILED",uA.DELIVERED="DELIVERED",uA.READ="READ";var dA,hA=function(e,t){var n,r,i,a,s;if(!t||!("sendingStatus"in t))return lA.NONE;if("pending"===t.sendingStatus)return lA.PENDING;if("failed"===t.sendingStatus)return lA.FAILED;if(null===(n=null==e?void 0:e.isGroupChannel)||void 0===n?void 0:n.call(e)){if(0===(null===(i=(r=e).getUnreadMemberCount)||void 0===i?void 0:i.call(r,t)))return lA.READ;if(0===(null===(s=(a=e).getUndeliveredMemberCount)||void 0===s?void 0:s.call(a,t)))return lA.DELIVERED}return"succeeded"===t.sendingStatus?lA.SENT:lA.NONE};function fA(e){return(fA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pA(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function mA(e){pA(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===fA(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}var gA={IMAGE:["image/jpeg","image/jpg","image/png","image/gif","image/svg+xml","image/webp","image/bmp"],VIDEO:["video/mpeg","video/ogg","video/webm","video/mp4"],AUDIO:["audio/aac","audio/midi","audio/x-midi","audio/mpeg","audio/ogg","audio/opus","audio/wav","audio/webm","audio/3gpp","audio/3gpp2","audio/mp3"],DOCUMENT:["text/plain","text/css","text/csv","text/html","text/calendar","text/javascript","text/xml","text/x-log","video/quicktime"],APPLICATION:["application/x-abiword","application/x-freearc","application/vnd.amazon.ebook","application/octet-stream","application/x-bzip","application/x-bzip2","application/x-cdf","application/x-csh","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-fontobject","application/epub+zip","application/gzip","application/java-archive","application/json","application/ld+json","application/vnd.apple.installer+xml","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.text","application/ogg","application/pdf","application/x-httpd-php","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.rar","application/rtf","application/x-sh","application/x-tar","application/vnd.visio","application/xhtml+xml","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/xml","application/vnd.mozilla.xul+xml","application/zip","application/x-7z-compressed"],ARCHIVE:["application/zip","application/x-rar-compressed","application/x-7z-compressed","application/x-tar","application/gzip","application/x-bzip","application/x-bzip2","application/x-xz","application/x-iso9660-image"]},_A={IMAGE:[".apng",".avif",".gif",".jpg",".jpeg",".jfif",".pjpeg",".pjp",".png",".svg",".webp",".bmp",".ico",".cur",".tif",".tiff",".heic",".heif"],VIDEO:[".mp4",".webm",".ogv",".3gp",".3g2",".avi",".mov",".wmv",".mpg",".mpeg",".m4v",".mkv"],AUDIO:[".aac",".midi",".mp3",".oga",".opus",".wav",".weba",".3gp",".3g2"],DOCUMENT:[".txt",".log",".csv",".rtf",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],ARCHIVE:[".zip",".rar",".7z",".tar",".gz",".bz2",".xz",".iso"]},vA=function(e){if(Array.isArray(e)&&e.length>0){var t=e.reduce((function(e,t){switch(t.toLowerCase()){case"image":e.push.apply(e,E(E([],gA.IMAGE,!1),_A.IMAGE,!1));break;case"video":e.push.apply(e,E(E([],gA.VIDEO,!1),_A.VIDEO,!1));break;case"audio":e.push.apply(e,E(E([],gA.AUDIO,!1),_A.AUDIO,!1));break;case"archive":e.push.apply(e,E(E([],gA.ARCHIVE,!1),_A.ARCHIVE,!1));break;default:e.push(t)}return e}),[]);return Array.from(new Set(t)).join(",")}return E(E([],Object.values(gA).flat(),!0),Object.values(_A).flat(),!0).join(",")},EA={ADMIN:"ADMIN",TEXT:"TEXT",FILE:"FILE",MULTIPLE_FILES:"MULTIPLE_FILES",THUMBNAIL:"THUMBNAIL",OG:"OG",UNKNOWN:"UNKNOWN"},yA={IMAGE:"IMAGE",AUDIO:"AUDIO",VIDEO:"VIDEO",GIF:"GIF",VOICE:"VOICE",OTHERS:"OTHERS"},bA=function(e){return gA.IMAGE.indexOf(e)>=0},CA=function(e){return gA.VIDEO.indexOf(e)>=0||function(e){return q_(navigator.userAgent)&&function(e){return"video/quicktime"===e}(e)}(e)},NA=function(e){return"image/gif"===e},TA=function(e){return bA(e)||CA(e)},IA=function(e){return gA.AUDIO.indexOf(e)>=0},SA=function(e){return NA(e)?yA.GIF:bA(e)?yA.IMAGE:CA(e)?yA.VIDEO:IA(e)?yA.AUDIO:yA.OTHERS},wA=function(e){return"succeeded"===e.sendingStatus},AA=function(e,t){return hA(e,t)===lA.READ},MA=function(e){return"failed"===(null==e?void 0:e.sendingStatus)},OA=function(e){return"pending"===(null==e?void 0:e.sendingStatus)},RA=function(e){return e&&(e.isAdminMessage&&"function"==typeof e.isAdminMessage?e.isAdminMessage():"admin"===(null==e?void 0:e.messageType))},kA=function(e){return e&&(e.isUserMessage&&"function"==typeof e.isUserMessage?e.isUserMessage():"user"===(null==e?void 0:e.messageType))},xA=function(e){return!!e&&(e.isFileMessage&&"function"==typeof e.isFileMessage?e.isFileMessage():"file"===(null==e?void 0:e.messageType))},DA=function(e){return e&&(e.isMultipleFilesMessage&&"function"==typeof e.isMultipleFilesMessage?e.isMultipleFilesMessage():"file"===e.messageType&&Object.prototype.hasOwnProperty.call(e,"fileInfoList"))},UA=function(e){return!!e.parentMessageId&&!!e.parentMessage},LA=function(e){return!!e.messageForm},PA=function(e){var t;return!(!e||!(null===(t=e.extendedMessagePayload)||void 0===t?void 0:t.message_template))},FA=function(e){var t=e.type;return!(t&&!BA[t])},BA={default:"default"},jA=((dA={})[BA.default]="ui_container_type__default",dA),HA=function(e){return!(!e||!kA(e))&&(!!e.ogMetaData&&!!(e.ogMetaData.url||e.ogMetaData.title||e.ogMetaData.description||e.ogMetaData.defaultImage))},GA=function(e){return kA(e)},zA=function(e){return!(!e||!xA(e))&&TA(e.type)},VA=function(e){return!(!e||!xA(e))&&(zA(e)&&bA(e.type))},qA=function(e){return!(!e||!xA(e))&&(zA(e)&&CA(e.type))},KA=function(e){return!(!e||!xA(e))&&(zA(e)&&NA(e.type))},WA=function(e){return/^voice\//.test(e)},YA=function(e){var t,n,r,i;if(!e||!xA(e)||!e.type)return!1;var a=e.type.split(";"),s=a[0],o=a[1];if(!/^audio\//.test(s))return!1;if(o){var l=o.split("="),u=l[0],c=l[1];return"sbu_type"===u&&"voice"===c}return WA(null!==(i=null===(r=null===(n=null===(t=null==e?void 0:e.metaArrays)||void 0===t?void 0:t.find((function(e){return"KEY_INTERNAL_MESSAGE_TYPE"===e.key})))||void 0===n?void 0:n.value)||void 0===r?void 0:r[0])&&void 0!==i?i:"")},QA=function(e){return kA(e)&&(null==e?void 0:e.updatedAt)>0},XA=function(e){return RA(e)?EA.ADMIN:kA(e)?HA(e)?EA.OG:EA.TEXT:DA(e)?EA.MULTIPLE_FILES:xA(e)?zA(e)?EA.THUMBNAIL:YA(e)?yA.VOICE:EA.FILE:EA.UNKNOWN},ZA=function(e,t){return Array.isArray(t)?E(E([],e,!0),t,!0):(e.push(t),e)},JA=function(e){return Array.isArray(e)?e.reduce(ZA,[]).join(" "):e},$A=function(e,t){return t.userIds.some((function(t){return t===e}))},eM=function(e,t,n,r){var i="";return $A(t,e)&&(i=1===e.userIds.length?r.TOOLTIP__YOU:r.TOOLTIP__AND_YOU),"".concat(e.userIds.filter((function(e){return e!==t})).map((function(e){return n.get(e)||r.TOOLTIP__UNKNOWN_USER})).join(", ")).concat(i)};function tM(e){var t;return(null==e?void 0:e.extendedMessagePayload)&&Array.isArray(null===(t=null==e?void 0:e.extendedMessagePayload)||void 0===t?void 0:t.suggested_replies)?e.extendedMessagePayload.suggested_replies:[]}var nM,rM,iM=function(e,t){if(t||(t=40),null==e)return"";if(e.length<=t)return e;var n=t-"...".length,r=Math.ceil(n/2),i=Math.floor(n/2);return e.substr(0,r)+"..."+e.substr(e.length-i)},aM=function(e){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return!1}finally{document.body.removeChild(t)}}return!1},sM=function(e){var t;return null===(t=null==e?void 0:e.emojiCategories)||void 0===t?void 0:t.map((function(e){return e.emojis})).reduce((function(e,t){return e.concat(t)}),[])},oM=function(e,t){var n;return t?(null===(n=null==e?void 0:e.emojiCategories)||void 0===n?void 0:n.filter((function(e){return t.includes(e.id)})).flatMap((function(e){return e.emojis})))||[]:sM(e)};(rM=nM||(nM={})).normal="normal",rM.mention="mention",rM.url="url";var lM=function(e){return Boolean(e)&&"sender"in e},uM=function(e){return!(null==e?void 0:e.name)||"Group Channel"===e.name||"AI Chatbot Widget Channel"===e.name},cM=function(e){function t(t){var n=e.call(this,t)||this;return n.menuRef=a.a.createRef(),n.setupEvents=function(){var e=n.props.closeDropdown,t=n.menuRef,r=function(n){var r,i;(null==t?void 0:t.current)&&!(null===(i=null===(r=null==t?void 0:t.current)||void 0===r?void 0:r.contains)||void 0===i?void 0:i.call(r,n.target))&&(null==e||e())};n.setState({handleClickOutside:r}),document.addEventListener("mousedown",r)},n.cleanUpEvents=function(){var e=n.state.handleClickOutside;document.removeEventListener("mousedown",e)},n.getMenuPosition=function(){var e,t,r,i=n.props,a=i.parentRef,s=i.openLeft,o=document.getElementById("sendbird-app__layout"),l=(null===(e=null==o?void 0:o.getBoundingClientRect)||void 0===e?void 0:e.call(o))||{top:0,left:0,width:window.innerWidth,height:window.innerHeight},u=null===(r=null===(t=null==a?void 0:a.current)||void 0===t?void 0:t.getBoundingClientRect)||void 0===r?void 0:r.call(t),c=((null==u?void 0:u.x)||(null==u?void 0:u.left)||0)-l.left,d=((null==u?void 0:u.y)||(null==u?void 0:u.top)||0)-l.top,h={top:d,left:c};if(!n.menuRef.current)return h;var f=n.menuRef.current.getBoundingClientRect();if(d+f.height+60>l.height&&(h.top-=f.height),c+f.width>l.width&&!s&&(h.left-=f.width),h.top<0&&(h.top=f.height<l.height?(l.height-f.height)/2:0),h.top+=32,s){var p=Number.isNaN(f.width-30)?108:f.width-30;h.left-=p}return h.left<0&&(h.left=f.width<l.width?(l.width-f.width)/2:0),n.setState({menuStyle:h}),h},n.state={menuStyle:{top:0,left:0},handleClickOutside:function(){}},n}return p(t,e),t.prototype.componentDidMount=function(){this.setupEvents(),this.getMenuPosition()},t.prototype.componentWillUnmount=function(){this.cleanUpEvents()},t.prototype.render=function(){var e=document.getElementById(CM);if(!e)return a.a.createElement(a.a.Fragment,null);var t=this.state.menuStyle,n=this.props,r=n.children,i=n.style,o=n.className,l=void 0===o?"":o,u=n.testID,c=n.id;return Object(s.createPortal)(a.a.createElement("div",{className:nN(_M,l),"data-testid":u,id:c},a.a.createElement("div",{className:"sendbird-dropdown__menu-backdrop"}),a.a.createElement("ul",{className:"".concat(l," sendbird-dropdown__menu"),ref:this.menuRef,style:m({display:"inline-block",position:"fixed",left:"".concat(Math.round(t.left),"px"),top:"".concat(Math.round(t.top),"px")},i),"data-testid":"sendbird-dropdown-menu"},r)),e)},t}(a.a.Component),dM={x:0,y:0,left:0,top:0,height:0},hM=Object(i.createContext)(void 0),fM=function(e){var t=e.children,n=e.value;return a.a.createElement(hM.Provider,{value:n},t)},pM=function(){var e=Object(i.useContext)(hM);if(!e)throw new Error("useMessageMenuContext must be used within a MessageMenuProvider.");return e},mM=function(e){var t=e.className,n=e.disabled,r=e.tabIndex,i=void 0===r?0:r,s=e.testID,o=e.onClick,l=e.children,u=function(e){!n&&o&&o(e)};return a.a.createElement("li",{className:nN("sendbird-menu-item",t),role:"menuitem","aria-disabled":n,"data-testid":s,tabIndex:i,onClick:u,onKeyDown:function(e){"Enter"===e.code&&u(e)}},a.a.createElement(_N,{className:"sendbird-menu-item__text",type:vN.SUBTITLE_2,color:n?EN.ONBACKGROUND_4:EN.ONBACKGROUND_1},l))},gM=function(e){var t=e.className,n=e.disabled,r=void 0!==n&&n,i=e.tabIndex,s=void 0===i?0:i,o=e.testID,l=e.onClick,u=e.children;return a.a.createElement("div",{className:nN("sendbird-message__bottomsheet--action",t),role:"menuitem",tabIndex:s,"aria-disabled":r,onClick:l,"data-testid":o},u)},_M="sendbird-observing-message-menu",vM=function(e){return"m_".concat(e)},EM=cM,yM=function(e){var t=e.id,n=e.children,r=e.parentRef,o=e.parentContainRef,l=e.spaceFromTrigger,u=void 0===l?{x:0,y:0}:l,c=e.closeDropdown,d=Object(i.useState)({left:0,top:0}),h=d[0],f=d[1],p=Object(i.useRef)(null);Object(i.useEffect)((function(){return o&&(null==o?void 0:o.current)&&o.current.classList.add("sendbird-reactions--pressed"),function(){o&&(null==o?void 0:o.current)&&o.current.classList.remove("sendbird-reactions--pressed")}}),[]),Object(i.useEffect)((function(){var e=function(e){var t,n;(null==p?void 0:p.current)&&!(null===(n=null===(t=null==p?void 0:p.current)||void 0===t?void 0:t.contains)||void 0===n?void 0:n.call(t,e.target))&&c()};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[]),Object(i.useEffect)((function(){var e,t,n,i,a=(null==u?void 0:u.x)||0,s=(null==u?void 0:u.y)||0,o=document.getElementById("sendbird-app__layout"),l=(null===(e=null==o?void 0:o.getBoundingClientRect)||void 0===e?void 0:e.call(o))||{top:0,left:0,width:window.innerWidth},c=null!==(n=null===(t=null==r?void 0:r.current)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==n?n:dM,d=((null==c?void 0:c.x)||(null==c?void 0:c.left)||0)-l.left,h={top:((null==c?void 0:c.y)||(null==c?void 0:c.top)||0)-l.top,left:d};if(null==p?void 0:p.current){var m=null===(i=null==p?void 0:p.current)||void 0===i?void 0:i.getBoundingClientRect();h.top<m.height?(h.top+=c.height,h.top+=s):(h.top-=m.height,h.top-=s),h.left-=m.width/2,h.left+=c.height/2-2,h.left+=a;var g=l.width-m.width;g<h.left&&(h.left=g),h.left<0&&(h.left=0),f(h)}else f(h)}),[]);var m=document.getElementById(TM);return m?Object(s.createPortal)(a.a.createElement("div",{className:_M,id:t},a.a.createElement("div",{className:"sendbird-dropdown__menu-backdrop"}),a.a.createElement("ul",{className:"sendbird-dropdown__reaction-bar","data-testid":"sendbird-dropdown__reaction-bar",ref:p,style:{display:"inline-block",position:"fixed",left:"".concat(Math.round(h.left),"px"),top:"".concat(Math.round(h.top),"px")}},a.a.createElement(cA,{className:"sendbird-dropdown__reaction-bar__row",maxItemCount:8,itemWidth:44,itemHeight:40},n))),m):null},bM=function(e){var t=e.className,n=void 0===t?"":t,r=e.children,i=e.onClick,s=e.disable,o=void 0!==s&&s,l=e.dataSbId,u=void 0===l?"":l,c=e.testID;return a.a.createElement(mM,{className:nN.apply(void 0,E(E([],Array.isArray(n)?n:[n],!1),["sendbird-dropdown__menu-item",o?"disable":""],!1)),disabled:o,testID:null!=c?c:u,onClick:i},r)},CM="sendbird-dropdown-portal",NM=function(){return a.a.createElement("div",{id:CM,className:CM})},TM="sendbird-emoji-list-portal",IM=function(){return a.a.createElement("div",{id:TM})};function SM(e){var t=e.menuTrigger,n=e.menuItems,r=e.isOpen,s=e.onClick,o=Object(i.useState)(!1),l=o[0],u=o[1];return a.a.createElement("div",{className:"sendbird-context-menu",onClick:s},null==t?void 0:t((function(){return u(!l)})),(l||r)&&n((function(){return u(!1)})))}function wM(e){var t=Object(i.useRef)(e);return Kb(e,t.current)||(t.current=e),t.current}function AM(e,t){Object(i.useEffect)(e,t.map(wM))}var MM={getItem:function(e){return _(this,void 0,void 0,(function(){var t;return v(this,(function(n){return[2,null!==(t=localStorage.getItem(e))&&void 0!==t?t:null]}))}))},setItem:function(e,t){return _(this,void 0,void 0,(function(){return v(this,(function(n){return[2,localStorage.setItem(e,t)]}))}))}},OM=function(e){var t=e.children;return a.a.createElement(LC,null,a.a.createElement(aw,null,t))},RM="debug",kM="warning",xM="error",DM="info",UM="all",LM=function(e){switch(e){case kM:return"color: Orange";case xM:return"color: Red";default:return"color: Gray"}},PM=function(e){var t=e.level,n=e.title,r=e.description,i=void 0===r?"":r,a=e.payload,s=void 0===a?[]:a;console.log.apply(console,E(["%c SendbirdUIKit | ".concat(t," | ").concat((new Date).toISOString()," | ").concat(n," ").concat(i&&"|"),LM(t),i],s,!1))},FM=function(e,t){var n=PM,r=Array.isArray(e)?e:[e],i=function(e){return function(t,r){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];return n({level:e,title:t,description:r,payload:i})}};return r.reduce((function(e,t){return t===RM||t===UM?m(m({},e),{info:i(DM),error:i(xM),warning:i(kM)}):t===DM?m(m({},e),{info:i(DM)}):t===xM?m(m({},e),{error:i(xM)}):t===kM?m(m({},e),{warning:i(kM)}):m({},e)}),{info:$C,error:$C,warning:$C})},BM={"--sendbird-dark-primary-500":"#4d2aa6","--sendbird-dark-primary-400":"#6440C4","--sendbird-dark-primary-300":"#7B53EF","--sendbird-dark-primary-200":"#9E8CF5","--sendbird-dark-primary-100":"#E2DFFF","--sendbird-dark-secondary-500":"#007A7A","--sendbird-dark-secondary-400":"#189A8D","--sendbird-dark-secondary-300":"#2EBA9F","--sendbird-dark-secondary-200":"#6FD6BE","--sendbird-dark-secondary-100":"#AEF2DC","--sendbird-dark-information-100":"#b2d9ff","--sendbird-dark-error-500":"#A30E2D","--sendbird-dark-error-400":"#C11F41","--sendbird-dark-error-300":"#E53157","--sendbird-dark-error-200":"#FF6183","--sendbird-dark-error-100":"#FFABBD","--sendbird-dark-background-700":"#000000","--sendbird-dark-background-600":"#161616","--sendbird-dark-background-500":"#2C2C2C","--sendbird-dark-background-400":"#393939","--sendbird-dark-background-300":"#A8A8A8","--sendbird-dark-background-200":"#D9D9D9","--sendbird-dark-background-100":"#F0F0F0","--sendbird-dark-background-50":"#FFFFFF","--sendbird-dark-overlay":"rgba(0, 0, 0, 0.32)","--sendbird-dark-onlight-01":"rgba(0, 0, 0, 0.88)","--sendbird-dark-onlight-02":"rgba(0, 0, 0, 0.50)","--sendbird-dark-onlight-03":"rgba(0, 0, 0, 0.38)","--sendbird-dark-onlight-04":"rgba(0, 0, 0, 0.12)","--sendbird-dark-ondark-01":"rgba(255, 255, 255, 0.88)","--sendbird-dark-ondark-02":"rgba(255, 255, 255, 0.50)","--sendbird-dark-ondark-03":"rgba(255, 255, 255, 0.38)","--sendbird-dark-ondark-04":"rgba(255, 255, 255, 0.12)","--sendbird-dark-shadow-01":"0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-02":"0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-03":"0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-04":"0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-message-input":"0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)","--sendbird-light-primary-500":"#4d2aa6","--sendbird-light-primary-400":"#6440C4","--sendbird-light-primary-300":"#7B53EF","--sendbird-light-primary-200":"#9E8CF5","--sendbird-light-primary-100":"#E2DFFF","--sendbird-light-secondary-500":"#007A7A","--sendbird-light-secondary-400":"#189A8D","--sendbird-light-secondary-300":"#2EBA9F","--sendbird-light-secondary-200":"#6FD6BE","--sendbird-light-secondary-100":"#AEF2DC","--sendbird-light-information-100":"#b2d9ff","--sendbird-light-error-500":"#A30E2D","--sendbird-light-error-400":"#C11F41","--sendbird-light-error-300":"#E53157","--sendbird-light-error-200":"#FF6183","--sendbird-light-error-100":"#FFABBD","--sendbird-light-background-700":"#000000","--sendbird-light-background-600":"#161616","--sendbird-light-background-500":"#2C2C2C","--sendbird-light-background-400":"#393939","--sendbird-light-background-300":"#A8A8A8","--sendbird-light-background-200":"#D9D9D9","--sendbird-light-background-100":"#F0F0F0","--sendbird-light-background-50":" #FFFFFF","--sendbird-light-overlay":"rgba(0, 0, 0, 0.32)","--sendbird-light-onlight-01":"rgba(0, 0, 0, 0.88)","--sendbird-light-onlight-02":"rgba(0, 0, 0, 0.50)","--sendbird-light-onlight-03":"rgba(0, 0, 0, 0.38)","--sendbird-light-onlight-04":"rgba(0, 0, 0, 0.12)","--sendbird-light-ondark-01":"rgba(255, 255, 255, 0.88)","--sendbird-light-ondark-02":"rgba(255, 255, 255, 0.50)","--sendbird-light-ondark-03":"rgba(255, 255, 255, 0.38)","--sendbird-light-ondark-04":"rgba(255, 255, 255, 0.12)","--sendbird-light-shadow-01":"0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-02":"0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-03":"0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-04":"0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-message-input":"0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},jM=function(e){Object(i.useLayoutEffect)((function(){var t,n;(function(e){if(null==e)return!0;for(var t in e)if(e.hasOwnProperty(t))return!1;return JSON.stringify(e)===JSON.stringify({})})(e)||Qw({variables:m(m({},BM),(t=e,n={},Object.entries(t).forEach((function(e){for(var t=e[0],r=e[1],i=t,a=0,s=bw;a<s.length;a++){var o=s[a],l=new RegExp("-".concat(o,"$"));if(l.test(t)){var u=Cw.get(o);if(u){i=t.replace(l,"-".concat(u));break}}}n[i]=r})),n))})}),[e])},HM=function(e){return{version:Number(e.ui_template.version),uiTemplate:JSON.stringify(e.ui_template.body.items),colorVariables:e.color_variables}},GM=function(e){var t={};return e.forEach((function(e){t[e.key]=HM(e)})),t};var zM=function(e){var t,n=e.appId,r=e.userId,a=e.accessToken,s=e.customApiHost,o=e.customWebSocketHost,l=e.configureSession,u=e.theme,c=void 0===u?"light":u,d=e.logger,h=e.config,f=void 0===h?{}:h,p=e.nickname,g=void 0===p?"":p,E=e.colorSet,y=e.profileUrl,b=void 0===y?"":y,C=e.voiceRecord,N=e.userListQuery,T=e.imageCompression,I=void 0===T?{}:T,S=e.allowProfileEdit,w=void 0!==S&&S,A=e.disableMarkAsDelivered,M=void 0!==A&&A,O=e.renderUserProfile,R=e.onUserProfileMessage,k=e.onStartDirectMessage,x=e.isUserIdUsedForNickname,D=void 0===x||x,U=e.sdkInitParams,L=e.customExtensionParams,P=e.isMultipleFilesMessageEnabled,F=void 0!==P&&P,B=e.eventHandlers,j=e.htmlTextDirection,H=void 0===j?"ltr":j,G=e.forceLeftToRightMessageLayout,z=void 0!==G&&G,V=null!=k?k:R,q=f.userMention,K=void 0===q?{}:q,W=f.isREMUnitEnabled,Y=void 0!==W&&W,Q=f.pubSub,X=oN().isMobile,Z=Object(i.useState)(null!=Q?Q:vw())[0],J=Xb(Jb,(function(e){return e}),Qb),$=J.state,ee=J.updateState,te=IC().actions,ne=$.stores,re=ne.sdkStore,ie=ne.appInfoStore,ae=Object(i.useContext)(B_),se=ae.configs,oe=ae.configsWithAppAttr,le=ae.initDashboardConfigs,ue=re.initialized,ce=null==re?void 0:re.sdk,de=null!==(t=null==ce?void 0:ce.appInfo)&&void 0!==t?t:{},he=de.uploadSizeLimit,fe=de.multipleFilesMessageFileCountLimit;jM(E);var pe=function(e){var t,n=this,r=e.sdk,a=e.logger,s=e.appInfoStore,o=e.actions,l=null==s?void 0:s.messageTemplatesInfo,u=Object(i.useCallback)((function(e){var t,n;if(!l)return null;var r=null,i=null!==(t=null==l?void 0:l.templatesMap)&&void 0!==t?t:null;return i&&(r=null!==(n=i[e])&&void 0!==n?n:null),r}),[null==s?void 0:s.messageTemplatesInfo]),c=function(e){return _(n,void 0,void 0,(function(){var t,n,r,i;return v(this,(function(a){switch(a.label){case 0:t=!0,n=null,r=[],a.label=1;case 1:return t?[4,e.message.getMessageTemplatesByToken(n,{limit:20})]:[3,3];case 2:return i=a.sent(),t=i.hasMore,n=i.token,i.templates.forEach((function(e){r.push(JSON.parse(e.template))})),[3,1];case 3:return[2,r]}}))}))};return{getCachedTemplate:u,updateMessageTemplatesInfo:Object(i.useCallback)((function(e,t,i){return _(n,void 0,void 0,(function(){var n,s,l,u,c,d,h,f,p;return v(this,(function(m){switch(m.label){case 0:o.upsertWaitingTemplateKeys({keys:e,requestedAt:i}),n=[],m.label=1;case 1:m.trys.push([1,5,,6]),s=!0,l=null,m.label=2;case 2:return s?[4,r.message.getMessageTemplatesByToken(l,{keys:e})]:[3,4];case 3:return(u=m.sent()).templates.forEach((function(e){n.push(JSON.parse(e.template))})),s=u.hasMore,l=u.token,[3,2];case 4:return[3,6];case 5:return c=m.sent(),null===(p=null==a?void 0:a.error)||void 0===p||p.call(a,"Sendbird | fetchProcessedMessageTemplates failed",c,e),[3,6];case 6:return n.length>0?((d=localStorage.getItem("sendbird_message_templates_key"))?(h=JSON.parse(d),f=h.map((function(e){return e.key})),n.forEach((function(e){f.includes(e.key)||h.push(e)})),localStorage.setItem("sendbird_message_templates_key",JSON.stringify(h))):localStorage.setItem("sendbird_message_templates_key",JSON.stringify([n])),o.upsertMessageTemplates({payload:n.map((function(e){return{key:e.key,template:HM(e)}}))})):o.markErrorWaitingTemplateKeys({keys:e,messageId:t}),[2]}}))}))}),[o.upsertMessageTemplates,o.upsertWaitingTemplateKeys,null===(t=null==r?void 0:r.message)||void 0===t?void 0:t.getMessageTemplatesByToken]),initializeMessageTemplatesInfo:function(e){return _(n,void 0,void 0,(function(){var t,n,r,i,a,s;return v(this,(function(l){switch(l.label){case 0:return(t=null===(s=e.appInfo)||void 0===s?void 0:s.messageTemplateInfo.token)?(n=localStorage.getItem("sendbird_message_templates_token_key"),r=localStorage.getItem("sendbird_message_templates_key"),n&&n===t?[3,2]:[4,c(e)]):(localStorage.removeItem("sendbird_message_templates_token_key"),localStorage.removeItem("sendbird_message_templates_key"),[2]);case 1:return i=l.sent(),a={token:t,templatesMap:GM(i)},o.initMessageTemplateInfo({payload:a}),localStorage.setItem("sendbird_message_templates_token_key",t),localStorage.setItem("sendbird_message_templates_key",JSON.stringify(i)),[3,3];case 2:n&&n===t&&r&&(i=JSON.parse(r),a={token:t,templatesMap:GM(i)},o.initMessageTemplateInfo({payload:a})),l.label=3;case 3:return[2]}}))}))}}}({sdk:ce,logger:d,appInfoStore:ie,actions:te}),me=pe.getCachedTemplate,ge=pe.updateMessageTemplatesInfo,_e=pe.initializeMessageTemplatesInfo;Object(i.useEffect)((function(){te.connect({appId:n,userId:r,accessToken:a,isUserIdUsedForNickname:D,isMobile:X,logger:d,nickname:g,profileUrl:b,configureSession:l,customApiHost:s,customWebSocketHost:o,sdkInitParams:U,customExtensionParams:L,initDashboardConfigs:le,eventHandlers:B,initializeMessageTemplatesInfo:_e})}),[n,r]),iA((function(){te.disconnect({logger:d})}));var ve,Ee=Object(i.useState)(c),ye=Ee[0],be=Ee[1];Object(i.useEffect)((function(){be(c)}),[c]),Object(i.useEffect)((function(){var e=document.querySelector("body");null==e||e.classList.remove("sendbird-experimental__rem__units"),Y&&(null==e||e.classList.add("sendbird-experimental__rem__units"))}),[Y]),Object(i.useEffect)((function(){d.info("Setup theme","Theme: ".concat(ye));try{var e=document.querySelector("body");null==e||e.classList.remove("sendbird-theme--light"),null==e||e.classList.remove("sendbird-theme--dark"),null==e||e.classList.add("sendbird-theme--".concat(ye||"light")),d.info("Finish setup theme")}catch(e){d.warning("Setup theme failed","".concat(e))}return function(){try{var e=document.querySelector("body");null==e||e.classList.remove("sendbird-theme--light"),null==e||e.classList.remove("sendbird-theme--dark")}catch(e){}}}),[ye]),ve=H,Object(i.useEffect)((function(){document.getElementById(V_).parentElement.dir=ve}),[ve]);var Ce=aA(re.sdk,d),Ne=function(e,t){var n=e.isConnected,r=t.logger,a=Object(i.useMemo)((function(){return sA({logger:r,cb:function(e){try{e.markAsRead()}catch(t){r.warning("Channel: Mark as delivered failed",{channel:e,error:t})}}})}),[]);return Object(i.useEffect)((function(){n||a.clear()}),[n]),iA((function(){a.clear()})),a}({isConnected:Ce},{logger:d}),Te=oA({isConnected:Ce},{logger:d}),Ie=Object(i.useMemo)((function(){return Math.min(10,null!=fe?fe:Number.MAX_SAFE_INTEGER)}),[fe]),Se=Object(i.useMemo)((function(){return new Ew({sdk:ce,logger:d})}),[re.initialized]),we=Object(i.useMemo)((function(){return{common:{enableUsingDefaultUserProfile:se.common.enableUsingDefaultUserProfile},groupChannel:{enableOgtag:ue&&oe(ce).groupChannel.channel.enableOgtag,enableTypingIndicator:se.groupChannel.channel.enableTypingIndicator,enableReactions:ue&&oe(ce).groupChannel.channel.enableReactions,enableMention:se.groupChannel.channel.enableMention,replyType:se.groupChannel.channel.replyType,threadReplySelectType:se.groupChannel.channel.threadReplySelectType,enableVoiceMessage:se.groupChannel.channel.enableVoiceMessage,enableDocument:se.groupChannel.channel.input.enableDocument,typingIndicatorTypes:se.groupChannel.channel.typingIndicatorTypes,enableFeedback:se.groupChannel.channel.enableFeedback,enableSuggestedReplies:se.groupChannel.channel.enableSuggestedReplies,showSuggestedRepliesFor:se.groupChannel.channel.showSuggestedRepliesFor,suggestedRepliesDirection:se.groupChannel.channel.suggestedRepliesDirection,enableMarkdownForUserMessage:se.groupChannel.channel.enableMarkdownForUserMessage,enableFormTypeMessage:se.groupChannel.channel.enableFormTypeMessage,enableReactionsSupergroup:ue&&oe(ce).groupChannel.channel.enableReactionsSupergroup},groupChannelList:{enableTypingIndicator:se.groupChannel.channelList.enableTypingIndicator,enableMessageReceiptStatus:se.groupChannel.channelList.enableMessageReceiptStatus},groupChannelSettings:{enableMessageSearch:ue&&oe(ce).groupChannel.setting.enableMessageSearch},openChannel:{enableOgtag:ue&&oe(ce).openChannel.channel.enableOgtag,enableDocument:se.openChannel.channel.input.enableDocument}}}),[ue,se.common,se.groupChannel.channel,se.groupChannel.channelList,se.groupChannel.setting,se.openChannel.channel]),Ae=Object(i.useMemo)((function(){return{stores:{sdkStore:$.stores.sdkStore,userStore:$.stores.userStore,appInfoStore:$.stores.appInfoStore}}}),[$.stores.sdkStore,$.stores.userStore,$.stores.appInfoStore]),Me=Object(i.useMemo)((function(){return null!=he?he:26214400}),[he,26214400]),Oe=Object(i.useMemo)((function(){return m({compressionRate:.7,outputFormat:"preserve"},I)}),[I]),Re=Object(i.useMemo)((function(){var e,t;return{maxRecordingTime:null!==(e=null==C?void 0:C.maxRecordingTime)&&void 0!==e?e:6e5,minRecordingTime:null!==(t=null==C?void 0:C.minRecordingTime)&&void 0!==t?t:1e3}}),[null==C?void 0:C.maxRecordingTime,null==C?void 0:C.minRecordingTime]),ke=Object(i.useMemo)((function(){return{maxMentionCount:(null==K?void 0:K.maxMentionCount)||10,maxSuggestionCount:(null==K?void 0:K.maxSuggestionCount)||15}}),[null==K?void 0:K.maxMentionCount,null==K?void 0:K.maxSuggestionCount]),xe=Object(i.useMemo)((function(){return{disableUserProfile:!se.common.enableUsingDefaultUserProfile,isReactionEnabled:ue&&oe(ce).groupChannel.channel.enableReactions,isMentionEnabled:se.groupChannel.channel.enableMention,isVoiceMessageEnabled:se.groupChannel.channel.enableVoiceMessage,replyType:H_(se.groupChannel.channel.replyType).upperCase,isTypingIndicatorEnabledOnChannelList:se.groupChannel.channelList.enableTypingIndicator,isMessageReceiptStatusEnabledOnChannelList:se.groupChannel.channelList.enableMessageReceiptStatus,showSearchIcon:ue&&oe(ce).groupChannel.setting.enableMessageSearch}}),[ue,oe,se.common.enableUsingDefaultUserProfile,se.groupChannel.channel.enableReactions,se.groupChannel.channel.enableMention,se.groupChannel.channel.enableVoiceMessage,se.groupChannel.channel.replyType,se.groupChannel.channelList.enableTypingIndicator,se.groupChannel.channelList.enableMessageReceiptStatus,se.groupChannel.setting.enableMessageSearch]),De=Object(i.useMemo)((function(){return{config:m(m({disableMarkAsDelivered:M,renderUserProfile:O,onStartDirectMessage:V,onUserProfileMessage:V,allowProfileEdit:w,isOnline:Ce,userId:r,appId:n,accessToken:a,theme:ye,setCurrentTheme:be,setCurrenttheme:be,isMultipleFilesMessageEnabled:F,uikitMultipleFilesMessageLimit:Ie,logger:d,pubSub:Z,userListQuery:N,htmlTextDirection:H,forceLeftToRightMessageLayout:z,markAsReadScheduler:Ne,markAsDeliveredScheduler:Te,uikitUploadSizeLimit:Me,imageCompression:Oe,voiceRecord:Re,userMention:ke},we),xe)}}),[M,O,V,w,Ce,r,n,a,ye,be,F,Ie,d,Z,N,H,z,Ne,Te,Me,Oe,Re,ke,we,xe]),Ue=Object(i.useMemo)((function(){return{utils:{updateMessageTemplatesInfo:ge,getCachedTemplate:me}}}),[ge,me]);return AM((function(){ee(m(m(m(m({},Ae),Ue),De),{eventHandlers:B,emojiManager:Se}))}),[Ae,De,B,Se,Ue]),null},VM=function(e){var t,n,r,s,o,l,u,c,d,h=e.children,f=e.stringSet,p=e.breakpoint,g=e.dateLocale,_=eN({config:{renderUserProfile:null==e?void 0:e.renderUserProfile,onStartDirectMessage:null==e?void 0:e.onStartDirectMessage,allowProfileEdit:null==e?void 0:e.allowProfileEdit,appId:null==e?void 0:e.appId,userId:null==e?void 0:e.userId,accessToken:null==e?void 0:e.accessToken,theme:null==e?void 0:e.theme,htmlTextDirection:null==e?void 0:e.htmlTextDirection,forceLeftToRightMessageLayout:null==e?void 0:e.forceLeftToRightMessageLayout,pubSub:null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.pubSub,logger:null==e?void 0:e.logger,userListQuery:null==e?void 0:e.userListQuery,voiceRecord:{maxRecordingTime:null!==(r=null===(n=null==e?void 0:e.voiceRecord)||void 0===n?void 0:n.maxRecordingTime)&&void 0!==r?r:6e5,minRecordingTime:null!==(o=null===(s=null==e?void 0:e.voiceRecord)||void 0===s?void 0:s.minRecordingTime)&&void 0!==o?o:1e3},userMention:{maxMentionCount:(null===(u=null===(l=null==e?void 0:e.config)||void 0===l?void 0:l.userMention)||void 0===u?void 0:u.maxMentionCount)||10,maxSuggestionCount:(null===(d=null===(c=null==e?void 0:e.config)||void 0===c?void 0:c.userMention)||void 0===d?void 0:d.maxSuggestionCount)||15},imageCompression:m({compressionRate:.7,outputFormat:"preserve"},null==e?void 0:e.imageCompression),disableMarkAsDelivered:null==e?void 0:e.disableMarkAsDelivered,isMultipleFilesMessageEnabled:null==e?void 0:e.isMultipleFilesMessageEnabled},eventHandlers:null==e?void 0:e.eventHandlers}),v=Object(i.useRef)(function(e){return Yb({config:m(m({},Qb.config),null==e?void 0:e.config),stores:m(m({},Qb.stores),null==e?void 0:e.stores),eventHandlers:m(m({},Qb.eventHandlers),null==e?void 0:e.eventHandlers),emojiManager:Qb.emojiManager,utils:m(m({},Qb.utils),null==e?void 0:e.utils)})}(_)),E=Object(i.useMemo)((function(){return m(m({},FC("en")),f)}),[f]);return a.a.createElement(Jb.Provider,{value:v.current},a.a.createElement(sN,{logger:v.current.getState().config.logger,breakpoint:p},a.a.createElement(ZC,{stringSet:E,dateLocale:g},a.a.createElement(OM,null,a.a.createElement(gw,null,h)))),a.a.createElement(IM,null),a.a.createElement($S,null),a.a.createElement(NM,null))},qM=function(e){var t=e.children,n=e.config,r=null==n?void 0:n.logLevel,s=Object(i.useState)(FM(r)),o=s[0],l=s[1];return Object(i.useEffect)((function(){l(FM(r))}),[r]),a.a.createElement(VM,m({},e,{logger:o}),a.a.createElement(zM,m({},e,{logger:o})),t)},KM=function(e){var t,n,r,i,s,o,l,u,c,d,h,f,p,g,_,v,E,y,b,C,N,T,I,S,w,A,M,O,R,k,x,D,U,L,P,F,B,j,H,G,z,V,q,K,W=(t={legacyConfig:{replyType:e.replyType,isMentionEnabled:e.isMentionEnabled,isReactionEnabled:e.isReactionEnabled,disableUserProfile:e.disableUserProfile,isVoiceMessageEnabled:e.isVoiceMessageEnabled,isTypingIndicatorEnabledOnChannelList:e.isTypingIndicatorEnabledOnChannelList,isMessageReceiptStatusEnabledOnChannelList:e.isMessageReceiptStatusEnabledOnChannelList,showSearchIcon:e.showSearchIcon},uikitOptions:e.uikitOptions},L=t.legacyConfig,P=t.uikitOptions,F=void 0===P?{}:P,B=L.replyType,j=L.isMentionEnabled,H=L.isReactionEnabled,G=L.disableUserProfile,z=L.isVoiceMessageEnabled,V=L.isTypingIndicatorEnabledOnChannelList,q=L.isMessageReceiptStatusEnabledOnChannelList,K=L.showSearchIcon,{common:{enableUsingDefaultUserProfile:null!==(r=null===(n=F.common)||void 0===n?void 0:n.enableUsingDefaultUserProfile)&&void 0!==r?r:"boolean"==typeof G?!G:void 0},groupChannel:{enableOgtag:null===(i=F.groupChannel)||void 0===i?void 0:i.enableOgtag,enableMention:null!==(o=null===(s=F.groupChannel)||void 0===s?void 0:s.enableMention)&&void 0!==o?o:j,enableReactions:null!==(u=null===(l=F.groupChannel)||void 0===l?void 0:l.enableReactions)&&void 0!==u?u:H,enableReactionsSupergroup:null===(c=F.groupChannel)||void 0===c?void 0:c.enableReactionsSupergroup,enableTypingIndicator:null===(d=F.groupChannel)||void 0===d?void 0:d.enableTypingIndicator,enableVoiceMessage:null!==(f=null===(h=F.groupChannel)||void 0===h?void 0:h.enableVoiceMessage)&&void 0!==f?f:z,replyType:null!==(g=null===(p=F.groupChannel)||void 0===p?void 0:p.replyType)&&void 0!==g?g:null!=B?H_(B).lowerCase:void 0,threadReplySelectType:null===(_=F.groupChannel)||void 0===_?void 0:_.threadReplySelectType,input:{enableDocument:null===(E=null===(v=F.groupChannel)||void 0===v?void 0:v.input)||void 0===E?void 0:E.enableDocument},typingIndicatorTypes:null===(y=F.groupChannel)||void 0===y?void 0:y.typingIndicatorTypes,enableFeedback:null===(b=F.groupChannel)||void 0===b?void 0:b.enableFeedback,enableSuggestedReplies:null===(C=F.groupChannel)||void 0===C?void 0:C.enableSuggestedReplies,showSuggestedRepliesFor:null===(N=F.groupChannel)||void 0===N?void 0:N.showSuggestedRepliesFor,suggestedRepliesDirection:null===(T=F.groupChannel)||void 0===T?void 0:T.suggestedRepliesDirection,enableMarkdownForUserMessage:null===(I=F.groupChannel)||void 0===I?void 0:I.enableMarkdownForUserMessage,enableFormTypeMessage:null===(S=F.groupChannel)||void 0===S?void 0:S.enableFormTypeMessage},groupChannelList:{enableTypingIndicator:null!==(A=null===(w=F.groupChannelList)||void 0===w?void 0:w.enableTypingIndicator)&&void 0!==A?A:V,enableMessageReceiptStatus:null!==(O=null===(M=F.groupChannelList)||void 0===M?void 0:M.enableMessageReceiptStatus)&&void 0!==O?O:q},groupChannelSettings:{enableMessageSearch:null!==(k=null===(R=F.groupChannelSettings)||void 0===R?void 0:R.enableMessageSearch)&&void 0!==k?k:K},openChannel:{enableOgtag:null===(x=F.openChannel)||void 0===x?void 0:x.enableOgtag,input:{enableDocument:null===(U=null===(D=F.openChannel)||void 0===D?void 0:D.input)||void 0===U?void 0:U.enableDocument}}});return a.a.createElement(j_,{storage:MM,localConfigs:{common:null==W?void 0:W.common,groupChannel:{channel:null==W?void 0:W.groupChannel,channelList:null==W?void 0:W.groupChannelList,setting:null==W?void 0:W.groupChannelSettings},openChannel:{channel:null==W?void 0:W.openChannel}}},a.a.createElement(qM,m({},e)))};const WM={initialisingChatText:"CareAiChat-module__initialisingChatText__1WvCX",loadingText:"CareAiChat-module__loadingText__GO-Id",chatInterface:"CareAiChat-module__chatInterface__ESwZS",careAIChatInterface:"CareAiChat-module__careAIChatInterface__PiKmV",careAiChatInterface:"CareAiChat-module__careAIChatInterface__PiKmV",backIcon:"CareAiChat-module__backIcon__HV0VU",careaiContainer:"CareAiChat-module__careaiContainer__aV9aO",customMessage:"CareAiChat-module__customMessage__GXH4Y",customMessageBot:"CareAiChat-module__customMessageBot__CgEcY",customMessageUser:"CareAiChat-module__customMessageUser__WrxTg",customMessageAvatar:"CareAiChat-module__customMessageAvatar__mjg4n",customMessageContent:"CareAiChat-module__customMessageContent__yQgTI",customMessageBubble:"CareAiChat-module__customMessageBubble__JYLXZ",customMessageBubbleBot:"CareAiChat-module__customMessageBubbleBot__gq8-1",customMessageBubbleUser:"CareAiChat-module__customMessageBubbleUser__0ak9J",customMessageTime:"CareAiChat-module__customMessageTime__oHE73",customGroupChannelList:"CareAiChat-module__customGroupChannelList__-6ydS",customGroupChannelHeader:"CareAiChat-module__customGroupChannelHeader__b2iZV",customTextarea:"CareAiChat-module__customTextarea__urAzR",customTextareaExpanded:"CareAiChat-module__customTextareaExpanded__wpGsQ",sendBtn:"CareAiChat-module__sendBtn__RNo5U",sendBtnActive:"CareAiChat-module__sendBtnActive__66OyI",chatBotTypingIndicator:"CareAiChat-module__chatBotTypingIndicator__MDyW4",typingIndicatorAvatar:"CareAiChat-module__typingIndicatorAvatar__zv-l3",typingIndicatorText:"CareAiChat-module__typingIndicatorText__KPSYN",customInputWrapper:"CareAiChat-module__customInputWrapper__wNCUR",careAIDisclaimerText:"CareAiChat-module__careAIDisclaimerText__u695z",careAiDisclaimerText:"CareAiChat-module__careAIDisclaimerText__u695z",customCardBubble:"CareAiChat-module__customCardBubble__3QqBC",chatCardImage:"CareAiChat-module__chatCardImage__YdRqx",chatCardContent:"CareAiChat-module__chatCardContent__H4Byf",chatCardTitle:"CareAiChat-module__chatCardTitle__GKTlu",chatCardDescription:"CareAiChat-module__chatCardDescription__mTd7M",chatCardButton:"CareAiChat-module__chatCardButton__0uUqp",chatCardButtonSupport:"CareAiChat-module__chatCardButtonSupport__NdA4A",chatCardButtonListing:"CareAiChat-module__chatCardButtonListing__sprTC",chatCardButtonDoctor_profile:"CareAiChat-module__chatCardButtonDoctor_profile__iyezf",chatCardButtonDoctorProfile:"CareAiChat-module__chatCardButtonDoctor_profile__iyezf",chatCardButtonConsult:"CareAiChat-module__chatCardButtonConsult__TpdK3",suggestedReplies:"CareAiChat-module__suggestedReplies__FRkYy",suggestedRepliesWrapper:"CareAiChat-module__suggestedRepliesWrapper__CEOzn",suggestedReplyBtn:"CareAiChat-module__suggestedReplyBtn__FaU0p",customChatHistory:"CareAiChat-module__customChatHistory__7cGwx",messageText:"CareAiChat-module__messageText__VfNQc",messageTime:"CareAiChat-module__messageTime__E79Em",careAiHeaderHistory:"CareAiChat-module__careAiHeaderHistory__3-5oG",chatInterfacePageLoader:"CareAiChat-module__chatInterfacePageLoader__2ngxf",errorContainer:"CareAiChat-module__errorContainer__bXRgI",errorMessage:"CareAiChat-module__errorMessage__X-l-H",retryButton:"CareAiChat-module__retryButton__IL1vh"};var YM=a.a.createContext({disableUserProfile:!0,isOpenChannel:!1}),QM=function(){return Object(i.useContext)(YM)},XM=function(e){var t,n=e.isOpenChannel,r=void 0!==n&&n,i=e.disableUserProfile,s=void 0!==i&&i,o=e.renderUserProfile,l=e.onUserProfileMessage,u=e.onStartDirectMessage,c=e.children,d=IC().state.config,h=null!==(t=null!=u?u:l)&&void 0!==t?t:d.onStartDirectMessage;return a.a.createElement(YM.Provider,{value:{isOpenChannel:r,disableUserProfile:null!=s?s:!d.common.enableUsingDefaultUserProfile,renderUserProfile:null!=o?o:d.renderUserProfile,onStartDirectMessage:h,onUserProfileMessage:h}},c)},ZM=function(){var e=Object(i.useContext)(JM);if(!e)throw new Error("useGroupChannelList must be used within a GroupChannelListProvider");var t=Object(i.useCallback)((function(t){e.setState((function(e){return m(m({},e),{groupChannels:t})}),!0)}),[]);return{state:J_.useSyncExternalStore(e.subscribe,e.getState),actions:Object(i.useMemo)((function(){return{setGroupChannels:t}}),[t])}},JM=a.a.createContext(null),$M={className:"",selectedChannelUrl:"",disableAutoSelect:!1,allowProfileEdit:!1,isTypingIndicatorEnabled:!1,isMessageReceiptStatusEnabled:!1,onChannelSelect:function(){},onChannelCreated:function(){},onThemeChange:$C,onCreateChannelClick:$C,onBeforeCreateChannel:null,onUserProfileUpdated:$C,typingChannelUrls:[],refreshing:!1,initialized:!1,groupChannels:[],refresh:null,loadMore:null,scrollRef:{current:null}},eO=function(e){var t,n,r,a,s,o,l=e.className,u=void 0===l?"":l,c=e.selectedChannelUrl,d=void 0===c?"":c,h=e.disableAutoSelect,f=void 0!==h&&h,p=e.channelListQueryParams,_=e.onThemeChange,v=e.onChannelSelect,E=e.onChannelCreated,y=e.onCreateChannelClick,b=e.onBeforeCreateChannel,C=e.onUserProfileUpdated,N=g(e,["className","selectedChannelUrl","disableAutoSelect","channelListQueryParams","onThemeChange","onChannelSelect","onChannelCreated","onCreateChannelClick","onBeforeCreateChannel","onUserProfileUpdated"]),T=IC().state,I=T.config,S=T.stores,w=ZM(),A=w.state,M=w.actions,O=Xb(JM,(function(e){return e}),$M).updateState,R=S.sdkStore.sdk,k=oA({isConnected:aA(R,I.logger)},I),x=Object(i.useRef)(null),D=Wm(R,{collectionCreator:rO(R,p),markAsDelivered:function(e){return e.forEach(k.push)},onChannelsDeleted:function(e){e.forEach((function(e){e===d&&v(null)}))},onChannelsUpdated:function(){M.setGroupChannels(P)}}),U=D.refreshing,L=D.initialized,P=D.groupChannels,F=D.refresh,B=D.loadMore;Object(i.useEffect)((function(){var e;!f&&S.sdkStore.initialized&&L&&(d||v(null!==(e=P[0])&&void 0!==e?e:null))}),[f,S.sdkStore.initialized,L,d]),Object(i.useEffect)((function(){null==F||F()}),[Object.keys(null!=p?p:{}).sort().map((function(e){return"".concat(e,"=").concat(encodeURIComponent(JSON.stringify(p[e])))})).join("&")]);var j=A.typingChannelUrls;Hm(R,{onTypingStatusUpdated:function(e){var t,n=j.filter((function(t){return t!==e.url}));(null===(t=e.getTypingUsers())||void 0===t?void 0:t.length)>0?O({typingChannelUrls:n.concat(e.url)}):O({typingChannelUrls:n})}});var H=null===(n=null!==(t=N.allowProfileEdit)&&void 0!==t?t:I.allowProfileEdit)||void 0===n||n,G=null!==(a=null!==(r=N.isTypingIndicatorEnabled)&&void 0!==r?r:I.groupChannelList.enableTypingIndicator)&&void 0!==a&&a,z=null!==(o=null!==(s=N.isMessageReceiptStatusEnabled)&&void 0!==s?s:I.groupChannelList.enableMessageReceiptStatus)&&void 0!==o&&o,V=Object(i.useMemo)((function(){return{onChannelSelect:v,onChannelCreated:E,onThemeChange:_,onCreateChannelClick:y,onBeforeCreateChannel:b,onUserProfileUpdated:C}}),[v,E,_,y,b,C]),q=Object(i.useMemo)((function(){return{className:u,selectedChannelUrl:d,disableAutoSelect:f,allowProfileEdit:H,isTypingIndicatorEnabled:G,isMessageReceiptStatusEnabled:z,typingChannelUrls:j,refreshing:U,initialized:L,refresh:F,loadMore:B}}),[u,d,f,H,G,z,j,U,L,x]);return AM((function(){O(m(m(m({},V),q),{groupChannels:P}))}),[q,V,P.map((function(e){return e.serialize()}))]),null},tO=function(e){var t=e.children,n=eN({onChannelSelect:null==e?void 0:e.onChannelSelect,onChannelCreated:null==e?void 0:e.onChannelCreated,className:null==e?void 0:e.className,selectedChannelUrl:null==e?void 0:e.selectedChannelUrl,allowProfileEdit:null==e?void 0:e.allowProfileEdit,disableAutoSelect:null==e?void 0:e.disableAutoSelect,isTypingIndicatorEnabled:null==e?void 0:e.isTypingIndicatorEnabled,isMessageReceiptStatusEnabled:null==e?void 0:e.isMessageReceiptStatusEnabled,channelListQueryParams:null==e?void 0:e.channelListQueryParams,onThemeChange:null==e?void 0:e.onThemeChange,onCreateChannelClick:null==e?void 0:e.onCreateChannelClick,onBeforeCreateChannel:null==e?void 0:e.onBeforeCreateChannel,onUserProfileUpdated:null==e?void 0:e.onUserProfileUpdated}),r=Object(i.useRef)(function(e){return Yb(m(m({},$M),e))}(n));return a.a.createElement(JM.Provider,{value:r.current},t)},nO=function(e){var t=e.children,n=e.className;return a.a.createElement(tO,m({},e),a.a.createElement(eO,m({},e)),a.a.createElement(XM,m({},e),a.a.createElement("div",{className:"sendbird-channel-list ".concat(n)},t)))};function rO(e,t){return function(n){var r=m(m({},n),t);return e.groupChannel.createGroupChannelCollection(m(m({},r),{filter:new ff(r)}))}}var iO,aO;function sO(e){return"sendingStatus"in e?"succeeded"===e.sendingStatus?String(e.messageId):e.reqId:String(e.messageId)}function oO(){var e,t;return 0===(null===(e=document.getElementById("sendbird-dropdown-portal"))||void 0===e?void 0:e.childElementCount)&&0===(null===(t=document.getElementById("sendbird-emoji-list-portal"))||void 0===t?void 0:t.childElementCount)}function lO(e){var t,n=null===(t=document.querySelectorAll('[data-sb-created-at="'.concat(e,'"]')))||void 0===t?void 0:t[0];return n instanceof HTMLElement?n.offsetTop:null}(aO=iO||(iO={})).PARENT="PARENT",aO.THREAD="THREAD";var uO,cO,dO=function(e){return!!e&&(e.isFrozen&&"operator"!==e.myRole)},hO=function(e){return!!e&&"muted"===e.myMutedState},fO=function(e,t){var n,r,i,a;return t&&Array.isArray(null===(r=null===(n=null==e?void 0:e.lastMessage)||void 0===n?void 0:n.extendedMessagePayload)||void 0===r?void 0:r.suggested_replies)&&!!(null===(a=null===(i=null==e?void 0:e.lastMessage)||void 0===i?void 0:i.extendedMessagePayload)||void 0===a?void 0:a.disable_chat_input)},pO=function(e){return e<=1},mO=function(e,t){return t&&e.some((function(e){var t;return!!e.messageForm&&!e.messageForm.isSubmitted&&!!(null===(t=e.extendedMessagePayload)||void 0===t?void 0:t.disable_chat_input)&&pO(e.messageForm.version)}))};function gO(e){var t=e.channel,n=e.config,r=e.moduleLevel;return!(!t||t.isBroadcast||t.isEphemeral)&&(t.isSuper?null!=r?r:n.groupChannel.enableReactionsSupergroup:null!=r?r:n.groupChannel.enableReactions)}(cO=uO||(uO={})).CHANNEL="CHANNEL",cO.THREAD="THREAD";var _O,vO,EO=function(e,t){return!t||0===t.length||t.includes(e)};(vO=_O||(_O={})).USER_UPDATED="USER_UPDATED",vO.SEND_MESSAGE_START="SEND_MESSAGE_START",vO.SEND_MESSAGE_FAILED="SEND_MESSAGE_FAILED",vO.SEND_USER_MESSAGE="SEND_USER_MESSAGE",vO.SEND_FILE_MESSAGE="SEND_FILE_MESSAGE",vO.ON_FILE_INFO_UPLOADED="ON_FILE_INFO_UPLOADED",vO.UPDATE_USER_MESSAGE="UPDATE_USER_MESSAGE",vO.DELETE_MESSAGE="DELETE_MESSAGE",vO.LEAVE_CHANNEL="LEAVE_CHANNEL",vO.CREATE_CHANNEL="CREATE_CHANNEL",vO.UPDATE_OPEN_CHANNEL="UPDATE_OPEN_CHANNEL";var yO=_O,bO=function(e){return e};var CO=function(){var e,t,n,r=Object(i.useContext)(SO);if(!r)throw new Error("useGroupChannel must be used within a GroupChannelProvider");var a=IC().state.config,s=a.markAsReadScheduler,o=J_.useSyncExternalStore(r.subscribe,r.getState),l=Object(i.useCallback)((function(e){r.setState((function(t){return m(m({},t),{animatedMessageId:e})}))}),[]),u=Object(i.useCallback)((function(e){r.setState((function(t){return m(m({},t),{isScrollBottomReached:e})}))}),[]),c=Object(i.useCallback)((function(e){return _(void 0,void 0,void 0,(function(){return v(this,(function(t){switch(t.label){case 0:return o.scrollRef.current?(l(null),u(!0),[4,new Promise((function(e){setTimeout(e,n)}))]):[2];case 1:return t.sent(),a.isOnline&&o.hasNext()?[4,o.resetWithStartingPoint(Number.MAX_SAFE_INTEGER)]:[3,3];case 2:t.sent(),t.label=3;case 3:return o.scrollPubSub.publish("scrollToBottom",{animated:e}),o.currentChannel&&!o.hasNext()&&(o.resetNewMessages(),o.disableMarkAsRead||s.push(o.currentChannel)),[2]}var n}))}))}),[o.scrollRef.current,a.isOnline,s]),d=Object(i.useCallback)((function(e,t,n,r){return _(void 0,void 0,void 0,(function(){var i,a,s,u,c;return v(this,(function(d){switch(d.label){case 0:return i=o.scrollRef.current,a=null==i?void 0:i.parentNode,(s={activate:function(){i&&a&&(i.style.pointerEvents="auto",a.style.cursor="auto")},deactivate:function(){i&&a&&(i.style.pointerEvents="none",a.style.cursor="wait")}}).deactivate(),l(null),(u=o.messages.find((function(n){return n.messageId===t||n.createdAt===e})))?((c=lO(u.createdAt))&&o.scrollPubSub.publish("scroll",{top:c,animated:r}),(null==n||n)&&l(t),[3,3]):[3,1];case 1:return[4,o.resetWithStartingPoint(e)];case 2:d.sent(),setTimeout((function(){var i=lO(e);i&&o.scrollPubSub.publish("scroll",{top:i,lazy:!1,animated:r}),(null==n||n)&&l(t)})),d.label=3;case 3:return s.activate(),[2]}}))}))}),[l,o.scrollRef.current,null===(e=o.messages)||void 0===e?void 0:e.map((function(e){return null==e?void 0:e.messageId}))]),h=Object(i.useCallback)((function(e,t,n){o.currentChannel&&(n?o.currentChannel.deleteReaction(e,t).catch((function(e){var t;null===(t=a.logger)||void 0===t||t.warning("Failed to delete reaction:",e)})):o.currentChannel.addReaction(e,t).catch((function(e){var t;null===(t=a.logger)||void 0===t||t.warning("Failed to add reaction:",e)})))}),[null===(t=o.currentChannel)||void 0===t?void 0:t.deleteReaction,null===(n=o.currentChannel)||void 0===n?void 0:n.addReaction]),f=function(e){var t=this,n=e.onBeforeSendUserMessage,r=void 0===n?bO:n,a=e.onBeforeSendFileMessage,s=void 0===a?bO:a,o=e.onBeforeUpdateUserMessage,l=void 0===o?bO:o,u=e.onBeforeSendVoiceMessage,c=void 0===u?bO:u,d=e.onBeforeSendMultipleFilesMessage,h=void 0===d?bO:d,f=e.sendFileMessage,p=e.sendMultipleFilesMessage,g=e.sendUserMessage,E=e.updateUserMessage,y=e.updateFileMessage,b=e.resendMessage,C=e.deleteMessage,N=e.resetNewMessages,T=e.scrollToBottom,I=e.quoteMessage,S=e.replyType,w=e.currentChannel,A=IC().state,M=A.eventHandlers,O=A.config.pubSub,R=Object(i.useCallback)((function(t){var n=m({},t);return e.quoteMessage&&"NONE"!==S&&(n.isReplyToChannel=!0,n.parentMessageId=null==I?void 0:I.messageId),n}),[S,I]),k=Object(i.useCallback)((function(){setTimeout(T,0)}),[]),x=Object(i.useCallback)((function(e,n,r){return _(t,void 0,void 0,(function(){var t,i;return v(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e(n)];case 1:return[2,void 0===(t=a.sent())?n:t];case 2:throw i=a.sent(),"object"==typeof(null==M?void 0:M.message)&&fw(r).with("file","voice",(function(){var e,t,r,a;n.file&&(null===(t=(e=M.message).onFileUploadFailed)||void 0===t||t.call(e,i)),null===(a=(r=M.message).onSendMessageFailed)||void 0===a||a.call(r,n,i)})).with("multipleFiles",(function(){var e,t,r,a;n.fileInfoList&&(null===(t=(e=M.message).onFileUploadFailed)||void 0===t||t.call(e,i)),null===(a=(r=M.message).onSendMessageFailed)||void 0===a||a.call(r,n,i)})).with("user",(function(){var e,t;null===(t=(e=M.message).onSendMessageFailed)||void 0===t||t.call(e,n,i)})).with("update",(function(){var e,t;null===(t=(e=M.message).onUpdateMessageFailed)||void 0===t||t.call(e,n,i)})).exhaustive(),i;case 3:return[2]}}))}))}),[M]);return{sendUserMessage:Object(i.useCallback)((function(e){return _(t,void 0,void 0,(function(){var t,n;return v(this,(function(i){switch(i.label){case 0:return t=R(e),[4,x(r,t,"user")];case 1:return n=i.sent(),[2,g(n,k)]}}))}))}),[R,g,T,x]),sendFileMessage:Object(i.useCallback)((function(e){return _(t,void 0,void 0,(function(){var t,n;return v(this,(function(r){switch(r.label){case 0:return t=R(e),[4,x(s,t,"file")];case 1:return n=r.sent(),[2,f(n,k)]}}))}))}),[R,f,T,x]),sendMultipleFilesMessage:Object(i.useCallback)((function(e){return _(t,void 0,void 0,(function(){var t,n;return v(this,(function(r){switch(r.label){case 0:return t=R(e),[4,x(h,t,"multipleFiles")];case 1:return n=r.sent(),[2,p(n,k)]}}))}))}),[R,p,T,x]),sendVoiceMessage:Object(i.useCallback)((function(e,n){return _(t,void 0,void 0,(function(){var t,r;return v(this,(function(i){switch(i.label){case 0:return t=R(m(m({},e),{fileName:"Voice_message.mp3",mimeType:"audio/mp3;sbu_type=voice",metaArrays:[new vo({key:"KEY_VOICE_MESSAGE_DURATION",value:["".concat(n)]}),new vo({key:"KEY_INTERNAL_MESSAGE_TYPE",value:["voice/mp3"]})]})),[4,x(c,t,"voice")];case 1:return r=i.sent(),[2,f(r,k)]}}))}))}),[R,f,T,x]),updateUserMessage:Object(i.useCallback)((function(e,n){return _(t,void 0,void 0,(function(){var t,r;return v(this,(function(i){switch(i.label){case 0:return t=R(n),[4,x(l,t,"update")];case 1:return r=i.sent(),[2,E(e,r).then((function(e){return O.publish(_O.UPDATE_USER_MESSAGE,{channel:w,message:e,publishingModules:[uO.CHANNEL]}),e}))]}}))}))}),[R,E,x,null==w?void 0:w.url]),updateFileMessage:y,resendMessage:b,deleteMessage:C,resetNewMessages:N}}(m(m({},o),{scrollToBottom:c})),p=Object(i.useCallback)((function(e){r.setState((function(t){return m(m({},t),{currentChannel:e,fetchChannelError:null,quoteMessage:null,animatedMessageId:null,nicknamesMap:new Map(e.members.map((function(e){return[e.userId,e.nickname]})))})}),!0)}),[]),g=Object(i.useCallback)((function(e){r.setState((function(t){return m(m({},t),{currentChannel:null,fetchChannelError:e,quoteMessage:null,animatedMessageId:null})}))}),[]),E=Object(i.useCallback)((function(e){r.setState((function(t){return m(m({},t),{quoteMessage:e})}))}),[]),y=Object(i.useMemo)((function(){return m({setCurrentChannel:p,handleChannelError:g,setQuoteMessage:E,scrollToBottom:c,scrollToMessage:d,toggleReaction:h,setAnimatedMessageId:l,setIsScrollBottomReached:u},f)}),[p,g,E,c,d,h,l,u,f]);return{state:o,actions:y}};function NO(e,t){void 0===t&&(t=!0),t?setTimeout((function(){e()})):e()}function TO(e,t){return"boolean"==typeof t?t?"smooth":"auto":e}var IO={currentChannel:null,channelUrl:"",fetchChannelError:null,nicknamesMap:new Map,messages:[],quoteMessage:null,animatedMessageId:null,isScrollBottomReached:!0,scrollRef:{current:null},scrollDistanceFromBottomRef:{current:0},scrollPositionRef:{current:0},messageInputRef:{current:null},isReactionEnabled:!1,isMessageGroupingEnabled:!0,isMultipleFilesMessageEnabled:!1,showSearchIcon:!0,replyType:"NONE",threadReplySelectType:iO.PARENT,disableMarkAsRead:!1,scrollBehavior:"auto",scrollPubSub:null},SO=Object(i.createContext)(null),wO=function(e){var t=e.children,n=eN({channelUrl:null==e?void 0:e.channelUrl,renderUserProfile:null==e?void 0:e.renderUserProfile,disableUserProfile:null==e?void 0:e.disableUserProfile,onUserProfileMessage:null==e?void 0:e.onUserProfileMessage,onStartDirectMessage:null==e?void 0:e.onStartDirectMessage,isReactionEnabled:null==e?void 0:e.isReactionEnabled,isMessageGroupingEnabled:null==e?void 0:e.isMessageGroupingEnabled,isMultipleFilesMessageEnabled:null==e?void 0:e.isMultipleFilesMessageEnabled,showSearchIcon:null==e?void 0:e.showSearchIcon,threadReplySelectType:null==e?void 0:e.threadReplySelectType,disableMarkAsRead:null==e?void 0:e.disableMarkAsRead,scrollBehavior:null==e?void 0:e.scrollBehavior,forceLeftToRightMessageLayout:null==e?void 0:e.forceLeftToRightMessageLayout,startingPoint:null==e?void 0:e.startingPoint,animatedMessageId:null==e?void 0:e.animatedMessageId,onMessageAnimated:null==e?void 0:e.onMessageAnimated,messageListQueryParams:null==e?void 0:e.messageListQueryParams,filterEmojiCategoryIds:null==e?void 0:e.filterEmojiCategoryIds,onBeforeSendUserMessage:null==e?void 0:e.onBeforeSendUserMessage,onBeforeSendFileMessage:null==e?void 0:e.onBeforeSendFileMessage,onBeforeSendVoiceMessage:null==e?void 0:e.onBeforeSendVoiceMessage,onBeforeSendMultipleFilesMessage:null==e?void 0:e.onBeforeSendMultipleFilesMessage,onBeforeUpdateUserMessage:null==e?void 0:e.onBeforeUpdateUserMessage,onBeforeDownloadFileMessage:null==e?void 0:e.onBeforeDownloadFileMessage,onBackClick:null==e?void 0:e.onBackClick,onChatHeaderActionClick:null==e?void 0:e.onChatHeaderActionClick,onReplyInThreadClick:null==e?void 0:e.onReplyInThreadClick,onSearchClick:null==e?void 0:e.onSearchClick,onQuoteMessageClick:null==e?void 0:e.onQuoteMessageClick,renderUserMentionItem:null==e?void 0:e.renderUserMentionItem}),r=Object(i.useRef)(function(e){return Yb(m(m({},IO),e))}(n));return a.a.createElement(SO.Provider,{value:r.current},t)},AO=function(e){var t,n,r,a,s,o,l=e.channelUrl,u=e.children,c=e.isReactionEnabled,d=e.replyType,h=e.threadReplySelectType,f=e.isMessageGroupingEnabled,p=void 0===f||f,g=e.isMultipleFilesMessageEnabled,E=e.showSearchIcon,y=e.disableMarkAsRead,b=void 0!==y&&y,C=e.scrollBehavior,N=void 0===C?"auto":C,T=e.startingPoint,I=e.animatedMessageId,S=e.messageListQueryParams,w=e.onBeforeSendUserMessage,A=e.onBeforeSendFileMessage,M=e.onBeforeSendVoiceMessage,O=e.onBeforeSendMultipleFilesMessage,R=e.onBeforeUpdateUserMessage,k=e.onBeforeDownloadFileMessage,x=e.onMessageAnimated,D=e.onBackClick,U=e.onChatHeaderActionClick,L=e.onReplyInThreadClick,P=e.onSearchClick,F=e.onQuoteMessageClick,B=e.renderUserMentionItem,j=e.filterEmojiCategoryIds,H=CO(),G=H.state,z=H.actions,V=OO().updateState,q=IC().state,K=q.config,W=q.stores.sdkStore,Y=K.markAsReadScheduler,Q=K.logger,X=K.pubSub,Z=function(e,t){void 0===t&&(t=[]);var n=Object(i.useRef)(null),r=Object(i.useRef)(0),a=Object(i.useRef)(0),s=Object(i.useState)((function(){return vw({publishSynchronous:!0})}))[0],o=CO().actions.setIsScrollBottomReached;return Object(i.useLayoutEffect)((function(){r.current=0,a.current=0,o(!0),n.current&&(n.current.scrollTop=n.current.scrollHeight)}),t),Object(i.useLayoutEffect)((function(){var t=[];return t.push(s.subscribe("scrollToBottom",(function(t){var r=t.resolve,i=t.animated;NO((function(){n.current?(n.current.scroll?n.current.scroll({top:n.current.scrollHeight,behavior:TO(e,i)}):n.current.scrollTop=n.current.scrollHeight,a.current=0,o(!0),r&&r()):r&&r()}))}))),t.push(s.subscribe("scroll",(function(t){var r=t.top,i=t.animated,s=t.lazy,l=t.resolve;NO((function(){if(n.current){var t=n.current,s=t.scrollTop,u=t.scrollHeight,c=t.clientHeight;n.current.scroll?n.current.scroll({top:r,behavior:TO(e,i)}):"number"==typeof r&&(n.current.scrollTop=r),a.current=Math.max(0,u-s-c),o(0===a.current),l&&l()}}),s)}))),function(){t.forEach((function(e){return(0,e.remove)()}))}}),[e]),{scrollRef:n,scrollPubSub:s,scrollDistanceFromBottomRef:a,scrollPositionRef:r}}(N,[null===(t=G.currentChannel)||void 0===t?void 0:t.url]),J=Z.scrollRef,$=Z.scrollPubSub,ee=Z.scrollDistanceFromBottomRef,te=Z.scrollPositionRef,ne=G.isScrollBottomReached,re=H_(null!=d?d:K.groupChannel.replyType).upperCase,ie=(a=null!=h?h:K.groupChannel.threadReplySelectType,{lowerCase:a.toLowerCase(),upperCase:a.toUpperCase()}).upperCase,ae=H_(null!=d?d:K.groupChannel.replyType).upperCase,se=gO({channel:G.currentChannel,config:K,moduleLevel:c}),oe=T_((function(){return"NONE"===ae?me.NONE:me.ONLY_REPLY_TO_CHANNEL})),le=N_(W.sdk,G.currentChannel,{startingPoint:T,replyType:oe,collectionCreator:kO(G.currentChannel,S),shouldCountNewMessages:function(){return!ne},markAsRead:function(e){ne&&!b&&e.forEach((function(e){return Y.push(e)}))},onMessagesReceived:function(e){ne&&oO()&&e.length!==G.messages.length&&setTimeout((function(){return z.scrollToBottom(!0)}),10)},onChannelDeleted:function(){z.setCurrentChannel(null),null==D||D()},onCurrentUserBanned:function(){z.setCurrentChannel(null),null==D||D()},onChannelUpdated:function(e){z.setCurrentChannel(e)},logger:Q});Pm((function(){return _(void 0,void 0,void 0,(function(){var e,t,n;return v(this,(function(r){switch(r.label){case 0:if(!W.initialized||!l)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,W.sdk.groupChannel.getChannel(l)];case 2:return e=r.sent(),z.setCurrentChannel(e),[3,4];case 3:return t=r.sent(),z.handleChannelError(t),null===(n=null==Q?void 0:Q.error)||void 0===n||n.call(Q,"GroupChannelProvider: error when fetching channel",t),[3,4];case 4:return[2]}}))}))}),[W.initialized,W.sdk,l]),s=function(){return _(void 0,void 0,void 0,(function(){var e,t;return v(this,(function(n){return le.initialized&&z.scrollToBottom(),e=function(e){var t;e.channel.url===(null===(t=G.currentChannel)||void 0===t?void 0:t.url)&&z.scrollToBottom(!0)},void 0===(null==X?void 0:X.subscribe)?[2]:(t=[K.pubSub.subscribe(yO.SEND_USER_MESSAGE,e),K.pubSub.subscribe(yO.SEND_FILE_MESSAGE,e)],[2,function(){t.forEach((function(e){return e.remove()}))}])}))}))},o=[le.initialized,null===(n=G.currentChannel)||void 0===n?void 0:n.url],Object(i.useLayoutEffect)(Bm(s),o),Object(i.useEffect)((function(){"number"==typeof T&&z.scrollToMessage(T,0,!1,!1)}),[T]),Object(i.useEffect)((function(){I&&z.setAnimatedMessageId(I)}),[I]);var ue=Object(i.useMemo)((function(){return{onBeforeSendUserMessage:w,onBeforeSendFileMessage:A,onBeforeSendVoiceMessage:M,onBeforeSendMultipleFilesMessage:O,onBeforeUpdateUserMessage:R,onBeforeDownloadFileMessage:k,onBackClick:D,onChatHeaderActionClick:U,onReplyInThreadClick:L,onSearchClick:P,onQuoteMessageClick:F,onMessageAnimated:x}}),[w,A,M,O,R,k,D,U,L,P,F,x]),ce=Object(i.useMemo)((function(){return{renderUserMentionItem:B,filterEmojiCategoryIds:j}}),[B,j]),de=Object(i.useMemo)((function(){return{isReactionEnabled:se,isMessageGroupingEnabled:p,isMultipleFilesMessageEnabled:g,replyType:re,threadReplySelectType:ie,showSearchIcon:null!=E?E:K.groupChannelSettings.enableMessageSearch,disableMarkAsRead:b,scrollBehavior:N}}),[se,p,g,re,ie,E,b,N,K.groupChannelSettings.enableMessageSearch]),he=Object(i.useMemo)((function(){return{scrollRef:J,scrollPubSub:$,scrollDistanceFromBottomRef:ee,scrollPositionRef:te,isScrollBottomReached:ne}}),[J,$,ee,te,ne]);return AM((function(){V(m(m(m(m(m({channelUrl:l,currentChannel:G.currentChannel},de),he),ue),ce),le))}),[l,null===(r=G.currentChannel)||void 0===r?void 0:r.serialize(),de,he,ue,ce,le.initialized,le.loading,le.messages.map((function(e){return e.serialize()}))]),u},MO=function(e){return a.a.createElement(wO,m({},e),a.a.createElement(AO,m({},e),a.a.createElement(XM,m({},e),e.children)))},OO=function(){return Xb(SO,(function(e){return e}),IO)},RO=function(){var e=CO(),t=e.state,n=e.actions;return m(m({},t),n)};function kO(e,t){return function(n){var r=m(m(m({},n),{prevResultLimit:30,nextResultLimit:30}),t);return e.createMessageCollection(m(m({},r),{filter:new Kd(r)}))}}var xO,DO,UO=function(e){var t,n=e.members;return a.a.createElement(a.a.Fragment,null,(t=Object(i.useContext)(XC).stringSet,n&&0!==n.length?n&&1===n.length?"".concat(n[0].nickname," ").concat(t.TYPING_INDICATOR__IS_TYPING):n&&2===n.length?"".concat(n[0].nickname," ").concat(t.TYPING_INDICATOR__AND," ").concat(n[1].nickname," ").concat(t.TYPING_INDICATOR__ARE_TYPING):t.TYPING_INDICATOR__MULTIPLE_TYPING:""))},LO=function(e){var t,n,r,s=e.channelUrl,o=IC().state,l=null===(n=null===(t=null==o?void 0:o.stores)||void 0===t?void 0:t.sdkStore)||void 0===n?void 0:n.sdk,u=null===(r=null==o?void 0:o.config)||void 0===r?void 0:r.logger,c=Object(i.useState)(ZS()),d=c[0],h=c[1],f=Object(i.useState)([]),p=f[0],m=f[1];return Object(i.useEffect)((function(){var e;if(null===(e=null==l?void 0:l.groupChannel)||void 0===e?void 0:e.addGroupChannelHandler){l.groupChannel.removeGroupChannelHandler(d);var t=ZS(),n=new Om({onTypingStatusUpdated:function(e){if(u.info("Channel > Typing Indicator: onTypingStatusUpdated",e),e.url===s){var t=e.getTypingUsers();m(t)}}});l.groupChannel.addGroupChannelHandler(t,n),h(t)}return function(){var e;m([]),(null===(e=null==l?void 0:l.groupChannel)||void 0===e?void 0:e.removeGroupChannelHandler)&&l.groupChannel.removeGroupChannelHandler(d)}}),[s]),a.a.createElement(_N,{className:"sendbird-conversation__footer__typing-indicator__text",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},a.a.createElement(UO,{members:p}))};function PO(){var e=Object(i.useContext)(XC).stringSet;return a.a.createElement("div",{className:"sendbird-connection-status"},a.a.createElement(_N,{type:vN.BODY_2,color:EN.ONBACKGROUND_2},e.TRYING_TO_CONNECT),a.a.createElement(YS,{type:QS.DISCONNECTED,fillColor:XS.SENT,width:"14px",height:"14px"}))}function FO(e){var t=e.className,n=void 0===t?"":t,r=e.width,i=void 0===r?"26px":r,s=e.height,o=void 0===s?"26px":s,l=e.children,u=e.testID;return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-loader"],!1).join(" "),"data-testid":u,style:{width:"string"==typeof i?i:"".concat(i,"px"),height:"string"==typeof o?o:"".concat(o,"px")}},l||a.a.createElement(YS,{type:QS.SPINNER,width:"26px",height:"26px"}))}(DO=xO||(xO={})).Text="text",DO.Bubble="bubble";var BO="LOADING",jO="NO_CHANNELS",HO="NO_MESSAGES",GO="WRONG",zO="SEARCH_IN",VO="SEARCHING",qO="NO_RESULTS";function KO(e){var t=e.className,n=void 0===t?"":t,r=e.type,s=e.iconSize,o=e.searchInString,l=void 0===o?"":o,u=e.retryToConnect,c=Object(i.useContext)(XC).stringSet;return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-place-holder"],!1).join(" ")},r===BO&&a.a.createElement(FO,{width:s||"48px",height:s||"48px"},a.a.createElement(YS,{type:QS.SPINNER,fillColor:XS.PRIMARY,width:s||"48px",height:s||"48px"})),(r===jO||r===HO||r===GO)&&a.a.createElement("div",{className:"sendbird-place-holder__body"},r===jO&&a.a.createElement(YS,{className:"sendbird-place-holder__body__icon",type:QS.CHAT,fillColor:XS.ON_BACKGROUND_3,width:s||"64px",height:s||"64px"}),r===GO&&a.a.createElement(YS,{className:"sendbird-place-holder__body__icon",type:QS.ERROR,fillColor:XS.ON_BACKGROUND_3,width:s||"64px",height:s||"64px"}),r===HO&&a.a.createElement(YS,{className:"sendbird-place-holder__body__icon",type:QS.MESSAGE,fillColor:XS.ON_BACKGROUND_3,width:s||"64px",height:s||"64px"}),a.a.createElement(_N,{className:"sendbird-place-holder__body__text",type:vN.BODY_1,color:EN.ONBACKGROUND_2},r===jO&&c.PLACE_HOLDER__NO_CHANNEL,r===GO&&c.PLACE_HOLDER__WRONG,r===HO&&c.PLACE_HOLDER__NO_MESSAGES),u&&a.a.createElement("div",{className:"sendbird-place-holder__body__reconnect",role:"button",onClick:u,onKeyPress:u,tabIndex:0},a.a.createElement(YS,{className:"sendbird-place-holder__body__reconnect__icon",type:QS.REFRESH,fillColor:XS.PRIMARY,width:"20px",height:"20px"}),a.a.createElement(_N,{className:"sendbird-place-holder__body__reconnect__text",type:vN.BUTTON_1,color:EN.PRIMARY},c.PLACE_HOLDER__RETRY_TO_CONNECT))),(r===qO||r===zO||r===VO)&&a.a.createElement("div",{className:"sendbird-place-holder__body--align-top"},r===zO&&a.a.createElement("div",{className:"sendbird-place-holder__body--align-top__text"},a.a.createElement(_N,{className:"sendbird-place-holder__body--align-top__text__search-in",type:vN.BUTTON_2,color:EN.ONBACKGROUND_2},c.SEARCH_IN),a.a.createElement(_N,{className:"sendbird-place-holder__body--align-top__text__channel-name",type:vN.BUTTON_2,color:EN.PRIMARY},"'".concat(l)),a.a.createElement(_N,{className:"sendbird-place-holder__body--align-top__text__quote",type:vN.BUTTON_2,color:EN.PRIMARY},"'")),r===VO&&a.a.createElement(_N,{className:"sendbird-place-hlder__body--align-top__searching",type:vN.BODY_1,color:EN.ONBACKGROUND_2},c.SEARCHING),r===qO&&a.a.createElement(_N,{className:"sendbird-place-hlder__body--align-top__no-result",type:vN.BODY_1,color:EN.ONBACKGROUND_2},c.NO_SEARCHED_MESSAGE)))}var WO=function(e){var t,n,r,i,s=e.isLoading,o=e.isInvalid,l=e.channelUrl,u=eN(e),c=u.renderChannelHeader,d=u.renderMessageList,h=u.renderMessageInput,f=u.renderTypingIndicator,p=u.renderPlaceholderLoader,m=u.renderPlaceholderInvalid,g=IC().state,_=g.stores,v=g.config,E=null===(t=null==_?void 0:_.sdkStore)||void 0===t?void 0:t.error,y=v.logger,b=v.isOnline;return s?a.a.createElement("div",{className:"sendbird-conversation"},(null==p?void 0:p())||a.a.createElement(KO,{type:BO})):l?o?a.a.createElement("div",{className:"sendbird-conversation"},(null==m?void 0:m())||a.a.createElement(KO,{type:GO})):E?a.a.createElement("div",{className:"sendbird-conversation"},(null==m?void 0:m())||a.a.createElement(KO,{type:GO,retryToConnect:function(){y.info("Channel: reconnecting")}})):a.a.createElement("div",{className:"sendbird-conversation"},null==c?void 0:c({className:"sendbird-conversation__channel-header"}),null==d?void 0:d(e),a.a.createElement("div",{className:"sendbird-conversation__footer"},null==h?void 0:h(),a.a.createElement("div",{className:"sendbird-conversation__footer__typing-indicator"},(null==f?void 0:f())||(null===(n=null==v?void 0:v.groupChannel)||void 0===n?void 0:n.enableTypingIndicator)&&(null===(i=null===(r=null==v?void 0:v.groupChannel)||void 0===r?void 0:r.typingIndicatorTypes)||void 0===i?void 0:i.has(xO.Text))&&a.a.createElement(LO,{channelUrl:l}),!b&&a.a.createElement(PO,null)))):a.a.createElement("div",{className:"sendbird-conversation"},(null==m?void 0:m())||a.a.createElement(KO,{type:jO}))},YO=function(e){if(null!==e)return"number"==typeof e?"".concat(e,"px"):e};function QO(e,t,n){var r;return"min(".concat(null!=t?t:n,", ").concat(null!==(r=YO(e))&&void 0!==r?r:n,")")}var XO=function(){var e=Object(i.useRef)(!1),t=function(){var e=Object(i.useState)(!1),t=e[0],n=e[1],r=Object(i.useState)(null),a=r[0],s=r[1],o=Object(i.useCallback)((function(e){null!==e&&s(e)}),[]);return Object(i.useEffect)((function(){if(a){var e=new IntersectionObserver((function(e){var t=e[0];n(t.isIntersecting)}));return e.observe(a),function(){e.disconnect()}}}),[a]),[o,t]}(),n=t[0];return t[1]&&(e.current=!0),[n,e.current]};function ZO(e,t){return void 0===e&&(e=!1),void 0===t&&(t=null),e?"50%":YO(t)}function JO(e,t,n){var r="string"==typeof e?parseInt(e,10):e,i=n-1,a=1===t?2*r:r,s=t===i?2*r:r,o=t===i-1?2*r:r;return"".concat(0===t?2*r:r,"px ").concat(a,"px ").concat(s,"px ").concat(o,"px")}var $O=function(e){var t,n=e.className,r=void 0===n?"":n,s=e.url,o=e.alt,l=void 0===o?"":o,u=e.width,c=void 0===u?null:u,d=e.maxSideLength,h=void 0===d?null:d,f=e.height,p=void 0===f?null:f,g=e.circle,_=void 0!==g&&g,v=e.fixedSize,y=void 0!==v&&v,b=e.placeHolder,C=void 0===b?null:b,N=e.defaultComponent,T=void 0===N?null:N,I=e.borderRadius,S=void 0===I?null:I,w=e.onLoad,A=void 0===w?$C:w,M=e.onError,O=void 0===M?$C:M,R=e.shadeOnHover,k=e.isUploaded,x=void 0===k||k,D=XO(),U=D[0],L=D[1]?s:null,P=Object(i.useState)(!1),F=P[0],B=P[1],j=Object(i.useState)(!0),H=j[0],G=j[1],z=function(e){var t=e.width,n=e.height,r=e.maxSideLength,a=e.defaultMinLength;return[Object(i.useMemo)((function(){return QO(t,r,a)}),[t]),Object(i.useMemo)((function(){return QO(n,r,a)}),[n])]}({width:c,height:p,maxSideLength:h,defaultMinLength:"400px"}),V=z[0],q=z[1];return V&&q&&a.a.createElement("div",{ref:U,className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-image-renderer"],!1).join(" "),style:{width:"100%",minWidth:V,maxWidth:y?V:"400px",height:q}},H&&("function"==typeof C?C({style:{width:"100%",minWidth:V,maxWidth:y?V:"400px",height:q,position:"absolute",display:"flex",justifyContent:"center",alignItems:"center"}}):C),!L||F?"function"==typeof T?T():T:(t=L?{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:"url(".concat(L,")")}:{},a.a.createElement("div",{className:"sendbird-image-renderer__image",style:m({width:"100%",minWidth:V,maxWidth:y?V:"400px",height:q,position:"absolute",borderRadius:ZO(_,S)},t)})),R&&a.a.createElement("div",{className:"sendbird-multiple-files-image-renderer__image-cover",style:m({borderRadius:ZO(_,S)},x?{}:{display:"inline-flex"})}),L&&a.a.createElement(eR,{src:L,alt:l,onLoadStart:function(){G(!0),B(!1)},onLoad:function(){G(!1),B(!1),A()},onError:function(){G(!1),B(!0),O()}}))},eR=function(e){var t=e.src,n=e.alt,r=e.onLoadStart,s=void 0===r?$C:r,o=e.onLoad,l=void 0===o?$C:o,u=e.onError,c=void 0===u?$C:u,d=Object(i.useRef)({currSrc:t,prevSrc:t,loadFailure:!1});return d.current.currSrc!==t&&(d.current.prevSrc=d.current.currSrc,d.current.currSrc=t),Object(i.useLayoutEffect)((function(){if(t){var e=d.current.prevSrc!==d.current.currSrc,n=d.current.loadFailure;(e||n)&&s()}}),[t,navigator.onLine]),a.a.createElement("img",{className:"sendbird-image-renderer__hidden-image-loader",src:t,alt:n,onLoad:function(){d.current.loadFailure=!1,l()},onError:function(){d.current.loadFailure=!0,c()}})},tR=function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=Number.parseFloat(e);if(!Number.isNaN(t))return t}return NaN},nR=function(e){var t=e.width,n=e.height,r=e.text,i=tR(t),s=tR(n);return"number"!=typeof i||Number.isNaN(i)||(i*=.575),"number"!=typeof s||Number.isNaN(s)||(s*=.575),a.a.createElement("div",{className:nN("sendbird-avatar-img--default",r&&"text"),style:{width:t,height:n}},r?a.a.createElement("div",{className:"sendbird-avatar-text"},r):a.a.createElement(YS,{type:QS.USER,fillColor:XS.CONTENT,width:i,height:s}))},rR=function(e){var t=e.src,n=void 0===t?"":t,r=e.alt,i=void 0===r?"":r,s=e.height,o=e.width,l=e.customDefaultComponent,u=function(){return l?l({width:o,height:s}):a.a.createElement(nR,{width:o,height:s})};return"string"==typeof n?a.a.createElement($O,{className:"sendbird-avatar-img",url:n,height:s,width:o,alt:i,defaultComponent:u}):n&&n.length?1===n.length?a.a.createElement($O,{className:"sendbird-avatar-img",url:n[0],height:s,width:o,alt:i,defaultComponent:u}):2===n.length?a.a.createElement("div",{className:"sendbird-avatar--inner__two-child"},a.a.createElement($O,{className:"sendbird-avatar-img",url:n[0],height:s,width:o,alt:i,defaultComponent:u}),a.a.createElement($O,{className:"sendbird-avatar-img",url:n[1],height:s,width:o,alt:i,defaultComponent:u})):3===n.length?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"sendbird-avatar--inner__three-child--upper"},a.a.createElement($O,{className:"sendbird-avatar-img",url:n[0],height:s,width:o,alt:i,defaultComponent:u})),a.a.createElement("div",{className:"sendbird-avatar--inner__three-child--lower"},a.a.createElement($O,{className:"sendbird-avatar-img",url:n[1],height:s,width:o,alt:i,defaultComponent:u}),a.a.createElement($O,{className:"sendbird-avatar-img",url:n[2],height:s,width:o,alt:i,defaultComponent:u}))):a.a.createElement("div",{className:"sendbird-avatar--inner__four-child"},n.slice(0,4).map((function(e,t){return a.a.createElement($O,{className:"sendbird-avatar-img",url:e,height:s,width:o,alt:i,key:"".concat(e,"-").concat(t),defaultComponent:u})}))):a.a.createElement($O,{className:"sendbird-avatar-img",url:"",height:s,width:o,alt:i,defaultComponent:u})};var iR=a.a.forwardRef((function(e,t){var n=e.className,r=void 0===n?"":n,i=e.src,s=void 0===i?"":i,o=e.alt,l=void 0===o?"":o,u=e.width,c=void 0===u?"56px":u,d=e.height,h=void 0===d?"56px":d,f=e.zIndex,p=void 0===f?0:f,m=e.left,g=void 0===m?"":m,_=e.bottom,v=void 0===_?"":_,y=e.onClick,b=e.customDefaultComponent;return a.a.createElement("div",{className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-avatar"],!1).join(" "),role:"button",ref:t,style:{height:h,width:c,zIndex:p,left:g,bottom:v},onClick:y,onKeyDown:y,tabIndex:0},a.a.createElement(rR,{src:s,width:c,height:h,alt:l,customDefaultComponent:b}))})),aR=function(e,t){return(null==e?void 0:e.coverUrl)&&!new RegExp("^".concat("https://static.sendbird.com/sample/cover/cover_")).test(e.coverUrl)?e.coverUrl:((null==e?void 0:e.members)||[]).filter((function(e){return e.userId!==t})).map((function(e){return e.profileUrl}))};function sR(e){var t=e.channel,n=e.userId,r=e.theme,s=e.width,o=void 0===s?56:s,l=e.height,u=void 0===l?56:l,c=null==t?void 0:t.isBroadcast,d=Object(i.useMemo)((function(){return c?function(e){return!(null==e?void 0:e.coverUrl)||!!new RegExp("^".concat("https://static.sendbird.com/sample/cover/cover_")).test(e.coverUrl)}(t)?a.a.createElement("div",{className:"sendbird-chat-header--default-avatar",style:{width:o,height:u,display:"flex",justifyContent:"center",alignItems:"center"}},a.a.createElement(YS,{type:QS.BROADCAST,fillColor:XS.CONTENT,width:.575*o,height:.575*u})):a.a.createElement(iR,{className:"sendbird-chat-header--avatar--broadcast-channel",src:aR(t,n),width:o,height:u,alt:null==t?void 0:t.name}):a.a.createElement(iR,{className:"sendbird-chat-header--avatar--group-channel",src:aR(t,n),width:"".concat(o,"px"),height:"".concat(u,"px"),alt:null==t?void 0:t.name})}),[aR(t,n),r]);return a.a.createElement(a.a.Fragment,null,d)}var oR,lR;(lR=oR||(oR={})).ONBACKGROUND_1="ONBACKGROUND_1",lR.ONBACKGROUND_2="ONBACKGROUND_2",lR.ONBACKGROUND_3="ONBACKGROUND_3",lR.ONBACKGROUND_4="ONBACKGROUND_4",lR.ONCONTENT_1="ONCONTENT_1",lR.PRIMARY="PRIMARY",lR.ERROR="ERROR";var uR=function(e){switch(e){case oR.ONBACKGROUND_1:return"sendbird-color--onbackground-1";case oR.ONBACKGROUND_2:return"sendbird-color--onbackground-2";case oR.ONBACKGROUND_3:return"sendbird-color--onbackground-3";case oR.ONBACKGROUND_4:return"sendbird-color--onbackground-4";case oR.ONCONTENT_1:return"sendbird-color--oncontent-1";case oR.PRIMARY:return"sendbird-color--primary";case oR.ERROR:return"sendbird-color--error";default:return""}},cR=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?oR.ONBACKGROUND_1:r,s=e.disabled,o=void 0!==s&&s,l=e.disableUnderline,u=void 0!==l&&l,c=e.onClick,d=void 0===c?function(){}:c,h=e.children;return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),[uR(i),u?"sendbird-textbutton--not-underline":"sendbird-textbutton",o?"sendbird-textbutton--disabled":""],!1).join(" "),role:"button",tabIndex:0,onClick:function(e){return d(e)},onKeyPress:function(e){return d(e)}},h)},dR=function(e){var t=e.className,n=e.type,r=e.color,i=e.width,s=void 0===i?"22px":i,o=e.height,l=void 0===o?"22px":o,u=e.onClick,c=void 0===u?$C:u;return a.a.createElement(YS,{className:t,type:n,fillColor:r,width:s,height:l,onClick:function(e){return null==c?void 0:c(e)}})},hR=Object.assign((function(e){var t,n=e.className,r=e.renderLeft,i=e.renderRight,s=e.renderMiddle,o=!1;try{o=null===(t=null==oN?void 0:oN())||void 0===t?void 0:t.isMobile}catch(e){}return a.a.createElement("div",{className:nN("sendbird-ui-header",n),"data-testid":"sendbird-ui-header"},r?a.a.createElement("div",{className:nN("sendbird-ui-header__left",o?"sendbird-ui-header--is-mobile":"sendbird-ui-header--is-desktop")},null==r?void 0:r()):null,a.a.createElement("div",{className:"sendbird-ui-header__middle"},null==s?void 0:s()),i?a.a.createElement("div",{className:nN("sendbird-ui-header__right",o?"sendbird-ui-header--is-mobile":"sendbird-ui-header--is-desktop")},null==i?void 0:i()):null)}),{Title:function(e){var t=e.title,n=e.subtitle,r=e.onClickSubtitle;return a.a.createElement("div",{className:"sendbird-ui-header__middle"},t&&a.a.createElement(_N,{className:"sendbird-ui-header__middle__title",type:vN.H_2,color:EN.ONBACKGROUND_1},t),n&&(r?a.a.createElement(cR,{className:"sendbird-ui-header__middle__subtitle__container",onClick:r,disableUnderline:!0},a.a.createElement(_N,{className:"sendbird-ui-header__middle__subtitle",type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},n)):a.a.createElement(_N,{className:"sendbird-ui-header__middle__subtitle",type:vN.BODY_1,color:EN.ONBACKGROUND_2},n)))},IconButton:function(e){var t=e.className,n=e.onClick,r=e.type,i=e.color,s=e.width,o=void 0===s?"32px":s,l=e.height,u=void 0===l?"32px":l,c=e.renderIcon,d=void 0===c?function(e){return a.a.createElement(dR,m({},e))}:c;return a.a.createElement(lN,{className:t,width:o,height:u,onClick:n},d({type:r,color:i}))},Icon:dR}),fR=function(e){var t=e.className,n=e.currentChannel,r=e.showSearchIcon,i=e.onBackClick,s=e.onSearchClick,o=e.onChatHeaderActionClick,l=e.renderLeft,u=e.renderMiddle,c=e.renderRight,d=IC().state.config,h=d.userId,f=d.theme,p=oN().isMobile,g=JC().stringSet,_="muted"===(null==n?void 0:n.myMutedState),v=function(e,t,n){var r,i=n||yN;return(null==e?void 0:e.name)||(null==e?void 0:e.members)?uM(e)?1===(null===(r=null==e?void 0:e.members)||void 0===r?void 0:r.length)?i.NO_MEMBERS:null==e?void 0:e.members.filter((function(e){return e.userId!==t})).map((function(e){return e.nickname||i.NO_NAME})).join(", "):e.name:i.NO_TITLE}(n,h,g);return a.a.createElement(hR,{className:nN("sendbird-chat-header",t),renderLeft:null!=l?l:function(){return a.a.createElement(a.a.Fragment,null,p&&a.a.createElement(hR.Icon,{className:"sendbird-chat-header__icon_back",onClick:i,type:QS.ARROW_LEFT,color:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(sR,{theme:f,channel:n,userId:h,height:32,width:32}))},renderMiddle:null!=u?u:function(){return a.a.createElement(hR.Title,{title:v})},renderRight:null!=c?c:function(){return a.a.createElement(a.a.Fragment,null,_&&a.a.createElement(hR.Icon,{className:"sendbird-chat-header__right__mute",type:QS.NOTIFICATIONS_OFF_FILLED,color:XS.ON_BACKGROUND_2,width:"24px",height:"24px"}),r&&!(null==n?void 0:n.isEphemeral)&&a.a.createElement(hR.IconButton,{className:"sendbird-chat-header__right__search",onClick:s,type:QS.SEARCH,color:XS.PRIMARY,renderIcon:function(e){return a.a.createElement(hR.Icon,m({},e,{width:"24px",height:"24px"}))}}),a.a.createElement(hR.IconButton,{className:"sendbird-chat-header__right__info",onClick:o,type:QS.INFO,color:XS.PRIMARY,renderIcon:function(e){return a.a.createElement(hR.Icon,m({},e,{width:"24px",height:"24px"}))}}))}})},pR=function(e){var t=RO();return a.a.createElement(fR,m({},e,t,{currentChannel:t.currentChannel}))};function mR(e){return pA(1,arguments),e instanceof Date||"object"===fA(e)&&"[object Date]"===Object.prototype.toString.call(e)}function gR(e){if(pA(1,arguments),!mR(e)&&"number"!=typeof e)return!1;var t=mA(e);return!isNaN(Number(t))}function _R(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function vR(e,t){pA(2,arguments);var n=mA(e).getTime(),r=_R(t);return new Date(n+r)}function ER(e,t){pA(2,arguments);var n=_R(t);return vR(e,-n)}function yR(e){pA(1,arguments);var t=1,n=mA(e),r=n.getUTCDay(),i=(r<t?7:0)+r-t;return n.setUTCDate(n.getUTCDate()-i),n.setUTCHours(0,0,0,0),n}function bR(e){pA(1,arguments);var t=mA(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=yR(r),a=new Date(0);a.setUTCFullYear(n,0,4),a.setUTCHours(0,0,0,0);var s=yR(a);return t.getTime()>=i.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}function CR(e){pA(1,arguments);var t=bR(e),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var r=yR(n);return r}var NR={};function TR(){return NR}function IR(e,t){var n,r,i,a,s,o,l,u;pA(1,arguments);var c=TR(),d=_R(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.weekStartsOn)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(o=s.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==i?i:c.weekStartsOn)&&void 0!==r?r:null===(l=c.locale)||void 0===l||null===(u=l.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==n?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=mA(e),f=h.getUTCDay(),p=(f<d?7:0)+f-d;return h.setUTCDate(h.getUTCDate()-p),h.setUTCHours(0,0,0,0),h}function SR(e,t){var n,r,i,a,s,o,l,u;pA(1,arguments);var c=mA(e),d=c.getUTCFullYear(),h=TR(),f=_R(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(o=s.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==i?i:h.firstWeekContainsDate)&&void 0!==r?r:null===(l=h.locale)||void 0===l||null===(u=l.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==n?n:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(d+1,0,f),p.setUTCHours(0,0,0,0);var m=IR(p,t),g=new Date(0);g.setUTCFullYear(d,0,f),g.setUTCHours(0,0,0,0);var _=IR(g,t);return c.getTime()>=m.getTime()?d+1:c.getTime()>=_.getTime()?d:d-1}function wR(e,t){var n,r,i,a,s,o,l,u;pA(1,arguments);var c=TR(),d=_R(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(o=s.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==i?i:c.firstWeekContainsDate)&&void 0!==r?r:null===(l=c.locale)||void 0===l||null===(u=l.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==n?n:1),h=SR(e,t),f=new Date(0);f.setUTCFullYear(h,0,d),f.setUTCHours(0,0,0,0);var p=IR(f,t);return p}function AR(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var MR=function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return AR("yy"===t?r%100:r,t.length)},OR=function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):AR(n+1,2)},RR=function(e,t){return AR(e.getUTCDate(),t.length)},kR=function(e,t){return AR(e.getUTCHours()%12||12,t.length)},xR=function(e,t){return AR(e.getUTCHours(),t.length)},DR=function(e,t){return AR(e.getUTCMinutes(),t.length)},UR=function(e,t){return AR(e.getUTCSeconds(),t.length)},LR=function(e,t){var n=t.length,r=e.getUTCMilliseconds();return AR(Math.floor(r*Math.pow(10,n-3)),t.length)},PR="midnight",FR="noon",BR="morning",jR="afternoon",HR="evening",GR="night",zR={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return MR(e,t)},Y:function(e,t,n,r){var i=SR(e,r),a=i>0?i:1-i;return"YY"===t?AR(a%100,2):"Yo"===t?n.ordinalNumber(a,{unit:"year"}):AR(a,t.length)},R:function(e,t){return AR(bR(e),t.length)},u:function(e,t){return AR(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return AR(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return AR(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return OR(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return AR(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var i=function(e,t){pA(1,arguments);var n=mA(e),r=IR(n,t).getTime()-wR(n,t).getTime();return Math.round(r/6048e5)+1}(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):AR(i,t.length)},I:function(e,t,n){var r=function(e){pA(1,arguments);var t=mA(e),n=yR(t).getTime()-CR(t).getTime();return Math.round(n/6048e5)+1}(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):AR(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):RR(e,t)},D:function(e,t,n){var r=function(e){pA(1,arguments);var t=mA(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),i=n-r;return Math.floor(i/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):AR(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var i=e.getUTCDay(),a=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return AR(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var i=e.getUTCDay(),a=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return AR(a,t.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),i=0===r?7:r;switch(t){case"i":return String(i);case"ii":return AR(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,i=e.getUTCHours();switch(r=12===i?FR:0===i?PR:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,i=e.getUTCHours();switch(r=i>=17?HR:i>=12?jR:i>=4?BR:GR,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return kR(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):xR(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):AR(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):AR(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):DR(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):UR(e,t)},S:function(e,t){return LR(e,t)},X:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return qR(i);case"XXXX":case"XX":return KR(i);case"XXXXX":case"XXX":default:return KR(i,":")}},x:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return qR(i);case"xxxx":case"xx":return KR(i);case"xxxxx":case"xxx":default:return KR(i,":")}},O:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+VR(i,":");case"OOOO":default:return"GMT"+KR(i,":")}},z:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+VR(i,":");case"zzzz":default:return"GMT"+KR(i,":")}},t:function(e,t,n,r){var i=r._originalDate||e;return AR(Math.floor(i.getTime()/1e3),t.length)},T:function(e,t,n,r){return AR((r._originalDate||e).getTime(),t.length)}};function VR(e,t){var n=e>0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),a=r%60;if(0===a)return n+String(i);var s=t;return n+String(i)+s+AR(a,2)}function qR(e,t){return e%60==0?(e>0?"-":"+")+AR(Math.abs(e)/60,2):KR(e,t)}function KR(e,t){var n=t||"",r=e>0?"-":"+",i=Math.abs(e);return r+AR(Math.floor(i/60),2)+n+AR(i%60,2)}var WR=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},YR=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},QR={p:YR,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],i=r[1],a=r[2];if(!a)return WR(e,t);switch(i){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;case"PPPP":default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",WR(i,t)).replace("{{time}}",YR(a,t))}};function XR(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}var ZR=["D","DD"],JR=["YY","YYYY"];function $R(e){return-1!==ZR.indexOf(e)}function ek(e){return-1!==JR.indexOf(e)}function tk(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var nk=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rk=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ik=/^'([^]*?)'?$/,ak=/''/g,sk=/[a-zA-Z]/;function ok(e,t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,g,_,v,E,y;pA(2,arguments);var b=String(t),C=TR(),N=null!==(r=null!==(i=null==n?void 0:n.locale)&&void 0!==i?i:C.locale)&&void 0!==r?r:YC,T=_R(null!==(a=null!==(s=null!==(o=null!==(l=null==n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null==n||null===(u=n.locale)||void 0===u||null===(c=u.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:C.firstWeekContainsDate)&&void 0!==s?s:null===(d=C.locale)||void 0===d||null===(h=d.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==a?a:1);if(!(T>=1&&T<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var I=_R(null!==(f=null!==(p=null!==(m=null!==(g=null==n?void 0:n.weekStartsOn)&&void 0!==g?g:null==n||null===(_=n.locale)||void 0===_||null===(v=_.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==m?m:C.weekStartsOn)&&void 0!==p?p:null===(E=C.locale)||void 0===E||null===(y=E.options)||void 0===y?void 0:y.weekStartsOn)&&void 0!==f?f:0);if(!(I>=0&&I<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!N.localize)throw new RangeError("locale must contain localize property");if(!N.formatLong)throw new RangeError("locale must contain formatLong property");var S=mA(e);if(!gR(S))throw new RangeError("Invalid time value");var w=XR(S),A=ER(S,w),M={firstWeekContainsDate:T,weekStartsOn:I,locale:N,_originalDate:S},O=b.match(rk).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,QR[t])(e,N.formatLong):e})).join("").match(nk).map((function(r){if("''"===r)return"'";var i=r[0];if("'"===i)return lk(r);var a=zR[i];if(a)return null!=n&&n.useAdditionalWeekYearTokens||!ek(r)||tk(r,t,String(e)),null!=n&&n.useAdditionalDayOfYearTokens||!$R(r)||tk(r,t,String(e)),a(A,r,N.localize,M);if(i.match(sk))throw new RangeError("Format string contains an unescaped latin alphabet character `"+i+"`");return r})).join("");return O}function lk(e){var t=e.match(ik);return t?t[1].replace(ak,"'"):e}function uk(e){if(e){var t=e.querySelectorAll("[data-sb-mention='true']");return Array.from(t)}return[]}function ck(e,t){var n=e.ref,r=t.logger,a=n.current,s=Object(i.useState)([]),o=s[0],l=s[1];return Object(i.useLayoutEffect)((function(){if(a){var e=uk(a);l(e)}}),[a]),Object(i.useEffect)((function(){var e=new MutationObserver((function(e){e.length>0&&l(uk(a))}));return a&&e.observe(a,{childList:!0,subtree:!0}),function(){try{e.disconnect()}catch(t){r.error("useDirtyGetMentions: observer disconnect failed",{observer:e})}}}),[a]),o}var dk=function(e){var t=e.children,n=void 0===t?void 0:t,r=e.className,i=void 0===r?"":r,s=e.separatorColor,o=void 0===s?oR.ONBACKGROUND_4:s;return a.a.createElement("div",{className:E(E([],Array.isArray(i)?i:[i],!0),["sendbird-separator"],!1).join(" ")},a.a.createElement("div",{className:["sendbird-separator__left","".concat(uR(o),"--background-color")].join(" ")}),a.a.createElement("div",{className:"sendbird-separator__text"},n||a.a.createElement(_N,{type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},"Date Separator")),a.a.createElement("div",{className:["sendbird-separator__right","".concat(uR(o),"--background-color")].join(" ")}))},hk="Enter",fk="ArrowUp",pk="ArrowDown",mk="Backspace",gk=1,_k=3,vk="SPAN",Ek="BR",yk="DIV";
/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */
const{entries:bk,setPrototypeOf:Ck,isFrozen:Nk,getPrototypeOf:Tk,getOwnPropertyDescriptor:Ik}=Object;let{freeze:Sk,seal:wk,create:Ak}=Object,{apply:Mk,construct:Ok}="undefined"!=typeof Reflect&&Reflect;Sk||(Sk=function(e){return e}),wk||(wk=function(e){return e}),Mk||(Mk=function(e,t,n){return e.apply(t,n)}),Ok||(Ok=function(e,t){return new e(...t)});const Rk=Kk(Array.prototype.forEach),kk=Kk(Array.prototype.lastIndexOf),xk=Kk(Array.prototype.pop),Dk=Kk(Array.prototype.push),Uk=Kk(Array.prototype.splice),Lk=Kk(String.prototype.toLowerCase),Pk=Kk(String.prototype.toString),Fk=Kk(String.prototype.match),Bk=Kk(String.prototype.replace),jk=Kk(String.prototype.indexOf),Hk=Kk(String.prototype.trim),Gk=Kk(Object.prototype.hasOwnProperty),zk=Kk(RegExp.prototype.test),Vk=(qk=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ok(qk,t)});var qk;function Kk(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Mk(e,t,r)}}function Wk(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lk;Ck&&Ck(e,null);let r=t.length;for(;r--;){let i=t[r];if("string"==typeof i){const e=n(i);e!==i&&(Nk(t)||(t[r]=e),i=e)}e[i]=!0}return e}function Yk(e){for(let t=0;t<e.length;t++){Gk(e,t)||(e[t]=null)}return e}function Qk(e){const t=Ak(null);for(const[n,r]of bk(e)){Gk(e,n)&&(Array.isArray(r)?t[n]=Yk(r):r&&"object"==typeof r&&r.constructor===Object?t[n]=Qk(r):t[n]=r)}return t}function Xk(e,t){for(;null!==e;){const n=Ik(e,t);if(n){if(n.get)return Kk(n.get);if("function"==typeof n.value)return Kk(n.value)}e=Tk(e)}return function(){return null}}const Zk=Sk(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Jk=Sk(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$k=Sk(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ex=Sk(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),tx=Sk(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),nx=Sk(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),rx=Sk(["#text"]),ix=Sk(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ax=Sk(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sx=Sk(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ox=Sk(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),lx=wk(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ux=wk(/<%[\w\W]*|[\w\W]*%>/gm),cx=wk(/\$\{[\w\W]*/gm),dx=wk(/^data-[\-\w.\u00B7-\uFFFF]+$/),hx=wk(/^aria-[\-\w]+$/),fx=wk(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),px=wk(/^(?:\w+script|data):/i),mx=wk(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),gx=wk(/^html$/i),_x=wk(/^[a-z][.\w]*(-[.\w]+)+$/i);var vx=Object.freeze({__proto__:null,ARIA_ATTR:hx,ATTR_WHITESPACE:mx,CUSTOM_ELEMENT:_x,DATA_ATTR:dx,DOCTYPE_NAME:gx,ERB_EXPR:ux,IS_ALLOWED_URI:fx,IS_SCRIPT_OR_DATA:px,MUSTACHE_EXPR:lx,TMPLIT_EXPR:cx});const Ex=1,yx=3,bx=7,Cx=8,Nx=9,Tx=function(){return"undefined"==typeof window?null:window},Ix=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;t&&t.hasAttribute("data-tt-policy-suffix")&&(n=t.getAttribute("data-tt-policy-suffix"));const r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};var Sx=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tx();const n=t=>e(t);if(n.version="3.2.4",n.removed=[],!t||!t.document||t.document.nodeType!==Nx||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const i=r,a=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:u,NodeFilter:c,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:p}=t,m=u.prototype,g=Xk(m,"cloneNode"),_=Xk(m,"remove"),v=Xk(m,"nextSibling"),E=Xk(m,"childNodes"),y=Xk(m,"parentNode");if("function"==typeof o){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let b,C="";const{implementation:N,createNodeIterator:T,createDocumentFragment:I,getElementsByTagName:S}=r,{importNode:w}=i;let A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof bk&&"function"==typeof y&&N&&void 0!==N.createHTMLDocument;const{MUSTACHE_EXPR:M,ERB_EXPR:O,TMPLIT_EXPR:R,DATA_ATTR:k,ARIA_ATTR:x,IS_SCRIPT_OR_DATA:D,ATTR_WHITESPACE:U,CUSTOM_ELEMENT:L}=vx;let{IS_ALLOWED_URI:P}=vx,F=null;const B=Wk({},[...Zk,...Jk,...$k,...tx,...rx]);let j=null;const H=Wk({},[...ix,...ax,...sx,...ox]);let G=Object.seal(Ak(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,V=null,q=!0,K=!0,W=!1,Y=!0,Q=!1,X=!0,Z=!1,J=!1,$=!1,ee=!1,te=!1,ne=!1,re=!0,ie=!1;const ae="user-content-";let se=!0,oe=!1,le={},ue=null;const ce=Wk({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const he=Wk({},["audio","video","img","source","image","track"]);let fe=null;const pe=Wk({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let ve=_e,Ee=!1,ye=null;const be=Wk({},[me,ge,_e],Pk);let Ce=Wk({},["mi","mo","mn","ms","mtext"]),Ne=Wk({},["annotation-xml"]);const Te=Wk({},["title","style","font","a","script"]);let Ie=null;const Se=["application/xhtml+xml","text/html"],we="text/html";let Ae=null,Me=null;const Oe=r.createElement("form"),Re=function(e){return e instanceof RegExp||e instanceof Function},ke=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Me||Me!==e){if(e&&"object"==typeof e||(e={}),e=Qk(e),Ie=-1===Se.indexOf(e.PARSER_MEDIA_TYPE)?we:e.PARSER_MEDIA_TYPE,Ae="application/xhtml+xml"===Ie?Pk:Lk,F=Gk(e,"ALLOWED_TAGS")?Wk({},e.ALLOWED_TAGS,Ae):B,j=Gk(e,"ALLOWED_ATTR")?Wk({},e.ALLOWED_ATTR,Ae):H,ye=Gk(e,"ALLOWED_NAMESPACES")?Wk({},e.ALLOWED_NAMESPACES,Pk):be,fe=Gk(e,"ADD_URI_SAFE_ATTR")?Wk(Qk(pe),e.ADD_URI_SAFE_ATTR,Ae):pe,de=Gk(e,"ADD_DATA_URI_TAGS")?Wk(Qk(he),e.ADD_DATA_URI_TAGS,Ae):he,ue=Gk(e,"FORBID_CONTENTS")?Wk({},e.FORBID_CONTENTS,Ae):ce,z=Gk(e,"FORBID_TAGS")?Wk({},e.FORBID_TAGS,Ae):{},V=Gk(e,"FORBID_ATTR")?Wk({},e.FORBID_ATTR,Ae):{},le=!!Gk(e,"USE_PROFILES")&&e.USE_PROFILES,q=!1!==e.ALLOW_ARIA_ATTR,K=!1!==e.ALLOW_DATA_ATTR,W=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Y=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Q=e.SAFE_FOR_TEMPLATES||!1,X=!1!==e.SAFE_FOR_XML,Z=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,ne=e.RETURN_TRUSTED_TYPE||!1,$=e.FORCE_BODY||!1,re=!1!==e.SANITIZE_DOM,ie=e.SANITIZE_NAMED_PROPS||!1,se=!1!==e.KEEP_CONTENT,oe=e.IN_PLACE||!1,P=e.ALLOWED_URI_REGEXP||fx,ve=e.NAMESPACE||_e,Ce=e.MATHML_TEXT_INTEGRATION_POINTS||Ce,Ne=e.HTML_INTEGRATION_POINTS||Ne,G=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Re(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Re(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(G.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Q&&(K=!1),te&&(ee=!0),le&&(F=Wk({},rx),j=[],!0===le.html&&(Wk(F,Zk),Wk(j,ix)),!0===le.svg&&(Wk(F,Jk),Wk(j,ax),Wk(j,ox)),!0===le.svgFilters&&(Wk(F,$k),Wk(j,ax),Wk(j,ox)),!0===le.mathMl&&(Wk(F,tx),Wk(j,sx),Wk(j,ox))),e.ADD_TAGS&&(F===B&&(F=Qk(F)),Wk(F,e.ADD_TAGS,Ae)),e.ADD_ATTR&&(j===H&&(j=Qk(j)),Wk(j,e.ADD_ATTR,Ae)),e.ADD_URI_SAFE_ATTR&&Wk(fe,e.ADD_URI_SAFE_ATTR,Ae),e.FORBID_CONTENTS&&(ue===ce&&(ue=Qk(ue)),Wk(ue,e.FORBID_CONTENTS,Ae)),se&&(F["#text"]=!0),Z&&Wk(F,["html","head","body"]),F.table&&(Wk(F,["tbody"]),delete z.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Vk('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Vk('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=e.TRUSTED_TYPES_POLICY,C=b.createHTML("")}else void 0===b&&(b=Ix(p,a)),null!==b&&"string"==typeof C&&(C=b.createHTML(""));Sk&&Sk(e),Me=e}},xe=Wk({},[...Jk,...$k,...ex]),De=Wk({},[...tx,...nx]),Ue=function(e){let t=y(e);t&&t.tagName||(t={namespaceURI:ve,tagName:"template"});const n=Lk(e.tagName),r=Lk(t.tagName);return!!ye[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===_e?"svg"===n:t.namespaceURI===me?"svg"===n&&("annotation-xml"===r||Ce[r]):Boolean(xe[n]):e.namespaceURI===me?t.namespaceURI===_e?"math"===n:t.namespaceURI===ge?"math"===n&&Ne[r]:Boolean(De[n]):e.namespaceURI===_e?!(t.namespaceURI===ge&&!Ne[r])&&(!(t.namespaceURI===me&&!Ce[r])&&(!De[n]&&(Te[n]||!xe[n]))):!("application/xhtml+xml"!==Ie||!ye[e.namespaceURI]))},Le=function(e){Dk(n.removed,{element:e});try{y(e).removeChild(e)}catch(t){_(e)}},Pe=function(e,t){try{Dk(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Dk(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{Le(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Fe=function(e){let t=null,n=null;if($)e="<remove></remove>"+e;else{const t=Fk(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===Ie&&ve===_e&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=b?b.createHTML(e):e;if(ve===_e)try{t=(new f).parseFromString(i,Ie)}catch(e){}if(!t||!t.documentElement){t=N.createDocument(ve,"template",null);try{t.documentElement.innerHTML=Ee?C:i}catch(e){}}const a=t.body||t.documentElement;return e&&n&&a.insertBefore(r.createTextNode(n),a.childNodes[0]||null),ve===_e?S.call(t,Z?"html":"body")[0]:Z?t.documentElement:a},Be=function(e){return T.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},je=function(e){return e instanceof h&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},He=function(e){return"function"==typeof l&&e instanceof l};function Ge(e,t,r){Rk(e,e=>{e.call(n,t,r,Me)})}const ze=function(e){let t=null;if(Ge(A.beforeSanitizeElements,e,null),je(e))return Le(e),!0;const r=Ae(e.nodeName);if(Ge(A.uponSanitizeElement,e,{tagName:r,allowedTags:F}),e.hasChildNodes()&&!He(e.firstElementChild)&&zk(/<[/\w]/g,e.innerHTML)&&zk(/<[/\w]/g,e.textContent))return Le(e),!0;if(e.nodeType===bx)return Le(e),!0;if(X&&e.nodeType===Cx&&zk(/<[/\w]/g,e.data))return Le(e),!0;if(!F[r]||z[r]){if(!z[r]&&qe(r)){if(G.tagNameCheck instanceof RegExp&&zk(G.tagNameCheck,r))return!1;if(G.tagNameCheck instanceof Function&&G.tagNameCheck(r))return!1}if(se&&!ue[r]){const t=y(e)||e.parentNode,n=E(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const i=g(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,v(e))}}}return Le(e),!0}return e instanceof u&&!Ue(e)?(Le(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!zk(/<\/no(script|embed|frames)/i,e.innerHTML)?(Q&&e.nodeType===yx&&(t=e.textContent,Rk([M,O,R],e=>{t=Bk(t,e," ")}),e.textContent!==t&&(Dk(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ge(A.afterSanitizeElements,e,null),!1):(Le(e),!0)},Ve=function(e,t,n){if(re&&("id"===t||"name"===t)&&(n in r||n in Oe))return!1;if(K&&!V[t]&&zk(k,t));else if(q&&zk(x,t));else if(!j[t]||V[t]){if(!(qe(e)&&(G.tagNameCheck instanceof RegExp&&zk(G.tagNameCheck,e)||G.tagNameCheck instanceof Function&&G.tagNameCheck(e))&&(G.attributeNameCheck instanceof RegExp&&zk(G.attributeNameCheck,t)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(t))||"is"===t&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&zk(G.tagNameCheck,n)||G.tagNameCheck instanceof Function&&G.tagNameCheck(n))))return!1}else if(fe[t]);else if(zk(P,Bk(n,U,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==jk(n,"data:")||!de[e]){if(W&&!zk(D,Bk(n,U,"")));else if(n)return!1}else;return!0},qe=function(e){return"annotation-xml"!==e&&Fk(e,L)},Ke=function(e){Ge(A.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||je(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:j,forceKeepAttr:void 0};let i=t.length;for(;i--;){const a=t[i],{name:s,namespaceURI:o,value:l}=a,u=Ae(s);let c="value"===s?l:Hk(l);if(r.attrName=u,r.attrValue=c,r.keepAttr=!0,r.forceKeepAttr=void 0,Ge(A.uponSanitizeAttribute,e,r),c=r.attrValue,!ie||"id"!==u&&"name"!==u||(Pe(s,e),c=ae+c),X&&zk(/((--!?|])>)|<\/(style|title)/i,c)){Pe(s,e);continue}if(r.forceKeepAttr)continue;if(Pe(s,e),!r.keepAttr)continue;if(!Y&&zk(/\/>/i,c)){Pe(s,e);continue}Q&&Rk([M,O,R],e=>{c=Bk(c,e," ")});const d=Ae(e.nodeName);if(Ve(d,u,c)){if(b&&"object"==typeof p&&"function"==typeof p.getAttributeType)if(o);else switch(p.getAttributeType(d,u)){case"TrustedHTML":c=b.createHTML(c);break;case"TrustedScriptURL":c=b.createScriptURL(c)}try{o?e.setAttributeNS(o,s,c):e.setAttribute(s,c),je(e)?Le(e):xk(n.removed)}catch(e){}}}Ge(A.afterSanitizeAttributes,e,null)},We=function e(t){let n=null;const r=Be(t);for(Ge(A.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Ge(A.uponSanitizeShadowNode,n,null),ze(n),Ke(n),n.content instanceof s&&e(n.content);Ge(A.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,a=null,o=null,u=null;if(Ee=!e,Ee&&(e="\x3c!--\x3e"),"string"!=typeof e&&!He(e)){if("function"!=typeof e.toString)throw Vk("toString is not a function");if("string"!=typeof(e=e.toString()))throw Vk("dirty is not a string, aborting")}if(!n.isSupported)return e;if(J||ke(t),n.removed=[],"string"==typeof e&&(oe=!1),oe){if(e.nodeName){const t=Ae(e.nodeName);if(!F[t]||z[t])throw Vk("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)r=Fe("\x3c!----\x3e"),a=r.ownerDocument.importNode(e,!0),a.nodeType===Ex&&"BODY"===a.nodeName||"HTML"===a.nodeName?r=a:r.appendChild(a);else{if(!ee&&!Q&&!Z&&-1===e.indexOf("<"))return b&&ne?b.createHTML(e):e;if(r=Fe(e),!r)return ee?null:ne?C:""}r&&$&&Le(r.firstChild);const c=Be(oe?e:r);for(;o=c.nextNode();)ze(o),Ke(o),o.content instanceof s&&We(o.content);if(oe)return e;if(ee){if(te)for(u=I.call(r.ownerDocument);r.firstChild;)u.appendChild(r.firstChild);else u=r;return(j.shadowroot||j.shadowrootmode)&&(u=w.call(i,u,!0)),u}let d=Z?r.outerHTML:r.innerHTML;return Z&&F["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&zk(gx,r.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+d),Q&&Rk([M,O,R],e=>{d=Bk(d,e," ")}),b&&ne?b.createHTML(d):d},n.setConfig=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ke(e),J=!0},n.clearConfig=function(){Me=null,J=!1},n.isValidAttribute=function(e,t,n){Me||ke({});const r=Ae(e),i=Ae(t);return Ve(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&Dk(A[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=kk(A[e],t);return-1===n?void 0:Uk(A[e],n,1)[0]}return xk(A[e])},n.removeHooks=function(e){A[e]=[]},n.removeAllHooks=function(){A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function wx(e){var t=e.userId,n=e.nickname,r='<span data-userid="'.concat(t,'" data-sb-mention="true" class="').concat("sendbird-mention-user-label",'">').concat(n,"</span>"),i=Sx(window).sanitize(r).split(" ");return E([i[0],'contenteditable="false"'],i.slice(1),!0).join(" ")}var Ax=function(e){return void 0===e&&(e=""),e?e.replace(/[<>]/g,(function(e){return"<"===e?"&#60;":"&#62;"})):""},Mx=function(e){return e?Array.from(e):[]};function Ox(e){var t;return e&&(null===(t=e.isGroupChannel)||void 0===t?void 0:t.call(e))&&!e.isBroadcast&&!e.isSuper}function Rx(e){return e.nodeType===gk}function kx(e){var t="",n="";return e.forEach((function(e){if(Rx(e)&&e.nodeName===vk){var r=e.innerText,i=e.dataset,a=(void 0===i?{}:i).userid,s=void 0===a?"":a;t+=r,n+="".concat("@","{").concat(s,"}")}else if(Rx(e)&&e.nodeName===Ek)t+="\n",n+="\n";else if(Rx(e)&&e.nodeName===yk){var o=e.textContent;t+="\n".concat(l=void 0===o?"":o),n+="\n".concat(l)}else{var l,u=e.textContent;t+=l=void 0===u?"":u,n+=l}})),{messageText:t,mentionTemplate:n}}var xx=".".concat("sendbird-word__mention",", .").concat("sendbird-mention-user-label");function Dx(e,t){return E([e],Array.from(e.querySelectorAll(t)),!0).find((function(e){return e.matches(t)}))}function Ux(e){var t=window.getSelection();if(t&&t.rangeCount>0){var n=t.getRangeAt(t.rangeCount-1);n.deleteContents();var r=document.createTextNode(e+"");n.insertNode(r),n.setStart(r,r.length),n.collapse(!0),t.removeAllRanges(),t.addRange(n)}}function Lx(e){var t=e.ref,n=e.setIsInput,r=e.channel,a=e.setMentionedUsers;return Object(i.useCallback)((function(e){e.preventDefault();var t=e.clipboardData.getData("text/html"),i=e.clipboardData.getData("text")||function(e){var t=e.clipboardData.getData("text/uri-list");return 0===t.length?"":t.split("\n").reduce((function(e,t){var n=t.trim();return""===n||n.startsWith("#")||(e+=n+"\n"),e}),"")}(e);if(!t)return Ux(Ax(i)),void n(!0);var s,o=function(e){var t=document.createElement("div");return t.innerHTML=e,t}(Sx(window).sanitize(t));if(!(null==(s=o)?void 0:s.querySelector(xx)))return Ux(Ax(i)),o.remove(),void n(!0);var l,u,c=function(e){var t=Dx(e,".".concat("sendbird-og-message-item-body__text-bubble"));if(t)return Mx(t.childNodes);var n=Dx(e,".".concat("sendbird-text-message-item-body"));return Mx(n?n.childNodes:e.childNodes)}(o),d=null==(l=c)?void 0:l.reduce((function(e,t){var n,r,i,a=null==t?void 0:t.innerText;if(t instanceof Text&&(i=!1,a=null!==(n=t.textContent)&&void 0!==n?n:""),t instanceof HTMLElement&&(i=t.classList.contains("sendbird-word__mention")||t.classList.contains("sendbird-mention-user-label")?t:t.querySelector(xx)),i){var s=null==t?void 0:t.innerText,o=null===(r=i.dataset)||void 0===r?void 0:r.userid;return E(E([],e,!0),[{text:s,userId:o}],!1)}return E(E([],e,!0),[{text:a}],!1)}),[]),h=r.isGroupChannel()?function(e,t){var n={},r=t.members;return e.forEach((function(e){if(e.userId){var t=r.find((function(t){return t.userId===e.userId}));t&&(n[e.userId]=t)}})),Object.values(n)}(d,r):[];a(h),u=d.map((function(e){var t=e.text,n=e.userId;return n?wx({userId:n,nickname:t}):Ax(t)})).join(" ").concat(" "),document.execCommand("insertHTML",!1,u),o.remove(),n(!0)}),[t,n,r,a])}var Px,Fx,Bx="string",jx="mention",Hx="url",Gx="undetermined",zx="markdown",Vx=/\[(.*?)\]\((.*?)\)|\*\*(.*?)\*\*/g;function qx(e){var t=e.tokens,n=e.mentionedUsers,r=void 0===n?[]:n,i=e.templatePrefix,a=void 0===i?"@":i;if(!(null==r?void 0:r.length))return t;var s=function(e,t){var n=t||"@";return RegExp("(".concat(e.map((function(e){var t=e.userId.replace(/([.*+?^${}()|[\]\\])/g,"\\$1");return"".concat(n,"\\{").concat(t,"\\}")})).join("|"),")"),"g")}(r,a);return t.map((function(e){return e.type!==Gx?e:e.value.split(s).map((function(e){if(e.match(s)){var t=r.find((function(t){return"@{".concat(null==t?void 0:t.userId,"}")===e}));return{value:(null==t?void 0:t.nickname)||"(No name)",type:jx,userId:null==t?void 0:t.userId}}return{value:e,type:Gx}}))})).flat()}function Kx(e){var t=[];return e.forEach((function(e){if(e.type!==jx&&e.type!==zx){var n=e.value,r=Array.from(n.matchAll(Vx)).map((function(e){var t,n=e[0],r=null!==(t=e.index)&&void 0!==t?t:0;return{text:n,start:r,end:r+n.length,groups:e.filter((function(e){return"string"==typeof e}))}})),i=n,a=0;if(r.forEach((function(e){var r,s=e.text,o=e.start,l=e.end,u=e.groups,c={type:Gx,value:i.slice(0,o-a)};t.push(c),s.startsWith("[")?r="url":s.startsWith("**")&&(r="bold");var d={type:zx,markdownType:r,value:s,groups:u};t.push(d),i=n.slice(l),a=l})),i){var s={type:Gx,value:i};t.push(s)}}else t.push(e)})),t}function Wx(e){return e.reduce((function(e,t){var n=e[e.length-1];return(null==n?void 0:n.type)===Bx&&t.type===Bx?(n.value="".concat(n.value).concat(t.value),e):E(E([],e,!0),[t],!1)}),[])}function Yx(e){var t,n,r=e.messageText,i=e.mentionedUsers,a=void 0===i?[]:i,s=e.templatePrefix,o=void 0===s?"@":s,l=e.includeMarkdown,u=void 0!==l&&l,c=qx({tokens:[{type:Gx,value:r}],mentionedUsers:a,templatePrefix:o});return Wx((t=u?Kx(c):c,n=/(?:https?:\/\/|www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.(xn--)?[a-z]{2,20}\b([-a-zA-Z0-9@:%_+[\],.~#?&/=]*[-a-zA-Z0-9@:%_+~#?&/=])*/g,t.map((function(e){if(e.type!==Gx)return e;var t=e.value,r=void 0===t?"":t,i=Array.from(r.matchAll(n)).map((function(e){var t,n=e[0],r=null!==(t=e.index)&&void 0!==t?t:0;return{text:n,start:r,end:r+n.length}})),a=[{value:r,type:Bx}],s=0;return i.forEach((function(e){var t=e.text,n=e.start,r=e.end,i=a.pop().value,o=i.slice(0,n-s),l=t,u=i.slice(r-s);o.length>0&&a.push({value:o,type:Bx}),a.push({value:l,type:Hx}),u.length>0&&a.push({value:u,type:Bx}),s=r})),a})).flat()))}function Qx(e){return function e(t){return t.map((function(t){return t.type===zx?e(Xx({messageText:t.groups[1]})):t.value})).join("")}(Kx([{type:Gx,value:e}]))}function Xx(e){var t=e.messageText;return Wx(Kx([{type:Gx,value:t}]))}(Fx=Px||(Px={})).BASE="base",Fx.GROUP="group",Fx.OPEN="open";var Zx=function(){return null},Jx=function(e){e&&e.current&&(e.current.innerHTML="")},$x={targetString:"",startNodeIndex:null,startOffsetIndex:null,endNodeIndex:null,endOffsetIndex:null},eD=a.a.forwardRef((function(e,t){var n,r,s,o,l,u=e.channel,c=e.className,d=void 0===c?"":c,h=e.messageFieldId,f=void 0===h?"":h,p=e.isEdit,g=void 0!==p&&p,_=e.isMobile,v=void 0!==_&&_,y=e.isMentionEnabled,b=void 0!==y&&y,C=e.isVoiceMessageEnabled,N=void 0===C||C,T=e.isSelectingMultipleFilesEnabled,I=void 0!==T&&T,S=e.disabled,w=void 0!==S&&S,A=e.message,M=void 0===A?null:A,O=e.placeholder,R=void 0===O?"":O,k=e.maxLength,x=void 0===k?5e3:k,D=e.onFileUpload,U=void 0===D?Zx:D,L=e.onSendMessage,P=void 0===L?Zx:L,F=e.onUpdateMessage,B=void 0===F?Zx:F,j=e.onCancelEdit,H=void 0===j?Zx:j,G=e.onStartTyping,z=void 0===G?Zx:G,V=e.channelUrl,q=void 0===V?"":V,K=e.mentionSelectedUser,W=void 0===K?null:K,Y=e.onUserMentioned,Q=void 0===Y?Zx:Y,X=e.onMentionStringChange,Z=void 0===X?Zx:X,J=e.onMentionedUserIdsUpdated,$=void 0===J?Zx:J,ee=e.onVoiceMessageIconClick,te=void 0===ee?Zx:ee,ne=e.onKeyUp,re=void 0===ne?Zx:ne,ie=e.onKeyDown,ae=void 0===ie?Zx:ie,se=e.renderFileUploadIcon,oe=void 0===se?Zx:se,le=e.renderVoiceMessageIcon,ue=void 0===le?Zx:le,ce=e.renderSendMessageIcon,de=void 0===ce?Zx:ce,he=e.setMentionedUsers,fe=void 0===he?Zx:he,pe=e.acceptableMimeTypes,me=t&&"current"in t?t:Object(i.useRef)(null),ge=Object(i.useRef)(null),_e=f||"sendbird-message-input-text-field",ve=JC().stringSet,Ee=IC().state,ye=Ee.config,be=Ee.eventHandlers,Ce=function(e){var t=e.channel,n=e.config;return fw(null==t?void 0:t.channelType).with(Px.GROUP,(function(){var e;return null===(e=null==n?void 0:n.groupChannel)||void 0===e?void 0:e.enableDocument})).with(Px.OPEN,(function(){var e;return null===(e=null==n?void 0:n.openChannel)||void 0===e?void 0:e.enableDocument})).otherwise((function(){return!0}))}({channel:u,config:ye}),Ne=Object(i.useRef)(),Te=Object(i.useState)(!1),Ie=Te[0],Se=Te[1],we=Object(i.useState)([]),Ae=we[0],Me=we[1],Oe=Object(i.useState)(m({},$x)),Re=Oe[0],ke=Oe[1],xe=null==e?void 0:e.value;Object(i.useEffect)((function(){var e=null==me?void 0:me.current;Me([]),Se(!!(null==e?void 0:e.textContent)&&e.textContent.trim().length>0)}),[xe]),Object(i.useEffect)((function(){g||(Se(!1),Jx(me))}),[q]),Object(i.useEffect)((function(){var e,t;if(g&&(null==M?void 0:M.messageId)){var n=null==me?void 0:me.current;if(b&&(null==M?void 0:M.mentionedUsers)&&M.mentionedUsers.length>0&&(null==M?void 0:M.mentionedMessageTemplate)&&M.mentionedMessageTemplate.length>0){var r=M.mentionedUsers,i=void 0===r?[]:r,a=Yx({messageText:null==M?void 0:M.mentionedMessageTemplate,mentionedUsers:i,includeMarkdown:u.isGroupChannel()&&ye.groupChannel.enableMarkdownForUserMessage});n&&(n.innerHTML=a.map((function(e){if(e.type===jx){var t=i.find((function(t){return t.userId===e.userId})),n="".concat("@").concat((null==t?void 0:t.nickname)||e.value||ve.MENTION_NAME__NO_NAME);return wx({userId:e.userId,nickname:n})}return Ax(e.value)})).join(""))}else{try{n&&(n.innerHTML=null!==(e=Ax(null==M?void 0:M.message))&&void 0!==e?e:"")}catch(e){}Me([])}Se(!!(null==n?void 0:n.textContent)&&(null===(t=null==n?void 0:n.textContent)||void 0===t?void 0:t.trim().length)>0)}}),[g,M]);var De=Object(i.useCallback)((function(){var e,t=null==me?void 0:me.current;if(b&&t){var n=Array.from(t.getElementsByClassName("sendbird-mention-user-label")).map((function(e){var t;return null===(t=null==e?void 0:e.dataset)||void 0===t?void 0:t.userid}));(function(e,t){if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1})(Ae,n)&&0!==n.length||($(n),Me(n))}Se(!!(null==t?void 0:t.textContent)&&(null===(e=t.textContent)||void 0===e?void 0:e.trim().length)>0)}),[Re,b]);Object(i.useEffect)((function(){var e,t,n,r;if(b&&W){var i=Re.targetString,a=Re.startNodeIndex,s=Re.startOffsetIndex,o=Re.endNodeIndex,l=Re.endOffsetIndex,u=null==me?void 0:me.current;if(i&&null!==a&&null!==s&&null!==l&&null!==o&&u){var c=Mx(null==u?void 0:u.childNodes),d=null!==(t=null===(e=c[a])||void 0===e?void 0:e.textContent)&&void 0!==t?t:"",h=document.createTextNode(d.slice(0,s)),f=null!==(r=null===(n=c[o])||void 0===n?void 0:n.textContent)&&void 0!==r?r:"",p=l&&document.createTextNode("".concat(f.slice(l))),g=wx({userId:null==W?void 0:W.userId,nickname:"".concat("@").concat((null==W?void 0:W.nickname)||ve.MENTION_NAME__NO_NAME)}),_=document.createElement("div");_.innerHTML=g;var v=E(E(E([],c.slice(0,a),!0),[h,_.childNodes[0],p],!1),c.slice(o+1),!0);if(u&&(u.innerHTML="",v.forEach((function(e){e&&u.appendChild(e)}))),Q(W),window.getSelection||document.getSelection){var y=window.getSelection()||document.getSelection();null==y||y.removeAllRanges();var C=new Range;C.selectNodeContents(u),C.setStart(u.childNodes[a+2],1),C.setEnd(u.childNodes[a+2],1),C.collapse(!1),null==y||y.addRange(C),u.focus()}ke(m({},$x)),De()}}}),[W,b]);var Ue=Object(i.useCallback)((function(){var e,t,n=(null===(e=null===window||void 0===window?void 0:window.getSelection)||void 0===e?void 0:e.call(window))||(null===(t=null===document||void 0===document?void 0:document.getSelection)||void 0===t?void 0:t.call(document)),r=null==me?void 0:me.current;if((null==n?void 0:n.anchorNode)===r&&Z(""),b&&r&&n&&n.anchorNode===n.focusNode&&n.anchorOffset===n.focusOffset)for(var i="",a=null,s=null,o=function(e){var t,o=r.childNodes[e];if(o.nodeType===_k){var l=o===n.anchorNode?(null==o?void 0:o.textContent)?null==o?void 0:o.textContent.slice(0,n.anchorOffset):"":null!==(t=null==o?void 0:o.textContent)&&void 0!==t?t:"";if(i.length>0)i+=l;else{for(var u=l.lastIndexOf("@"),c=u-1;c>-1&&"@"===l[c];c-=1)u=c;u>-1&&(i=l,a=e,s=u)}}else i="",a=null,s=null;if(o===n.anchorNode){var d=i&&null!==s?i.slice(s):"";return ke({targetString:d,startNodeIndex:a,startOffsetIndex:s,endNodeIndex:e,endOffsetIndex:n.anchorOffset}),Z(d),{value:void 0}}},l=0;l<r.childNodes.length;l+=1){var u=o(l);if("object"==typeof u)return u.value}}),[b]),Le=function(){var e,t;try{var n=null==me?void 0:me.current;if(!g&&(null==n?void 0:n.textContent)){var r=kx(n.childNodes),i=r.messageText,a=r.mentionTemplate;P({message:i,mentionTemplate:a}),Jx(me),K_(navigator.userAgent)?(ge.current&&ge.current.focus(),requestAnimationFrame((function(){return n.focus()}))):n.focus(),Se(!1)}}catch(n){null===(t=null===(e=null==be?void 0:be.message)||void 0===e?void 0:e.onSendMessageFailed)||void 0===t||t.call(e,M,n)}},Pe=!(null===(r=null===(n=null==me?void 0:me.current)||void 0===n?void 0:n.textContent)||void 0===r?void 0:r.trim()),Fe=Lx({ref:me,setMentionedUsers:fe,channel:u,setIsInput:Se}),Be=function(){var e,t=me,n=window.getSelection();if(n&&0!==n.rangeCount){var r=n.getRangeAt(n.rangeCount-1).getBoundingClientRect(),i=null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect();if(i&&t.current)if(r.bottom>i.bottom){var a=Math.min(r.bottom-i.bottom,t.current.scrollHeight-t.current.clientHeight);t.current.scrollTop+=a}else if(r.top<i.top){a=Math.min(i.top-r.top,t.current.scrollTop);t.current.scrollTop-=a}}};return a.a.createElement("form",{className:nN.apply(void 0,E(E([],Array.isArray(d)?d:[d],!1),[g&&"sendbird-message-input__edit",w&&"sendbird-message-input-form__disabled"],!1))},a.a.createElement("div",{className:nN("sendbird-message-input",w&&"sendbird-message-input__disabled"),"data-testid":"sendbird-message-input"},K_(navigator.userAgent)&&a.a.createElement("input",{id:"ghost-input-reset-ime-cjk",ref:ge,style:{opacity:0,padding:0,margin:0,height:0,border:"none",position:"absolute",top:-9999},defaultValue:"_"}),a.a.createElement("div",{id:"".concat(_e).concat(g?null==M?void 0:M.messageId:""),className:"sendbird-message-input--textarea ".concat(_e),contentEditable:!w,role:"textbox","aria-label":"Text Input",ref:me,disabled:w,maxLength:x,onKeyDown:function(e){var t,n,r,i;ae(e)?e.preventDefault():(!e.shiftKey&&e.key===hk&&!v&&(null===(t=null==me?void 0:me.current)||void 0===t?void 0:t.textContent)&&me.current.textContent.trim().length>0&&!0!==(null===(n=null==e?void 0:e.nativeEvent)||void 0===n?void 0:n.isComposing)&&(e.preventDefault(),Le()),e.key!==mk||2!==(null===(i=null===(r=null==me?void 0:me.current)||void 0===r?void 0:r.childNodes)||void 0===i?void 0:i.length)||me.current.childNodes[0].textContent||me.current.childNodes[1].nodeType!==gk||me.current.removeChild(me.current.childNodes[1]))},onKeyUp:function(e){re(e)?e.preventDefault():Ue()},onClick:function(){Ue()},onInput:function(){var e;z(),Se(!!(null===(e=null==me?void 0:me.current)||void 0===e?void 0:e.textContent)&&me.current.textContent.trim().length>0),De()},onPaste:function(e){Fe(e),setTimeout(Be)}}),0===(null!==(l=null===(o=null===(s=null==me?void 0:me.current)||void 0===s?void 0:s.textContent)||void 0===o?void 0:o.length)&&void 0!==l?l:0)&&a.a.createElement(_N,{className:"sendbird-message-input--placeholder",type:vN.BODY_1,color:w?EN.ONBACKGROUND_4:EN.ONBACKGROUND_3},R||ve.MESSAGE_INPUT__PLACE_HOLDER),!g&&Ie&&a.a.createElement(lN,{className:"sendbird-message-input--send",height:"32px",width:"32px",onClick:function(){return Le()},testID:"sendbird-message-input-send-button"},(null==de?void 0:de())||a.a.createElement(YS,{type:QS.SEND,fillColor:w?XS.ON_BACKGROUND_4:XS.PRIMARY,width:"20px",height:"20px"})),!g&&!Ie&&((null==oe?void 0:oe())||Ce&&a.a.createElement(lN,{className:nN("sendbird-message-input--attach",N&&"is-voice-message-enabled"),height:"32px",width:"32px",onClick:function(){var e,t;null===(t=null===(e=null==Ne?void 0:Ne.current)||void 0===e?void 0:e.click)||void 0===t||t.call(e)}},a.a.createElement(YS,{type:QS.ATTACH,fillColor:w?XS.ON_BACKGROUND_4:XS.CONTENT_INVERSE,width:"20px",height:"20px"}),a.a.createElement("input",{className:"sendbird-message-input--attach-input",type:"file",ref:Ne,onChange:function(e){return function(e){var t,n,r=e.currentTarget.files;try{r&&U(Array.from(r))}catch(e){null===(n=null===(t=null==be?void 0:be.message)||void 0===t?void 0:t.onFileUploadFailed)||void 0===n||n.call(t,e)}finally{e.target.value=""}}(e)},accept:vA(pe),multiple:I&&Ox(u)}))),N&&!g&&!Ie&&a.a.createElement(lN,{className:"sendbird-message-input--voice-message",width:"32px",height:"32px",onClick:te},(null==ue?void 0:ue())||a.a.createElement(YS,{type:QS.AUDIO_ON_LINED,fillColor:w?XS.ON_BACKGROUND_4:XS.CONTENT_INVERSE,width:"20px",height:"20px"}))),g&&a.a.createElement("div",{className:"sendbird-message-input--edit-action","data-testid":"sendbird-message-input--edit-action"},a.a.createElement(NN,{className:"sendbird-message-input--edit-action__cancel",type:fN.SECONDARY,size:mN.SMALL,onClick:H},ve.BUTTON__CANCEL),a.a.createElement(NN,{className:"sendbird-message-input--edit-action__save",type:fN.PRIMARY,size:mN.SMALL,disabled:Pe,onClick:function(){return function(){var e,t;try{var n=null==me?void 0:me.current,r=null==M?void 0:M.messageId;if(g&&r&&n){var i=kx(n.childNodes),a=i.messageText,s=i.mentionTemplate;B({messageId:r,message:a,mentionTemplate:s}),Jx(me)}}catch(n){null===(t=null===(e=null==be?void 0:be.message)||void 0===e?void 0:e.onUpdateMessageFailed)||void 0===t||t.call(e,M,n)}}()}},ve.BUTTON__SAVE)))}));function tD(e){pA(1,arguments);var t=mA(e);return t.setHours(0,0,0,0),t}function nD(e,t){pA(2,arguments);var n=tD(e),r=tD(t);return n.getTime()===r.getTime()}function rD(e,t){pA(2,arguments);var n=mA(e),r=mA(t);return n.getFullYear()===r.getFullYear()}function iD(e,t){pA(2,arguments);var n=mA(e),r=_R(t);return isNaN(r)?new Date(NaN):r?(n.setDate(n.getDate()+r),n):n}function aD(e,t){pA(2,arguments);var n=_R(t);return iD(e,-n)}var sD,oD,lD=function(e,t,n){var r;return void 0===n&&(n=yN),(null==e?void 0:e.name)||(null==e?void 0:e.members)?uM(e)?1===(null===(r=null==e?void 0:e.members)||void 0===r?void 0:r.length)?n.NO_MEMBERS:((null==e?void 0:e.members)||[]).filter((function(e){return e.userId!==t})).map((function(e){return e.nickname||n.NO_NAME})).join(", "):e.name:n.NO_TITLE},uD=function(e){var t,n=e.channel,r=e.locale,i=e.stringSet,a=void 0===i?yN:i,s=null===(t=null==n?void 0:n.lastMessage)||void 0===t?void 0:t.createdAt,o=r?{locale:r}:null;return s?function(e){return pA(1,arguments),nD(e,Date.now())}(s)?ok(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__TODAY,o):function(e){return pA(1,arguments),nD(e,aD(Date.now(),1))}(s)?a.MESSAGE_STATUS__YESTERDAY||"Yesterday":function(e){return pA(1,arguments),rD(e,Date.now())}(s)?ok(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__THIS_YEAR,o):ok(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__PREVIOUS_YEAR,o):""},cD=function(e,t){var n,r,i,a,s,o;return void 0===t&&(t=yN),NA(e)?null!==(n=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GIF)&&void 0!==n?n:"":bA(e)?null!==(r=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO)&&void 0!==r?r:"":CA(e)?null!==(i=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VIDEO)&&void 0!==i?i:"":IA(e)?null!==(a=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_AUDIO)&&void 0!==a?a:"":WA(e)?null!==(s=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VOICE_MESSAGE)&&void 0!==s?s:"":null!==(o=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GENERAL)&&void 0!==o?o:""},dD=function(e,t){return void 0===t&&(t=yN),(null==e?void 0:e.lastMessage)?function(e,t){var n,r,i,a;if(void 0===e&&(e=null),void 0===t&&(t=yN),!e)return"";if(PA(e))return t.CHANNEL_PREVIEW_LAST_MESSAGE_TEMPLATE_MESSAGE;if(e.isFileMessage())return cD(e.type,t);if(e.isMultipleFilesMessage()){var s=null===(r=null===(n=e.fileInfoList)||void 0===n?void 0:n[0])||void 0===r?void 0:r.mimeType;return bA(s)||NA(s)?null!==(i=null==t?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO)&&void 0!==i?i:"":cD(s,t)}return null!==(a=e.message)&&void 0!==a?a:""}(null==e?void 0:e.lastMessage,t):""},hD=function(e){return(null==e?void 0:e.unreadMessageCount)?e.unreadMessageCount:0},fD=((sD={})[lA.SENT]=QS.DONE,sD[lA.DELIVERED]=QS.DONE_ALL,sD[lA.READ]=QS.DONE_ALL,sD[lA.FAILED]=QS.ERROR,sD[lA.PENDING]=void 0,sD[lA.NONE]=void 0,sD),pD=((oD={})[lA.SENT]=XS.SENT,oD[lA.DELIVERED]=XS.SENT,oD[lA.READ]=XS.READ,oD[lA.FAILED]=XS.ERROR,oD[lA.PENDING]=void 0,oD[lA.NONE]=void 0,oD);function mD(e){var t,n,r=e.className,i=e.message,s=e.channel,o=e.isDateSeparatorConsidered,l=void 0===o||o,u=JC(),c=u.stringSet,d=u.dateLocale,h=hA(s,i),f=(null===(t=null==s?void 0:s.isGroupChannel)||void 0===t?void 0:t.call(s))&&(s.isSuper||s.isPublic||s.isBroadcast)&&!(h===lA.PENDING||h===lA.FAILED);return a.a.createElement("div",{className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-message-status"],!1).join(" ")},h===lA.PENDING?a.a.createElement(FO,{className:"sendbird-message-status__icon",testID:"sendbird-message-status-icon",width:"16px",height:"16px"},a.a.createElement(YS,{type:QS.SPINNER,fillColor:XS.PRIMARY,width:"16px",height:"16px"})):a.a.createElement(YS,{className:nN("sendbird-message-status__icon",f&&"hide-icon",h!==lA.FAILED&&"sendbird-message-status--sent"),testID:"sendbird-message-status-icon",type:fD[h]||QS.ERROR,fillColor:pD[h],width:"16px",height:"16px"}),((n=h)===lA.SENT||n===lA.DELIVERED||n===lA.READ)&&a.a.createElement(_N,{className:"sendbird-message-status__text",testID:"sendbird-message-status-text",type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},l?ok((null==i?void 0:i.createdAt)||0,c.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:d}):uD({channel:s,locale:d,stringSet:c})))}var gD=function(e){var t=e.ref,n=e.onClick,r=void 0===n?$C:n,i=e.onBlur,s=void 0===i?$C:i,o=e.renderIcon,l=void 0===o?function(e){return a.a.createElement(YS,m({},e))}:o;return a.a.createElement(lN,{ref:t,width:"32px",height:"32px",onClick:r,onBlur:s},l({type:QS.MORE,fillColor:XS.CONTENT_INVERSE,width:"24px",height:"24px"}))},_D=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;kA(i)&&aM(i.message),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:n.MESSAGE_MENU__COPY)},vD=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.setQuoteMessage;return a.a.createElement(mM,m({},e,{disabled:i.parentMessageId>0,onClick:function(t){var n;o(i),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:n.MESSAGE_MENU__REPLY)},ED=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.onReplyInThread;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;o({message:i}),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:n.MESSAGE_MENU__THREAD)},yD=function(e){var t,n=JC().stringSet,r=pM(),i=r.hideMenu,s=r.onMoveToParentMessage;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;s(),i(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:n.MESSAGE_MENU__OPEN_IN_CHANNEL)},bD=function(e){var t,n=JC().stringSet,r=pM(),i=r.hideMenu,s=r.showEdit,o=r.isOnline;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;o&&(s(!0),i(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(t=e.children)&&void 0!==t?t:n.MESSAGE_MENU__EDIT)},CD=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.resendMessage,l=r.isOnline;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;l&&(o(i),s(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(t=e.children)&&void 0!==t?t:n.MESSAGE_MENU__RESEND)},ND=function(e){var t,n,r,i=JC().stringSet,s=pM(),o=s.message,l=s.hideMenu,u=s.deleteMessage,c=s.showRemove,d=s.isOnline,h=s.disableDeleteMessage;return a.a.createElement(mM,m({},e,{disabled:"boolean"==typeof h?h:(null!==(n=null===(t=o.threadInfo)||void 0===t?void 0:t.replyCount)&&void 0!==n?n:0)>0,onClick:function(t){var n;MA(o)?u(o):d&&(c(!0),l(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(r=e.children)&&void 0!==r?r:i.MESSAGE_MENU__DELETE)},TD=function(e){var t,n=e.channel,r=e.message;if(MA(r)||OA(r))return!1;if(!(null===(t=null==n?void 0:n.isGroupChannel)||void 0===t?void 0:t.call(n))||(null==n?void 0:n.isEphemeral))return!1;var i=null==n?void 0:n.isBroadcast,a=(null==n?void 0:n.myRole)===ue.OPERATOR;return!i||a},ID=function(e){var t,n=e.className,r=e.message,s=e.channel,o=e.isByMe,l=e.replyType,u=e.renderTrigger,c=void 0===u?gD:u,d=e.renderMenuItems,h=e.disableDeleteMessage,f=void 0===h?null:h,p=e.showEdit,m=void 0===p?$C:p,g=e.showRemove,_=void 0===g?$C:g,v=e.deleteMessage,E=e.resendMessage,y=e.setQuoteMessage,b=e.onReplyInThread,C=e.onMoveToParentMessage,N=IC().state.config.isOnline,T=Object(i.useRef)(null),I=Object(i.useRef)(null),S=Object(i.useState)(!1),w=S[0],A=S[1],M=function(){return A(!1)},O=function(){return A((function(e){return!e}))},R={message:r,channel:s,isByMe:o,replyType:l,onReplyInThread:b,onMoveToParentMessage:C};return a.a.createElement("div",{className:nN("sendbird-message-menu",n),ref:I},a.a.createElement(fM,{value:{message:r,hideMenu:M,showMenu:function(){return A(!0)},toggleMenu:O,setQuoteMessage:y,onReplyInThread:b,onMoveToParentMessage:C,showEdit:m,showRemove:_,deleteMessage:v,resendMessage:E,isOnline:N,disableDeleteMessage:f,triggerRef:T,containerRef:I}},c({ref:T,onClick:O}),w&&a.a.createElement(EM,{id:vM(r.messageId),parentRef:T,parentContainRef:I,closeDropdown:M,openLeft:o},null!==(t=null==d?void 0:d({items:{CopyMenuItem:_D,ReplyMenuItem:vD,ThreadMenuItem:ED,OpenInChannelMenuItem:yD,EditMenuItem:bD,ResendMenuItem:CD,DeleteMenuItem:ND}}))&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,function(e){var t=e.message;return kA(t)}(R)&&a.a.createElement(_D,null),function(e){var t=e.channel,n=e.message,r=e.replyType;return TD({channel:t,message:n})&&"QUOTE_REPLY"===r}(R)&&a.a.createElement(vD,null),function(e){var t=e.channel,n=e.message,r=e.replyType,i=e.onReplyInThread;return TD({channel:t,message:n})&&"THREAD"===r&&!(null==n?void 0:n.parentMessageId)&&"function"==typeof i}(R)&&a.a.createElement(ED,null),function(e){var t=e.onMoveToParentMessage;return!!(void 0===t?void 0:t)}(R)&&a.a.createElement(yD,null),function(e){var t=e.message,n=e.channel,r=e.isByMe;return!(null==n?void 0:n.isEphemeral)&&kA(t)&&wA(t)&&r}(R)&&a.a.createElement(bD,null),function(e){var t=e.message,n=e.isByMe;return MA(t)&&(null==t?void 0:t.isResendable)&&n}(R)&&a.a.createElement(CD,null),function(e){var t=e.message,n=e.channel,r=e.isByMe;return!(null==n?void 0:n.isEphemeral)&&!OA(t)&&r}(R)&&a.a.createElement(ND,null)))))};function SD(e){(function(e){return e&&"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()}function wD(e,t){var n=e.onLongPress,r=e.onClick,a=void 0===t?{}:t,s=a.delay,o=void 0===s?300:s,l=a.shouldPreventDefault,u=void 0===l||l,c=a.shouldStopPropagation,d=void 0!==c&&c,h=oN().isMobile,f=Object(i.useState)(!1),p=f[0],g=f[1],_=Object(i.useState)(!1),v=_[0],E=_[1],y=Object(i.useRef)(),b=Object(i.useRef)(),C=Object(i.useCallback)((function(e){e.persist();var t=m({},e);E(!1),d&&e.stopPropagation(),u&&e.target&&(e.target.addEventListener("touchend",SD,{passive:!1}),b.current=e.target),y.current=setTimeout((function(){n(t),g(!0)}),o)}),[n,o,u,d,h]),N=Object(i.useCallback)((function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1),E(!!n),(null==y?void 0:y.current)&&clearTimeout(y.current),!t||p||v||null==r||r(e),g(!1),u&&b.current&&b.current.removeEventListener("touchend",SD)}),[u,r,p,v]);return{onMouseDown:function(e){return C(e)},onMouseUp:function(e){return N(e)},onMouseLeave:function(e){return N(e,!1)},onTouchStart:function(e){return C(e)},onTouchMove:function(e){return N(e,!1,!0)},onTouchEnd:function(e){return N(e)}}}var AD=a.a.forwardRef((function(e,t){var n=e.className,r=e.width,i=e.height,s=e.selected,o=e.dataSbId,l=void 0===o?"":o,u=e.testID,c=e.onClick,d=e.children,h=wD({onLongPress:$C,onClick:c},{shouldPreventDefault:!0,shouldStopPropagation:!0});return a.a.createElement("div",m({className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-reaction-button".concat(s?"--selected":"")],!1).join(" "),ref:t,role:"button",style:{width:r,height:i}},h,{tabIndex:0,"data-sb-id":null!=u?u:l,"data-testid":null!=u?u:l}),a.a.createElement("div",{className:"sendbird-reaction-button__inner"},d))}));function MD(e){var t=e.className,n=e.message,r=e.userId,s=e.spaceFromTrigger,o=void 0===s?{x:0,y:0}:s,l=e.emojiContainer,u=e.filterEmojiCategoryIds,c=e.toggleReaction,d=Object(i.useRef)(null),h=Object(i.useRef)(null),f=Object(i.useMemo)((function(){return oM(l,null==u?void 0:u(n))}),[l,u]);return OA(n)||MA(n)?null:a.a.createElement("div",{className:JA([null!=t?t:"","sendbird-message-item-reaction-menu"]),ref:h},a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(lN,{className:"sendbird-message-item-reaction-menu__trigger",ref:d,width:"32px",height:"32px",onClick:function(){e()}},a.a.createElement(YS,{className:"sendbird-message-item-reaction-menu__trigger__icon",testID:"sendbird-message-item-reaction-menu__trigger__icon",type:QS.EMOJI_MORE,fillColor:XS.CONTENT_INVERSE,width:"24px",height:"24px"}))},menuItems:function(e){return 0===f.length?null:a.a.createElement(yM,{id:vM(n.messageId),parentRef:d,parentContainRef:h,closeDropdown:e,spaceFromTrigger:o},f.map((function(t){var i,s,o,l=(null===(o=null===(s=null===(i=null==n?void 0:n.reactions)||void 0===i?void 0:i.find((function(e){return e.key===t.key})))||void 0===s?void 0:s.userIds)||void 0===o?void 0:o.some((function(e){return e===r})))||!1;return a.a.createElement(AD,{key:t.key,width:"36px",height:"36px",selected:l,onClick:function(){e(),null==c||c(n,t.key,l)},testID:"ui_emoji_reactions_menu_".concat(t.key)},a.a.createElement($O,{url:t.url,width:"28px",height:"28px",placeHolder:function(e){var t=e.style;return a.a.createElement("div",{style:t},a.a.createElement(YS,{type:QS.QUESTION,fillColor:XS.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))})))}}))}var OD=a.a.forwardRef((function(e,t){var n=e.className,r=void 0===n?"":n,i=e.testID,s=e.children,o=e.count,l=void 0===o?"":o,u=e.isAdd,c=void 0!==u&&u,d=e.selected,h=void 0!==d&&d,f=e.onClick,p=void 0===f?function(){}:f;return a.a.createElement("div",{className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-reaction-badge".concat(h&&!c?"--selected":c?"--is-add":"")],!1).join(" "),"data-testid":i,role:"button",ref:t,onClick:p,onKeyDown:p,onTouchEnd:p,tabIndex:0},a.a.createElement("div",{className:"sendbird-reaction-badge__inner"},a.a.createElement("div",{className:"sendbird-reaction-badge__inner__icon"},s),a.a.createElement(_N,{className:s&&l?"sendbird-reaction-badge__inner__count":"",type:vN.CAPTION_3,color:EN.ONBACKGROUND_1},l)))})),RD=function(e){var t,n=e.className,r=void 0===n?"":n,o=e.children,l=e.onBackdropClick,u=IC().state.config.logger,c=Object(i.useRef)();return c.current=document.getElementById(JS),c.current||(c.current=document.createElement("div"),c.current.setAttribute("id",JS),document.body.appendChild(c.current),null===(t=null==u?void 0:u.warning)||void 0===t||t.call(u,"@sendbird/uikit-react/ui/BottomSheet | Should put a ModalRoot to use the BottomSheet.")),Object(s.createPortal)(a.a.createElement("div",{className:"".concat(r," sendbird-bottomsheet")},a.a.createElement("div",{className:"sendbird-bottomsheet__content",role:"dialog","aria-modal":"true","aria-expanded":"true"},o),a.a.createElement("div",{className:"sendbird-bottomsheet__backdrop",onClick:function(e){null==e||e.stopPropagation(),null==l||l()}})),c.current)};function kD(e){var t=e.height,n=void 0===t?24:t,r=e.width,i=void 0===r?24:r;return a.a.createElement("div",{className:"sendbird-muted-avatar",style:{height:"".concat(n,"px"),width:"".concat(i,"px")}},a.a.createElement("div",{className:"sendbird-muted-avatar__icon"},a.a.createElement("div",{className:"sendbird-muted-avatar__bg",style:{height:"".concat(n,"px"),width:"".concat(i,"px")}}),a.a.createElement(YS,{type:QS.MUTE,fillColor:XS.WHITE,width:"".concat(n-8,"px"),height:"".concat(i-8,"px")})))}function xD(e){var t=e.id,n=e.checked,r=void 0!==n&&n,s=e.disabled,o=e.onChange,l=Object(i.useState)(r),u=l[0],c=l[1];return a.a.createElement("label",{className:["sendbird-checkbox",s?"disabled":""].join(" "),htmlFor:t},a.a.createElement("input",{disabled:s,id:t,type:"checkbox",checked:u,onClick:function(){s||c(!u)},onChange:o}),a.a.createElement("span",{className:["sendbird-checkbox--checkmark",s?"disabled":""].join(" ")}))}var DD=function(e){var t=e.stores,n=(void 0===t?{}:t).sdkStore;return(void 0===n?{}:n).sdk},UD=function(e){return function(t){return new Promise((function(n,r){var i=DD(e),a=function(e){var t=e.config;return(void 0===t?{}:t).pubSub}(e);i||r(new Error("Sdk not found")),i.groupChannel||r(new Error("Not found GroupChannelModule")),i.groupChannel.createChannel&&"function"==typeof i.groupChannel.createChannel||r(new Error('Not found the function "createChannel"')),i.groupChannel.createChannel(t).then((function(e){n(e),a.publish(yO.CREATE_CHANNEL,{channel:e})})).catch(r)}))}};function LD(e){var t,n,r=e.user,s=e.currentUserId,o=e.disableMessaging,l=void 0!==o&&o,u=e.onSuccess,c=IC().state,d=UD(c),h=null===(t=null==c?void 0:c.config)||void 0===t?void 0:t.logger,f=Object(i.useContext)(XC).stringSet,p=s||(null===(n=null==c?void 0:c.config)||void 0===n?void 0:n.userId),m=QM().onStartDirectMessage;return a.a.createElement("div",{className:"sendbird__user-profile"},a.a.createElement("section",{className:"sendbird__user-profile-avatar"},a.a.createElement(iR,{height:"80px",width:"80px",src:null==r?void 0:r.profileUrl})),a.a.createElement("section",{className:"sendbird__user-profile-name"},a.a.createElement(_N,{type:vN.H_2,color:EN.ONBACKGROUND_1},(null==r?void 0:r.nickname)||f.NO_NAME)),(null==r?void 0:r.userId)!==p&&!l&&a.a.createElement("section",{className:"sendbird__user-profile-message"},a.a.createElement(NN,{type:fN.SECONDARY,onClick:function(){var e={isDistinct:!1,invitedUserIds:(null==r?void 0:r.userId)?[null==r?void 0:r.userId]:[],operatorUserIds:[p]};null==u||u(),d(e).then((function(e){h.info("UserProfile, channel create",e),null==m||m(e)}))}},f.USER_PROFILE__MESSAGE)),a.a.createElement("div",{className:"sendbird__user-profile-separator"}),a.a.createElement("section",{className:"sendbird__user-profile-userId"},a.a.createElement(_N,{className:"sendbird__user-profile-userId--label",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},f.USER_PROFILE__USER_ID),a.a.createElement(_N,{className:"sendbird__user-profile-userId--value",type:vN.BODY_1,color:EN.ONBACKGROUND_1},null==r?void 0:r.userId)))}function PD(e){var t=e.user,n=e.channel,r=e.className,s=void 0===r?void 0:r,o=e.checked,l=e.checkBox,u=e.isOperator,c=e.disabled,d=e.disableMessaging,h=e.action,f=e.onChange,p=e.avatarSize,m=void 0===p?"40px":p,g=e.onClick,_=e.onUserAvatarClick,v=e.renderListItemMenu,y=e.size,b=void 0===y?"normal":y,C=null!=u?u:"operator"===(null==t?void 0:t.role),N=t.userId,T=Object(i.useRef)(null),I=Object(i.useRef)(null),S=Object(i.useRef)(null),w=QM(),A=w.disableUserProfile,M=w.renderUserProfile,O=JC().stringSet,R=IC().state.config.userId,k="small"===b?"sendbird-user-list-item--small":"sendbird-user-list-item",x="small"===b?"sendbird-user-list-item--small__avatar":"sendbird-user-list-item__avatar",D="small"===b?"sendbird-user-list-item--small__title":"sendbird-user-list-item__title",U="small"===b?"sendbird-user-list-item--small__subtitle":"sendbird-user-list-item__subtitle",L="small"===b?"sendbird-user-list-item--small__checkbox":"sendbird-user-list-item__checkbox",P="small"===b?"sendbird-user-list-item--small__action":"sendbird-user-list-item__action",F="small"===b?"sendbird-user-list-item--small__operator":"sendbird-user-list-item__operator";return a.a.createElement("div",{className:nN.apply(void 0,E([k],Array.isArray(s)?s:[s],!1)),ref:I},a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(iR,{className:x,ref:S,src:(null==t?void 0:t.profileUrl)||(null==t?void 0:t.plainProfileUrl)||"",width:m,height:m,onClick:function(){var t;A||(e(),null===(t=null!=_?_:g)||void 0===t||t())}}),(null==t?void 0:t.isMuted)&&a.a.createElement(kD,{height:tR(m),width:tR(m)}))},menuItems:function(e){return M?M({user:t,currentUserId:null!=R?R:"",close:e,avatarRef:S}):a.a.createElement(EM,{openLeft:!0,parentRef:S,parentContainRef:S,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{disableMessaging:d,user:t,currentUserId:R,onSuccess:e}))}}),a.a.createElement(_N,{className:D,type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},t.nickname||O.NO_NAME,R===t.userId&&O.CHANNEL_SETTING__MEMBERS__YOU),!t.nickname&&a.a.createElement(_N,{className:U,type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},t.userId),l&&a.a.createElement("label",{className:L,htmlFor:N},a.a.createElement(xD,{id:N,checked:o,disabled:c,onChange:function(e){return null==f?void 0:f(e)}})),C&&a.a.createElement(_N,{className:nN(F,l&&"checkbox"),type:vN.SUBTITLE_2,color:EN.ONBACKGROUND_2},O.LABEL__OPERATOR),!l&&!v&&h&&a.a.createElement("div",{className:P,ref:T},h({actionRef:T,parentRef:I})),!l&&v&&a.a.createElement("div",{className:P,ref:T},v({channel:n,user:t})))}function FD(e){var t=e.className,n=void 0===t?"":t,r=e.children,i=void 0===r?"":r;return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-tooltip"],!1).join(" ")},a.a.createElement(_N,{className:"sendbird-tooltip__text",type:vN.CAPTION_2,color:EN.ONCONTENT_1},i))}function BD(e){var t=e.className,n=void 0===t?"":t,r=e.children,s=e.hoverTooltip,o=Object(i.useState)(!1),l=o[0],u=o[1],c=Object(i.useRef)();return a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-tooltip-wrapper"],!1).join(" "),onMouseOver:function(){u(!0)},onFocus:function(){u(!0)},onMouseOut:function(){u(!1)},onBlur:function(){u(!1)}},a.a.createElement("div",{className:"sendbird-tooltip-wrapper__children",ref:c},r),l&&a.a.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip",style:{bottom:"calc(100% + ".concat(8,"px)")}},a.a.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip__inner"},a.a.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip__inner__tooltip-container",style:{left:c.current?"calc(".concat(c.current.offsetWidth/2,"px - 50%)"):void 0}},s))))}var jD=a.a.createContext({message:{},isByMe:!1}),HD=function(e){var t=e.children,n=e.message,r=e.isByMe,i=void 0!==r&&r;return a.a.createElement(jD.Provider,{value:{message:n,isByMe:i}},t)},GD=function(){var e=a.a.useContext(jD);if(void 0===e)throw new Error("useMessageContext must be used within a MessageProvider");return e},zD=function(e){var t,n,r,s=e.message,o=e.channel,l=e.emojiKey,u=void 0===l?"":l,c=e.hideMenu,d=e.emojiContainer,h=e.onPressUserProfileHandler,f=o.members,p=void 0===f?[]:f,m=Object(i.useState)(u),g=m[0],_=m[1];function v(){if(h&&s){var e=null==s?void 0:s.sender;h(e)}}return a.a.createElement(RD,{onBackdropClick:c},a.a.createElement("div",{className:"sendbird-message__bottomsheet"},a.a.createElement("div",{className:"sendbird-message__bottomsheet__reacted-members"},null===(t=s.reactions)||void 0===t?void 0:t.map((function(e){var t=function(e,t){var n,r,i,a=(i=null!=t?t:"",function(e){return e.key===i});return(null===(r=null===(n=null==e?void 0:e.emojiCategories.find((function(e){return e.emojis.some(a)})))||void 0===n?void 0:n.emojis.find(a))||void 0===r?void 0:r.url)||""}(d,e.key);return a.a.createElement("div",{key:e.key,className:nN("sendbird-message__bottomsheet__reacted-members__item",g===e.key&&"sendbird-message__bottomsheet__reacted-members__item__selected"),onClick:function(){_(e.key)}},a.a.createElement($O,{url:t,width:"28px",height:"28px",placeHolder:function(e){var t=e.style;return a.a.createElement("div",{style:t},a.a.createElement(YS,{type:QS.QUESTION,fillColor:XS.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}),a.a.createElement(_N,{type:vN.BUTTON_2,color:g===e.key?EN.PRIMARY:EN.ONBACKGROUND_3},e.userIds.length))}))),a.a.createElement("div",{className:"sendbird-message__bottomsheet__reactor-list"},(null===(r=null===(n=s.reactions)||void 0===n?void 0:n.find((function(e){return e.key===g})))||void 0===r?void 0:r.userIds.map((function(e){return p.find((function(t){return t.userId===e}))})).filter((function(e){return void 0!==e}))).map((function(e){return a.a.createElement(PD,{key:e.userId,className:"sendbird-message__bottomsheet__reactor-list__item",user:e,avatarSize:"36px",onUserAvatarClick:v})})))))};function VD(e){var t,n=e.reaction,r=e.memberNicknamesMap,s=e.setEmojiKey,o=e.toggleReaction,l=e.emojisMap,u=e.channel,c=e.message,d=e.isFiltered,h=_w().openModal,f=IC().state.config.userId,p=oN().isMobile,g=GD(),_=Object(i.useContext)(XC).stringSet,v=$A(f,n),E=n.userIds.length>0&&(null==u?void 0:u.isGroupChannel())&&!u.isSuper,y=function(){!d||v?(s(""),null==o||o(null!=c?c:null==g?void 0:g.message,n.key,v)):h({modalProps:{titleText:"Add reaction failed",hideFooter:!0,isCloseOnClickOutside:!0},childElement:function(e){var t=e.closeModal;return a.a.createElement(nw,{type:fN.PRIMARY,submitText:_.BUTTON__OK,hideCancelButton:!0,onCancel:t,onSubmit:t})}})},b=wD({onLongPress:function(){s(n.key)},onClick:y},{shouldPreventDefault:!0,shouldStopPropagation:!0});return a.a.createElement(BD,{className:"sendbird-emoji-reactions__reaction-badge",hoverTooltip:E?a.a.createElement(FD,null,eM(n,f,r,_)):a.a.createElement(a.a.Fragment,null)},a.a.createElement("div",m({},p?b:{onClick:y}),a.a.createElement(OD,{count:n.userIds.length,selected:v},a.a.createElement($O,{circle:!0,url:(null===(t=l.get(null==n?void 0:n.key))||void 0===t?void 0:t.url)||"",width:"20px",height:"20px",defaultComponent:a.a.createElement(YS,{width:"20px",height:"20px",type:QS.QUESTION})}))))}var qD=function(e){var t=wD({onLongPress:function(){},onClick:e.onClick},{shouldPreventDefault:!0,shouldStopPropagation:!0});return a.a.createElement("div",m({className:"sendbird-emoji-reactions__add-reaction-badge","data-testid":"sendbird-emoji-reactions__add-reaction-badge"},t),a.a.createElement(OD,{isAdd:!0},a.a.createElement(YS,{type:QS.EMOJI_MORE,fillColor:XS.ON_BACKGROUND_3,width:"20px",height:"20px"})))},KD=function(e){var t=e.userId,n=e.message,r=e.emojiContainer,s=e.hideMenu,o=e.toggleReaction,l=Object(i.useMemo)((function(){return sM(r)}),[r]);return a.a.createElement(RD,{onBackdropClick:s},a.a.createElement("div",{className:"sendbird-message__bottomsheet sendbird-message__emojis-bottomsheet"},l.map((function(e){var r,i,l,u,c=null!==(u=null===(l=null===(i=null===(r=null==n?void 0:n.reactions)||void 0===r?void 0:r.find((function(t){return t.key===e.key})))||void 0===i?void 0:i.userIds)||void 0===l?void 0:l.some((function(e){return e===t})))&&void 0!==u&&u;return a.a.createElement(AD,{key:e.key,width:"44px",height:"44px",selected:c,onClick:function(t){null==t||t.stopPropagation(),null==o||o(n,e.key,c),s()},testID:"ui_mobile_emoji_reactions_menu_".concat(e.key)},a.a.createElement($O,{url:e.url,width:"38px",height:"38px",placeHolder:function(e){var t=e.style;return a.a.createElement("div",{style:t},a.a.createElement(YS,{type:QS.QUESTION,fillColor:XS.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}))))},WD=function(e){var t,n,r,s,o,l=e.className,u=void 0===l?"":l,c=e.userId,d=e.message,h=e.channel,f=e.emojiContainer,p=e.memberNicknamesMap,m=e.spaceFromTrigger,g=void 0===m?{x:0,y:0}:m,_=e.isByMe,v=void 0!==_&&_,E=e.toggleReaction,y=e.onPressUserProfile,b=e.filterEmojiCategoryIds,C=!1;try{var N=IC().state.config;C=!!h&&gO({channel:h,config:N})}catch(e){}var T=oN().isMobile,I=Object(i.useRef)(null),S=Object(i.useState)(!1),w=S[0],A=S[1],M=Object(i.useState)(""),O=M[0],R=M[1],k=function(e){var t,n=new Map;return null===(t=null==e?void 0:e.emojiCategories)||void 0===t||t.forEach((function(e){var t;null===(t=null==e?void 0:e.emojis)||void 0===t||t.forEach((function(e){e&&e.key&&n.set(e.key,e)}))})),n}(f),x=Object(i.useMemo)((function(){return oM(f,null==b?void 0:b(d))}),[f,b]),D=(null!==(n=null===(t=d.reactions)||void 0===t?void 0:t.length)&&void 0!==n?n:0)<k.size;return a.a.createElement("div",{className:JA([u,"sendbird-emoji-reactions",v?"outgoing":"incoming"])},(null!==(s=null===(r=d.reactions)||void 0===r?void 0:r.length)&&void 0!==s?s:0)>0&&(null===(o=d.reactions)||void 0===o?void 0:o.map((function(e){return a.a.createElement(VD,{key:null==e?void 0:e.key,reaction:e,memberNicknamesMap:p,setEmojiKey:R,toggleReaction:E,emojisMap:k,channel:h,message:d,isFiltered:oM(f,null==b?void 0:b(d)).every((function(t){return t.key!==(null==e?void 0:e.key)}))})}))),!T&&D&&a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(OD,{className:"sendbird-emoji-reactions__add-reaction-badge",testID:"sendbird-emoji-reactions__add-reaction-badge",ref:I,isAdd:!0,onClick:function(t){var n;e(),null===(n=null==t?void 0:t.stopPropagation)||void 0===n||n.call(t)}},a.a.createElement(YS,{type:QS.EMOJI_MORE,fillColor:XS.ON_BACKGROUND_3,width:"20px",height:"20px"}))},menuItems:function(e){return 0===x.length?null:a.a.createElement(yM,{parentRef:I,parentContainRef:I,closeDropdown:e,spaceFromTrigger:g},oM(f,null==b?void 0:b(d)).map((function(t){var n,r,i,s=(null===(i=null===(r=null===(n=null==d?void 0:d.reactions)||void 0===n?void 0:n.find((function(e){return e.key===t.key})))||void 0===r?void 0:r.userIds)||void 0===i?void 0:i.some((function(e){return e===c})))||!1;return a.a.createElement(AD,{key:t.key,width:"36px",height:"36px",selected:s,onClick:function(n){e(),null==E||E(d,t.key,s),null==n||n.stopPropagation()},testID:"ui_emoji_reactions_menu_".concat(t.key)},a.a.createElement($O,{url:(null==t?void 0:t.url)||"",width:"28px",height:"28px",placeHolder:function(e){var t=e.style;return a.a.createElement("div",{style:t},a.a.createElement(YS,{type:QS.QUESTION,fillColor:XS.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))})))}}),T&&D&&a.a.createElement(qD,{onClick:function(){A(!0)}}),T&&w&&a.a.createElement(KD,{userId:c,message:d,emojiContainer:f,hideMenu:function(){A(!1)},toggleReaction:E}),T&&O&&null!==h&&C&&a.a.createElement(zD,{message:d,channel:h,emojiKey:O,hideMenu:function(){R("")},emojiContainer:f,onPressUserProfileHandler:y}))};function YD(e){var t,n=e.className,r=void 0===n?"":n,i=e.message;return((null==i?void 0:i.isAdminMessage)||(null==i?void 0:i.messageType))&&(null===(t=null==i?void 0:i.isAdminMessage)||void 0===t?void 0:t.call(i))&&"admin"===(null==i?void 0:i.messageType)?a.a.createElement("div",{className:E(E([],Array.isArray(r)?r:[r],!0),["sendbird-admin-message"],!1).join(" ")},a.a.createElement(_N,{className:"sendbird-admin-message__text",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},null==i?void 0:i.message)):null}function QD(e){return fw(e).when(xA,(function(){var t;return null!==(t=null==e?void 0:e.type)&&void 0!==t?t:""})).when(DA,(function(){var t,n;return null!==(n=null===(t=XD(e))||void 0===t?void 0:t.mimeType)&&void 0!==n?n:""})).otherwise((function(){return""}))}function XD(e){var t=e.fileInfoList;return t.length>0?t[0]:null}function ZD(e){return fw(e).when(xA,(function(){var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""})).when(DA,(function(){var t,n;return null!==(n=null===(t=XD(e))||void 0===t?void 0:t.fileName)&&void 0!==n?n:""})).otherwise((function(){return""}))}function JD(e){return fw(e).when(xA,(function(){var t;return null!==(t=null==e?void 0:e.url)&&void 0!==t?t:""})).when(DA,(function(){var t,n;return null!==(n=null===(t=XD(e))||void 0===t?void 0:t.url)&&void 0!==n?n:""})).otherwise((function(){return""}))}function $D(e){var t=function(e){return fw(e).when(xA,(function(){return e.thumbnails})).when(DA,(function(){var t,n;return null!==(n=null===(t=XD(e))||void 0===t?void 0:t.thumbnails)&&void 0!==n?n:[]})).otherwise((function(){return[]}))}(e);return t&&t.length>0?t[0].url:""}function eU(e){var t,n,r,s,o,l,u,c=e.message,d=e.userId,h=void 0===d?"":d,f=e.isByMe,p=void 0!==f&&f,g=e.className,_=void 0===g?"":g,v=e.isUnavailable,E=void 0!==v&&v,y=e.onClick,b=Object(i.useContext)(XC).stringSet,C=c.parentMessage,N=null==C?void 0:C.sender,T=h===(null==N?void 0:N.userId)?b.QUOTED_MESSAGE__CURRENT_USER:null==N?void 0:N.nickname,I=JD(C),S=QD(C),w=h===(null===(n=null==c?void 0:c.sender)||void 0===n?void 0:n.userId)?b.QUOTED_MESSAGE__CURRENT_USER:null===(r=null==c?void 0:c.sender)||void 0===r?void 0:r.nickname,A=Object(i.useState)(!1),M=A[0],O=A[1],R=m({},yA),k=null!==(o=null===(s=ZD(C))||void 0===s?void 0:s.split("/"))&&void 0!==o?o:I.split("/");return a.a.createElement("div",{className:JA([_,"sendbird-quote-message",p?"outgoing":"incoming",E?"unavailable":""]),key:null==C?void 0:C.messageId,onClick:function(){!E&&y&&y()},onTouchEnd:function(){!E&&y&&y()}},a.a.createElement("div",{className:"sendbird-quote-message__replied-to"},a.a.createElement(YS,{className:"sendbird-quote-message__replied-to__icon",type:QS.REPLY,fillColor:XS.ON_BACKGROUND_3,width:"12px",height:"12px"}),a.a.createElement(_N,{className:"sendbird-quote-message__replied-to__text",testID:"sendbird-quote-message__replied-to__text",type:vN.CAPTION_2,color:EN.ONBACKGROUND_3},a.a.createElement("span",{className:"sendbird-quote-message__replied-to__text__nickname"},w),a.a.createElement("span",{className:"sendbird-quote-message__replied-to__text__text"},b.QUOTED_MESSAGE__REPLIED_TO),a.a.createElement("span",{className:"sendbird-quote-message__replied-to__text__nickname"},T))),a.a.createElement("div",{className:"sendbird-quote-message__replied-message"},E&&a.a.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},a.a.createElement(_N,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:vN.BODY_2,color:EN.ONBACKGROUND_1},b.QUOTED_MESSAGE__UNAVAILABLE)),kA(C)&&(null===(l=null==C?void 0:C.message)||void 0===l?void 0:l.length)>0&&!E&&a.a.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},a.a.createElement(_N,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:vN.BODY_2,color:EN.ONBACKGROUND_1},null==C?void 0:C.message)),YA(C)&&I&&!E&&a.a.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},a.a.createElement(_N,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:vN.BODY_2,color:EN.ONBACKGROUND_1},b.VOICE_MESSAGE)),(zA(C)||DA(C))&&I&&!E&&a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message"},a.a.createElement($O,{className:"sendbird-quote-message__replied-message__thumbnail-message__image",url:I,alt:S,width:"144px",height:"108px",onLoad:function(){return O(!0)},defaultComponent:a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__placeholder"},a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon"},a.a.createElement(YS,{type:CA(S)?QS.PLAY:QS.PHOTO,fillColor:XS.ON_BACKGROUND_2,width:"22px",height:"22px"})))}),CA(S)&&!((null===(u=null==C?void 0:C.thumbnails)||void 0===u?void 0:u.length)>0)&&a.a.createElement(a.a.Fragment,null,a.a.createElement("video",{className:"sendbird-quote-message__replied-message__thumbnail-message__video"},a.a.createElement("source",{src:I,type:S})),a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover"},a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover__icon"},a.a.createElement(YS,{type:QS.PLAY,fillColor:XS.ON_BACKGROUND_2,width:"14px",height:"14px"})))),M&&NA(S)&&a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover"},a.a.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover__icon"},a.a.createElement(YS,{type:QS.GIF,fillColor:XS.THUMBNAIL_ICON,width:"14px",height:"14px"})))),XA(C)===EA.FILE&&I&&!E&&a.a.createElement("div",{className:"sendbird-quote-message__replied-message__file-message"},a.a.createElement(YS,{className:"sendbird-quote-message__replied-message__file-message__type-icon",type:(t={},t[R.IMAGE]=QS.PHOTO,t[R.VIDEO]=QS.PLAY,t[R.AUDIO]=QS.FILE_AUDIO,t[R.GIF]=QS.GIF,t[R.OTHERS]=QS.FILE_DOCUMENT,t)[SA(S)],fillColor:XS.ON_BACKGROUND_3,width:"16px",height:"16px"}),a.a.createElement(_N,{className:"sendbird-quote-message__replied-message__file-message__file-name",type:vN.BODY_2,color:EN.ONBACKGROUND_3},iM(k[k.length-1])))))}var tU=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;kA(i)&&aM(i.message),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__COPY),a.a.createElement(YS,{type:QS.COPY,fillColor:XS.PRIMARY,width:"24px",height:"24px"})))},nU=function(e){var t,n,r,i=JC().stringSet,s=pM(),o=s.message,l=s.hideMenu,u=s.setQuoteMessage;return a.a.createElement(mM,m({},e,{disabled:o.parentMessageId>0,onClick:function(t){var n;u(o),l(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.SUBTITLE_1,color:(null!==(n=o.parentMessageId)&&void 0!==n?n:0)>0?EN.ONBACKGROUND_4:EN.ONBACKGROUND_1},i.MESSAGE_MENU__REPLY),a.a.createElement(YS,{type:QS.REPLY,fillColor:(null!==(r=o.parentMessageId)&&void 0!==r?r:0)>0?XS.ON_BACKGROUND_4:XS.PRIMARY,width:"24px",height:"24px"})))},rU=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.onReplyInThread;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;o({message:i}),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__THREAD),a.a.createElement(YS,{type:QS.THREAD,fillColor:XS.PRIMARY,width:"24px",height:"24px"})))},iU=function(e){var t,n=JC().stringSet,r=pM(),i=r.hideMenu,s=r.showEdit,o=r.isOnline;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;o&&(s(!0),i(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__EDIT),a.a.createElement(YS,{type:QS.EDIT,fillColor:XS.PRIMARY,width:"24px",height:"24px"})))},aU=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.resendMessage,l=r.isOnline;return a.a.createElement(mM,m({},e,{onClick:function(t){var n;l&&(o(i),s(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__RESEND),a.a.createElement(YS,{type:QS.REFRESH,fillColor:XS.PRIMARY,width:"24px",height:"24px"})))},sU=function(e){var t,n,r,i=JC().stringSet,s=pM(),o=s.message,l=s.hideMenu,u=s.deleteMessage,c=s.showRemove,d=s.isOnline,h=s.disableDeleteMessage;return a.a.createElement(mM,m({},e,{disabled:"boolean"==typeof h?h:(null!==(n=null===(t=o.threadInfo)||void 0===t?void 0:t.replyCount)&&void 0!==n?n:0)>0,onClick:function(t){var n;MA(o)?u(o):d&&(c(!0),l(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(r=e.children)&&void 0!==r?r:a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.SUBTITLE_1,color:h?EN.ONBACKGROUND_4:EN.ONBACKGROUND_1},i.MESSAGE_MENU__DELETE),a.a.createElement(YS,{type:QS.DELETE,fillColor:XS.PRIMARY,width:"24px",height:"24px"})))},oU=function(e){var t,n=JC().stringSet,r=pM(),i=r.hideMenu,s=r.message,o=r.onDownloadClick,l=s.url;return a.a.createElement(mM,m({},e,{onClick:function(){i()}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement("a",{className:"sendbird-message__contextmenu--hyperlink",rel:"noopener noreferrer",href:l,target:"_blank",onClick:o},a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__SAVE),a.a.createElement(YS,{type:QS.DOWNLOAD,fillColor:XS.PRIMARY,width:"24px",height:"24px"})))},lU=function(e){var t,n,r,i,s=e.channel,o=e.message,l=e.replyType,u=e.userId,c=e.resendMessage,d=e.showEdit,h=e.showRemove,f=e.deleteMenuState,p=e.deleteMessage,m=e.setQuoteMessage,g=e.parentRef,_=e.onReplyInThread,v=e.isOpenedFromThread,E=void 0!==v&&v,y=e.onDownloadClick,b=void 0===y?null:y,C=e.renderMenuItems,N=e.hideMenu,T=(null===(t=null==o?void 0:o.sender)||void 0===t?void 0:t.userId)===u,I=IC().state.config.isOnline,S=kA(o),w=kA(o)&&wA(o)&&T,A=MA(o)&&(null==o?void 0:o.isResendable)&&T,M=!OA(o)&&T,O=T&&(void 0===f||"HIDE"!==f)&&M,R=!OA(o)&&xA(o)&&!(YA(o)&&(null==s?void 0:s.isSuper)||(null==s?void 0:s.isBroadcast)),k="QUOTE_REPLY"===l&&!MA(o)&&!OA(o)&&(null==s?void 0:s.isGroupChannel()),x="THREAD"===l&&!E&&!MA(o)&&!OA(o)&&!UA(o)&&(null==s?void 0:s.isGroupChannel()),D=void 0!==f&&"DISABLE"===f||(null!==(r=null===(n=null==o?void 0:o.threadInfo)||void 0===n?void 0:n.replyCount)&&void 0!==r?r:0)>0,U={message:o,hideMenu:N,setQuoteMessage:m,onReplyInThread:_,onMoveToParentMessage:$C,showEdit:d,showRemove:h,deleteMessage:p,resendMessage:c,isOnline:I,disableDeleteMessage:D,triggerRef:g,containerRef:g,onDownloadClick:b};return a.a.createElement(fM,{value:U},a.a.createElement(EM,{className:"sendbird-message__mobile-context-menu",parentRef:g,parentContainRef:g,closeDropdown:N},null!==(i=null==C?void 0:C({items:{CopyMenuItem:tU,ReplyMenuItem:nU,ThreadMenuItem:rU,EditMenuItem:iU,ResendMenuItem:aU,DeleteMenuItem:sU}}))&&void 0!==i?i:a.a.createElement(a.a.Fragment,null,S&&a.a.createElement(tU,null),k&&a.a.createElement(nU,null),x&&a.a.createElement(rU,null),w&&a.a.createElement(iU,null),A&&a.a.createElement(aU,null),O&&a.a.createElement(sU,null),R&&a.a.createElement(oU,null))))},uU=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu;return a.a.createElement(gM,m({},e,{onClick:function(t){var n;kA(i)&&aM(i.message),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(YS,{type:QS.COPY,fillColor:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__COPY)))},cU=function(e){var t,n=JC().stringSet,r=pM(),i=r.hideMenu,s=r.showEdit,o=r.isOnline;return a.a.createElement(gM,m({},e,{onClick:function(t){var n;o&&(s(!0),i(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(YS,{type:QS.EDIT,fillColor:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__EDIT)))},dU=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.resendMessage,l=r.isOnline;return a.a.createElement(gM,m({},e,{onClick:function(t){var n;l&&(o(i),s(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(YS,{type:QS.REFRESH,fillColor:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__RESEND)))},hU=function(e){var t,n,r,i=JC().stringSet,s=pM(),o=s.message,l=s.hideMenu,u=s.setQuoteMessage;return a.a.createElement(gM,m({},e,{disabled:o.parentMessageId>0,onClick:function(t){var n;u(o),l(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(YS,{type:QS.REPLY,fillColor:(null!==(n=o.parentMessageId)&&void 0!==n?n:0)>0?XS.ON_BACKGROUND_3:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:(null!==(r=o.parentMessageId)&&void 0!==r?r:0)>0?EN.ONBACKGROUND_4:EN.ONBACKGROUND_1},i.MESSAGE_MENU__REPLY)))},fU=function(e){var t,n=JC().stringSet,r=pM(),i=r.message,s=r.hideMenu,o=r.onReplyInThread;return a.a.createElement(gM,m({},e,{onClick:function(t){var n;o({message:i}),s(),null===(n=e.onClick)||void 0===n||n.call(e,t)}}),null!==(t=e.children)&&void 0!==t?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(YS,{type:QS.THREAD,fillColor:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__THREAD)))},pU=function(e){var t,n,r,i=JC().stringSet,s=pM(),o=s.message,l=s.hideMenu,u=s.deleteMessage,c=s.showRemove,d=s.isOnline,h=s.disableDeleteMessage;return a.a.createElement(gM,m({},e,{disabled:"boolean"==typeof h?h:(null!==(n=null===(t=o.threadInfo)||void 0===t?void 0:t.replyCount)&&void 0!==n?n:0)>0,onClick:function(t){var n;MA(o)?u(o):d&&(c(!0),l(),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),null!==(r=e.children)&&void 0!==r?r:a.a.createElement(a.a.Fragment,null,a.a.createElement(YS,{type:QS.DELETE,fillColor:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:h?EN.ONBACKGROUND_4:EN.ONBACKGROUND_1},i.MESSAGE_MENU__DELETE)))},mU=function(e){var t,n=JC().stringSet,r=pM(),i=r.hideMenu,s=r.message,o=r.onDownloadClick,l=s.url;return a.a.createElement(gM,{onClick:function(){return i()}},null!==(t=e.children)&&void 0!==t?t:a.a.createElement("a",{className:"sendbird-message__bottomsheet--hyperlink",rel:"noopener noreferrer",href:l,target:"_blank",onClick:o},a.a.createElement(YS,{type:QS.DOWNLOAD,fillColor:XS.PRIMARY,width:"24px",height:"24px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},n.MESSAGE_MENU__SAVE)))},gU=function(e){var t,n,r,s,o=e.hideMenu,l=e.channel,u=e.emojiContainer,c=e.message,d=e.replyType,h=e.userId,f=e.resendMessage,p=e.deleteMessage,m=e.toggleReaction,g=e.isReactionEnabled,_=void 0!==g&&g,v=e.showEdit,E=e.showRemove,y=e.deleteMenuState,b=e.setQuoteMessage,C=e.onReplyInThread,N=e.isOpenedFromThread,T=void 0!==N&&N,I=e.onDownloadClick,S=e.renderMenuItems,w=(null===(t=null==c?void 0:c.sender)||void 0===t?void 0:t.userId)===h,A=IC().state.config.isOnline,M=kA(c),O=kA(c)&&wA(c)&&w,R=A&&MA(c)&&(null==c?void 0:c.isResendable)&&w,k=!OA(c)&&w,x=w&&(void 0===y||"HIDE"!==y)&&k,D=void 0!==y&&"DISABLE"===y||(null!==(r=null===(n=null==c?void 0:c.threadInfo)||void 0===n?void 0:n.replyCount)&&void 0!==r?r:0)>0,U=wA(c)&&xA(c)&&!YA(c),L=!MA(c)&&!OA(c)&&_,P="QUOTE_REPLY"===d&&!MA(c)&&!OA(c)&&(null==l?void 0:l.isGroupChannel())&&!(null==l?void 0:l.isBroadcast),F="THREAD"===d&&!T&&!MA(c)&&!OA(c)&&!UA(c)&&(null==l?void 0:l.isGroupChannel())&&!(null==l?void 0:l.isBroadcast),B=Math.floor(window.innerWidth/38)-1,j=Object(i.useState)(!1),H=j[0],G=j[1],z=u&&sM(u),V=H?z:null==z?void 0:z.slice(0,B),q=z&&z.length>B,K={message:c,hideMenu:o,setQuoteMessage:b,onReplyInThread:C,onMoveToParentMessage:function(){},showEdit:v,showRemove:E,deleteMessage:p,resendMessage:f,isOnline:A,disableDeleteMessage:D,triggerRef:null,containerRef:null,onDownloadClick:I};return a.a.createElement(fM,{value:K},a.a.createElement(RD,{onBackdropClick:o},a.a.createElement("div",{className:"sendbird-message__bottomsheet"},L&&a.a.createElement("div",{className:"sendbird-message__bottomsheet-reactions"},a.a.createElement("ul",{className:"sendbird-message__bottomsheet-reaction-bar"},a.a.createElement("div",{className:nN("sendbird-message__bottomsheet-reaction-bar__row",H&&"sendbird-message__bottomsheet-reaction-bar__all")},V.map((function(e){var t,n,r,i=null===(r=null===(n=null===(t=null==c?void 0:c.reactions)||void 0===t?void 0:t.filter((function(t){return t.key===e.key}))[0])||void 0===n?void 0:n.userIds)||void 0===r?void 0:r.some((function(e){return e===h}));return a.a.createElement(AD,{key:e.key,width:"".concat(38,"px"),height:"".concat(38,"px"),selected:i,onClick:function(){o(),null==m||m(c,e.key,i)},testID:"ui_mobile_emoji_reactions_menu_".concat(e.key)},a.a.createElement($O,{url:(null==e?void 0:e.url)||"",width:"28px",height:"28px",placeHolder:function(e){var t=e.style;return a.a.createElement("div",{style:t},a.a.createElement(YS,{type:QS.QUESTION,fillColor:XS.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))})),q&&!H&&a.a.createElement(AD,{key:"emoji_more",width:"38px",height:"38px",onClick:function(){return G(!0)},testID:"ui_mobile_emoji_reactions_menu_emojiadd"},a.a.createElement($O,{url:"",width:"28px",height:"28px",placeHolder:function(e){var t=e.style;return a.a.createElement("div",{style:t},a.a.createElement(YS,{type:QS.EMOJI_MORE,fillColor:XS.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))))),!H&&a.a.createElement("div",{className:"sendbird-message__bottomsheet--actions"},null!==(s=null==S?void 0:S({items:{CopyMenuItem:uU,EditMenuItem:cU,ResendMenuItem:dU,ReplyMenuItem:hU,ThreadMenuItem:fU,DeleteMenuItem:pU}}))&&void 0!==s?s:a.a.createElement(a.a.Fragment,null,M&&a.a.createElement(uU,null),O&&a.a.createElement(cU,null),R&&a.a.createElement(dU,null),P&&a.a.createElement(hU,null),F&&a.a.createElement(fU,null),x&&a.a.createElement(pU,null),U&&a.a.createElement(mU,null))))))},_U=function(e){return a.a.createElement(a.a.Fragment,null,(null==e?void 0:e.isReactionEnabled)?a.a.createElement(gU,m({},e)):a.a.createElement(lU,m({},e)))};var vU=a.a.forwardRef((function(e,t){var n,r=e.className,i=e.threadInfo,s=e.onClick,o=i.mostRepliedUsers,l=void 0===o?[]:o,u=i.replyCount,c=JC().stringSet;return a.a.createElement("div",{className:"sendbird-ui-thread-replies ".concat(r),role:"button",onClick:function(e){null==s||s(e),null==e||e.stopPropagation()},onKeyDown:function(e){null==s||s(e),null==e||e.stopPropagation()},ref:t},a.a.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles"},l.slice(0,4).map((function(e){return a.a.createElement(iR,{key:e.userId,className:"sendbird-ui-thread-replies__user-profiles__avatar",src:null==e?void 0:e.profileUrl,alt:"user profile",width:"20px",height:"20px"})})),(null==l?void 0:l.length)>=5&&a.a.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar"},a.a.createElement(iR,{className:"sendbird-ui-thread-replies__user-profiles__avatar__image",src:null===(n=null==l?void 0:l[4])||void 0===n?void 0:n.profileUrl,alt:"user profile",width:"20px",height:"20px"}),a.a.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar__cover"}),a.a.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar__plus"},a.a.createElement(YS,{type:QS.PLUS,fillColor:XS.WHITE,width:"16px",height:"16px"})))),a.a.createElement(_N,{className:"sendbird-ui-thread-replies__reply-counts",type:vN.CAPTION_2,color:EN.PRIMARY},1===u?"".concat(u," ").concat(c.CHANNEL__THREAD_REPLY):"".concat(u>99?c.CHANNEL__THREAD_OVER_MAX:u," ").concat(c.CHANNEL__THREAD_REPLIES)),a.a.createElement(YS,{className:"sendbird-ui-thread-replies__icon",type:QS.CHEVRON_RIGHT,fillColor:XS.PRIMARY,width:"16px",height:"16px"}))}));function EU(e){var t,n,r,s=e.mentionTemplate,o=e.mentionedUserId,l=e.mentionedUserNickname,u=e.isByMe,c=Object(i.useRef)(),d=IC().state,h=null===(t=null==d?void 0:d.config)||void 0===t?void 0:t.userId,f=null===(r=null===(n=null==d?void 0:d.stores)||void 0===n?void 0:n.sdkStore)||void 0===r?void 0:r.sdk,p=h===o,m=Object(i.useState)(),g=m[0],_=m[1],v=Object(i.useCallback)((function(e){!g&&(null==f?void 0:f.createApplicationUserListQuery)?(null==f?void 0:f.createApplicationUserListQuery({userIdsFilter:[o]})).next().then((function(t){(null==t?void 0:t.length)>0&&_(t[0]),e()})):e()}),[f,o]);return a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement("a",{className:nN("sendbird-word__mention",p&&"sendbird-word__mention--me"),onClick:function(){return v(e)},ref:c,"data-userid":o,"data-nickname":l,"data-sb-mention":!0},a.a.createElement(_N,{type:vN.CAPTION_1,color:u?EN.ONCONTENT_1:EN.ONBACKGROUND_1},"".concat(s).concat(l)))},menuItems:function(e){return a.a.createElement(EM,{parentRef:c,parentContainRef:c,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{user:g,onSuccess:e,currentUserId:h}))}})}var yU=/https?:\/\//;function bU(e){var t=e.className,n=void 0===t?"":t,r=e.src,i=e.type,s=e.color,o=e.children,l=yU.test(r)?r:"http://".concat(r);return a.a.createElement("a",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-link-label",hN(s)],!1).join(" "),href:l,target:"_blank",rel:"noopener noreferrer",onTouchEnd:function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),tN(l)}},a.a.createElement(_N,{className:"sendbird-link-label__label",testID:"sendbird-link-label__label",type:i,color:s},o))}var CU=["https:","http:","tel:","mailto:"];function NU(e){var t=decodeURIComponent(e);try{var n=new URL(t).protocol;return CU.some((function(e){return e===n.toLowerCase()}))?t:"#"}catch(e){t.startsWith("http://")||t.startsWith("https://")||(t="https://"+t)}return t}function TU(e){var t=e.tokens,n=GD(),r=null==n?void 0:n.message,i=null==n?void 0:n.isByMe,s=r.updatedAt,o=r.createdAt;return a.a.createElement(a.a.Fragment,null,null==t?void 0:t.map((function(e,t){var n=function(e,t,n){return"sb-msg_".concat(e,"_").concat(t,"_").concat(n)}(o,s,t);return fw(e.type).with(zx,(function(){var t=e,r=t.groups;return a.a.createElement("span",{className:"sendbird-word",key:n,"data-testid":"sendbird-ui-word"},fw(t.markdownType).with("bold",(function(){return a.a.createElement("span",{style:{fontWeight:"bold"}},a.a.createElement(TU,{tokens:Xx({messageText:r[1]})}))})).with("url",(function(){return a.a.createElement("a",{className:i?"sendbird-label--color-oncontent-1":"sendbird-label--color-onbackground-1",href:NU(r[2])},a.a.createElement(TU,{tokens:Xx({messageText:r[1]})}))})).otherwise((function(){return a.a.createElement(a.a.Fragment,null)})))})).with(jx,(function(){return a.a.createElement("span",{className:"sendbird-word",key:n,"data-testid":"sendbird-ui-word"},a.a.createElement(EU,{mentionTemplate:"@",mentionedUserId:e.userId,mentionedUserNickname:e.value,isByMe:i}))})).with(Hx,(function(){return a.a.createElement("span",{className:"sendbird-word",key:n,"data-testid":"sendbird-ui-word"},a.a.createElement(bU,{src:e.value,type:vN.BODY_1,color:i?EN.ONCONTENT_1:EN.ONBACKGROUND_1},e.value))})).otherwise((function(){return a.a.createElement(a.a.Fragment,{key:n},e.value.split("\n").map((function(e){var t,n,r=(null===(t=e.match(/^\s*/))||void 0===t?void 0:t[0])||"",i=(null===(n=e.match(/\s*$/))||void 0===n?void 0:n[0])||"",a=r.replace(/ /g,""),s=i.replace(/ /g,"");return a+e.trim()+s})).join("\n"))}))})))}function IU(e){var t,n,r,s,o=e.className,l=e.message,u=e.isByMe,c=void 0!==u&&u,d=e.mouseHover,h=void 0!==d&&d,f=e.isMentionEnabled,p=void 0!==f&&f,m=e.isReactionEnabled,g=void 0!==m&&m,_=e.isMarkdownEnabled,v=void 0!==_&&_,E=e.onMessageHeightChange,y=void 0===E?function(){}:E,b=Object(i.useContext)(XC).stringSet,C=p&&(null===(t=null==l?void 0:l.mentionedMessageTemplate)||void 0===t?void 0:t.length)>0&&(null==l?void 0:l.mentionedUsers)&&(null===(n=null==l?void 0:l.mentionedUsers)||void 0===n?void 0:n.length)>0,N=Object(i.useMemo)((function(){var e;return Yx(C?{mentionedUsers:null!==(e=null==l?void 0:l.mentionedUsers)&&void 0!==e?e:void 0,messageText:null==l?void 0:l.mentionedMessageTemplate,includeMarkdown:v}:{messageText:null==l?void 0:l.message,includeMarkdown:v})}),[null==l?void 0:l.updatedAt,null==l?void 0:l.message]),T=function(){var e;return tN(null===(e=null==l?void 0:l.ogMetaData)||void 0===e?void 0:e.url)};return a.a.createElement("div",{className:JA([null!=o?o:"","sendbird-og-message-item-body",c?"outgoing":"incoming",h?"mouse-hover":"",g&&(null===(r=null==l?void 0:l.reactions)||void 0===r?void 0:r.length)>0?"reactions":""])},a.a.createElement(_N,{type:vN.BODY_1,color:c?EN.ONCONTENT_1:EN.ONBACKGROUND_1},a.a.createElement("div",{className:"sendbird-og-message-item-body__text-bubble"},a.a.createElement(TU,{tokens:N}),QA(l)&&a.a.createElement(_N,{className:"sendbird-og-message-item-body__text-bubble__message",type:vN.BODY_1,color:c?EN.ONCONTENT_2:EN.ONBACKGROUND_2}," ".concat(b.MESSAGE_EDITED," ")))),(null===(s=l.ogMetaData)||void 0===s?void 0:s.defaultImage)&&a.a.createElement(SU,{onClick:T,ogImage:l.ogMetaData.defaultImage,onMessageHeightChange:y}),l.ogMetaData&&a.a.createElement(wU,{onClick:T,ogMetaData:l.ogMetaData,onMessageHeightChange:y}),a.a.createElement("div",{className:"sendbird-og-message-item-body__cover"}))}var SU=function(e){var t=e.onClick,n=e.ogImage,r=e.onMessageHeightChange,s=Object(i.useRef)(null),o=oN().isMobile;return a.a.createElement("div",{ref:s,className:nN("sendbird-og-message-item-body__og-thumbnail",!n.url&&"sendbird-og-message-item-body__og-thumbnail__empty"),onClick:function(){return t()}},a.a.createElement($O,{className:"sendbird-og-message-item-body__og-thumbnail__image",url:n.url||"",alt:n.alt||"",width:"100%",height:o?"136px":"240px",onLoad:r,onError:function(){var e,t;try{null===(t=null===(e=null==s?void 0:s.current)||void 0===e?void 0:e.classList)||void 0===t||t.add("sendbird-og-message-item-body__og-thumbnail__empty")}catch(e){}},defaultComponent:a.a.createElement("div",{className:"sendbird-og-message-item-body__og-thumbnail__place-holder"},a.a.createElement(YS,{className:"sendbird-og-message-item-body__og-thumbnail__place-holder__icon",type:QS.THUMBNAIL_NONE,width:"56px",height:"56px"}))}))},wU=function(e){var t=e.onClick,n=e.ogMetaData,r=e.onMessageHeightChange;return Object(i.useEffect)((function(){r()}),[n.title,n.description,n.url]),a.a.createElement("div",{className:"sendbird-og-message-item-body__description",onClick:function(){return t()}},n.title&&a.a.createElement(_N,{className:"sendbird-og-message-item-body__description__title",type:vN.SUBTITLE_2,color:EN.ONBACKGROUND_1},n.title),n.description&&a.a.createElement(_N,{className:"sendbird-og-message-item-body__description__description",type:vN.BODY_2,color:EN.ONBACKGROUND_1},n.description),n.url&&a.a.createElement(_N,{className:"sendbird-og-message-item-body__description__url",type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},n.url))};function AU(e){var t,n=e.className,r=void 0===n?"":n,s=e.message,o=e.isByMe,l=void 0!==o&&o,u=e.mouseHover,c=void 0!==u&&u,d=e.isMentionEnabled,h=void 0!==d&&d,f=e.isReactionEnabled,p=void 0!==f&&f,m=e.isMarkdownEnabled,g=void 0!==m&&m,_=Object(i.useContext)(XC).stringSet,v=h&&(null==s?void 0:s.mentionedMessageTemplate)&&s.mentionedMessageTemplate.length>0&&(null==s?void 0:s.mentionedUsers)&&s.mentionedUsers.length>0,E=Object(i.useMemo)((function(){var e;return Yx(v?{mentionedUsers:null!==(e=null==s?void 0:s.mentionedUsers)&&void 0!==e?e:void 0,messageText:null==s?void 0:s.mentionedMessageTemplate,includeMarkdown:g}:{messageText:null==s?void 0:s.message,includeMarkdown:g})}),[null==s?void 0:s.updatedAt,null==s?void 0:s.message]);return a.a.createElement(_N,{type:vN.BODY_1,color:l?EN.ONCONTENT_1:EN.ONBACKGROUND_1},a.a.createElement("div",{className:JA([r,"sendbird-text-message-item-body",l?"outgoing":"incoming",c?"mouse-hover":"",p&&(null===(t=null==s?void 0:s.reactions)||void 0===t?void 0:t.length)>0?"reactions":""])},a.a.createElement(TU,{tokens:E}),QA(s)&&a.a.createElement(_N,{className:"sendbird-text-message-item-body__message edited",type:vN.BODY_1,color:l?EN.ONCONTENT_2:EN.ONBACKGROUND_2}," ".concat(_.MESSAGE_EDITED," "))))}function MU(e){var t,n=this,r=e.className,i=void 0===r?"":r,s=e.message,o=e.isByMe,l=void 0!==o&&o,u=e.mouseHover,c=void 0!==u&&u,d=e.isReactionEnabled,h=void 0!==d&&d,f=e.truncateLimit,p=e.onBeforeDownloadFileMessage,m=null;try{var g=IC().state.config.logger;m=g}catch(e){}var E=oN().isMobile,y=null!=f?f:E?20:void 0,b=function(){return tN(null==s?void 0:s.url)},C=p?function(){return _(n,void 0,void 0,(function(){var e,t,n;return v(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,p({message:s})];case 1:return r.sent()?b():null===(t=null==m?void 0:m.info)||void 0===t||t.call(m,"FileMessageItemBody: Not allowed to download."),[3,3];case 2:return e=r.sent(),null===(n=null==m?void 0:m.error)||void 0===n||n.call(m,"FileMessageItemBody: Error occurred while determining download continuation:",e),[3,3];case 3:return[2]}}))}))}:b;return a.a.createElement("div",{className:JA([i,"sendbird-file-message-item-body",l?"outgoing":"incoming",c?"mouse-hover":"",h&&(null===(t=null==s?void 0:s.reactions)||void 0===t?void 0:t.length)>0?"reactions":""])},a.a.createElement("div",{className:"sendbird-file-message-item-body__file-icon"},a.a.createElement(YS,{className:"sendbird-file-message-item-body__file-icon__icon",type:{IMAGE:QS.PHOTO,VIDEO:QS.PLAY,AUDIO:QS.FILE_AUDIO,GIF:QS.GIF,OTHERS:QS.FILE_DOCUMENT}[SA(null==s?void 0:s.type)],fillColor:XS.PRIMARY,width:"24px",height:"24px"})),a.a.createElement(cR,{className:"sendbird-file-message-item-body__file-name",onClick:C,color:l?oR.ONCONTENT_1:oR.ONBACKGROUND_1},a.a.createElement(_N,{className:"sendbird-file-message-item-body__file-name__text",testID:"sendbird-file-message-item-body__file-name__text",type:vN.BODY_1,color:l?EN.ONCONTENT_1:EN.ONBACKGROUND_1},iM((null==s?void 0:s.name)||(null==s?void 0:s.url),y))))}function OU(e,t){return Object(i.useLayoutEffect)((function(){var t;null===(t=e.current)||void 0===t||t.focus()}),[e.current]),Gm((function(e){var n=t[e.key];null==n||n(e),e.stopPropagation()}))}var RU="MULTI";function kU(e){if(e.viewerType!==RU){var t=e.onDelete,n=e.isByMe,r=e.disableDelete,i=e.className;return n?a.a.createElement("div",{className:"sendbird-fileviewer__header__right__actions__delete ".concat(i)},a.a.createElement(YS,{className:r?"disabled":"",type:QS.DELETE,fillColor:r?XS.GRAY:XS.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(e){r||null==t||t(e)}})):a.a.createElement(a.a.Fragment,null)}return a.a.createElement(a.a.Fragment,null)}function xU(e){if(e.viewerType===RU){var t=e.onClickLeft,n=e.onClickRight;return a.a.createElement("div",{className:"sendbird-file-viewer-slider"},a.a.createElement("div",{className:"sendbird-file-viewer-arrow--left"},a.a.createElement(YS,{type:QS.SLIDE_LEFT,fillColor:XS.ON_BACKGROUND_1,height:"32px",width:"32px",onClick:function(e){null==t||t(),e.stopPropagation()}})),a.a.createElement("div",{className:"sendbird-file-viewer-arrow--right"},a.a.createElement(YS,{type:QS.SLIDE_LEFT,fillColor:XS.ON_BACKGROUND_1,height:"32px",width:"32px",onClick:function(e){e.stopPropagation(),null==n||n()}})))}return a.a.createElement(a.a.Fragment,null)}var DU=function(e){var t=e.profileUrl,n=e.nickname,r=e.onClose,s=e.onDownloadClick,o=e,l=o.onClickLeft,u=o.onClickRight,c=Object(i.useRef)(null),d=OU(c,{Escape:function(e){return null==r?void 0:r(e)},ArrowLeft:function(){return null==l?void 0:l()},ArrowRight:function(){return null==u?void 0:u()}}),h=function(e){var t=e.props;if(t.viewerType===RU){var n=t;return n.fileInfoList[n.currentIndex]}var r=t;return{name:r.name,type:r.type,url:r.url}}({props:e}),f=h.name,p=h.type,g=h.url,_=Object(i.useContext)(XC).stringSet;return a.a.createElement(rw,{onClose:r},a.a.createElement("div",{className:"sendbird-fileviewer","data-testid":"sendbird-fileviewer",onKeyDown:d,tabIndex:1,ref:c},a.a.createElement("div",{className:"sendbird-fileviewer__header"},a.a.createElement("div",{className:"sendbird-fileviewer__header__left"},a.a.createElement("div",{className:"sendbird-fileviewer__header__left__avatar"},a.a.createElement(iR,{height:"32px",width:"32px",src:t})),a.a.createElement("div",{className:"sendbird-fileviewer__header__left__text-container"},a.a.createElement(_N,{className:"sendbird-fileviewer__header__left__filename",type:vN.H_2,color:EN.ONBACKGROUND_1},f),a.a.createElement(_N,{className:"sendbird-fileviewer__header__left__sender-name",type:vN.BODY_1,color:EN.ONBACKGROUND_2},n))),a.a.createElement("div",{className:"sendbird-fileviewer__header__right"},TA(p)&&a.a.createElement("div",{className:"sendbird-fileviewer__header__right__actions"},a.a.createElement("a",{className:"sendbird-fileviewer__header__right__actions__download",rel:"noopener noreferrer",href:g,target:"_blank",onClick:s},a.a.createElement(YS,{type:QS.DOWNLOAD,fillColor:XS.ON_BACKGROUND_1,height:"24px",width:"24px"})),a.a.createElement(kU,m({className:"sendbird-fileviewer__header__right__actions__delete"},e))),a.a.createElement("div",{className:"sendbird-fileviewer__header__right__actions__close"},a.a.createElement(YS,{type:QS.CLOSE,fillColor:XS.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(e){return null==r?void 0:r(e)}})))),a.a.createElement("div",{className:"sendbird-fileviewer__content"},CA(p)&&a.a.createElement("video",{controls:!0,className:"sendbird-fileviewer__content__video"},a.a.createElement("source",{src:g,type:p})),bA(p)&&a.a.createElement("img",{src:g,alt:f,className:e.viewerType===RU?"sendbird-fileviewer__content__img__multi":"sendbird-fileviewer__content__img"}),!TA(p)&&a.a.createElement("div",{className:"sendbird-fileviewer__content__unsupported"},a.a.createElement(_N,{type:vN.H_1,color:EN.ONBACKGROUND_1},(null==_?void 0:_.UI__FILE_VIEWER__UNSUPPORT)||"Unsupported message")),a.a.createElement(xU,m({},e)))))};function UU(e){var t,n,r,i=e.message,o=e.statefulFileInfoList,l=void 0===o?[]:o,u=e.onClose,c=e.isByMe,d=void 0!==c&&c,h=e.onDelete,f=e.currentIndex,p=e.onClickLeft,m=e.onClickRight,g=e.onDownloadClick;if(DA(i)){var _=i;return a.a.createElement(DU,{profileUrl:_.sender.profileUrl,nickname:_.sender.nickname,viewerType:RU,fileInfoList:l.filter((function(e){return e.url})).map((function(e){return{name:e.fileName||"",type:e.mimeType||"",url:e.url||""}})),currentIndex:f||0,onClickLeft:p||$C,onClickRight:m||$C,onClose:u,onDownloadClick:g})}if(xA(i)){_=i;return Object(s.createPortal)(a.a.createElement(DU,{profileUrl:null===(t=_.sender)||void 0===t?void 0:t.profileUrl,nickname:null===(n=_.sender)||void 0===n?void 0:n.nickname,name:_.name,type:_.type,url:null==_?void 0:_.url,isByMe:d,disableDelete:((null===(r=_.threadInfo)||void 0===r?void 0:r.replyCount)||0)>0,onClose:u,onDelete:h||$C,onDownloadClick:g}),document.getElementById(JS))}return a.a.createElement(a.a.Fragment,null)}function LU(e){var t,n=e.children,r=e.className,i=e.message,s=e.isReactionEnabled;return a.a.createElement("div",{className:"sendbird-image-grid-wrap"},a.a.createElement("div",{className:JA([null!=r?r:"","sendbird-image-grid",s&&(null===(t=null==i?void 0:i.reactions)||void 0===t?void 0:t.length)>0?"reactions":""])},n))}var PU={CHAT_WEB:"calc(".concat(200,"px - ").concat(6,"px)"),CHAT_MOBILE:"calc(50vw - ".concat(77,"px)"),THREAD_PARENT_WEB:"calc(".concat(118,"px)"),THREAD_PARENT_MOBILE:"calc(50vw - ".concat(42,"px)"),THREAD_CHILD_WEB:"calc(".concat(94,"px)"),THREAD_CHILD_MOBILE:"calc(50vw - ".concat(72,"px)")},FU={CHAT_WEB:"6px",CHAT_MOBILE:"6px",THREAD_PARENT_WEB:"6px",THREAD_PARENT_MOBILE:"6px",THREAD_CHILD_WEB:"6px",THREAD_CHILD_MOBILE:"6px"},BU="parent",jU="child";function HU(e){var t=this,n=e.className,r=e.message,s=e.isReactionEnabled,o=void 0!==s&&s,l=e.threadMessageKindKey,u=e.statefulFileInfoList,c=void 0===u?[]:u,d=e.onBeforeDownloadFileMessage,h=void 0===d?null:d,f=IC().state.config.logger,p=Object(i.useState)(-1),m=p[0],g=p[1];return l?a.a.createElement(a.a.Fragment,null,m>-1&&a.a.createElement(UU,{message:r,statefulFileInfoList:c,currentIndex:m,onClickLeft:function(){g(0===m?c.length-1:m-1)},onClickRight:function(){g(m===c.length-1?0:m+1)},onClose:function(){g(-1)},onDownloadClick:function(e){return _(t,void 0,void 0,(function(){var t,n,i;return v(this,(function(a){switch(a.label){case 0:if(!h)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,h({message:r,index:m})];case 2:return a.sent()||(e.preventDefault(),null===(n=null==f?void 0:f.info)||void 0===n||n.call(f,"MultipleFilesMessageItemBody: Not allowed to download.")),[3,4];case 3:return t=a.sent(),null===(i=null==f?void 0:f.error)||void 0===i||i.call(f,"MultipleFilesMessageItemBody: Error occurred while determining download continuation:",t),[3,4];case 4:return[2]}}))}))}}),a.a.createElement(LU,{className:n,message:r,isReactionEnabled:o},c.map((function(e,t){var n,i,s,o;return a.a.createElement("div",{className:"sendbird-multiple-files-image-renderer-wrapper",onClick:r.sendingStatus===_e.SUCCEEDED?function(){return g(t)}:void 0,key:"sendbird-multiple-files-image-renderer-".concat(t,"-").concat(e.url)},a.a.createElement($O,{url:null!==(o=null!==(s=null===(i=null===(n=e.thumbnails)||void 0===n?void 0:n[0])||void 0===i?void 0:i.url)&&void 0!==s?s:e.url)&&void 0!==o?o:"",fixedSize:!1,width:PU[l],maxSideLength:PU.CHAT_WEB,height:PU[l],borderRadius:JO(FU[l],t,c.length),shadeOnHover:!0,isUploaded:!!e.isUploaded,placeHolder:function(t){var n=t.style;return e.mimeType&&NA(e.mimeType)?a.a.createElement(GU.GIF,{style:n}):a.a.createElement(GU.Default,{style:n})},defaultComponent:a.a.createElement(GU.LoadError,null)}))})))):a.a.createElement(a.a.Fragment,null)}var GU={Default:function(e){var t=e.style;return a.a.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder",style:t},a.a.createElement(YS,{type:QS.PHOTO,fillColor:XS.ON_BACKGROUND_2,width:"34px",height:"34px"}))},GIF:function(e){var t=e.style;return a.a.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder",style:t},a.a.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder__icon"},a.a.createElement(YS,{type:QS.GIF,fillColor:XS.THUMBNAIL_ICON,width:"34px",height:"34px"})))},LoadError:function(){return a.a.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder"},a.a.createElement(YS,{type:QS.THUMBNAIL_NONE,fillColor:XS.ON_BACKGROUND_2,width:"34px",height:"34px"}))}};var zU,VU,qU="progress-bar-color--primary",KU="progress-bar-color--gray",WU=function(e){var t=e.className,n=void 0===t?"":t,r=e.disabled,s=void 0!==r&&r,o=e.maxSize,l=e.currentSize,u=void 0===l?0:l,c=e.colorType,d=void 0===c?qU:c,h=Object(i.useMemo)((function(){return"".concat(u/o*100,"%")}),[u,o]);return a.a.createElement("div",{className:nN("sendbird-progress-bar",n,d,s&&"progress-bar--disabled")},a.a.createElement("div",{className:"sendbird-progress-bar__fill",style:{width:h}}))},YU=function(e){var t,n=e.key,r=void 0===n?"":n,a=e.channelUrl,s=void 0===a?"":a,o=e.audioFile,l=e.audioFileUrl,u=void 0===l?"":l,c=e.audioFileMimeType,d=void 0===c?"audio/mp3;sbu_type=voice":c,h=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=""),"".concat(e,"-").concat(t)}(s,r),f=Object(i.useContext)(UC),p=f.play,m=f.pause,g=f.stop,_=f.voicePlayerStore,v=sw().isRecordable,E=(null===(t=null==_?void 0:_.audioStorage)||void 0===t?void 0:t[h])||OC();return Object(i.useEffect)((function(){return function(){var e;if(o||u){var t=document.getElementById("sendbird-global-audio-player-id");null===(e=null==t?void 0:t.pause)||void 0===e||e.call(t)}}}),[]),{play:function(){v||null==p||p({groupKey:h,audioFile:o,audioFileUrl:u,audioFileMimeType:d})},pause:function(){null==m||m(h)},stop:function(e){void 0===e&&(e=""),null==g||g(e)},playbackTime:1e3*((null==E?void 0:E.playbackTime)||0),duration:1e3*((null==E?void 0:E.duration)||0),playingStatus:E.playingStatus}},QU=function(e){var t=e.className,n=e.time,r=void 0===n?0:n,i=e.labelType,s=void 0===i?vN.CAPTION_2:i,o=e.labelColor,l=void 0===o?EN.ONCONTENT_1:o,u=r<0?0:r,c=Math.floor(u/36e5),d=Math.floor(u%36e5/6e4),h=Math.floor(u%36e5%6e4/1e3);return a.a.createElement("div",{className:"sendbird-ui-play-time ".concat(t)},a.a.createElement(_N,{type:s,color:l},"".concat(c?c+":":"").concat(d<10?"0":"").concat(d||"0",":").concat(h<10?"0":"").concat(h)))},XU=function(e){var t,n=e.className,r=e.message,s=e.channelUrl,o=e.isByMe,l=void 0!==o&&o,u=e.isReactionEnabled,c=void 0!==u&&u,d=Object(i.useState)(!1),h=d[0],f=d[1],p=YU({channelUrl:s,key:"".concat(null==r?void 0:r.messageId),audioFileUrl:null==r?void 0:r.url,audioFileMimeType:null==r?void 0:r.type}),m=p.play,g=p.pause,_=p.playbackTime,v=void 0===_?0:_,E=p.duration,y=p.playingStatus,b=void 0===y?SC:y;Object(i.useEffect)((function(){var e;c&&(null===(e=null==r?void 0:r.reactions)||void 0===e?void 0:e.length)>0?f(!0):f(!1)}),[c,null===(t=null==r?void 0:r.reactions)||void 0===t?void 0:t.length]);var C=Object(i.useMemo)((function(){var e;if(null==r?void 0:r.metaArrays){var t=null===(e=null==r?void 0:r.metaArrays.find((function(e){return"KEY_VOICE_MESSAGE_DURATION"===e.key})))||void 0===e?void 0:e.value[0];return t?parseInt(t):1}return 1}),[null==r?void 0:r.metaArrays]);return a.a.createElement("div",{className:nN("sendbird-voice-message-item-body",n,h&&"is-reactions-contained")},a.a.createElement(WU,{className:"sendbird-voice-message-item-body__progress-bar",maxSize:E||C,currentSize:v,colorType:l?qU:KU}),a.a.createElement("div",{className:"sendbird-voice-message-item-body__status-button"},(b===SC||b===MC)&&a.a.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button",onClick:m},a.a.createElement(YS,{width:"18px",height:"18px",type:QS.PLAY,fillColor:XS.PRIMARY})),b===wC&&a.a.createElement(FO,{width:"22.2px",height:"22.2px"},a.a.createElement(YS,{width:"22.2px",height:"22.2px",type:QS.SPINNER,fillColor:XS.PRIMARY_2})),b===AC&&a.a.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button",onClick:function(){g()}},a.a.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause"},a.a.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause__inner"}),a.a.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause__inner"})))),a.a.createElement(QU,{className:"sendbird-voice-message-item-body__playback-time",time:C-v,labelType:vN.BODY_1,labelColor:l?EN.ONCONTENT_1:EN.ONBACKGROUND_1}))};function ZU(e){var t,n,r=e.className,s=void 0===r?"":r,o=e.message,l=e.isByMe,u=void 0!==l&&l,c=e.mouseHover,d=void 0!==c&&c,h=e.isReactionEnabled,f=void 0!==h&&h,p=e.showFileViewer,g=void 0===p?$C:p,_=e.style,v=void 0===_?{}:_,E=$D(o),y=Object(i.useState)(!1),b=y[0],C=y[1],N=wD({onLongPress:$C,onClick:function(){wA(o)&&(null==g||g(!0))}});return a.a.createElement("div",m({className:JA([s,"sendbird-thumbnail-message-item-body",u?"outgoing":"incoming",d?"mouse-hover":"",f&&(null!==(n=null===(t=o.reactions)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0?"reactions":""])},N),a.a.createElement($O,{className:"sendbird-thumbnail-message-item-body__thumbnail",url:E||JD(o),alt:QD(o),width:(null==v?void 0:v.width)||"360px",height:(null==v?void 0:v.height)||"270px",onLoad:function(){C(!0)},placeHolder:function(e){var t=e.style;return a.a.createElement("div",{className:"sendbird-thumbnail-message-item-body__placeholder",style:t})}}),qA(o)&&!E&&!b&&a.a.createElement("video",{className:"sendbird-thumbnail-message-item-body__video"},a.a.createElement("source",{src:JD(o),type:QD(o)})),a.a.createElement("div",{className:"sendbird-thumbnail-message-item-body__image-cover"}),(qA(o)||KA(o))&&a.a.createElement("div",{className:"sendbird-thumbnail-message-item-body__icon-wrapper"},a.a.createElement("div",{className:"sendbird-thumbnail-message-item-body__icon-wrapper__icon"},a.a.createElement(YS,{type:qA(o)?QS.PLAY:QS.GIF,fillColor:XS.THUMBNAIL_ICON,width:"34px",height:"34px"}))))}function JU(e){var t,n=e.className,r=e.message,s=e.isByMe,o=void 0!==s&&s,l=e.mouseHover,u=void 0!==l&&l,c=e.isReactionEnabled,d=void 0!==c&&c,h=Object(i.useContext)(XC).stringSet;return a.a.createElement("div",{className:JA([null!=n?n:"","sendbird-unknown-message-item-body",o?"outgoing":"incoming",u?"mouse-hover":"",d&&(null===(t=null==r?void 0:r.reactions)||void 0===t?void 0:t.length)>0?"reactions":""])},a.a.createElement(_N,{className:"sendbird-unknown-message-item-body__header",type:vN.BODY_1,color:o?EN.ONCONTENT_1:EN.ONBACKGROUND_1},h.UNKNOWN__UNKNOWN_MESSAGE_TYPE),a.a.createElement(_N,{className:"sendbird-unknown-message-item-body__description",type:vN.BODY_1,color:o?EN.ONCONTENT_2:EN.ONBACKGROUND_2},h.UNKNOWN__CANNOT_READ_MESSAGE))}(VU=zU||(zU={})).Box="box",VU.Text="text",VU.Image="image",VU.TextButton="textButton",VU.ImageButton="imageButton",VU.Carousel="carouselView";const $U=(e,t)=>"string"!=typeof t[e]?{}:{[e]:eL(t[e])};function eL(e){return e.startsWith("#")?9===e.length?`#${e.slice(3)}${e[1]}${e[2]}`:5===e.length?`#${e.slice(2)}${e[1]}`:e:e}const tL=e=>e?{viewStyle:Object.assign(Object.assign(Object.assign({},e),$U("backgroundColor",e)),$U("borderColor",e))}:{},nL={run(e){return e.type===zU.Text||e.type===zU.TextButton?Object.assign(Object.assign(Object.assign({},e),tL(e.viewStyle)),(t=e.textStyle)?{textStyle:Object.assign(Object.assign({},t),$U("color",t))}:{}):e.type===zU.ImageButton||e.type===zU.Image?Object.assign(Object.assign(Object.assign({},e),tL(e.viewStyle)),(n=e.imageStyle)?{imageStyle:Object.assign(Object.assign({},n),$U("tintColor",n))}:{}):Object.assign(Object.assign({},e),tL(e.viewStyle));var t,n}},rL=e=>"string"==typeof e?!Number.isNaN(Number(e)):"number"==typeof e&&!Number.isNaN(e),iL=(e,t)=>void 0===t[e]||null===t[e]?{}:rL(t[e])?{[e]:Number(t[e])}:{},aL=(e,t)=>t?{[e]:{left:rL(t.left)?Number(t.left):t.left,right:rL(t.right)?Number(t.right):t.right,top:rL(t.top)?Number(t.top):t.top,bottom:rL(t.bottom)?Number(t.bottom):t.bottom}}:{},sL=(e,t)=>t?{[e]:{type:t.type,value:rL(t.value)?Number(t.value):t.value}}:{},oL=e=>{return Object.assign(Object.assign(Object.assign({},sL("width",e.width)),sL("height",e.height)),(t=e.viewStyle)?{viewStyle:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t),iL("borderWidth",t)),iL("radius",t)),aL("margin",t.margin)),aL("padding",t.padding))}:{});var t},lL=e=>{return Object.assign(Object.assign(Object.assign({},oL(e)),(t=e.textStyle)?{textStyle:Object.assign(Object.assign(Object.assign({},t),iL("size",t)),iL("weight",t))}:{}),iL("maxTextLines",e));var t},uL=e=>{return Object.assign(Object.assign({},oL(e)),(t=e.metaData)?{metaData:{pixelWidth:rL(t.pixelWidth)?Number(t.pixelWidth):t.pixelWidth,pixelHeight:rL(t.pixelHeight)?Number(t.pixelHeight):t.pixelHeight}}:{});var t},cL=e=>{return Object.assign(Object.assign(Object.assign({},oL(e)),(t=e.carouselStyle)?{carouselStyle:Object.assign(Object.assign({},t),iL("spacing",t))}:{}),{items:e.items.map(e=>Object.assign(Object.assign({},e),{body:Object.assign(Object.assign({},e.body),{items:e.body.items.map(e=>dL.run(e))})}))});var t},dL={run:e=>e.type===zU.Text||e.type===zU.TextButton?Object.assign(Object.assign({},e),lL(e)):e.type===zU.ImageButton||e.type===zU.Image?Object.assign(Object.assign({},e),uL(e)):e.type===zU.Carousel?Object.assign(Object.assign({},e),cL(e)):Object.assign(Object.assign({},e),oL(e))},hL=()=>{},fL=e=>{var t;const n=(null==e?void 0:e.defaultMapper)||hL,r={defaultMapper:n,mapBoxProps:(null==e?void 0:e.mapBoxProps)||n,mapTextProps:(null==e?void 0:e.mapTextProps)||n,mapImageProps:(null==e?void 0:e.mapImageProps)||n,mapTextButtonProps:(null==e?void 0:e.mapTextButtonProps)||n,mapImageButtonProps:(null==e?void 0:e.mapImageButtonProps)||n,mapCarouselProps:(null==e?void 0:e.mapCarouselProps)||n},i=[nL,dL,...null!==(t=null==e?void 0:e.transforms)&&void 0!==t?t:[]],a=new Set;return{setTransforms(e){i.length=0,i.push(...e),a.clear()},addTransforms(e){i.push(...e)},parse(e,t){const n=i.reduce((e,t)=>t.run(e),e);switch(n.type){case zU.Box:return{transformed:n,properties:r.mapBoxProps(n,t)};case zU.Text:return{transformed:n,properties:r.mapTextProps(n,t)};case zU.Image:return{transformed:n,properties:r.mapImageProps(n,t)};case zU.TextButton:return{transformed:n,properties:r.mapTextButtonProps(n,t)};case zU.ImageButton:return{transformed:n,properties:r.mapImageButtonProps(n,t)};case zU.Carousel:return{transformed:n,properties:r.mapCarouselProps(n,t)};default:return{transformed:n,properties:void 0}}}}},pL=({children:e})=>a.a.createElement(a.a.Fragment,null,e);function mL(e){var t,n,r,i,a,s;return{box:(null===(t=null==e?void 0:e.views)||void 0===t?void 0:t.box)||pL,text:(null===(n=null==e?void 0:e.views)||void 0===n?void 0:n.text)||pL,image:(null===(r=null==e?void 0:e.views)||void 0===r?void 0:r.image)||pL,imageButton:(null===(i=null==e?void 0:e.views)||void 0===i?void 0:i.imageButton)||pL,textButton:(null===(a=null==e?void 0:e.views)||void 0===a?void 0:a.textButton)||pL,carouselView:(null===(s=null==e?void 0:e.views)||void 0===s?void 0:s.carouselView)||pL}}const gL=Object(i.createContext)({sizes:{},updateSize:()=>{}}),_L=({children:e})=>{const[t,n]=Object(i.useState)({}),r=Object(i.useCallback)(e=>{var{id:t}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["id"]);t&&n(e=>Object.assign(Object.assign({},e),{[t]:r}))},[]);return a.a.createElement(gL.Provider,{value:{sizes:t,updateSize:r}},e)};var vL,EL,yL,bL,CL,NL,TL,IL,SL,wL;(EL=vL||(vL={})).Row="row",EL.Column="column",(bL=yL||(yL={})).Center="center",bL.Left="left",bL.Right="right",bL.Top="top",bL.Bottom="bottom",(NL=CL||(CL={}))[NL.FillParent=0]="FillParent",NL[NL.WrapContent=1]="WrapContent",(IL=TL||(TL={})).Normal="normal",IL.Bold="bold",(wL=SL||(SL={})).AspectFit="aspectFit",wL.AspectFill="aspectFill",wL.ScalesToFill="scalesToFill";const AL=[1,2],ML=e=>{switch(e){case yL.Right:case yL.Bottom:return"flex-end";case yL.Center:return"center";case yL.Left:case yL.Top:default:return"flex-start"}},OL=(e=>{const t=new Map,n=function(n){return(t.has(n)||t.set(n,e.call(this,n)))&&t.get(n)};return n.cache=t,n})(e=>{const t=(e,n)=>{"items"in e&&null!=(null==e?void 0:e.items)&&e.items.forEach((e,r)=>{const i=`${n}-${r}`;e.id=i,t(e,i)})};return e.forEach((e,n)=>{const r=""+n;e.id=r,t(e,r)}),e}),RL={rootLayout:vL.Column,view:{size:{width:{type:"flex",value:CL.FillParent},height:{type:"flex",value:CL.WrapContent}}},box:{layout:vL.Row,align:{vertical:yL.Top,horizontal:yL.Left}},textButton:{maxTextLines:1},carousel:{style:{spacing:10,maxChildWidth:240}}},kL=e=>{const t=e.Container||a.a.Fragment,n=e.UnknownMessage||(()=>null),r=e.parser||fL(),i=e.renderer||mL(),s=({templateItems:e,templateVersion:t,parentLayout:o=RL.box.layout,depth:l=0})=>{if(!(e=>!e||AL.includes(Number(e)))(t))throw new Error(`Cannot parse template item due to unsupported template version: ${t}, ${AL}`);return a.a.createElement(a.a.Fragment,null,e.map((e,u,c)=>{const d=r.parse(e,{parentLayout:o,depth:l,elemIdx:u,siblings:c}),h=d.transformed,f={key:u,siblings:c,parentLayout:o,parsedProperties:d.properties};switch(h.type){case zU.Carousel:if(!Array.isArray(h.items)||0===h.items.length)throw new Error("Cannot parse template item as Carousel if carousel has no items.");return a.a.createElement(i.carouselView,Object.assign({},h,f),h.items.map((e,t)=>a.a.createElement(s,{key:t,templateItems:e.body.items||[],depth:l+1,templateVersion:e.version})));case zU.Box:return a.a.createElement(i.box,Object.assign({},h,f),a.a.createElement(s,{templateItems:h.items||[],parentLayout:h.layout,depth:l+1,templateVersion:t}));case zU.Text:return a.a.createElement(i.text,Object.assign({},h,f));case zU.Image:return a.a.createElement(i.image,Object.assign({},h,f));case zU.TextButton:return a.a.createElement(i.textButton,Object.assign({},h,f));case zU.ImageButton:return a.a.createElement(i.imageButton,Object.assign({},h,f));default:return a.a.createElement(n,{item:h})}}))};return{MessageTemplate:({templateVersion:e,templateItems:n,parentLayout:r=RL.rootLayout})=>{const i=OL(n);return a.a.createElement(_L,null,a.a.createElement(t,null,a.a.createElement(s,{isRoot:!0,parentLayout:r,templateItems:i,templateVersion:e})))},MessageTemplateBase:s}};var xL,DL;(DL=xL||(xL={})).Web="web",DL.Custom="custom",DL.UIKit="uikit",zU.Image,xL.Web,SL.AspectFill,zU.Box,vL.Column,CL.FillParent,zU.Box,CL.FillParent,CL.FillParent,zU.Box,vL.Column,CL.FillParent,CL.WrapContent,zU.Text,yL.Center,yL.Center,CL.FillParent,zU.Image,xL.Web,CL.FillParent,SL.AspectFill,zU.Box,CL.FillParent,zU.Box,CL.FillParent,CL.FillParent,zU.Box,vL.Column,zU.Box,yL.Left,yL.Center,vL.Row,CL.FillParent,zU.Text,CL.FillParent,yL.Center,yL.Left,TL.Bold,zU.ImageButton,xL.UIKit,SL.AspectFit,zU.Text,zU.TextButton,xL.Web,TL.Bold,zU.Image,xL.Web,SL.AspectFill,zU.Box,vL.Column,CL.FillParent,zU.Box,CL.FillParent,vL.Row,zU.TextButton,xL.Web,TL.Bold,zU.TextButton,xL.Web,CL.FillParent,TL.Bold,zU.Box,CL.FillParent,vL.Row,zU.Text,CL.FillParent,TL.Bold,zU.ImageButton,xL.UIKit,SL.AspectFit,zU.Text,zU.Box,vL.Column,zU.Image,SL.AspectFill,zU.Box,vL.Column,zU.Text,TL.Bold,zU.Text,zU.Box,yL.Left,yL.Center,vL.Row,zU.Image,SL.AspectFill,zU.Box,yL.Left,yL.Center,vL.Column,zU.Text,TL.Bold,zU.Text,TL.Bold,zU.Box,yL.Left,yL.Center,vL.Row,zU.Image,SL.AspectFill,zU.Box,yL.Left,yL.Center,vL.Column,zU.Text,TL.Bold,zU.Text,TL.Bold,zU.Box,yL.Left,yL.Center,vL.Row,zU.Image,SL.AspectFill,zU.Box,yL.Left,yL.Center,vL.Column,zU.Text,TL.Bold,zU.Text,TL.Bold,zU.Box,yL.Left,yL.Center,vL.Row,zU.TextButton,xL.Web,TL.Bold,zU.TextButton,xL.Web,TL.Bold,zU.Box,vL.Column,zU.Image,zU.Box,vL.Column,zU.Box,vL.Row,zU.Box,vL.Column,zU.Text,TL.Bold,zU.Text,zU.ImageButton,xL.UIKit,zU.Box,vL.Column,zU.Box,yL.Left,yL.Center,vL.Row,zU.Image,SL.AspectFill,zU.Box,vL.Column,zU.Text,TL.Bold,zU.Text,zU.Box,yL.Left,yL.Center,vL.Row,zU.Image,SL.AspectFill,zU.Box,vL.Column,zU.Text,TL.Bold,zU.Text,CL.FillParent,CL.FillParent,CL.FillParent,CL.FillParent,CL.FillParent,CL.FillParent,CL.FillParent,CL.WrapContent,CL.FillParent,CL.FillParent;function UL({spacing:e,childrenLength:t,paddingInlineStart:n,paddingInlineEnd:r}){const s=n,o=r,l=Object(i.useRef)(null),u=Object(i.useRef)(Array.from({length:t},()=>a.a.createRef())),c=Object(i.useRef)(!1),d=Object(i.useRef)(!1),h=Object(i.useRef)(null),f=Object(i.useRef)({sx:null,sy:null,offset:0,translateX:0,currentIndex:0}),[p,m]=Object(i.useState)(()=>u.current.map(()=>0)),g=Object(i.useMemo)(()=>{let t=s;return p.map((n,r)=>{const i=t-(r>0?e:0),a=i-n;return t=a,{start:i,end:a}})},[p,e,s]),_=Object(i.useMemo)(()=>p.reduce((e,t)=>e+t,0)+e*(t-1),[p,e,t]);Object(i.useLayoutEffect)(()=>{m(u.current.map(e=>{var t,n;return null!==(n=null===(t=e.current)||void 0===t?void 0:t.clientWidth)&&void 0!==n?n:0}))},[t]),Object(i.useLayoutEffect)(()=>{g.length>0&&(f.current.translateX=g[0].start,C())},[g]);const v=()=>{l.current&&(c.current=!0,l.current.style.cursor="grabbing",l.current.style.transition="none",h.current=requestAnimationFrame(C))},E=()=>{l.current&&(c.current=!1,l.current.style.cursor="grab",l.current.style.transition="transform 0.5s ease",h.current&&(cancelAnimationFrame(h.current),h.current=null))},y=()=>{const{offset:e,currentIndex:n}=f.current,r=Math.abs(e)>=24;let i=n;r&&(e<0&&n<t-1)?i=n+1:r&&(e>0&&n>0)&&(i=n-1),f.current.currentIndex=i,f.current.translateX=function(e){var t,n;const r=null!==(n=null===(t=l.current)||void 0===t?void 0:t.clientWidth)&&void 0!==n?n:0,i=s,a=Math.min(0,r-_)-o;return Math.min(i,Math.max(a,e))}(g[i].start),f.current.offset=0},b=()=>{d.current=!1},C=()=>{l.current&&(l.current.style.transform=`translateX(${f.current.translateX+f.current.offset}px)`),h.current&&(h.current=requestAnimationFrame(C))};return{carouselRef:l,childrenRefs:u,handlers:{onMouseDown:e=>{v(),b(),f.current.sx=e.clientX,f.current.sy=e.clientY,f.current.offset=0,h.current=requestAnimationFrame(C)},onMouseMove:e=>{c.current&&null!==f.current.sx&&(f.current.offset=e.clientX-f.current.sx)},onMouseUp:()=>{c.current&&(b(),y(),E())},onMouseLeave:()=>{c.current&&(b(),y(),E())},onTouchStart:e=>{b(),E();const t=e.touches[0];f.current.sx=t.clientX,f.current.sy=t.clientY,f.current.offset=0,h.current=requestAnimationFrame(C)},onTouchMove:e=>{if(null===f.current.sx||null===f.current.sy||d.current)return;const{clientX:t,clientY:n}=e.touches[0],{sx:r,sy:i}=f.current;if(c.current)return void(f.current.offset=t-r);Math.abs(n-i)>Math.abs(t-r)?d.current=!0:(f.current.offset=t-r,l.current&&(l.current.style.touchAction="pan-x"),v())},onTouchEnd:()=>{l.current&&(l.current.style.touchAction="pan-y"),b(),y(),E()}}}}const LL=({children:e,style:t,spacing:n=RL.carousel.style.spacing,maxChildWidth:r=RL.carousel.style.maxChildWidth})=>{const i=null!=t?t:{},{paddingInlineStart:s=0,paddingInlineEnd:o=0}=i,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(i,["paddingInlineStart","paddingInlineEnd"]),{carouselRef:u,childrenRefs:c,handlers:d}=UL({spacing:n,childrenLength:e.length,paddingInlineStart:Number(s),paddingInlineEnd:Number(o)});return a.a.createElement("div",Object.assign({},d,{ref:u,className:"sb-message-template__carousel",style:Object.assign(Object.assign({},l),{gap:n,width:"100%",overflow:"visible"})}),e.map((e,t)=>a.a.createElement(PL,{ref:c.current[t],key:t,maxChildWidth:r},e)))},PL=a.a.forwardRef((function({maxChildWidth:e,children:t},n){const r=function(e,t){return!!e.templateItems.find(e=>{var n,r,i,a;const s="flex"===(null===(n=e.width)||void 0===n?void 0:n.type)&&(null===(r=e.width)||void 0===r?void 0:r.value)===CL.FillParent,o="fixed"===(null===(i=e.width)||void 0===i?void 0:i.type)&&(null===(a=e.width)||void 0===a?void 0:a.value)>=t;return s||o})}(t.props,e)?e:"fit-content";return a.a.createElement("div",{ref:n,style:{maxWidth:r,width:"100%",flexShrink:0,overflow:"hidden",userSelect:"none"}},t)}));function FL(e){var t;return e.type===zU.Text&&(null===(t=e.width)||void 0===t?void 0:t.value)==CL.WrapContent}const BL=({size:e,option:t})=>"wrap"===t?"flex"===e.type&&e.value==CL.WrapContent:"fill"===t?"flex"===e.type&&e.value==CL.FillParent:"fixed"===e.type;const jL=e=>{const{imageSize:t,canvasRef:n,canvasProps:r}=HL(e);return a.a.createElement("canvas",Object.assign({},r,{ref:n,width:null==t?void 0:t.width,height:null==t?void 0:t.height,onError:e.onError}))},HL=e=>{var{metaData:t,tintColor:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["metaData","tintColor"]);const a=Object(i.useRef)(null),[s,o]=Object(i.useState)(),l=Object(i.useMemo)(()=>(null==t?void 0:t.pixelHeight)&&(null==t?void 0:t.pixelWidth)?{width:t.pixelWidth,height:t.pixelHeight}:s,[s,null==t?void 0:t.pixelHeight,null==t?void 0:t.pixelWidth]);return Object(i.useEffect)(()=>{if(null==l&&(console.log("Canvas_ReactMessageTemplateImage: no metaData, render fit to container"),a.current)){a.current.style.width="100%",a.current.style.height="100%";const e=a.current.getBoundingClientRect();o(e)}},[l]),Object(i.useEffect)(()=>{if(r.src){const e=new Image,t=()=>{if(a.current&&n&&l){const t=a.current.getContext("2d");if(t){const{width:r,height:i}=l;t.clearRect(0,0,r,i),t.beginPath(),t.globalCompositeOperation="source-over",t.fillStyle="#000",t.drawImage(e,0,0,r,i),t.globalCompositeOperation="source-atop",t.fillStyle=n,t.fillRect(0,0,r,i)}}},i=e=>{var t;null===(t=r.onError)||void 0===t||t.call(r,e)};return e.addEventListener("load",t),e.addEventListener("error",i),e.src=r.src,()=>{e.removeEventListener("load",t),e.removeEventListener("error",i)}}},[r.src,l,n]),{canvasRef:a,canvasProps:r,imageSize:l}},GL=e=>a.a.createElement("img",Object.assign({},e,{onError:e.onError,referrerPolicy:"no-referrer"})),zL=e=>a.a.createElement("div",{style:Object.assign(Object.assign({},e.style),{backgroundColor:"transparent"})});const VL=e=>{var{tintColor:t,metaData:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["tintColor","metaData"]);const{hasError:i,onError:s}=qL(r.src);return r.onError&&console.warn("`onError` is intercepted and not executed in the ReactMessageTemplateImage."),i?a.a.createElement(zL,Object.assign({},r)):t&&!(e=>{var t;if("string"!=typeof e)return!1;return"gif"===(null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase())})(r.src)?a.a.createElement(jL,Object.assign({},r,{onError:s,tintColor:t,metaData:n})):a.a.createElement(GL,Object.assign({},r,{onError:s}))},qL=e=>{const[t,n]=Object(i.useState)(!1);return Object(i.useEffect)(()=>n(!1),[e]),{hasError:t,onError:Object(i.useCallback)(()=>n(!0),[])}};function KL(e){return Object.assign({display:"flex",overflow:"hidden",boxSizing:"border-box"},e)}function WL(e,t,n){!function(e,t,n){var r,i;const{width:a,height:s}=RL.view.size,{parentLayout:o}=n,l=function(e,t,n){const r={};"flex"===e.type&&e.value==CL.FillParent?(r.width="100%",n===vL.Row&&(r.flex=1)):"fixed"===e.type&&e.value>=0&&(r.width=e.value);"flex"===t.type&&t.value==CL.FillParent?(r.height="100%",n===vL.Column&&(r.flex=1)):"fixed"===t.type&&t.value>=0&&(r.height=t.value);return r}(null!==(r=t.width)&&void 0!==r?r:a,null!==(i=t.height)&&void 0!==i?i:s,o);Object.assign(e,l)}(e,t,n),function(e,t){var n,r,i,a,s,o,l,u;const{viewStyle:c}=t;e.marginBlockStart=null===(n=null==c?void 0:c.margin)||void 0===n?void 0:n.top,e.marginBlockEnd=null===(r=null==c?void 0:c.margin)||void 0===r?void 0:r.bottom,e.marginInlineStart=null===(i=null==c?void 0:c.margin)||void 0===i?void 0:i.left,e.marginInlineEnd=null===(a=null==c?void 0:c.margin)||void 0===a?void 0:a.right;const d=(null!==(o=null===(s=null==c?void 0:c.margin)||void 0===s?void 0:s.left)&&void 0!==o?o:0)+(null!==(u=null===(l=null==c?void 0:c.margin)||void 0===l?void 0:l.right)&&void 0!==u?u:0);d>0&&"100%"===e.width&&(e.width=`calc(100% - ${d}px)`);(null==c?void 0:c.backgroundColor)&&(e.backgroundColor=c.backgroundColor);(null==c?void 0:c.backgroundImageUrl)&&(e.backgroundImage=`url(${JSON.stringify(c.backgroundImageUrl)})`,e.backgroundSize="100% 100%",e.backgroundPosition="center");!function(e,t,n,r){t&&(e["--border-width"]=t+"px",e["--border-color"]=n||"transparent");r&&(e.borderRadius=r,e["--border-radius"]=r+"px")}(e,null==c?void 0:c.borderWidth,null==c?void 0:c.borderColor,null==c?void 0:c.radius)}(e,t)}function YL(e,t=RL.box.layout,n=RL.box.align){t===vL.Row&&(e.flexDirection="row",e.alignItems=ML(n.vertical),e.justifyContent=ML(n.horizontal)),t===vL.Column&&(e.flexDirection="column",e.alignItems=ML(n.horizontal),e.justifyContent=ML(n.vertical))}function QL(e,t){const{contentMode:n=SL.AspectFit}=t||{};if(n)switch(n){case SL.AspectFill:e.objectFit="cover";break;case SL.AspectFit:e.objectFit="contain";break;case SL.ScalesToFill:e.objectFit="fill"}}function XL(e,t){var n,r,i,a;const s=null==t?void 0:t.metaData;(null==s?void 0:s.pixelHeight)&&(null==s?void 0:s.pixelWidth)&&"fixed"!==(null===(n=null==t?void 0:t.width)||void 0===n?void 0:n.type)&&"fixed"!==(null===(r=null==t?void 0:t.height)||void 0===r?void 0:r.type)&&(e.aspectRatio=`${null===(i=null==t?void 0:t.metaData)||void 0===i?void 0:i.pixelWidth} / ${null===(a=null==t?void 0:t.metaData)||void 0===a?void 0:a.pixelHeight}`)}function ZL(e){return{WebkitLineClamp:e,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden",overflowWrap:"anywhere",flex:1}}function JL(e,t,n){const{textStyle:r,width:i}=t,{size:a,color:s,weight:o}=r||{};if(a&&(e.fontSize=a),s&&(e.color=s),o&&(e.fontWeight=o),"flex"===(null==i?void 0:i.type)&&(null==i?void 0:i.value)==CL.WrapContent&&(e.width="fit-content",e.maxWidth="100%"),t.type===zU.Text){const{siblings:t,elemIdx:r}=n;null!=t&&t.length>=2&&t.every(FL)&&(e.flexShrink=t.length-1===r?1:0)}}const $L=a.a.createContext(null),eP=e=>{const{message:t,handleWebAction:n,handleCustomAction:r,handlePredefinedAction:i,children:s}=e,o=a.a.useMemo(()=>({message:t,handleWebAction:n,handleCustomAction:r,handlePredefinedAction:i}),[null==t?void 0:t.updatedAt]);return a.a.createElement($L.Provider,{value:o},s)};function tP(e){const t=Object(i.useRef)(e);return Object(i.useEffect)(()=>{t.current=e},[e]),Object(i.useCallback)((...e)=>t.current(...e),[t])}function nP(){}function rP(e){const t=tP(e);return function(e,t){const n=tP(e),r=Object(i.useRef)(nP);return Object(i.useCallback)(t=>{if(r.current(),r.current=nP,null!=t){const n=e(t);"function"==typeof n&&(r.current=n)}},[n,...t])}(e=>{const n=new ResizeObserver(e=>{null!=e[0]&&t(e[0])});return n.observe(e),()=>{n.unobserve(e)}},[t])}function iP({width:e=RL.view.size.width,height:t=RL.view.size.height,parentLayout:n=RL.box.layout,option:r}){return n===vL.Row?BL({size:e,option:r}):BL({size:t,option:r})}function aP(e){const{style:t,props:n}=e,r=function(){const[e,t]=Object(i.useState)(-1),[n,r]=Object(i.useState)(-1),[a,s]=Object(i.useState)(-1),[o,l]=Object(i.useState)(-1),[u,c]=Object(i.useState)(-1),[d,h]=Object(i.useState)(-1);return{ref:rP(e=>{const{width:n,height:i}=e.contentRect,a=e.target,{width:o,height:u}=a.getBoundingClientRect();t(o),r(u),s(n),l(i),c(o-n),h(u-i)}),width:e,height:n,contentWidth:a,contentHeight:o,paddingWidth:u,paddingHeight:d}}(),{ref:a}=r,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(r,["ref"]),{updateSize:o,sizes:l}=Object(i.useContext)(gL),{id:u,siblings:c,parentLayout:d}=n,{width:h,height:f,paddingWidth:p,paddingHeight:m,contentWidth:g,contentHeight:_}=s;Object(i.useEffect)(()=>{o({id:n.id,width:h,height:f,paddingWidth:p,paddingHeight:m,contentWidth:g,contentHeight:_})},[n.id,h,f,p,m,g,_,o]);return{recalculatedStyle:Object(i.useMemo)(()=>{const e=(e=0,t)=>{var n,r,i,a;return d===vL.Row?e+(null!==(r=null===(n=l[t.id])||void 0===n?void 0:n.contentWidth)&&void 0!==r?r:0):e+(null!==(a=null===(i=l[t.id])||void 0===i?void 0:i.contentHeight)&&void 0!==a?a:0)};if(iP({width:n.width,height:n.height,parentLayout:d,option:"fill"})){const n=c.filter(({width:e,height:t})=>!iP({width:e,height:t,parentLayout:d,option:"fill"})).reduce(e,0),r=c.filter(({width:e,height:t})=>iP({width:e,height:t,parentLayout:d,option:"fill"})).length,i=d===vL.Row?{maxWidth:`calc((100% - ${n}px) / ${r})`}:{maxHeight:`calc((100% - ${n}px) / ${r})`};return Object.assign(Object.assign(Object.assign({},t),i),0==h&&{height:0})}{const n=c.findIndex(e=>e.id===u),r=c.slice(0,n).filter(({width:e,height:t})=>iP({width:e,height:t,parentLayout:d,option:"wrap"})).reduce(e,0);return Object.assign(Object.assign(Object.assign({},t),0===h&&{height:0}),d===vL.Row?{maxWidth:`calc(100% - ${r}px)`}:{maxHeight:`calc(100% - ${r}px)`})}},[n.width,n.height,d,l,c,t,h,u]),elemRef:a}}const sP=(e="")=>((e="")=>["http://","https://","ftp://"].some(t=>e.startsWith(t)))(e)?e:"https://"+e,oP=({children:e,props:t,className:n,style:r})=>{var i,s,o,l,u,c,d,h,f;const{recalculatedStyle:p,elemRef:m}=aP({style:r,props:t}),{message:g,handleWebAction:_,handleCustomAction:v,handlePredefinedAction:E}=(()=>{const e=a.a.useContext($L);if(!e)throw new Error("useMessageContext must be used within a MessageProvider");return e})(),y=(null===(i=t.viewStyle)||void 0===i?void 0:i.borderWidth)?"sb-message-template__border":"",b={paddingBlockStart:null===(o=null===(s=t.viewStyle)||void 0===s?void 0:s.padding)||void 0===o?void 0:o.top,paddingBlockEnd:null===(u=null===(l=t.viewStyle)||void 0===l?void 0:l.padding)||void 0===u?void 0:u.bottom,paddingInlineStart:null===(d=null===(c=t.viewStyle)||void 0===c?void 0:c.padding)||void 0===d?void 0:d.left,paddingInlineEnd:null===(f=null===(h=t.viewStyle)||void 0===h?void 0:h.padding)||void 0===f?void 0:f.right},C=e=>{var n,r,i,a,s,o,l;"web"===(null===(n=t.action)||void 0===n?void 0:n.type)?_?_(e,t.action,g):null===(i=null===window||void 0===window?void 0:window.open(sP(null===(r=null==t?void 0:t.action)||void 0===r?void 0:r.data),"_blank","noopener noreferrer"))||void 0===i||i.focus():"custom"===(null===(a=t.action)||void 0===a?void 0:a.type)?v?v(e,t.action,g):null===(o=null===window||void 0===window?void 0:window.open(sP(null===(s=null==t?void 0:t.action)||void 0===s?void 0:s.data),"_blank","noopener noreferrer"))||void 0===o||o.focus():"uikit"===(null===(l=t.action)||void 0===l?void 0:l.type)&&(null==E||E(e,t.action,g))};if(t.type===zU.TextButton)return a.a.createElement("button",{className:lP(n,y),"data-sb-template-id":t.elementId,style:Object.assign(Object.assign({},r),b),onClick:C},e);const{display:N,flexDirection:T,justifyContent:I,alignItems:S,objectFit:w}=p,A=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(p,["display","flexDirection","justifyContent","alignItems","objectFit"]);return a.a.createElement("div",{ref:m,className:lP(n,y,t.action&&"sb-message-template__action"),"data-sb-template-id":t.elementId,style:A,onClick:C},a.a.createElement("div",{style:Object.assign({display:N,flexDirection:T,justifyContent:I,alignItems:S,objectFit:w,width:"100%",height:"100%"},b)},e))};function lP(...e){return e.filter(e=>!!e).join(" ")}function uP(e){const{text:t,maxTextLines:n}=e,r=function(e){var t,n,r,i;const a=null===(t=null==e?void 0:e.height)||void 0===t?void 0:t.type,s=null===(n=null==e?void 0:e.width)||void 0===n?void 0:n.type,o="fixed"===a||"fixed"===s,l="flex"===a&&(null===(r=null==e?void 0:e.height)||void 0===r?void 0:r.value)===CL.FillParent||"flex"===s&&(null===(i=null==e?void 0:e.width)||void 0===i?void 0:i.value)===CL.FillParent;return o||l}(e),i="number"==typeof n&&n>0,s=function(e){return e.split("\n").map((e,t)=>a.a.createElement(a.a.Fragment,{key:t},e,a.a.createElement("br",null)))}(t);if(i||r){const e=Object.assign(Object.assign({},(i||r)&&{maxWidth:"100%"}),r&&{maxHeight:"100%",overflow:"hidden"});return a.a.createElement("div",{style:e},i?a.a.createElement("div",{style:ZL(n)},s):s)}return i?a.a.createElement("div",{style:ZL(n)},s):s}const cP=mL({views:{box:e=>a.a.createElement(oP,{className:"sb-message-template__box",elementId:e.elementId,style:e.parsedProperties,props:e},e.children),text:e=>a.a.createElement(oP,{className:"sb-message-template__text",elementId:e.elementId,style:e.parsedProperties,props:e},uP(e)),image(e){var t;return a.a.createElement(oP,{className:"sb-message-template__image-container",elementId:e.elementId,style:e.parsedProperties,props:e},a.a.createElement(VL,{className:"sb-message-template__image",alt:"image",src:e.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:null===(t=e.imageStyle)||void 0===t?void 0:t.tintColor,metaData:e.metaData}))},textButton:e=>a.a.createElement(oP,{className:"sb-message-template__text-button",elementId:e.elementId,style:e.parsedProperties,props:e},uP(Object.assign({maxTextLines:RL.textButton.maxTextLines},e))),imageButton(e){var t;return a.a.createElement(oP,{className:"sb-message-template__image-container sb-message-template__image-button",elementId:e.elementId,style:e.parsedProperties,props:e},a.a.createElement(VL,{className:"sb-message-template__image",alt:"image-button",src:e.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:null===(t=e.imageStyle)||void 0===t?void 0:t.tintColor,metaData:e.metaData}))},carouselView(e){var t,n;return a.a.createElement(LL,{maxChildWidth:null===(t=e.carouselStyle)||void 0===t?void 0:t.maxChildWidth,spacing:null===(n=e.carouselStyle)||void 0===n?void 0:n.spacing,style:e.parsedProperties},e.children)}}}),dP=fL({mapBoxProps(e,t){const n=KL();return WL(n,e,t),YL(n,e.layout,e.align),n},mapTextProps(e,t){var n;const r=KL({whiteSpace:"pre-line",wordBreak:"break-word"});return WL(r,e,t),JL(r,e,t),YL(r,vL.Row,e.align),function(e,t=RL.box.align.horizontal){e.textAlign=t}(r,null===(n=e.align)||void 0===n?void 0:n.horizontal),r},mapImageProps(e,t){const n=KL();return WL(n,e,t),QL(n,e.imageStyle),XL(n,e),n},mapTextButtonProps(e,t){const n=KL({whiteSpace:"pre-line",alignItems:"center",justifyContent:"center"});return WL(n,e,t),JL(n,e,t),n},mapImageButtonProps(e,t){const n=KL();return WL(n,e,t),QL(n,e.imageStyle),XL(n,e),n},mapCarouselProps(e,t){var n,r,i,a,s,o,l,u;const c=KL();return WL(c,e,t),c.paddingBlockStart=null===(r=null===(n=e.viewStyle)||void 0===n?void 0:n.padding)||void 0===r?void 0:r.top,c.paddingBlockEnd=null===(a=null===(i=e.viewStyle)||void 0===i?void 0:i.padding)||void 0===a?void 0:a.bottom,c.paddingInlineStart=null===(o=null===(s=e.viewStyle)||void 0===s?void 0:s.padding)||void 0===o?void 0:o.left,c.paddingInlineEnd=null===(u=null===(l=e.viewStyle)||void 0===l?void 0:l.padding)||void 0===u?void 0:u.right,c}});kL({renderer:cP,parser:dP,Container:({children:e,className:t})=>a.a.createElement("div",{className:"sb-message-template__parent "+t,style:{display:"flex",flexDirection:"column",maxWidth:400,marginBlockEnd:24}},e)});var hP=kL({parser:dP,renderer:cP,Container:function(e){var t=e.children,n=e.className;return a.a.createElement("div",{className:["sb-message-template__parent ".concat(n),"sendbird-message-template__root"].join(" ")},t)}}).MessageTemplate;function fP(e){var t=e.templateItems,n=e.templateVersion;return a.a.createElement(hP,{templateItems:t,templateVersion:n})}function pP(e){var t=e.className,n=e.message,r=e.isByMe,s=Object(i.useContext)(XC).stringSet,o=n.message;return a.a.createElement("div",{className:JA([null!=t?t:"",r?"outgoing":"incoming","sendbird-template-message-item-body__fallback_message"])},o?a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{type:vN.BODY_1,color:EN.ONCONTENT_INVERSE_1},o)):a.a.createElement(a.a.Fragment,null,a.a.createElement(_N,{className:"sendbird-template-message-item-body__fallback_message__header",type:vN.BODY_1,color:EN.ONCONTENT_INVERSE_1},s.UNKNOWN__TEMPLATE_ERROR),a.a.createElement(_N,{className:"sendbird-template-message-item-body__fallback_message__description",type:vN.BODY_1,color:EN.ONCONTENT_INVERSE_3},s.UNKNOWN__CANNOT_READ_TEMPLATE)))}function mP(e){var t=e.className,n=e.isByMe;return a.a.createElement("div",{className:nN(t,n?"outgoing":"incoming","sendbird-template-loading-message-item-body")},a.a.createElement(FO,{className:"sendbird-message-status__icon",testID:"sendbird-message-status-icon",width:"40px",height:"40px"},a.a.createElement(YS,{type:QS.SPINNER,fillColor:XS.CONTENT_INVERSE_3,width:"40px",height:"40px"})))}var gP=function(e){var t=e.message,n=e.templateVersion,r=e.templateItems;return a.a.createElement(eP,{message:t},a.a.createElement(fP,{templateVersion:n,templateItems:r}))},_P=function(e){var t={},n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=e[r];if("object"==typeof i&&null!==i){var a=_P(i),s=a[0],o=a[1];t[r]=s,n[r]=o}else if("string"==typeof i){var l=i.split(","),u=l[0],c=l[1];t[r]=u,n[r]=c||u}else t[r]=i,n[r]=i}return[t,n]};var vP=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return p(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){var n;null===(n=this.props.logger)||void 0===n||n.error("Error caught by ErrorBoundary: ",e,t)},t.prototype.render=function(){return this.state.hasError?this.props.fallbackMessage:this.props.children},t}(i.Component),EP=function(e,t,n){void 0===n&&(n="");for(var r=0,i=Object.entries(e);r<i.length;r++){var a=i[r],s=a[0],o=a[1],l=n?"".concat(n,".").concat(s):s;o&&"object"==typeof o?EP(o,t,l):t[l]=o}};var yP=function(e){var t=e.template,n=e.templateData,r=void 0===n?{}:n,i=e.colorVariables,a=e.theme,s={};i&&a&&(s=function(e){var t=e.colorVariables,n=e.theme,r=_P(t),i=r[0],a=r[1];return"light"===n?i:a}({colorVariables:i,theme:a}));var o,l=m(m({},r),s),u=(EP(l,o={}),o),c=t;return Object.entries(u).forEach((function(e){var t=e[0],n=e[1],r="\\{".concat(t,"\\}"),i=new RegExp(r,"g");c=c.replace(i,n)})),c};function bP(e){var t,n=e.className,r=void 0===n?"":n,s=e.message,o=e.isByMe,l=void 0!==o&&o,u=e.theme,c=void 0===u?"light":u,d=null===(t=s.extendedMessagePayload)||void 0===t?void 0:t.message_template,h=function(){return a.a.createElement(pP,{className:r,message:s,isByMe:l})};if(!(null==d?void 0:d.key))return h();var f=d.key,p=IC().state;if(!p)return h();var m=p.config.logger,g=p.utils,_=g.getCachedTemplate,v=g.updateMessageTemplatesInfo,E=p.stores.appInfoStore.waitingTemplateKeysMap,y=Object.entries(E).map((function(e){var t=e[0],n=e[1];return[t,n.requestedAt,n.erroredMessageIds.join(",")].join("-")})).join("_"),b=Object(i.useState)(T()),C=b[0],N=b[1];function T(){var e={filledMessageTemplateItemsList:[],isErrored:!1},t=[],n=_(f);if(n||t.push(f),null==d?void 0:d.view_variables)try{Object.entries(d.view_variables).forEach((function(e){e[0];e[1].forEach((function(e){var n=null==e?void 0:e.key;!n||_(n)||t.includes(n)||t.push(n)}))}))}catch(t){return m.error("TemplateMessageItemBody | received view_variables is malformed: ",d),e.isErrored=!0,e}try{if(t.length>0)!function(e){if(e.length>0){var t=[];e.forEach((function(e){var n=E[e];t.push([e,n])}));var n=Date.now(),r=[];t.forEach((function(e){var t=e[0],i=e[1];if(!i||-1===i.erroredMessageIds.indexOf(s.messageId)&&n>i.requestedAt+500)r.push(t);else if(i.erroredMessageIds.indexOf(s.messageId)>-1)throw new Error("TemplateMessageItemBody | fetching template key ".concat(t," for messageId: ").concat(s.messageId," has failed."))})),r.length>0&&v(r,s.messageId,n)}}(t);else if(n){var r=function(e){var t=yP({template:e.uiTemplate,templateData:d.variables,colorVariables:e.colorVariables,theme:c});if(d.view_variables){var n={};Object.entries(d.view_variables).forEach((function(e){var t=e[0],r=e[1],i=[];r.forEach((function(e){var r=null==e?void 0:e.key;if(r){var a=_(r);a||m.error("TemplateMessageItemBody | simple template is expected to be cached: ",r);var s=yP({template:a.uiTemplate,templateData:e.variables,colorVariables:a.colorVariables,theme:c});i.push({version:a.version,body:{items:JSON.parse(s)}}),n[t]=JSON.stringify(i)}}))})),Object.entries(n).forEach((function(e){var n=e[0],r=e[1];t=function(e,t,n){return function(e,t,n){var r="",i=0;return t.forEach((function(t){var a=t.start,s=t.end;r+=e.slice(i,a)+n,i=s})),r+=e.slice(i)}(e,function(e,t){for(var n=[],r=0;-1!==(r=e.indexOf(t,r));)n.push({start:r,end:r+t.length}),r+=t.length;return n}(e,t),n)}(t,'"@{'.concat(n,'}"'),r)}))}return JSON.parse(t)}(n);e.filledMessageTemplateItemsList.push({version:n.version,items:r})}}catch(t){m.error("TemplateMessageItemBody | fetching non-cached templates by given template keys failed: ",t),e.isErrored=!0}return e}return Object(i.useEffect)((function(){if(!C.isErrored&&0===C.filledMessageTemplateItemsList.length){var e=T();N(e)}}),[d.key,y]),C.isErrored?h():0===C.filledMessageTemplateItemsList.length?a.a.createElement(mP,{className:r,isByMe:l}):a.a.createElement("div",{className:JA([r,l?"outgoing":"incoming","sendbird-template-message-item-body"])},a.a.createElement(vP,{fallbackMessage:a.a.createElement(pP,{className:r,message:s,isByMe:l}),logger:m},C.filledMessageTemplateItemsList.map((function(e,t){var n;return a.a.createElement(gP,{key:t,message:s,templateVersion:null!==(n=e.version)&&void 0!==n?n:0,templateItems:e.items})}))))}function CP(e){var t=e.text,n=e.onCancel,r=Object(i.useContext)(XC).stringSet,s=OU(Object(i.useRef)(null),{Enter:function(){return null==n?void 0:n()},Escape:function(){return null==n?void 0:n()}});return a.a.createElement("div",{onKeyDown:s},a.a.createElement(rw,{contentClassName:"sendbird-message-feedback-modal-content__mobile",type:fN.PRIMARY,onSubmit:n,onClose:n,submitText:r.BUTTON__OK,renderHeader:function(){return a.a.createElement("div",{className:"sendbird-modal__header"},a.a.createElement(_N,{type:vN.H_1,color:EN.ONBACKGROUND_1,className:"sendbird-message-feedback-modal-header"},t))},customFooter:a.a.createElement("div",{className:"sendbird-message-feedback-modal-footer__root_failed"},a.a.createElement(NN,{onClick:n},a.a.createElement(_N,{type:vN.BUTTON_3,color:EN.ONCONTENT_1},r.BUTTON__OK)))}))}function NP(e){var t=e.className,n=void 0===t?"":t,r=e.isByMe,s=e.displayThreadReplies,o=e.bottom,l=e.message,u=e.channel,c=e.userId,d=e.chainBottom,h=void 0!==d&&d,f=Object(i.useRef)(null),p=QM(),m=p.disableUserProfile,g=p.renderUserProfile;return r||h||!lM(l)?null:a.a.createElement(SM,{menuTrigger:function(e){var t,r;return a.a.createElement(iR,{className:nN(n,s&&"use-thread-replies"),src:(null===(r=null===(t=null==u?void 0:u.members)||void 0===t?void 0:t.find((function(e){return(null==e?void 0:e.userId)===l.sender.userId})))||void 0===r?void 0:r.profileUrl)||l.sender.profileUrl||"",ref:f,width:"28px",height:"28px",bottom:o,onClick:function(){m||e()}})},menuItems:function(e){return g?g({user:l.sender,close:e,currentUserId:c,avatarRef:f}):a.a.createElement(EM,{parentRef:f,parentContainRef:f,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{user:l.sender,onSuccess:e}))}})}var TP=function(e){var t=e.children;return a.a.createElement(_N,{className:"sendbird-form-message__input__label",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},t)},IP=function(e){var t=e.name,n=e.required,r=e.errorMessage,s=e.isValid,o=e.values,l=e.isInvalidated,u=e.isSubmitTried,c=e.style,d=e.onFocused,h=e.onChange,f=e.placeHolder,p=e.isSubmitted,m=c.layout,g=c.options,_=void 0===g?[]:g,v=c.resultCount,E=null!=v?v:{},y=E.min,b=void 0===y?1:y,C=E.max,N=void 0===C?1:C,T=p?_.map((function(e){return{state:o.includes(e)?"submittedSelected":"submittedDefault",option:e}})):_.map((function(e){return{state:o.includes(e)?"selected":"default",option:e}})),I=Object(i.useContext)(XC).stringSet,S=function(){null==d||d(!0)},w=function(){null==d||d(!1)};return a.a.createElement("div",{className:"sendbird-form-message__input__root"},a.a.createElement(TP,null,a.a.createElement("div",{className:"sendbird-form-message__input__title-container"},t," ",!n&&a.a.createElement("span",{className:"sendbird-form-message__input__title-optional"},"(optional)"))),a.a.createElement("div",{className:"sendbird-input_for_form"},function(){switch(m){case"chip":return a.a.createElement("div",{className:"sendbird-form-message__input__chip-container"},T.map((function(e,t){return a.a.createElement("div",{className:"sendbird-form-message__input__chip ".concat(e.state),key:t,onClick:function(){return function(e){var t;p||(t=1===b&&1===N?"selected"===T[e].state?[]:[T[e].option]:T.reduce((function(t,n,r){return r===e?"default"===n.state&&o.length<N&&t.push(n.option):"selected"===n.state&&t.push(n.option),t}),[]),h(t))}(t)}},a.a.createElement("div",{className:"sendbird-form-message__input__chip-text"},e.option),p&&"submittedSelected"===e.state&&a.a.createElement(YS,{className:"sendbird-form-message__submitted-check-icon-chip",type:QS.DONE,fillColor:XS.SECONDARY_2,width:"20px",height:"20px"}))})));case"textarea":var e=o.length>0?o[0]:"";return a.a.createElement("div",{className:"sendbird-form-message__input__container"},p?a.a.createElement("div",{className:"sendbird-form-message__submitted-input-box textarea"},a.a.createElement("div",{className:"sendbird-form-message__submitted-input-box-text"},e),s&&a.a.createElement("div",{className:"sendbird-form-message__submitted-check-icon-container"},a.a.createElement(YS,{type:QS.DONE,fillColor:XS.SECONDARY_2,width:"20px",height:"20px"})),!e&&a.a.createElement(_N,{className:"sendbird-input__placeholder",type:vN.BODY_1,color:EN.ONBACKGROUND_3},I.FORM_ITEM_OPTIONAL_EMPTY)):a.a.createElement(a.a.Fragment,null,a.a.createElement("textarea",{className:nN("sendbird-input__input",!!r&&"error","sendbird-form-message__input__textarea"),required:n,disabled:p,value:e,onFocus:S,onBlur:w,onChange:function(e){var t=e.target.value;h(t?[t]:[])}}),f&&!e&&a.a.createElement(_N,{className:"sendbird-input__placeholder textarea",type:vN.BODY_1,color:EN.ONBACKGROUND_3},f)));case"text":case"number":case"phone":case"email":e=o.length>0?o[0]:"";return a.a.createElement("div",{className:"sendbird-form-message__input__container"},p?a.a.createElement("div",{className:"sendbird-form-message__submitted-input-box"},a.a.createElement("div",{className:"sendbird-form-message__submitted-input-box-text"},e),s&&a.a.createElement("div",{className:"sendbird-form-message__submitted-check-icon-container"},a.a.createElement(YS,{type:QS.DONE,fillColor:XS.SECONDARY_2,width:"20px",height:"20px"})),!e&&a.a.createElement(_N,{className:"sendbird-input__placeholder",type:vN.BODY_1,color:EN.ONBACKGROUND_3},I.FORM_ITEM_OPTIONAL_EMPTY)):a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{type:"number"===m?"text":m,inputMode:"number"===m?"numeric":"text",className:"sendbird-input__input ".concat(r?"error":""),name:t,required:n,disabled:p,value:e,onFocus:S,onBlur:w,onChange:function(e){var t=e.target.value;h(t?[t]:[])}}),f&&!e&&a.a.createElement(_N,{className:"sendbird-input__placeholder",type:vN.BODY_1,color:EN.ONBACKGROUND_3},f)));default:return a.a.createElement(a.a.Fragment,null)}}(),r&&(u||l)&&a.a.createElement(_N,{className:"sendbird-form-message__error-label",type:vN.CAPTION_3},r)))},SP=function(e){var t=e.isByMe,n=e.text;return a.a.createElement("div",{className:JA(["sendbird-unknown-message-item-body",t?"outgoing":"incoming"])},a.a.createElement(_N,{className:"sendbird-unknown-message-item-body__description",type:vN.BODY_1,color:t?EN.ONCONTENT_3:EN.ONBACKGROUND_3},n))};function wP(e){var t=this,n=e.message,r=e.form,s=e.isByMe,o=e.logger,l=r.items,u=r.id,c=Object(i.useContext)(XC).stringSet,d=Object(i.useState)(!1),h=d[0],f=d[1],p=Object(i.useState)(!1),g=p[0],E=p[1],y=Object(i.useState)((function(){var e=[];return l.forEach((function(t){var n=t.required,r=t.style,i=void 0===r?{}:r,a=i.layout,s=i.defaultOptions,o=void 0===s?[]:s;e.push({draftValues:"chip"===a?o:[],required:n,errorMessage:null,isInvalidated:!1})})),e})),b=y[0],C=y[1],N=r.isSubmitted,T=b.some((function(e){return!!e.errorMessage})),I=b.some((function(e){return e.isInvalidated})),S=T&&(g||I)||N,w=Object(i.useCallback)((function(){return _(t,void 0,void 0,(function(){var e;return v(this,(function(t){switch(t.label){case 0:E(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),b.some((function(e){return e.errorMessage}))?[2]:b.some((function(e){return e.required&&(!e.draftValues||0===e.draftValues.length)}))?(C((function(e){return e.map((function(e){return e.required&&0===e.draftValues.length?m(m({},e),{errorMessage:c.FORM_ITEM_REQUIRED}):e}))})),[2]):(b.forEach((function(e,t){l[t].draftValues=e.draftValues})),[4,n.submitMessageForm()]);case 2:return t.sent(),[3,4];case 3:return e=t.sent(),f(!0),null==o||o.error(e),[3,4];case 4:return[2]}}))}))}),[b,n.messageId,n.submitMessageForm,u]);return pO(r.version)?a.a.createElement("div",{className:JA(["".concat("sendbird-text-message-item-body"," disable-hover"),"sendbird-form-message__root","incoming"])},l.map((function(e,t){var n,r=e.name,i=e.placeholder,s=e.id,o=e.required,l=e.style,u=b[t],d=u.draftValues,h=void 0===d?[]:d,f=u.errorMessage;return a.a.createElement(IP,{key:s,style:l,placeHolder:i,values:null!==(n=e.submittedValues)&&void 0!==n?n:h,isInvalidated:b[t].isInvalidated,isSubmitTried:g,errorMessage:f,isValid:N,isSubmitted:N,name:r,required:o,onFocused:function(e){!f||e||b[t].isInvalidated?f||C((function(e){var n=e.slice(0);return n[t]=m(m({},n[t]),{isInvalidated:!1}),n})):C((function(e){var n=e.slice(0);return n[t]=m(m({},n[t]),{isInvalidated:!0}),n}))},onChange:function(n){C((function(r){var i=r.slice(0);return i[t]=m(m({},i[t]),{draftValues:n,errorMessage:e.isValid(n)?o&&0===n.length?c.FORM_ITEM_REQUIRED:null:c.FORM_ITEM_INVALID}),i}))}})})),a.a.createElement(NN,{className:"sendbird-form-message__submit-button",onClick:w,disabled:S,labelType:vN.BUTTON_2,labelColor:EN.ONCONTENT_1},N?"Submitted successfully":"Submit"),h&&a.a.createElement(CP,{text:"Submit failed.",onCancel:function(){f(!1)}})):a.a.createElement(SP,{isByMe:s,text:c.FORM_VERSION_ERROR})}var AP=function(e){var t,n=e.className,r=void 0===n?"sendbird-message-content__middle__message-item-body":n,s=e.message,o=e.channel,l=e.showFileViewer,u=e.onMessageHeightChange,c=e.onBeforeDownloadFileMessage,d=e.mouseHover,h=e.isMobile,f=e.config,p=e.isReactionEnabledInChannel,g=e.isByMe,_=null!==(t=e.customSubcomponentsProps)&&void 0!==t?t:{},v=function(e){var t=e.threadMessageKind,n=e.isMobile;return Object(i.useMemo)((function(){return fw(t).with(BU,(function(){return n?"THREAD_PARENT_MOBILE":"THREAD_PARENT_WEB"})).with(jU,(function(){return n?"THREAD_CHILD_MOBILE":"THREAD_CHILD_WEB"})).otherwise((function(){return n?"CHAT_MOBILE":"CHAT_WEB"}))}),[n,t])}({isMobile:h}),E=function(e){var t,n,r=Object(i.useRef)(new Map),a=function(e,t){return!r.current.has(e)&&t&&r.current.set(e,URL.createObjectURL(t)),r.current.get(e)},s=function(){r.current.size>0&&(r.current.forEach((function(e){return URL.revokeObjectURL(e)})),r.current.clear())};return Object(i.useEffect)((function(){return function(){return s()}}),[]),e&&e.isMultipleFilesMessage&&e.isMultipleFilesMessage()?e.sendingStatus===_e.SUCCEEDED?(s(),e.fileInfoList.map((function(e){var t,n;return m(m({},e),{url:e.url,isUploaded:!0,mimeType:null!==(t=e.mimeType)&&void 0!==t?t:void 0,fileName:null!==(n=e.fileName)&&void 0!==n?n:void 0})}))):null!==(n=null===(t=null==e?void 0:e.messageParams)||void 0===t?void 0:t.fileInfoList.map((function(e,t){var n,r;return m(m({},e),{url:null!==(r=null!==(n=a(t))&&void 0!==n?n:e.fileUrl)&&void 0!==r?r:e.file instanceof Blob?a(t,e.file):void 0,isUploaded:!e.file&&"string"==typeof e.fileUrl&&e.fileUrl.length>0})})))&&void 0!==n?n:[]:[]}(s),y=m({},EA),b=(null==o?void 0:o.isGroupChannel())&&f.groupChannel.enableOgtag,C=(null==o?void 0:o.isGroupChannel())&&f.groupChannel.enableFormTypeMessage,N=function(){return a.a.createElement(JU,{className:r,message:s,isByMe:g,mouseHover:d,isReactionEnabled:p})};return fw(s).when((function(e){return C&&LA(e)}),(function(){return a.a.createElement(wP,{isByMe:g,message:s,form:s.messageForm,logger:f.logger})})).when(PA,(function(){var e,t,n=s.extendedMessagePayload.message_template;return FA(n)?a.a.createElement(bP,{className:r,message:s,isByMe:g,theme:null==f?void 0:f.theme}):(null===(t=null===(e=f.logger)||void 0===e?void 0:e.error)||void 0===t||t.call(e,"TemplateMessageItemBody: invalid type value in message.extendedMessagePayload.message_template.",n),N())})).when((function(e){return b&&lM(e)&&HA(e)}),(function(){var e;return a.a.createElement(IU,{className:r,message:s,isByMe:g,mouseHover:d,isMentionEnabled:null!==(e=f.groupChannel.enableMention)&&void 0!==e&&e,isReactionEnabled:p,onMessageHeightChange:u,isMarkdownEnabled:f.groupChannel.enableMarkdownForUserMessage})})).when(GA,(function(){var e;return a.a.createElement(AU,{className:r,message:s,isByMe:g,mouseHover:d,isMentionEnabled:null!==(e=f.groupChannel.enableMention)&&void 0!==e&&e,isReactionEnabled:p,isMarkdownEnabled:f.groupChannel.enableMarkdownForUserMessage})})).when((function(e){return XA(e)===y.FILE}),(function(){return a.a.createElement(MU,{className:r,message:s,isByMe:g,mouseHover:d,isReactionEnabled:p,onBeforeDownloadFileMessage:c})})).when(DA,(function(){var e;return a.a.createElement(HU,m({className:r,message:s,isByMe:g,mouseHover:d,isReactionEnabled:p,threadMessageKindKey:v,statefulFileInfoList:E,onBeforeDownloadFileMessage:c},null!==(e=_.MultipleFilesMessageItemBody)&&void 0!==e?e:{}))})).when(YA,(function(){var e;return a.a.createElement(XU,{className:r,message:s,channelUrl:null!==(e=null==o?void 0:o.url)&&void 0!==e?e:"",isByMe:g,isReactionEnabled:p})})).when(zA,(function(){var e;return a.a.createElement(ZU,m({className:r,message:s,isByMe:g,mouseHover:d,isReactionEnabled:p,showFileViewer:l,style:h?{width:"100%"}:{}},null!==(e=_.ThumbnailMessageItemBody)&&void 0!==e?e:{}))})).otherwise((function(){return N()}))},MP=function(e){var t,n,r=e.channel,i=e.message;return a.a.createElement(_N,{className:"sendbird-message-content__middle__sender-name",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},(null===(n=null===(t=null==r?void 0:r.members)||void 0===t?void 0:t.find((function(e){var t;return(null==e?void 0:e.userId)===(null===(t=null==i?void 0:i.sender)||void 0===t?void 0:t.userId)})))||void 0===n?void 0:n.nickname)||function(e){return(null==e?void 0:e.sender)&&((null==(t=null==e?void 0:e.sender)?void 0:t.friendName)||(null==t?void 0:t.nickname)||(null==t?void 0:t.userId));var t}(i))},OP=a.a.forwardRef((function(e,t){var n=e.children,r=e.isSelected,i=e.onClick,s=void 0===i?function(){}:i,o=e.disabled,l=void 0!==o&&o;return a.a.createElement("button",{className:["sendbird-iconbutton__feedback",r?"sendbird-iconbutton__feedback__pressed":"",l?"sendbird-iconbutton__feedback__disabled":""].join(" "),ref:t,type:"button",onClick:function(e){null==s||s(e)},disabled:l},a.a.createElement("span",{className:["sendbird-iconbutton__feedback__inner",r?"sendbird-iconbutton__feedback__inner__pressed":"",l?"sendbird-iconbutton__feedback__inner__disabled":""].join(" ")},n))}));function RP(e){var t=e.hideMenu,n=e.onEditFeedback,r=e.onRemoveFeedback,i=JC().stringSet;return a.a.createElement(RD,{onBackdropClick:t},a.a.createElement("div",{className:"sendbird-message__bottomsheet--feedback-options-menu"},a.a.createElement("div",{className:"sendbird-message__bottomsheet--feedback-option",onClick:function(){t(),n()}},a.a.createElement(_N,{type:vN.BODY_1,color:EN.ONBACKGROUND_1},i.EDIT_COMMENT)),a.a.createElement("div",{className:"sendbird-message__bottomsheet--feedback-option",onClick:function(){t(),r()}},a.a.createElement(_N,{type:vN.BODY_1,color:EN.ERROR},i.REMOVE_FEEDBACK))))}var kP,xP,DP=function(e){var t=e.children;return a.a.createElement(_N,{className:"sendbird-input-label",type:vN.CAPTION_3,color:EN.ONBACKGROUND_1},t)},UP=a.a.forwardRef((function(e,t){var n=e.name,r=e.required,s=e.disabled,o=e.value,l=e.placeHolder,u=e.autoFocus,c=void 0!==u&&u,d=Object(i.useState)(o),h=d[0],f=d[1];return a.a.createElement("div",{className:"sendbird-input"},a.a.createElement("input",{className:"sendbird-input__input",ref:t,name:n,required:r,disabled:s,value:h,onChange:function(e){f(e.target.value)},autoFocus:c}),l&&!h&&a.a.createElement(_N,{className:"sendbird-input__placeholder",type:vN.BODY_1,color:EN.ONBACKGROUND_3},l))}));function LP(e){var t,n,r=e.selectedFeedback,s=e.message,o=e.onClose,l=e.onSubmit,u=e.onUpdate,c=e.onRemove,d=Object(i.useContext)(XC).stringSet,h=oN().isMobile,f=(null==s?void 0:s.myFeedback)&&r===s.myFeedback.rating,p=null===(t=null==s?void 0:s.myFeedback)||void 0===t?void 0:t.comment,m=function(){var e,t,n;if(r){var i=null!==(t=null===(e=_.current)||void 0===e?void 0:e.value)&&void 0!==t?t:"";f?i!==(null===(n=s.myFeedback)||void 0===n?void 0:n.comment)?null==u||u(r,i):null==o||o():s.myFeedback||null==l||l(r,i)}},g=Object(i.useRef)(),_=Object(i.useRef)(),v=OU(g,{Enter:function(){return m()},Escape:function(){return null==o?void 0:o()}});return a.a.createElement("div",{onKeyDown:v},a.a.createElement(rw,{contentClassName:"sendbird-message-feedback-modal-content__mobile",type:fN.PRIMARY,onCancel:o,onSubmit:function(){m()},submitText:d.BUTTON__SUBMIT,renderHeader:function(){return a.a.createElement("div",{className:"sendbird-modal__header"},a.a.createElement(_N,{type:vN.H_1,color:EN.ONBACKGROUND_1,className:"sendbird-message-feedback-modal-header"},d.FEEDBACK_MODAL_TITLE))},customFooter:a.a.createElement("div",{className:"sendbird-message-feedback-modal-footer__root"},!h&&(null==s?void 0:s.myFeedback)&&r===s.myFeedback.rating?a.a.createElement(NN,{type:fN.WARNING,onClick:c,labelType:vN.BUTTON_3},d.BUTTON__REMOVE_FEEDBACK):a.a.createElement("div",null),a.a.createElement("div",{className:"sendbird-message-feedback-modal-footer__right-content"},a.a.createElement(NN,{type:fN.SECONDARY,onClick:o},a.a.createElement(_N,{type:vN.BUTTON_3,color:EN.ONBACKGROUND_1},d.BUTTON__CANCEL)),a.a.createElement(NN,{onClick:function(){return m()}},a.a.createElement(_N,{type:vN.BUTTON_3,color:EN.ONCONTENT_1},p?d.BUTTON__SAVE:d.BUTTON__SUBMIT))))},a.a.createElement("div",{className:"sendbird-message-feedback-modal-body__root"},a.a.createElement(UP,{name:"sendbird-message-feedback-modal-body__root",ref:_,value:f?null===(n=s.myFeedback)||void 0===n?void 0:n.comment:void 0,placeHolder:d.FEEDBACK_CONTENT_PLACEHOLDER,autoFocus:!0}))))}function PP(e){var t,n,r,i=e.channel,s=e.message,o=e.showFileViewer,l=e.onMessageHeightChange,u=e.onBeforeDownloadFileMessage,c=e.renderSenderProfile,d=e.renderMessageHeader,h=e.renderMessageBody,f=e.isByMe,p=e.displayThreadReplies,g=e.mouseHover,_=e.isMobile,v=e.isReactionEnabledInChannel,E=e.hoveredMenuClassName,y=e.templateType,b=e.useReplying,C=IC().state.config,N=JC().dateLocale,T=null!==(t=jA[y])&&void 0!==t?t:"",I=c(m(m({},e),{chainBottom:!1,className:"",isByMe:f,displayThreadReplies:p})),S=d(e),w=h({message:s,channel:i,showFileViewer:o,onMessageHeightChange:l,mouseHover:g,isMobile:_,config:C,isReactionEnabledInChannel:v,isByMe:f,onBeforeDownloadFileMessage:u}),A=a.a.createElement(_N,{className:nN("sendbird-message-content__middle__body-container__created-at","right",E,T),type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},ok((null==s?void 0:s.createdAt)||0,"p",{locale:N})),M=null===(n=s.extendedMessagePayload)||void 0===n?void 0:n.message_template,O=null!==(r=null==M?void 0:M.container_options)&&void 0!==r?r:{},R=O.profile,k=void 0===R||R,x=O.time,D=void 0===x||x,U=O.nickname,L=void 0===U||U,P=k||L;return a.a.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__root"},!f&&P&&!b&&a.a.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__header-container"},a.a.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__header-container__left__profile"},k&&I),L&&S),w,!f&&D&&a.a.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__bottom"},A))}function FP(e){var t,n,r,s,o,l,u,c,d,h,f,p,g,E,y=this,b=e.className,C=e.userId,N=e.channel,T=e.message,I=e.disabled,S=void 0!==I&&I,w=e.chainTop,A=void 0!==w&&w,M=e.chainBottom,O=void 0!==M&&M,R=e.isReactionEnabled,k=void 0!==R&&R,x=e.disableQuoteMessage,D=void 0!==x&&x,U=e.replyType,L=e.threadReplySelectType,P=e.nicknamesMap,F=e.emojiContainer,B=e.scrollToMessage,j=e.showEdit,H=e.showRemove,G=e.showFileViewer,z=e.resendMessage,V=e.deleteMessage,q=e.toggleReaction,K=e.setQuoteMessage,W=e.onReplyInThread,Y=e.onQuoteMessageClick,Q=e.onMessageHeightChange,X=e.onBeforeDownloadFileMessage,Z=e.filterEmojiCategoryIds,J=eN(e),$=J.renderSenderProfile,ee=void 0===$?function(e){return a.a.createElement(NP,m({},e))}:$,te=J.renderMessageBody,ne=void 0===te?function(e){return a.a.createElement(AP,m({},e))}:te,re=J.renderMessageHeader,ie=void 0===re?function(e){return a.a.createElement(MP,m({},e))}:re,ae=J.renderMessageMenu,se=void 0===ae?function(e){return a.a.createElement(ID,m({},e))}:ae,oe=J.renderEmojiMenu,le=void 0===oe?function(e){return a.a.createElement(MD,m({},e))}:oe,ue=J.renderEmojiReactions,ce=void 0===ue?function(e){return a.a.createElement(WD,m({},e))}:ue,de=J.renderMobileMenuOnLongPress,he=void 0===de?function(e){return a.a.createElement(_U,m({},e))}:de,fe=JC(),pe=fe.dateLocale,me=fe.stringSet,ge=IC().state,_e=ge.config,ve=ge.eventHandlers,Ee=_e.logger,ye=null===(t=null==ve?void 0:ve.reaction)||void 0===t?void 0:t.onPressUserProfile,be=Object(i.useRef)(),Ce=Object(i.useRef)(),Ne=Object(i.useRef)(),Te=oN().isMobile,Ie=Object(i.useState)(!1),Se=Ie[0],we=Ie[1],Ae=Object(i.useState)(!1),Me=Ae[0],Oe=Ae[1],Re=function(e,t){var n=Object(i.useState)(!1),r=n[0],a=n[1];return Object(i.useEffect)((function(){var n,r,i=Array.isArray(t)?t:[t];r=null==i?void 0:i.map((function(t){return null==t?void 0:t.querySelector(e)})),a(null!==(n=null==r?void 0:r.some((function(e){return!!e})))&&void 0!==n&&n);var s=new MutationObserver((function(t){t.forEach((function(t){(t.addedNodes.length||t.removedNodes.length)&&(Array.from(t.addedNodes).forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&t.matches(e)&&a(!0)})),Array.from(t.removedNodes).forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&t.matches(e)&&a(!1)})))}))})),o={childList:!0,subtree:!0};return null==i||i.forEach((function(e){e&&s.observe(e,o)})),function(){s.disconnect()}}),[e,t]),r}("#".concat(vM(T.messageId),".").concat(_M),[document.getElementById(CM),document.getElementById(TM)]),ke=Object(i.useState)(!1),xe=ke[0],De=ke[1],Ue=Object(i.useState)(!1),Le=Ue[0],Pe=Ue[1],Fe=Object(i.useState)(""),Be=Fe[0],je=Fe[1],He=C===(null===(n=null==T?void 0:T.sender)||void 0===n?void 0:n.userId)||"pending"===(null==T?void 0:T.sendingStatus)||"failed"===(null==T?void 0:T.sendingStatus),Ge=He?"outgoing":"incoming",ze=A?"chain-top":"",Ve=k&&!(null==N?void 0:N.isEphemeral),qe=Ve?"use-reactions":"",Ke=Re?"sendbird-mouse-hover":"",We=!("QUOTE_REPLY"!==U&&"THREAD"!==U||!(null==T?void 0:T.parentMessageId)||!(null==T?void 0:T.parentMessage)||D),Ye=We?"use-quote":"",Qe=(null===(r=null==T?void 0:T.threadInfo)||void 0===r?void 0:r.replyCount)&&T.threadInfo.replyCount>0&&"THREAD"===U,Xe=!He&&!!(null==T?void 0:T.myFeedbackStatus)&&T.myFeedbackStatus!==kP.NOT_APPLICABLE,Ze=!!(null===(s=null==_e?void 0:_e.groupChannel)||void 0===s?void 0:s.enableFeedback)&&Xe,Je=null===(o=null==T?void 0:T.myFeedback)||void 0===o?void 0:o.rating,$e=!PA(T)&&!LA(T),et=$e&&Te,tt=$e&&He&&!Te,nt=$e&&Qe,rt=$e&&!He&&!Te,it=function(){Pe(!1)},at=function(e){void 0===e&&(e=!1),Te&&e?De(!0):Pe(!0)},st=wD({onLongPress:function(){et&&we(!0)},onClick:$C},{delay:300,shouldPreventDefault:!1});if(RA(T))return a.a.createElement(YD,{message:T});if(PA(T)){var ot=T.extendedMessagePayload.message_template;if(FA(ot))return a.a.createElement(PP,m({},e,{renderSenderProfile:ee,renderMessageHeader:ie,renderMessageBody:ne,isByMe:He,displayThreadReplies:Qe,mouseHover:Me,isMobile:Te,isReactionEnabledInChannel:Ve,hoveredMenuClassName:Ke,templateType:ot.type,useReplying:We}))}return a.a.createElement("div",{className:JA([null!=b?b:"","sendbird-message-content",Ge]),onMouseOver:function(){return Oe(!0)},onMouseLeave:function(){return Oe(!1)}},a.a.createElement("div",{className:nN("sendbird-message-content__left",qe,Ge,Ye),"data-testid":"sendbird-message-content__left"},ee(m(m({},e),{className:"sendbird-message-content__left__avatar",isByMe:He,displayThreadReplies:Qe,bottom:(E=2,Ce.current&&(E+=4+Ce.current.clientHeight),Ne.current&&(E+=4+Ne.current.clientHeight),E>0?E+"px":"")})),tt&&a.a.createElement("div",{className:nN("sendbird-message-content-menu",qe,Ke,Ge)},se({channel:N,message:T,isByMe:He,replyType:U,showEdit:j,showRemove:H,resendMessage:z,setQuoteMessage:K,onReplyInThread:function(e){var t,n,r=e.message;L===iO.THREAD?null==W||W({message:r}):L===iO.PARENT&&(null==B||B(null!==(n=null===(t=r.parentMessage)||void 0===t?void 0:t.createdAt)&&void 0!==n?n:0,r.parentMessageId))},deleteMessage:V}),Ve&&le({message:T,userId:C,emojiContainer:F,toggleReaction:q,filterEmojiCategoryIds:Z}))),a.a.createElement("div",m({className:nN("sendbird-message-content__middle"),"data-testid":"sendbird-message-content__middle"},Te?m({},st):{},{ref:be}),!He&&!A&&!We&&ie(e),We?a.a.createElement("div",{className:nN("sendbird-message-content__middle__quote-message",He?"outgoing":"incoming",Ye),"data-testid":"sendbird-message-content__middle__quote-message"},a.a.createElement(eU,{className:"sendbird-message-content__middle__quote-message__quote",message:T,userId:C,isByMe:He,isUnavailable:(null!==(l=null==N?void 0:N.messageOffsetTimestamp)&&void 0!==l?l:0)>(null!==(c=null===(u=T.parentMessage)||void 0===u?void 0:u.createdAt)&&void 0!==c?c:0),onClick:function(){var e;"THREAD"===U&&L===iO.THREAD&&(null==Y||Y({message:T})),("QUOTE_REPLY"===U||"THREAD"===U&&L===iO.PARENT)&&(null===(e=null==T?void 0:T.parentMessage)||void 0===e?void 0:e.createdAt)&&(null==T?void 0:T.parentMessageId)&&(null==B||B(T.parentMessage.createdAt,T.parentMessageId))}})):null,a.a.createElement("div",{className:nN("sendbird-message-content__middle__body-container")},He&&!O&&a.a.createElement("div",{className:nN("sendbird-message-content__middle__body-container__created-at","left",Ke)},a.a.createElement("div",{className:"sendbird-message-content__middle__body-container__created-at__component-container"},a.a.createElement(mD,{message:T,channel:N}))),ne({message:T,channel:N,showFileViewer:G,onMessageHeightChange:Q,mouseHover:Me,isMobile:Te,config:_e,isReactionEnabledInChannel:Ve,isByMe:He,onBeforeDownloadFileMessage:X}),Ve&&(null===(d=null==T?void 0:T.reactions)||void 0===d?void 0:d.length)>0&&a.a.createElement("div",{className:nN("sendbird-message-content-reactions",DA(T)?"image-grid":He&&!zA(T)&&!HA(T)&&"primary",Me&&"mouse-hover")},ce({userId:C,message:T,channel:N,isByMe:He,emojiContainer:null!=F?F:new Jm({}),memberNicknamesMap:null!=P?P:new Map,toggleReaction:q,onPressUserProfile:ye,filterEmojiCategoryIds:Z})),!He&&!O&&a.a.createElement(_N,{className:nN("sendbird-message-content__middle__body-container__created-at","right",Ke),type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},ok((null==T?void 0:T.createdAt)||0,me.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:pe}))),nt&&(null==T?void 0:T.threadInfo)&&a.a.createElement(vU,{className:"sendbird-message-content__middle__thread-replies",threadInfo:null==T?void 0:T.threadInfo,onClick:function(){return null==W?void 0:W({message:T})},ref:Ce}),Ze&&a.a.createElement("div",{className:"sendbird-message-content__middle__body-container__feedback-buttons-container",ref:Ne},a.a.createElement(OP,{isSelected:(null===(h=null==T?void 0:T.myFeedback)||void 0===h?void 0:h.rating)===lo.GOOD,onClick:function(){return _(y,void 0,void 0,(function(){var e,t,n;return v(this,(function(r){switch(r.label){case 0:if(Je)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,T.submitFeedback({rating:lo.GOOD})];case 2:return r.sent(),at(),[3,4];case 3:return e=r.sent(),null===(n=null===(t=null==_e?void 0:_e.logger)||void 0===t?void 0:t.error)||void 0===n||n.call(t,"Channel: Submit feedback failed.",e),je(me.FEEDBACK_FAILED_SUBMIT),[3,4];case 4:return[3,6];case 5:at(!0),r.label=6;case 6:return[2]}}))}))},disabled:!!(null==T?void 0:T.myFeedback)&&T.myFeedback.rating!==lo.GOOD},a.a.createElement(YS,{type:QS.FEEDBACK_LIKE,width:"24px",height:"24px"})),a.a.createElement(OP,{isSelected:(null===(f=null==T?void 0:T.myFeedback)||void 0===f?void 0:f.rating)===lo.BAD,onClick:function(){return _(y,void 0,void 0,(function(){var e,t,n;return v(this,(function(r){switch(r.label){case 0:if(Je)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,T.submitFeedback({rating:lo.BAD})];case 2:return r.sent(),at(),[3,4];case 3:return e=r.sent(),null===(n=null===(t=null==_e?void 0:_e.logger)||void 0===t?void 0:t.error)||void 0===n||n.call(t,"Channel: Submit feedback failed.",e),je(me.FEEDBACK_FAILED_SUBMIT),[3,4];case 4:return[3,6];case 5:at(!0),r.label=6;case 6:return[2]}}))}))},disabled:!!(null==T?void 0:T.myFeedback)&&T.myFeedback.rating!==lo.BAD},a.a.createElement(YS,{type:QS.FEEDBACK_DISLIKE,width:"24px",height:"24px"})))),rt&&a.a.createElement("div",{className:nN("sendbird-message-content__right",ze,qe,Ye),"data-testid":"sendbird-message-content__right"},a.a.createElement("div",{className:nN("sendbird-message-content-menu",ze,Ke,Ge)},Ve&&le({className:"sendbird-message-content-menu__reaction-menu",message:T,userId:C,emojiContainer:F,toggleReaction:q,filterEmojiCategoryIds:Z}),se({className:"sendbird-message-content-menu__normal-menu",channel:N,message:T,isByMe:He,replyType:U,showRemove:H,resendMessage:z,setQuoteMessage:K,onReplyInThread:function(e){var t,n,r=e.message;L===iO.THREAD?null==W||W({message:r}):L===iO.PARENT&&(null==B||B(null!==(n=null===(t=r.parentMessage)||void 0===t?void 0:t.createdAt)&&void 0!==n?n:0,r.parentMessageId))},deleteMessage:V}))),Se&&lM(T)&&N&&he({parentRef:be,channel:N,hideMenu:function(){we(!1)},message:T,isReactionEnabled:Ve,isByMe:He,userId:C,replyType:U,disabled:S,showRemove:H,emojiContainer:F,resendMessage:z,deleteMessage:V,setQuoteMessage:K,toggleReaction:q,showEdit:j,onReplyInThread:function(e){var t,n=e.message;L===iO.THREAD?null==W||W({message:n}):L===iO.PARENT&&(null==B||B((null===(t=null==n?void 0:n.parentMessage)||void 0===t?void 0:t.createdAt)||0,(null==n?void 0:n.parentMessageId)||0))},onDownloadClick:function(e){return _(y,void 0,void 0,(function(){var t,n,r;return v(this,(function(i){switch(i.label){case 0:if(!X)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,X({message:T})];case 2:return i.sent()||(e.preventDefault(),null===(n=null==Ee?void 0:Ee.info)||void 0===n||n.call(Ee,"MessageContent: Not allowed to download.")),[3,4];case 3:return t=i.sent(),null===(r=null==Ee?void 0:Ee.error)||void 0===r||r.call(Ee,"MessageContent: Error occurred while determining download continuation:",t),[3,4];case 4:return[2]}}))}))}}),(null===(p=null==T?void 0:T.myFeedback)||void 0===p?void 0:p.rating)&&xe&&a.a.createElement(RP,{hideMenu:function(){De(!1)},onEditFeedback:function(){De(!1),Pe(!0)},onRemoveFeedback:function(){return _(y,void 0,void 0,(function(){var e,t,n;return v(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),null===T.myFeedback?[3,2]:[4,T.deleteFeedback(T.myFeedback.id)];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return e=r.sent(),null===(n=null===(t=null==_e?void 0:_e.logger)||void 0===t?void 0:t.error)||void 0===n||n.call(t,"Channel: Delete feedback failed.",e),je(me.FEEDBACK_FAILED_DELETE),[3,4];case 4:return De(!1),[2]}}))}))}}),(null===(g=null==T?void 0:T.myFeedback)||void 0===g?void 0:g.rating)&&Le&&a.a.createElement(LP,{selectedFeedback:T.myFeedback.rating,message:T,onUpdate:function(e,t){return _(y,void 0,void 0,(function(){var n,r,i,a;return v(this,(function(s){switch(s.label){case 0:if(null===T.myFeedback)return[3,4];n=new go({id:T.myFeedback.id,rating:e,comment:t}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,T.updateFeedback(n)];case 2:return s.sent(),[3,4];case 3:return r=s.sent(),null===(a=null===(i=null==_e?void 0:_e.logger)||void 0===i?void 0:i.error)||void 0===a||a.call(i,"Channel: Update feedback failed.",r),je(me.FEEDBACK_FAILED_SAVE),[3,4];case 4:return it(),[2]}}))}))},onClose:it,onRemove:function(){return _(y,void 0,void 0,(function(){var e,t,n;return v(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),null===T.myFeedback?[3,2]:[4,T.deleteFeedback(T.myFeedback.id)];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return e=r.sent(),null===(n=null===(t=null==_e?void 0:_e.logger)||void 0===t?void 0:t.error)||void 0===n||n.call(t,"Channel: Delete feedback failed.",e),je(me.FEEDBACK_FAILED_DELETE),[3,4];case 4:return it(),[2]}}))}))}}),Be&&a.a.createElement(CP,{text:Be,onCancel:function(){je("")}}))}(xP=kP||(kP={})).NOT_APPLICABLE="NOT_APPLICABLE",xP.NO_FEEDBACK="NO_FEEDBACK",xP.SUBMITTED="SUBMITTED";var BP=function(e){var t=e.value,n=e.onClickReply,r=e.type,i=void 0===r?"vertical":r;return a.a.createElement("div",{className:"sendbird-suggested-replies__option ".concat(i),id:t,onClick:function(e){return n(e,t)}},t)},jP=function(e){var t=e.replyOptions,n=e.onSendMessage,r=e.type,s=void 0===r?"vertical":r,o=Object(i.useState)(!1),l=o[0],u=o[1],c=function(e,t){e.preventDefault(),n({message:t}),u(!0)};if(l)return null;var d=t.map((function(e,t){return a.a.createElement(BP,{key:t,value:e,onClickReply:c,type:s})}));return a.a.createElement("div",{className:"sendbird-suggested-replies ".concat(s)},d)};function HP(e){var t=e.member,n=e.isFocused,r=void 0!==n&&n,s=e.parentScrollRef,o=e.onClick,l=e.onMouseOver,u=e.onMouseMove,c=e.renderUserMentionItem,d=Object(i.useRef)(null),h=Object(i.useContext)(XC).stringSet;Object(i.useEffect)((function(){r&&null!=(null==s?void 0:s.current)&&null!=(null==d?void 0:d.current)&&(s.current.scrollTop>=d.current.offsetTop||s.current.scrollTop+s.current.clientHeight<=d.current.offsetTop)&&d.current.scrollIntoView({block:"nearest",inline:"nearest"})}),[r]);var f=Object(i.useMemo)((function(){if(c)return a.a.createElement("div",{className:"sendbird-mention-suggest-list__user-item",onClick:function(e){return null==o?void 0:o({event:e,member:t,itemRef:d})},onMouseOver:function(e){return null==l?void 0:l({event:e,member:t,itemRef:d})},onMouseMove:function(e){return null==u?void 0:u({event:e,member:t,itemRef:d})},key:(null==t?void 0:t.userId)||ZS(),ref:d},c({user:t}))}),[c]);return f||a.a.createElement("div",{className:nN("sendbird-mention-suggest-list__user-item",r&&"focused"),onClick:function(e){return null==o?void 0:o({event:e,member:t,itemRef:d})},onMouseOver:function(e){return null==l?void 0:l({event:e,member:t,itemRef:d})},onMouseMove:function(e){return null==u?void 0:u({event:e,member:t,itemRef:d})},key:(null==t?void 0:t.userId)||ZS(),ref:d},a.a.createElement(iR,{className:"sendbird-mention-suggest-list__user-item__avatar",src:null==t?void 0:t.profileUrl,alt:"user-profile",width:"24px",height:"24px"}),a.a.createElement(_N,{className:"sendbird-mention-suggest-list__user-item__nickname",testID:"sendbird-mention-suggest-list__user-item__nickname",type:vN.SUBTITLE_2,color:(null==t?void 0:t.nickname)?EN.ONBACKGROUND_1:EN.ONBACKGROUND_3},(null==t?void 0:t.nickname)||(null==h?void 0:h.MENTION_NAME__NO_NAME)),a.a.createElement(_N,{className:"sendbird-mention-suggest-list__user-item__user-id",testID:"sendbird-mention-suggest-list__user-item__user-id",type:vN.SUBTITLE_2,color:EN.ONBACKGROUND_2},null==t?void 0:t.userId))}function GP(e,t,n,r){return _(this,void 0,void 0,(function(){return v(this,(function(i){return[2,t.members.sort((function(e,t){var n;return null===(n=e.nickname)||void 0===n?void 0:n.localeCompare(t.nickname)})).filter((function(t){var n;return(null===(n=t.nickname)||void 0===n?void 0:n.toLowerCase().startsWith(r.toLowerCase()))&&t.userId!==e&&t.isActive})).slice(0,n)]}))}))}function zP(e,t,n,r){return _(this,void 0,void 0,(function(){return v(this,(function(i){return[2,t.createMemberListQuery({limit:n+1,nicknameStartsWithFilter:r}).next().then((function(t){return t.filter((function(t){return e!==(null==t?void 0:t.userId)})).slice(0,n)}))]}))}))}var VP=function(e){var t,n,r,s=e.className,o=e.currentChannel,l=e.targetNickname,u=void 0===l?"":l,c=e.onUserItemClick,d=e.onFocusItemChange,h=e.onFetchUsers,f=e.renderUserMentionItem,p=e.inputEvent,m=e.ableAddMention,g=void 0===m||m,_=e.maxMentionCount,v=void 0===_?10:_,E=e.maxSuggestionCount,y=void 0===E?15:E,b=IC().state,C=b.config,N=b.stores,T=C.logger,I=(null===(r=null===(n=null===(t=null==N?void 0:N.sdkStore)||void 0===t?void 0:t.sdk)||void 0===n?void 0:n.currentUser)||void 0===r?void 0:r.userId)||"",S=Object(i.useRef)(null),w=JC().stringSet,A=Object(i.useState)(null),M=A[0],O=A[1],R=Object(i.useState)(""),k=R[0],x=R[1],D=Object(i.useState)(""),U=D[0],L=D[1],P=Object(i.useState)(null),F=P[0],B=P[1],j=Object(i.useState)([]),H=j[0],G=j[1];return Object(i.useEffect)((function(){clearTimeout(null!=M?M:void 0),O(setTimeout((function(){x(u)}),300))}),[u]),Object(i.useEffect)((function(){var e;((null==p?void 0:p.key)===hk&&F&&H.length>0&&(null==c||c(F)),(null==p?void 0:p.key)===fk)&&(0<(e=H.findIndex((function(e){return(null==e?void 0:e.userId)===(null==F?void 0:F.userId)})))&&(B(H[e-1]),null==d||d(H[e-1])));(null==p?void 0:p.key)===pk&&((e=H.findIndex((function(e){return(null==e?void 0:e.userId)===(null==F?void 0:F.userId)})))<H.length-1&&(B(H[e+1]),null==d||d(H[e+1])))}),[p]),Object(i.useEffect)((function(){U&&0===k.indexOf(U)&&0===H.length||(!(null==o?void 0:o.isSuper)||(null==o?void 0:o.createMemberListQuery)?((null==o?void 0:o.isSuper)?zP:GP)(I,o,y,k.slice("@".length)).then((function(e){e.length<1?T.info("SuggestedMentionList: Fetched member list is empty"):(T.info("SuggestedMentionList: Fetching member list succeeded",{memberList:e}),B(e[0])),L(k),null==h||h(e),G(e)})).catch((function(e){e&&T.error("SuggestedMentionList: Fetching member list failed",e)})):T.warning("SuggestedMentionList: Creating member list query failed"))}),[null==o?void 0:o.url,null==o?void 0:o.members.map((function(e){return e.nickname})).join(),null==o?void 0:o.members.map((function(e){return e.isActive})).join(),k,y,I,H.length,U]),g||0!==H.length?a.a.createElement("div",{className:nN("sendbird-mention-suggest-list",s),"data-testid":"sendbird-mention-suggest-list",key:"sendbird-mention-suggest-list",ref:S},g&&(null==H?void 0:H.map((function(e){return a.a.createElement(HP,{key:(null==e?void 0:e.userId)||ZS(),member:e,isFocused:(null==e?void 0:e.userId)===(null==F?void 0:F.userId),parentScrollRef:S,onClick:function(e){var t=e.member;null==c||c(t)},onMouseOver:function(e){var t=e.member;B(t)},renderUserMentionItem:f})}))),!g&&a.a.createElement("div",{className:"sendbird-mention-suggest-list__notice-item"},a.a.createElement(YS,{className:"sendbird-mention-suggest-list__notice-item__icon",type:QS.INFO,fillColor:XS.ON_BACKGROUND_2,width:"20px",height:"20px"}),a.a.createElement(_N,{className:"sendbird-mention-suggest-list__notice-item__text",type:vN.SUBTITLE_2,color:EN.ONBACKGROUND_2},w.MENTION_COUNT__OVER_LIMIT.replace("%d",String(v))))):null},qP=function(e,t){var n=Object(i.useState)(!1),r=n[0],a=n[1];Object(i.useEffect)((function(){r?e():a(!0)}),t)},KP=function(e){var t,n,r=e.message,s=e.children,o=e.hasSeparator,l=e.chainTop,u=e.chainBottom,c=e.handleScroll,d=e.channel,h=e.emojiContainer,f=e.editInputDisabled,p=e.shouldRenderSuggestedReplies,g=e.isReactionEnabled,_=e.replyType,v=e.threadReplySelectType,y=e.nicknamesMap,b=e.scrollToMessage,C=e.toggleReaction,N=e.setQuoteMessage,T=e.onQuoteMessageClick,I=e.onReplyInThreadClick,S=e.onBeforeDownloadFileMessage,w=e.sendUserMessage,A=e.updateUserMessage,M=e.resendMessage,O=e.deleteMessage,R=e.setAnimatedMessageId,k=e.animatedMessageId,x=e.onMessageAnimated,D=e.usedInLegacy,U=void 0===D||D,L=eN(e),P=L.renderUserMentionItem,F=L.renderMessage,B=L.renderMessageContent,j=void 0===B?function(e){return a.a.createElement(FP,m({},e))}:B,H=L.renderSuggestedReplies,G=void 0===H?function(e){return a.a.createElement(jP,m({},e))}:H,z=L.renderCustomSeparator,V=L.renderEditInput,q=L.renderFileViewer,K=L.renderRemoveMessageModal,W=L.filterEmojiCategoryIds,Y=JC(),Q=Y.dateLocale,X=Y.stringSet,Z=IC().state.config,J=Z.userId,$=Z.isOnline,ee=Z.userMention,te=Z.logger,ne=Z.groupChannel,re=(null==ee?void 0:ee.maxMentionCount)||10,ie=(null==ee?void 0:ee.maxSuggestionCount)||15,ae=Object(i.useState)(!1),se=ae[0],oe=ae[1],le=Object(i.useState)(!1),ue=le[0],ce=le[1],de=Object(i.useState)(!1),he=de[0],fe=de[1],pe=Object(i.useState)(!1),me=pe[0],ge=pe[1],_e=Object(i.useState)(""),ve=_e[0],Ee=_e[1],ye=Object(i.useState)([]),be=ye[0],Ce=ye[1],Ne=Object(i.useState)([]),Te=Ne[0],Ie=Ne[1],Se=Object(i.useState)(null),we=Se[0],Ae=Se[1],Me=Object(i.useState)(null),Oe=Me[0],Re=Me[1],ke=Object(i.useState)([]),xe=ke[0],De=ke[1],Ue=Object(i.useRef)(null),Le=Object(i.useRef)(null),Pe=$&&ne.enableMention&&ve.length>0&&!dO(d)&&!hO(d),Fe=ck({ref:Ue},{logger:te}),Be=(null==Fe?void 0:Fe.length)<re;Object(i.useEffect)((function(){Ce(be.filter((function(e){var t=e.userId,n=Te.indexOf(t);return!(n<0)&&(Te.splice(n,1),!0)})))}),[Te]),qP((function(){null==c||c()}),[se,null===(t=null==r?void 0:r.reactions)||void 0===t?void 0:t.length]),qP((function(){null==c||c(!0)}),[null==r?void 0:r.updatedAt,null==r?void 0:r.message]);var je=Object(i.useRef)(p);Object(i.useEffect)((function(){je.current!==p?null==c||c():je.current=p}),[p]),Object(i.useLayoutEffect)((function(){U&&(null==c||c(!0))}),[]),Object(i.useLayoutEffect)((function(){var e=[];return k===r.messageId&&(null==Le?void 0:Le.current)?(e.push(setTimeout((function(){ge(!0)}),500)),e.push(setTimeout((function(){R(null),null==x||x()}),1600))):ge(!1),function(){e.forEach((function(e){return clearTimeout(e)}))}}),[k,Le.current,r.messageId]);var He=Object(i.useMemo)((function(){var e;return null!==(e=null==z?void 0:z({message:r}))&&void 0!==e?e:null}),[r,z]);return se&&(null===(n=null==r?void 0:r.isUserMessage)||void 0===n?void 0:n.call(r))?(null==V?void 0:V())||a.a.createElement(a.a.Fragment,null,Pe&&a.a.createElement(VP,{currentChannel:d,targetNickname:ve,inputEvent:null!=we?we:void 0,renderUserMentionItem:P,onUserItemClick:function(e){e&&Ce(E(E([],be,!0),[e],!1)),Ee(""),Re(e),Ae(null)},onFocusItemChange:function(){Ae(null)},onFetchUsers:function(e){De(e)},ableAddMention:Be,maxMentionCount:re,maxSuggestionCount:ie}),a.a.createElement(eD,{isEdit:!0,channel:d,disabled:f,ref:Ue,mentionSelectedUser:Oe,isMentionEnabled:ne.enableMention,message:r,onStartTyping:function(){var e;null===(e=null==d?void 0:d.startTyping)||void 0===e||e.call(d)},onUpdateMessage:function(e){var t,n=e.messageId,r=e.message,i=e.mentionTemplate;A(n,{message:r,mentionedUsers:be,mentionedMessageTemplate:i}),oe(!1),null===(t=null==d?void 0:d.endTyping)||void 0===t||t.call(d)},onCancelEdit:function(){var e;Ee(""),Ce([]),Ie([]),De([]),oe(!1),null===(e=null==d?void 0:d.endTyping)||void 0===e||e.call(d)},onUserMentioned:function(e){(null==Oe?void 0:Oe.userId)===(null==e?void 0:e.userId)&&(Re(null),Ee(""))},onMentionStringChange:function(e){Ee(e)},onMentionedUserIdsUpdated:function(e){Ie(e)},onKeyDown:function(e){return!!(Pe&&(null==xe?void 0:xe.length)>0&&(e.key===hk&&Be||e.key===fk||e.key===pk))&&(Ae(e),!0)}})):a.a.createElement("div",{className:nN("sendbird-msg-hoc sendbird-msg--scroll-ref",me&&"sendbird-msg-hoc__animated"),"data-testid":"sendbird-message-view",style:s||F?void 0:{marginBottom:"2px"},"data-sb-message-id":r.messageId,"data-sb-created-at":r.createdAt,ref:Le},o&&(He||a.a.createElement(dk,null,a.a.createElement(_N,{type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},ok(r.createdAt,X.DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR,{locale:Q})))),function(){if(s)return s;if(F){var t=m(m({},e),{renderMessage:void 0});return F(t)}return a.a.createElement(a.a.Fragment,null,j({className:"sendbird-message-hoc__message-content",userId:J,scrollToMessage:b,channel:d,message:r,disabled:!$,chainTop:l,chainBottom:u,isReactionEnabled:g,replyType:_,threadReplySelectType:v,nicknamesMap:y,emojiContainer:h,showEdit:oe,showRemove:ce,showFileViewer:fe,resendMessage:M,deleteMessage:O,toggleReaction:C,setQuoteMessage:N,onReplyInThread:I,onQuoteMessageClick:T,onMessageHeightChange:c,onBeforeDownloadFileMessage:S,filterEmojiCategoryIds:W}),p&&G({replyOptions:tM(r),onSendMessage:w,type:null==ne?void 0:ne.suggestedRepliesDirection}),ue&&(null==K?void 0:K({message:r,onCancel:function(){return ce(!1)}})),he&&q({message:r,onCancel:function(){return fe(!1)}}))}())},WP=function(e){var t=e.message,n=e.onCancel,r=e.deleteMessage,i=e.onDownloadClick,o=t.sender,l=t.type,u=t.url,c=t.name,d=void 0===c?"":c,h=t.threadInfo,f=o.profileUrl,p=o.nickname,m=o.userId,g=IC().state.config;return Object(s.createPortal)(a.a.createElement(YP,{profileUrl:f,nickname:p,type:l,url:u,name:d,onCancel:n,onDelete:function(){return r(t).then((function(){return n()}))},isByMe:g.userId===m,disableDelete:!!(null==h?void 0:h.replyCount)&&h.replyCount>0,onDownloadClick:i}),document.getElementById(JS))},YP=function(e){var t=e.profileUrl,n=e.nickname,r=e.name,i=e.type,s=e.url,o=e.isByMe,l=e.onCancel,u=e.onDelete,c=e.disableDelete,d=e.onDownloadClick;return a.a.createElement(rw,{onClose:l},a.a.createElement("div",{className:"sendbird-fileviewer","data-testid":"sendbird-fileviewer"},a.a.createElement("div",{className:"sendbird-fileviewer__header"},a.a.createElement("div",{className:"sendbird-fileviewer__header__left"},a.a.createElement("div",{className:"sendbird-fileviewer__header__left__avatar"},a.a.createElement(iR,{height:"32px",width:"32px",src:t})),a.a.createElement("div",{className:"sendbird-fileviewer__header__left__text-container"},a.a.createElement(_N,{className:"sendbird-fileviewer__header__left__filename",type:vN.H_2,color:EN.ONBACKGROUND_1},r),a.a.createElement(_N,{className:"sendbird-fileviewer__header__left__sender-name",type:vN.BODY_1,color:EN.ONBACKGROUND_2},n))),a.a.createElement("div",{className:"sendbird-fileviewer__header__right"},TA(i)&&a.a.createElement("div",{className:"sendbird-fileviewer__header__right__actions"},a.a.createElement("a",{className:"sendbird-fileviewer__header__right__actions__download",rel:"noopener noreferrer",href:s,target:"_blank",onClick:d},a.a.createElement(YS,{type:QS.DOWNLOAD,fillColor:XS.ON_BACKGROUND_1,height:"24px",width:"24px"})),u&&o&&a.a.createElement("div",{className:"sendbird-fileviewer__header__right__actions__delete"},a.a.createElement(YS,{className:c?"disabled":"",type:QS.DELETE,fillColor:c?XS.GRAY:XS.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(){c||u()}}))),a.a.createElement("div",{className:"sendbird-fileviewer__header__right__actions__close"},a.a.createElement(YS,{type:QS.CLOSE,fillColor:XS.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:l})))),a.a.createElement("div",{className:"sendbird-fileviewer__content"},CA(i)&&a.a.createElement("video",{controls:!0,className:"sendbird-fileviewer__content__video"},a.a.createElement("source",{src:s,type:i})),bA(i)&&a.a.createElement("img",{src:s,alt:r,className:"sendbird-fileviewer__content__img"}),!TA(i)&&a.a.createElement("div",{className:"sendbird-fileviewer__content__unsupported"},a.a.createElement(_N,{type:vN.H_1,color:EN.ONBACKGROUND_1},yN.UI__FILE_VIEWER__UNSUPPORT)))))},QP=function(e){var t=CO(),n=t.state.onBeforeDownloadFileMessage,r=t.actions.deleteMessage,i=IC().state.config.logger;return a.a.createElement(WP,m({},e,{deleteMessage:r,onDownloadClick:function(t){return _(void 0,void 0,void 0,(function(){var r,a,s;return v(this,(function(o){switch(o.label){case 0:if(!n)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n({message:e.message})];case 2:return o.sent()||(t.preventDefault(),null===(a=i.info)||void 0===a||a.call(i,"FileViewer: Not allowed to download.")),[3,4];case 3:return r=o.sent(),null===(s=i.error)||void 0===s||s.call(i,"FileViewer: Error occurred while determining download continuation:",r),[3,4];case 4:return[2]}}))}))}}))};function XP(e,t){return fw(t).when(DA,(function(){var e=t.fileInfoList.length;return"Do you want to delete all ".concat(e," photos?")})).otherwise((function(){return e.MODAL__DELETE_MESSAGE__TITLE}))}var ZP=function(e){var t,n=e.onSubmit,r=void 0===n?function(){}:n,s=e.onCancel,o=e.message,l=e.deleteMessage,u=Object(i.useContext)(XC).stringSet;return a.a.createElement(rw,{type:fN.DANGER,disabled:(null===(t=null==o?void 0:o.threadInfo)||void 0===t?void 0:t.replyCount)?o.threadInfo.replyCount>0:void 0,onCancel:s,onSubmit:function(){(o.isUserMessage()||o.isFileMessage()||o.isMultipleFilesMessage())&&l(o).then((function(){r(),s()}))},submitText:u.MESSAGE_MENU__DELETE,titleText:XP(u,o)})},JP=function(e){var t=CO().actions.deleteMessage;return a.a.createElement(ZP,m({},e,{deleteMessage:t}))},$P=function(e){var t=IC().state,n=t.config,r=t.emojiManager,i=CO(),s=i.state,o=s.loading,l=s.currentChannel,u=s.animatedMessageId,c=s.replyType,d=s.threadReplySelectType,h=s.isReactionEnabled,f=s.nicknamesMap,p=s.renderUserMentionItem,g=s.filterEmojiCategoryIds,_=s.onQuoteMessageClick,v=s.onReplyInThreadClick,E=s.onMessageAnimated,y=s.onBeforeDownloadFileMessage,b=s.messages,C=i.actions,N=C.toggleReaction,T=C.setQuoteMessage,I=C.setAnimatedMessageId,S=C.scrollToMessage,w=C.updateUserMessage,A=C.sendUserMessage,M=C.resendMessage,O=C.deleteMessage,R=e.message,k=!o&&Boolean(l),x=T_((function(){var e=n.groupChannel,t=e.enableSuggestedReplies,r=e.showSuggestedRepliesFor,i=b[b.length-1],a=lM(i)&&"succeeded"!==i.sendingStatus,s="all_messages"===r||R.messageId===i.messageId;return t&&tM(R).length>0&&!a&&s}));return a.a.createElement(KP,m({},e,{channel:l,emojiContainer:r.emojiContainer,editInputDisabled:!k||dO(null!=l?l:void 0)||hO(null!=l?l:void 0)||!n.isOnline,shouldRenderSuggestedReplies:x,isReactionEnabled:null!=h&&h,replyType:null!=c?c:"NONE",threadReplySelectType:null!=d?d:iO.PARENT,nicknamesMap:f,renderUserMentionItem:p,filterEmojiCategoryIds:g,scrollToMessage:S,toggleReaction:N,setQuoteMessage:T,onQuoteMessageClick:_,onReplyInThreadClick:v,sendUserMessage:A,updateUserMessage:w,resendMessage:M,deleteMessage:O,animatedMessageId:u,setAnimatedMessageId:I,onMessageAnimated:E,renderFileViewer:function(e){return a.a.createElement(QP,m({},e))},renderRemoveMessageModal:function(e){return a.a.createElement(JP,m({},e))},usedInLegacy:!1,onBeforeDownloadFileMessage:y}))},eF=function(e){var t=e.className,n=void 0===t?"":t,r=e.count,s=void 0===r?0:r,o=e.time,l=void 0===o?"":o,u=e.onClick,c=e.lastReadAt,d=Object(i.useContext)(XC),h=d.stringSet,f=d.dateLocale,p=Object(i.useMemo)((function(){var e,t;if("on"!==h.CHANNEL__MESSAGE_LIST__NOTIFICATION__ON){var n=(null===(t=null===(e=null==l?void 0:l.toString)||void 0===e?void 0:e.call(l))||void 0===t?void 0:t.split(" "))||[];return null==n||n.splice(-2,0,h.CHANNEL__MESSAGE_LIST__NOTIFICATION__ON),n.join(" ")}if(c)return ok(c,h.DATE_FORMAT__MESSAGE_LIST__NOTIFICATION__UNREAD_SINCE,{locale:f})}),[l,c]);return a.a.createElement("div",{className:nN(s<1?"sendbird-notification--hide":"sendbird-notification",n),"data-testid":"sendbird-notification",onClick:u},a.a.createElement(_N,{className:"sendbird-notification__text",testID:"sendbird-notification__text",color:EN.ONCONTENT_1,type:vN.CAPTION_2},"".concat(s," "),h.CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE," ".concat(p)),a.a.createElement(YS,{width:"24px",height:"24px",type:QS.CHEVRON_DOWN,fillColor:XS.CONTENT}))},tF=function(e){var t=e.className,n=void 0===t?"":t,r=Object(i.useContext)(XC).stringSet;return a.a.createElement("div",{className:nN("sendbird-notification","sendbird-notification--frozen",n),"data-testid":"sendbird-notification"},a.a.createElement(_N,{className:"sendbird-notification__text",testID:"sendbird-notification__text",type:vN.CAPTION_2},r.CHANNEL_FROZEN))},nF=function(){return a.a.createElement("div",{className:"typing-dots-container"},a.a.createElement("span",null),a.a.createElement("span",null),a.a.createElement("span",null))},rF=function(e){var t=e.sources,n=e.max;return a.a.createElement(a.a.Fragment,null," ",t.slice(0,n).map((function(e,t){return a.a.createElement(iR,{className:"sendbird-message-content__left__avatar multiple",src:e||"",key:"avatar_stack_item_".concat(e),width:"".concat(28,"px"),height:"".concat(28,"px"),zIndex:t,left:"".concat(24*t-2,"px")})}))," ")},iF=function(e){var t=e.typingMembers,n=t.length,r=Math.min(n,4),i=n-3,s=8*(r-1);return a.a.createElement("div",{className:"sendbird-message-content__left incoming",style:{minWidth:32*r-s+12}},a.a.createElement(rF,{sources:t.map((function(e){return e.profileUrl})),max:3}),i>0?a.a.createElement(iR,{className:"sendbird-message-content__left__avatar multiple",width:"".concat(28,"px"),height:"".concat(28,"px"),zIndex:3,left:"".concat(72,"px"),customDefaultComponent:function(e){var t=e.width,n=e.height;return a.a.createElement(nR,{width:t,height:n,text:"+".concat(i)})}}):null)},aF=function(e){var t=e.typingMembers,n=e.handleScroll;return Object(i.useLayoutEffect)((function(){null==n||n(!0)}),[]),0===t.length?null:a.a.createElement("div",{className:"sendbird-message-content incoming",style:{marginBottom:"2px"}},a.a.createElement(iF,{typingMembers:t}),a.a.createElement("div",{className:"sendbird-message-content__middle"},a.a.createElement(nF,null)))},sF=function(e,t,n,r,i,a){if(!i||"group"!==i.channelType)return[lF(e,t,r),lF(t,n,r)];if("THREAD"===a&&(null==t?void 0:t.threadInfo))return[!1,!1];var s=(null==t?void 0:t.sendingStatus)||"",o="pending"!==s&&"failed"!==s;return[lF(e,t,r,i)&&o,lF(t,n,r,i)&&o]},oF=function(e,t){return ok(e.createdAt,t.DATE_FORMAT__MESSAGE_CREATED_AT)},lF=function(e,t,n,r){var i,a;return!!(e&&t&&e.messageType&&"admin"!==e.messageType&&t.messageType&&"admin"!==(null==t?void 0:t.messageType)&&"sender"in e&&"sender"in t&&e.createdAt&&t.createdAt&&e.sender.userId&&t.sender.userId)&&((null==e?void 0:e.sendingStatus)===(null==t?void 0:t.sendingStatus)&&(null===(i=null==e?void 0:e.sender)||void 0===i?void 0:i.userId)===(null===(a=null==t?void 0:t.sender)||void 0===a?void 0:a.userId)&&oF(e,n)===oF(t,n)&&(!r||AA(r,e)===AA(r,t)))},uF=function(e,t,n){void 0===e&&(e=0);var r=e;if(!(r>10))try{var i=(null==t?void 0:t.current)||document.querySelector(".sendbird-conversation__messages-padding");i&&(i.scrollTop=i.scrollHeight),null==n||n(!0)}catch(e){setTimeout((function(){uF(r+1,t,n)}),500*r)}},cF=function(e,t,n){return Math.abs(e-t)<=n},dF=Object(i.forwardRef)((function(e,t){var n=e.messages,r=e.renderMessage,s=e.scrollPositionRef,o=e.scrollDistanceFromBottomRef,l=e.onLoadPrevious,u=e.onLoadNext,c=e.loadThreshold,d=void 0===c?.05:c,h=e.typingIndicator,f=e.onScrollPosition,p=void 0===f?$C:f,m=e.initDeps,g=a.a.useRef(!1),E=a.a.useRef(),y=Object(i.useRef)(0);Object(i.useLayoutEffect)((function(){t.current&&(t.current.scrollTop=t.current.scrollHeight)}),m),Object(i.useLayoutEffect)((function(){t.current&&("top"===E.current&&(t.current.scrollTop=t.current.scrollHeight-s.current),"bottom"===E.current&&(t.current.scrollTop=y.current),E.current=void 0)}),[t.current,n.length]);var b=Object(i.useCallback)((function(){return _(void 0,void 0,void 0,(function(){var e,n;return v(this,(function(r){switch(r.label){case 0:return t.current?(e=t.current,p(function(e){if(cF(e.scrollTop,0,10))return"top";if(cF(e.scrollHeight,e.clientHeight+e.scrollTop,10))return"bottom";return"middle"}(e)),s.current=e.scrollHeight-e.scrollTop,o.current=s.current-e.clientHeight,y.current=e.scrollTop,g.current?[2]:(n=e.clientHeight*Math.min(Math.max(0,d),1),e.scrollTop<=n?(g.current=!0,E.current="top",[4,l()]):[3,2])):[2];case 1:return r.sent(),g.current=!1,[3,5];case 2:return e.scrollHeight-e.scrollTop-e.clientHeight<=n?(g.current=!0,E.current="bottom",[4,u()]):[3,4];case 3:return r.sent(),g.current=!1,[3,5];case 4:E.current=void 0,r.label=5;case 5:return[2]}}))}))}),[n.length]);return a.a.createElement("div",{className:"sendbird-conversation__scroll-container"},a.a.createElement("div",{className:"sendbird-conversation__padding"}),a.a.createElement("div",{ref:t,className:"sendbird-conversation__messages-padding","data-testid":"sendbird-message-list-container",onScroll:b},n.map((function(e,t){return r({message:e,index:t})})),h))}));var hF=function(e){var t,n,r,s,o,l=e.className,u=void 0===l?"":l,c=eN(e),d=c.renderMessage,h=void 0===d?function(e){return a.a.createElement($P,m({},e))}:d,f=c.renderMessageContent,p=c.renderSuggestedReplies,g=c.renderCustomSeparator,_=c.renderPlaceholderLoader,v=void 0===_?function(){return a.a.createElement(KO,{type:BO})}:_,E=c.renderPlaceholderEmpty,y=void 0===E?function(){return a.a.createElement(KO,{className:"sendbird-conversation__no-messages",type:HO})}:E,b=c.renderFrozenNotification,C=void 0===b?function(){return a.a.createElement(tF,{className:"sendbird-conversation__messages__notification"})}:b,N=CO(),T=N.state,I=T.channelUrl,S=T.hasNext,w=T.loading,A=T.messages,M=T.newMessages,O=T.isScrollBottomReached,R=T.isMessageGroupingEnabled,k=T.currentChannel,x=T.replyType,D=T.scrollPubSub,U=T.loadNext,L=T.loadPrevious,P=T.resetNewMessages,F=T.scrollRef,B=T.scrollPositionRef,j=T.scrollDistanceFromBottomRef,H=N.actions,G=H.scrollToBottom,z=H.setIsScrollBottomReached,V=IC().state,q=JC().stringSet,K=Object(i.useState)(),W=K[0],Y=K[1];Object(i.useEffect)((function(){Y(O?void 0:new Date)}),[O]);var Q,X,Z=function(e){void 0===e&&(e=!1);var t=F.current;if(t){var n=j.current,r=t.scrollHeight-t.scrollTop-t.offsetHeight;if(n<r&&(!e||n<10)){var i=r-n;D.publish("scroll",{top:t.scrollTop+i,lazy:!1,animated:!1})}}},J=function(){return k&&k.isFrozen?C():null},$=function(){return O||!W?null:a.a.createElement(eF,{className:"sendbird-conversation__messages__notification",count:M.length,lastReadAt:W,onClick:function(){return G()}})},ee=function(){return!S()&&O?null:a.a.createElement("div",{className:"sendbird-conversation__scroll-bottom-button",onClick:function(){return G()},onKeyDown:function(){return G()},tabIndex:0,role:"button"},a.a.createElement(YS,{width:"24px",height:"24px",type:QS.CHEVRON_DOWN,fillColor:XS.PRIMARY}))};return w?v():0===A.length?y():a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"sendbird-conversation__messages ".concat(u),dir:(Q=V.config.htmlTextDirection,X=V.config.forceLeftToRightMessageLayout,X?"ltr":Q)},a.a.createElement(dF,{ref:F,initDeps:[I],scrollPositionRef:B,scrollDistanceFromBottomRef:j,onLoadNext:U,onLoadPrevious:L,onScrollPosition:function(e){var t="bottom"===e;M.length>0&&t&&P(),z(t)},messages:A,renderMessage:function(e){var t=e.message,n=e.index,r=function(e){var t=e.allMessages,n=e.stringSet,r=e.isMessageGroupingEnabled,i=void 0===r||r,a=e.currentIndex,s=void 0===a?0:a,o=e.currentMessage,l=e.currentChannel,u=void 0===l?null:l,c=e.replyType,d=void 0===c?"":c,h=t[s-1],f=t[s+1],p=i?sF(h,o,f,n,u,d):[!1,!1],m=p[0],g=p[1],_=null==h?void 0:h.createdAt,v=o.createdAt;return{chainTop:m,chainBottom:g,hasSeparator:!("sendingStatus"in o&&"succeeded"!==o.sendingStatus)&&!(_&&nD(v,_))}}({allMessages:A,stringSet:q,replyType:null!=x?x:"NONE",isMessageGroupingEnabled:null!=R&&R,currentIndex:n,currentMessage:t,currentChannel:k}),i=r.chainTop,s=r.chainBottom,o=r.hasSeparator,l=lM(t)&&t.sender.userId===V.config.userId;return a.a.createElement(HD,{message:t,key:sO(t),isByMe:l},h({handleScroll:Z,message:t,hasSeparator:o,chainTop:i,chainBottom:s,renderMessageContent:f,renderSuggestedReplies:p,renderCustomSeparator:g}))},typingIndicator:!S()&&(null===(n=null===(t=null==V?void 0:V.config)||void 0===t?void 0:t.groupChannel)||void 0===n?void 0:n.enableTypingIndicator)&&(null===(o=null===(s=null===(r=null==V?void 0:V.config)||void 0===r?void 0:r.groupChannel)||void 0===s?void 0:s.typingIndicatorTypes)||void 0===o?void 0:o.has(xO.Bubble))&&a.a.createElement(fF,{channelUrl:I,handleScroll:Z})}),a.a.createElement(a.a.Fragment,null,J()),a.a.createElement(a.a.Fragment,null,$()),a.a.createElement(a.a.Fragment,null,ee())))},fF=function(e){var t=IC().state.stores,n=CO().state,r=n.isScrollBottomReached,s=n.scrollPubSub,o=Object(i.useState)([]),l=o[0],u=o[1];return Hm(t.sdkStore.sdk,{onTypingStatusUpdated:function(t){t.url===e.channelUrl&&u(t.getTypingUsers()),r&&oO()&&setTimeout((function(){s.publish("scrollToBottom",{})}),10)}}),a.a.createElement(aF,{typingMembers:l,handleScroll:e.handleScroll})},pF=function(e){return a.a.createElement(VP,m({},e))},mF="sendbird-quote_message_input__avatar";function gF(e){var t,n=e.message;if(!xA(n)&&!DA(n)||YA(n))return a.a.createElement(a.a.Fragment,null);var r,i=$D(n);return i||(VA(n)||qA(n)?i=JD(n):DA(n)&&((r=null===(t=n.fileInfoList)||void 0===t?void 0:t[0])&&r.mimeType&&(bA(r.mimeType)||NA(r.mimeType)))&&(i=n.fileInfoList[0].url)),qA(n)&&i?a.a.createElement("div",{className:mF},a.a.createElement("video",{style:{width:"44px",height:"44px"},src:i})):(zA(n)||DA(n))&&i?a.a.createElement($O,{className:mF,url:i,alt:QD(n),width:"44px",height:"44px",fixedSize:!0}):function(e){return!(!e||!xA(e))&&IA(e.type)}(n)?a.a.createElement("div",{className:mF},a.a.createElement(YS,{type:QS.FILE_AUDIO,fillColor:XS.ON_BACKGROUND_2,width:"24px",height:"24px"})):a.a.createElement("div",{className:mF},a.a.createElement(YS,{type:QS.FILE_DOCUMENT,fillColor:XS.ON_BACKGROUND_2,width:"24px",height:"24px"}))}function _F(e){var t=e.className,n=e.replyingMessage,r=e.onClose,s=Object(i.useContext)(XC).stringSet,o=n,l=null==n?void 0:n.sender,u=(xA(n)||DA(n))&&!YA(n);return a.a.createElement("div",{className:JA(["sendbird-quote_message_input",null!=t?t:""])},u&&a.a.createElement(gF,{message:o}),a.a.createElement("div",{className:"sendbird-quote_message_input__body",style:{width:"calc(100% - ".concat(u?"164px":"120px",")"),left:u?"92px":"40px"}},a.a.createElement(_N,{className:"sendbird-quote_message_input__body__sender-name",type:vN.CAPTION_1,color:EN.ONBACKGROUND_1},"".concat(s.QUOTE_MESSAGE_INPUT__REPLY_TO," ").concat(l&&l.nickname?l.nickname:s.NO_NAME)),a.a.createElement(_N,{className:"sendbird-quote_message_input__body__message-content",type:vN.BODY_2,color:EN.ONBACKGROUND_3},VA(o)&&!KA(o)&&s.QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE,qA(o)&&s.QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO,KA(o)&&s.QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF,kA(n)&&n.message,XA(n)===EA.FILE&&ZD(o),DA(n)&&"".concat(o.fileInfoList.length," Photos"),YA(n)&&s.VOICE_MESSAGE)),a.a.createElement(YS,{className:"sendbird-quote_message_input__close-button",type:QS.CLOSE,fillColor:XS.ON_BACKGROUND_2,width:"24px",height:"24px",onClick:function(){return null==r?void 0:r(n)}}))}var vF="PREPARING",EF="READY_TO_RECORD",yF="RECORDING",bF="COMPLETED",CF=function(e){var t=e.onRecordingStarted,n=void 0===t?$C:t,r=e.onRecordingEnded,a=void 0===r?$C:r,s=IC().state.config.voiceRecord,o=null==s?void 0:s.maxRecordingTime,l=sw(),u=l.isRecordable,c=Object(i.useState)(null),d=c[0],h=c[1],f=Object(i.useState)(vF),p=f[0],m=f[1];Object(i.useEffect)((function(){u&&p===vF&&m(EF)}),[u]);var g=Object(i.useCallback)((function(){null==l||l.start({onRecordingStarted:function(){m(yF),n(),N(),b(0),C.current=setInterval((function(){b((function(e){var t=e+100;return t>o&&N(),t}))}),100)},onRecordingEnded:function(e){m(bF),a(e),h(e),N()}})}),[n,a]),_=Object(i.useCallback)((function(){null==l||l.stop(),N()}),[l]),v=Object(i.useCallback)((function(){_(),h(null)}),[l]),E=Object(i.useState)(0),y=E[0],b=E[1],C=Object(i.useRef)(null);function N(){C.current&&(clearInterval(C.current),C.current=null)}return Object(i.useEffect)((function(){y>o&&_()}),[y,o,_]),{start:g,stop:_,cancel:v,recordingStatus:p,recordingTime:y,recordedFile:d,recordingLimit:o}},NF="READY_TO_RECORD",TF="RECORDING",IF="READY_TO_PLAY",SF="PLAYING",wF=function(e){switch(e.inputState){case NF:return a.a.createElement("div",{className:"sendbird-controler-icon record-icon"});case TF:return a.a.createElement("div",{className:"sendbird-controler-icon stop-icon"});case IF:return a.a.createElement(YS,{className:"sendbird-controler-icon play-icon",width:"20px",height:"20px",type:QS.PLAY,fillColor:XS.ON_BACKGROUND_1});case SF:return a.a.createElement("div",{className:"sendbird-controler-icon pause-icon"},a.a.createElement("div",{className:"sendbird-controler-icon pause-icon-inner"}),a.a.createElement("div",{className:"sendbird-controler-icon pause-icon-inner"}));default:return a.a.createElement(a.a.Fragment,null)}},AF=function(e){var t=e.minRecordTime,n=void 0===t?1e3:t,r=e.maximumValue,s=e.currentValue,o=void 0===s?0:s,l=e.currentType,u=e.onCancelClick,c=e.onControlClick,d=e.onSubmitClick,h=e.renderCancelButton,f=e.renderControlButton,p=e.renderSubmitButton,m=Object(i.useState)(0),g=m[0],_=m[1],v=Object(i.useMemo)((function(){return l===NF}),[l]),E=Object(i.useMemo)((function(){return l===TF}),[l]),y=Object(i.useMemo)((function(){return(l===NF||l===TF)&&n>o}),[l,n,o]),b=Object(i.useMemo)((function(){return l===IF||l===SF}),[l]),C=JC().stringSet;return a.a.createElement("div",{className:"sendbird-voice-message-input"},a.a.createElement("div",{className:"sendbird-voice-message-input__indicator"},a.a.createElement("div",{className:"sendbird-voice-message-input__indicator__progress-bar"},a.a.createElement(WU,{className:"sendbird-voice-message-input__indicator__progress-bar__bar",disabled:v,maxSize:r,currentSize:o})),E?a.a.createElement("div",{className:"sendbird-voice-message-input__indicator__on-rec"}):null,a.a.createElement(QU,{className:"sendbird-voice-message-input__indicator__playback-time",time:b?r-o:o,labelColor:v?EN.ONBACKGROUND_4:EN.ONCONTENT_1})),a.a.createElement("div",{className:"sendbird-voice-message-input__controler"},(null==h?void 0:h())||a.a.createElement(cR,{className:"sendbird-voice-message-input__controler__cancel",onClick:function(){var e=Date.now();e-g>250&&(null==u||u(),_(e))},disableUnderline:!0},a.a.createElement(_N,{type:vN.BUTTON_1,color:EN.PRIMARY},C.BUTTON__CANCEL)),(null==f?void 0:f(l))||a.a.createElement("div",{className:"sendbird-voice-message-input__controler__main",onClick:function(){var e=Date.now();e-g>250&&(null==c||c(l),_(e))}},a.a.createElement(wF,{inputState:l})),(null==p?void 0:p())||a.a.createElement("div",{className:nN("sendbird-voice-message-input__controler__submit",y&&"voice-message--disabled"),onClick:function(){var e=Date.now();e-g>250&&(y||null==d||d(),_(e))}},a.a.createElement(YS,{width:"19px",height:"19px",type:QS.SEND,fillColor:y?XS.ON_BACKGROUND_4:XS.CONTENT}))))},MF=function(e){var t=e.imageFile,n=e.compressionRate,r=e.resizingWidth,i=e.resizingHeight,a=e.outputFormat,s=document.createElement("img");return new Promise((function(e,o){s.src=URL.createObjectURL(t),s.onerror=o,s.onload=function(){URL.revokeObjectURL(s.src);var l=document.createElement("canvas"),u=s.width,c=s.height,d=!r||r>u?u:r,h=!i||i>c?c:i,f=u/d,p=c/h;f>p?h=c/(r?f:1):p>f&&(d=u/(i?p:1)),l.width=d,l.height=h;var m=l.getContext("2d");if(m){m.drawImage(s,0,0,d,h);var g="preserve"===a?t.type:"image/".concat(a),_=g.split("/").pop(),v=t.name.lastIndexOf("."),E="".concat(-1===v?t.name:t.name.substring(0,v),".").concat(_);m.canvas.toBlob((function(t){if(t){var n=new File([t],E,{type:g});e(n)}else o(new Error("Failed to compress image"))}),g,n)}else o(new Error("Failed to get canvas 2d context"))}}))},OF=function(e){return _(void 0,[e],void 0,(function(e){var t,n,r,i,a,s,o=e.files,l=e.logger,u=e.imageCompression;return v(this,(function(e){switch(e.label){case 0:return t=u.compressionRate,n=u.outputFormat,r=void 0===n?"preserve":n,i=u.resizingWidth?tR(u.resizingWidth):void 0,a=u.resizingHeight?tR(u.resizingHeight):void 0,s={failedIndexes:[],compressedFiles:[]},Array.isArray(o)&&o.length>0?!t||t<0||1<t?(null==l||l.warning("utils - compressImages: The compressionRate is not acceptable.",t),[2,s]):[4,Promise.all(o.map((function(e,n){return _(void 0,void 0,void 0,(function(){var o,u;return v(this,(function(c){switch(c.label){case 0:if("image/jpg"!==e.type&&"image/png"!==e.type&&"image/jpeg"!==e.type)return null==l||l.warning("utils - compressImages: The fileType is not compressible.",{file:e,index:n}),s.failedIndexes.push(n),s.compressedFiles.push(e),[2];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,MF({imageFile:e,compressionRate:t,resizingWidth:i,resizingHeight:a,outputFormat:r})];case 2:return o=c.sent(),s.compressedFiles.push(o),[3,4];case 3:return u=c.sent(),s.compressedFiles.push(e),s.failedIndexes.push(n),null==l||l.warning("utils - compressImages: Failed to compress image file",{file:e,err:u}),[3,4];case 4:return[2]}}))}))})))]:(null==l||l.warning("utils - compressImages: There are no files.",o),[2,s]);case 1:return e.sent(),null==l||l.info("utils - compressImages: Finished compressing images",s),[2,s]}}))}))},RF=function(e){var t=e.channel,n=e.onCancelClick,r=e.onSubmitClick,s=Object(i.useRef)(ZS()).current,o=Object(i.useState)(null),l=o[0],u=o[1],c=Object(i.useState)(NF),d=c[0],h=c[1],f=Object(i.useState)(!1),p=f[0],m=f[1],g=Object(i.useState)(!1),_=g[0],v=g[1],E=Object(i.useState)(!1),y=E[0],b=E[1],C=JC().stringSet,N=IC().state.config,T=CF({onRecordingStarted:function(){h(TF)},onRecordingEnded:function(e){u(e)}}),I=T.start,S=T.stop,w=T.cancel,A=T.recordingTime,M=T.recordingStatus,O=T.recordingLimit,R=YU({channelUrl:null==t?void 0:t.url,key:s,audioFile:null!=l?l:void 0}),k=R.play,x=R.pause,D=R.playbackTime,U=R.playingStatus,L=R.stop;return Object(i.useEffect)((function(){dO(t)||hO(t)?v(!0):v(!1)}),[null==t?void 0:t.myRole,null==t?void 0:t.isFrozen,null==t?void 0:t.myMutedState]),Object(i.useEffect)((function(){p&&l&&(null==r||r(l,A),m(!1),u(null))}),[p,l,A]),Object(i.useEffect)((function(){l&&(A<N.voiceRecord.minRecordingTime?(h(NF),u(null)):h(U===AC?SF:IF))}),[l,A,U]),a.a.createElement("div",{className:"sendbird-voice-message-input-wrapper"},a.a.createElement(AF,{currentValue:M===bF?D:A,maximumValue:M===bF?A:O,currentType:d,onCancelClick:function(){null==n||n(),w(),L()},onSubmitClick:function(){_?(b(!0),h(NF)):(S(),x(),m(!0))},onControlClick:function(e){switch(e){case NF:L(),I();break;case TF:A>=N.voiceRecord.minRecordingTime&&!_?S():_?(w(),b(!0),h(NF)):(w(),h(NF));break;case IF:k();break;case SF:x()}}}),y&&a.a.createElement(rw,{className:"sendbird-voice-message-input-wrapper-alert",titleText:hO(t)?C.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED:C.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN,hideFooter:!0,isCloseOnClickOutside:!0,onClose:function(){b(!1),null==n||n()}},a.a.createElement("div",{className:"sendbird-voice-message-input-wrapper-alert__body"},a.a.createElement(NN,{className:"sendbird-voice-message-input-wrapper-alert__body__ok-button",type:fN.PRIMARY,size:mN.BIG,onClick:function(){b(!1),null==n||n()}},C.BUTTON__OK))))},kF=a.a.forwardRef((function(e,t){var n,r=e.currentChannel,s=e.messages,o=e.loading,l=e.quoteMessage,u=e.setQuoteMessage,c=e.messageInputRef,d=e.sendUserMessage,h=e.sendFileMessage,f=e.sendVoiceMessage,p=e.sendMultipleFilesMessage,m=e.renderUserMentionItem,g=e.renderFileUploadIcon,y=e.renderVoiceMessageIcon,b=e.renderSendMessageIcon,C=e.acceptableMimeTypes,N=e.disabled,T=JC().stringSet,I=oN().isMobile,S=IC().state,w=S.stores,A=S.config,M=A.isOnline,O=A.userMention,R=A.logger,k=A.groupChannel,x=w.sdkStore.sdk,D=O.maxMentionCount,U=O.maxSuggestionCount,L=null==r?void 0:r.isBroadcast,P="operator"===(null==r?void 0:r.myRole),F=null!==(n=e.isMultipleFilesMessageEnabled)&&void 0!==n?n:A.isMultipleFilesMessageEnabled,B=k.enableMention,j=k.enableVoiceMessage,H=Object(i.useState)(""),G=H[0],z=H[1],V=Object(i.useState)([]),q=V[0],K=V[1],W=Object(i.useState)([]),Y=W[0],Q=W[1],X=Object(i.useState)(null),Z=X[0],J=X[1],$=Object(i.useState)([]),ee=$[0],te=$[1],ne=Object(i.useState)(null),re=ne[0],ie=ne[1],ae=Object(i.useState)(!1),se=ae[0],oe=ae[1],le=o||!r||!x||!x.isCacheEnabled&&!M||dO(r)||hO(r)||fO(r,A.groupChannel.enableSuggestedReplies)||mO(s,A.groupChannel.enableFormTypeMessage)||N,ue=!le&&B&&G.length>0&&!L,ce=ck({ref:t||c},{logger:R}),de=(null==ce?void 0:ce.length)<D;Object(i.useEffect)((function(){z(""),K([]),Q([]),J(null),te([]),ie(null),oe(!1)}),[null==r?void 0:r.url]),Object(i.useEffect)((function(){K(q.filter((function(e){var t=e.userId,n=Y.indexOf(t);return!(n<0)&&(Y.splice(n,1),!0)})))}),[Y]);var he=function(e,t){var n=e.sendFileMessage,r=e.sendMultipleFilesMessage,s=e.quoteMessage,o=t.logger,l=JC().stringSet,u=IC().state.config,c=u.imageCompression,d=null==u?void 0:u.uikitUploadSizeLimit,h=null==u?void 0:u.uikitMultipleFilesMessageLimit,f=_w().openModal;return Object(i.useCallback)((function(e){return _(void 0,void 0,void 0,(function(){var t,i,u,p,m;return v(this,(function(g){switch(g.label){case 0:return 0===e.length?(o.warning("Channel|useHandleUploadFiles: given file list is empty.",{files:e}),[2]):e.length>h?(o.info("Channel|useHandleUploadFiles: Cannot upload files more than ".concat(h)),f({modalProps:{titleText:l.FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT.replace("%d","".concat(d)),hideFooter:!0},childElement:function(e){var t=e.closeModal;return a.a.createElement(nw,{type:fN.PRIMARY,submitText:l.BUTTON__OK,hideCancelButton:!0,onCancel:t,onSubmit:t})}}),[2]):e.some((function(e){return e.size>d}))?(o.info("Channel|useHandleUploadFiles: Cannot upload file size exceeding ".concat(d)),1048576,f({modalProps:{titleText:l.FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT.replace("%d","".concat(Math.floor(d/1048576))),hideFooter:!0},childElement:function(e){var t=e.closeModal;return a.a.createElement(nw,{type:fN.PRIMARY,submitText:l.BUTTON__OK,hideCancelButton:!0,onCancel:t,onSubmit:t})}}),[2]):[4,OF({files:e,imageCompression:c,logger:o})];case 1:return t=g.sent().compressedFiles,1===(i=t).length?(o.info("Channel|useHandleUploadFiles: sending one file."),u=i[0],[2,n({file:u,parentMessageId:null==s?void 0:s.messageId})]):i.length>1?(o.info("Channel|useHandleUploadFiles: sending multiple files."),p=[],m=[],i.forEach((function(e){bA(e.type)?p.push(e):m.push(e)})),[2,m.reduce((function(e,t){return e.then((function(){return n({file:t,parentMessageId:null==s?void 0:s.messageId})}))}),0===p.length?Promise.resolve():1===p.length?n({file:p[0]}):r({fileInfoList:p.map((function(e){return{file:e,fileName:e.name,fileSize:e.size,mimeType:e.type}})),parentMessageId:null==s?void 0:s.messageId}))]):[2]}}))}))}),[n,r,s])}({sendFileMessage:h,sendMultipleFilesMessage:p,quoteMessage:null!=l?l:void 0},{logger:R});return L&&!P?null:a.a.createElement("div",{className:se?"sendbird-message-input-wrapper--voice-message":"sendbird-message-input-wrapper"},ue&&a.a.createElement(pF,{currentChannel:r,targetNickname:G,inputEvent:null!=re?re:void 0,renderUserMentionItem:m,onUserItemClick:function(e){e&&K(E(E([],q,!0),[e],!1)),z(""),J(e),ie(null)},onFocusItemChange:function(){ie(null)},onFetchUsers:function(e){te(e)},ableAddMention:de,maxMentionCount:D,maxSuggestionCount:U}),l&&a.a.createElement("div",{className:"sendbird-message-input-wrapper__quote-message-input"},a.a.createElement(_F,{replyingMessage:l,onClose:function(){return u(null)}})),se?a.a.createElement(RF,{channel:null!=r?r:void 0,onSubmitClick:function(e,t){f({file:e,parentMessageId:null==l?void 0:l.messageId},t),u(null),oe(!1)},onCancelClick:function(){oe(!1)}}):a.a.createElement(eD,{className:"sendbird-message-input-wrapper__message-input",channel:r,channelUrl:null==r?void 0:r.url,isMobile:I,acceptableMimeTypes:C,mentionSelectedUser:Z,isMentionEnabled:B,isVoiceMessageEnabled:j,isSelectingMultipleFilesEnabled:F,onVoiceMessageIconClick:function(){oe(!0)},setMentionedUsers:K,placeholder:l&&T.MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER||dO(r)&&T.MESSAGE_INPUT__PLACE_HOLDER__FROZEN||hO(r)&&(I?T.MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT:T.MESSAGE_INPUT__PLACE_HOLDER__MUTED)||fO(r,A.groupChannel.enableSuggestedReplies)&&T.MESSAGE_INPUT__PLACE_HOLDER__SUGGESTED_REPLIES||mO(s,A.groupChannel.enableFormTypeMessage)&&T.MESSAGE_INPUT__PLACE_HOLDER__MESSAGE_FORM||N&&T.MESSAGE_INPUT__PLACE_HOLDER__DISABLED||void 0,ref:t||c,disabled:le,renderFileUploadIcon:g,renderSendMessageIcon:b,renderVoiceMessageIcon:y,onStartTyping:function(){null==r||r.startTyping()},onSendMessage:function(e){var t,n=e.message,i=e.mentionTemplate;d({message:n,mentionedUsers:q,mentionedMessageTemplate:i,parentMessageId:null==l?void 0:l.messageId}),z(""),K([]),u(null),null===(t=null==r?void 0:r.endTyping)||void 0===t||t.call(r)},onFileUpload:function(e){he(e),u(null)},onUserMentioned:function(e){(null==Z?void 0:Z.userId)===(null==e?void 0:e.userId)&&(J(null),z(""))},onMentionStringChange:function(e){z(e)},onMentionedUserIdsUpdated:function(e){Q(e)},onKeyDown:function(e){return!!(ue&&(null==ee?void 0:ee.length)>0&&(e.key===hk&&de||e.key===fk||e.key===pk))&&(ie(e),!0)}}))})),xF=function(e){var t=CO(),n=t.state,r=t.actions;return a.a.createElement(kF,m({},e,n,r))},DF=function(e){var t=RO(),n=CO().state,r=n.channelUrl,i=n.fetchChannelError,s=eN(e),o=s.renderChannelHeader,l=void 0===o?function(e){return a.a.createElement(pR,m({},e))}:o,u=s.renderMessageList,c=void 0===u?function(e){return a.a.createElement(hF,m({},e,{className:"sendbird-conversation__message-list"}))}:u,d=s.renderMessageInput,h=void 0===d?function(){return a.a.createElement(xF,m({},e))}:d;return a.a.createElement(WO,m({},e,t,{isInvalid:null!==i,channelUrl:r,renderChannelHeader:l,renderMessageList:c,renderMessageInput:h}))},UF=function(e){return a.a.createElement(MO,m({},e),a.a.createElement(DF,m({},e)))},LF=function(e){var t=e.renderTitle,n=e.renderIconButton,r=e.onEdit,i=e.allowProfileEdit,s=e.renderLeft,o=e.renderMiddle,l=e.renderRight,u=IC().state.stores.userStore.user,c=JC().stringSet,d=null!=o?o:t;return a.a.createElement(hR,{className:nN("sendbird-channel-header",i&&"sendbird-channel-header--allow-edit"),renderLeft:s,renderMiddle:function(){var e;return null!==(e=null==d?void 0:d())&&void 0!==e?e:a.a.createElement("div",{className:"sendbird-channel-header__title",role:"button",onClick:function(){null==r||r()},onKeyDown:function(){null==r||r()},tabIndex:0},a.a.createElement("div",{className:"sendbird-channel-header__title__left"},a.a.createElement(iR,{width:"32px",height:"32px",src:u.profileUrl,alt:u.nickname})),a.a.createElement("div",{className:"sendbird-channel-header__title__right"},a.a.createElement(_N,{className:"sendbird-channel-header__title__right__name",type:vN.SUBTITLE_2,color:EN.ONBACKGROUND_1},u.nickname||c.NO_NAME),a.a.createElement(_N,{className:"sendbird-channel-header__title__right__user-id",type:vN.BODY_2,color:EN.ONBACKGROUND_2},u.userId)))},renderRight:null!=l?l:n})},PF=a.a.createContext(null),FF=function(e){var t=e.children,n=g(e,["children"]);return a.a.createElement(PF.Provider,{value:n},t)},BF=function(e){var t,n=e.formRef,r=e.inputRef,s=e.onThemeChange,o=e.setProfileImage,l=IC().state,u=l.stores,c=l.config,d=c.theme,h=c.setCurrentTheme,f=null===(t=u.userStore)||void 0===t?void 0:t.user,p=JC().stringSet,m=Object(i.useState)(null),g=m[0],_=m[1],v=Object(i.useRef)(null);return a.a.createElement("form",{className:"sendbird-edit-user-profile",ref:n,onSubmit:function(e){e.preventDefault()}},a.a.createElement("section",{className:"sendbird-edit-user-profile__img"},a.a.createElement(DP,null,p.EDIT_PROFILE__IMAGE_LABEL),a.a.createElement("div",{className:"sendbird-edit-user-profile__img__avatar"},a.a.createElement(iR,{width:"80px",height:"80px",src:g||(null==f?void 0:f.profileUrl)})),a.a.createElement("input",{ref:v,type:"file",accept:"image/gif, image/jpeg, image/png",style:{display:"none"},onChange:function(e){e.target.files&&(_(URL.createObjectURL(e.target.files[0])),o(e.target.files[0])),v.current&&(v.current.value="")}}),a.a.createElement(cR,{className:"sendbird-edit-user-profile__img__avatar-button",disableUnderline:!0,onClick:function(){var e;return null===(e=v.current)||void 0===e?void 0:e.click()}},a.a.createElement(_N,{type:vN.BUTTON_1,color:EN.PRIMARY},p.EDIT_PROFILE__IMAGE_UPLOAD))),a.a.createElement("section",{className:"sendbird-edit-user-profile__name"},a.a.createElement(DP,null,p.EDIT_PROFILE__NICKNAME_LABEL),a.a.createElement(UP,{required:""!==(null==f?void 0:f.nickname),name:"sendbird-edit-user-profile__name__input",ref:r,value:null==f?void 0:f.nickname,placeHolder:p.EDIT_PROFILE__NICKNAME_PLACEHOLDER})),a.a.createElement("section",{className:"sendbird-edit-user-profile__userid"},a.a.createElement(DP,null,p.EDIT_PROFILE__USERID_LABEL),a.a.createElement(UP,{disabled:!0,name:"sendbird-edit-user-profile__userid__input",value:null==f?void 0:f.userId})),a.a.createElement("section",{className:"sendbird-edit-user-profile__theme"},a.a.createElement(DP,null,p.EDIT_PROFILE__THEME_LABEL),a.a.createElement("div",{className:"sendbird-edit-user-profile__theme__theme-icon"},"dark"===d?a.a.createElement(YS,{onClick:function(){h("light"),null==s||s("light")},type:QS.TOGGLE_ON,width:44,height:24}):a.a.createElement(YS,{onClick:function(){h("dark"),null==s||s("dark")},type:QS.TOGGLE_OFF,width:44,height:24}))))},jF=function(){var e=function(){var e=a.a.useContext(PF);if(!e)throw new Error("EditUserProfileContext not found. Use within the EditUserProfile module.");return e}(),t=e.onEditProfile,n=e.onCancel,r=e.onThemeChange,s=Object(i.useContext)(XC).stringSet,o=function(e){var t=e.onEditProfile,n=IC(),r=n.state,a=n.actions,s=Object(i.useRef)(null),o=Object(i.useRef)(null),l=Object(i.useState)(null),u=l[0],c=l[1];return{formRef:o,inputRef:s,updateUserInfo:function(){!function(e){var t,n,r,i=e.globalContext,a=e.formRef,s=e.inputRef,o=e.profileImage,l=e.onEditProfile,u=e.updateUserInfo,c=i.stores,d=c.sdkStore.sdk,h=c.userStore.user;""===(null==h?void 0:h.nickname)||s.current.value?null==d||d.updateCurrentUserInfo({nickname:null===(r=null==s?void 0:s.current)||void 0===r?void 0:r.value,profileImage:null!=o?o:void 0}).then((function(e){u(e),null==l||l(e)})):null===(n=(t=a.current).reportValidity)||void 0===n||n.call(t)}({globalContext:r,formRef:o,inputRef:s,profileImage:u,onEditProfile:t,updateUserInfo:a.updateUserInfo})},profileImage:u,setProfileImage:c}}({onEditProfile:t}),l=o.formRef,u=o.inputRef,c=o.updateUserInfo,d=o.setProfileImage;return a.a.createElement(rw,{titleText:s.EDIT_PROFILE__TITLE,submitText:s.BUTTON__SAVE,type:fN.PRIMARY,onCancel:n,isFullScreenOnMobile:!0,onSubmit:c},a.a.createElement(BF,{formRef:l,inputRef:u,setProfileImage:d,onThemeChange:r}))},HF=function(e){var t=e.onEditProfile,n=e.onCancel,r=e.onThemeChange;return a.a.createElement(FF,{onEditProfile:t,onCancel:n,onThemeChange:r},a.a.createElement(jF,null))};function GF(e,t,n){void 0===n&&(n={leading:!0,trailing:!1});var r=Object(i.useRef)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((function(){return function(){r.current&&clearTimeout(r.current)}}),[]),Gm((function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];if(r.current)a.current=i;else{n.leading?e.apply(void 0,i):a.current=i;var o=function(){n.trailing&&a.current?(e.apply(void 0,a.current),a.current=null,r.current=setTimeout(o,t)):r.current=null};r.current=setTimeout(o,t)}}))}var zF=function(e){var t=e.channel,n=e.onSubmit,r=e.onCancel,i=IC().state.config,s=i.logger,o=i.isOnline,l=JC().stringSet;if(t)return a.a.createElement(rw,{disabled:!o,onCancel:r,onSubmit:function(){s.info("LeaveGroupChannel: Leaving channel",t),t.leave().then((function(){s.info("LeaveGroupChannel: Leaving channel successful!",t),null==n||n()}))},submitText:l.MODAL__LEAVE_CHANNEL__FOOTER,titleText:l.MODAL__LEAVE_CHANNEL__TITLE})};function VF(e){var t=e.channel,n=e.disabled,r=void 0!==n&&n,s=e.onLeaveChannel,o=Object(i.useRef)(null),l=Object(i.useRef)(null),u=Object(i.useState)(!1),c=u[0],d=u[1],h=Object(i.useContext)(XC).stringSet;return a.a.createElement("div",{ref:l,tabIndex:0,role:"button",style:{display:"inline-block"},onKeyDown:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()}},a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(lN,{ref:o,onClick:e,height:"32px",width:"32px"},a.a.createElement(YS,{type:QS.MORE,fillColor:XS.PRIMARY,width:"24px",height:"24px"}))},menuItems:function(e){return a.a.createElement(EM,{parentRef:o,parentContainRef:l,closeDropdown:e},a.a.createElement(bM,{onClick:function(){r||(d(!0),e())},testID:"channel_list_item_context_menu_leave_channel"},h.CHANNEL_SETTING__LEAVE_CHANNEL__TITLE))}}),c&&a.a.createElement(zF,{channel:t,onSubmit:function(){d(!1),null==s||s()},onCancel:function(){return d(!1)}}))}function qF(e){var t=e.count,n=e.maxLevel,r=void 0===n?2:n,s=e.className,o=void 0===s?"":s,l=Object(i.useContext)(XC).stringSet,u=parseInt("9".repeat(r>6?6:r),10);return a.a.createElement("div",{className:E(E([],Array.isArray(o)?o:[o],!0),["sendbird-badge"],!1).join(" ")},a.a.createElement("div",{className:"sendbird-badge__text"},a.a.createElement(_N,{type:vN.CAPTION_2,color:EN.ONCONTENT_1},"string"==typeof t?t:t>u?"".concat(u).concat(l.BADGE__OVER):t)))}function KF(e){var t=e.className,n=void 0===t?"":t,r=e.children,i=e.isReverse,s=void 0!==i&&i,o=e.color,l=e.userId;return a.a.createElement("span",{className:nN("sendbird-mention-user-label",n,s&&"reverse",o),contentEditable:!1,"data-userid":l,"data-sb-mention":!0},r)}var WF=function(e){var t=e.channel,n=e.tabIndex,r=e.isTyping,s=e.isSelected,o=e.channelName,l=e.isMessageStatusEnabled,u=void 0===l||l,c=e.onClick,d=void 0===c?$C:c,h=e.onLeaveChannel,f=void 0===h?function(){return Promise.resolve()}:h,p=e.renderChannelAction,g=IC().state.config,_=g.theme,v=g.userId,E=JC(),y=E.dateLocale,b=E.stringSet,C=oN().isMobile,N=g.groupChannel.enableMention,T=dD(t,b),I=g.groupChannel.enableMarkdownForUserMessage?Qx(T):T,S=Object(i.useState)(!1),w=S[0],A=S[1],M=wD({onLongPress:function(){C&&A(!0)},onClick:d},{delay:1e3});return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",m({className:["sendbird-channel-preview",s?"sendbird-channel-preview--active":""].join(" "),role:"link",tabIndex:n},C?m({},M):{onClick:d}),a.a.createElement("div",{className:"sendbird-channel-preview__avatar"},a.a.createElement(sR,{channel:t,userId:v,theme:_})),a.a.createElement("div",{className:"sendbird-channel-preview__content"},a.a.createElement("div",{className:"sendbird-channel-preview__content__upper"},a.a.createElement("div",{className:"sendbird-channel-preview__content__upper__header"},!!t.isBroadcast&&a.a.createElement("div",{className:"sendbird-channel-preview__content__upper__header__broadcast-icon"},a.a.createElement(YS,{type:QS.BROADCAST,fillColor:XS.SECONDARY,height:"16px",width:"16px"})),a.a.createElement(_N,{className:"sendbird-channel-preview__content__upper__header__channel-name",testID:"sendbird-channel-preview__content__upper__header__channel-name",type:vN.SUBTITLE_2,color:EN.ONBACKGROUND_1},o),a.a.createElement(_N,{className:"sendbird-channel-preview__content__upper__header__total-members",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},function(e){return(null==e?void 0:e.memberCount)?e.memberCount:0}(t)),t.isFrozen&&a.a.createElement("div",{title:"Frozen",className:"sendbird-channel-preview__content__upper__header__frozen-icon"},a.a.createElement(YS,{type:QS.FREEZE,fillColor:XS.PRIMARY,height:12,width:12}))),!t.isEphemeral&&u&&a.a.createElement(mD,{className:"sendbird-channel-preview__content__upper__last-message-at",channel:t,message:t.lastMessage,isDateSeparatorConsidered:!1}),!t.isEphemeral&&!u&&a.a.createElement(_N,{className:"sendbird-channel-preview__content__upper__last-message-at",type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},uD({channel:t,locale:y,stringSet:b}))),a.a.createElement("div",{className:"sendbird-channel-preview__content__lower"},a.a.createElement(_N,{className:"sendbird-channel-preview__content__lower__last-message",type:vN.BODY_2,color:EN.ONBACKGROUND_3},r&&a.a.createElement(UO,{members:t.getTypingUsers()}),!r&&!YA(t.lastMessage)&&I,!r&&YA(t.lastMessage)&&b.VOICE_MESSAGE),!s&&!t.isEphemeral&&a.a.createElement("div",{className:"sendbird-channel-preview__content__lower__unread-message-count"},N&&t.unreadMentionCount>0?a.a.createElement(KF,{className:"sendbird-channel-preview__content__lower__unread-message-count__mention",color:"purple"},"@"):null,hD(t)?a.a.createElement(qF,{count:hD(t)}):null))),!C&&a.a.createElement("div",{className:"sendbird-channel-preview__action"},p({channel:t}))),w&&C&&a.a.createElement(rw,{className:"sendbird-channel-preview__leave--mobile",titleText:o,hideFooter:!0,isCloseOnClickOutside:!0,onCancel:function(){return A(!1)}},a.a.createElement(cR,{onClick:function(){f(),A(!1)},className:"sendbird-channel-preview__leave-label--mobile"},a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},b.CHANNEL_PREVIEW_MOBILE_LEAVE))))},YF=function(e){var t,n,r,i=e.channel,s=e.isSelected,o=e.isTyping,l=e.renderChannelAction,u=e.onLeaveChannel,c=e.onClick,d=e.tabIndex,h=IC().state.config,f=JC().stringSet,p=ZM().state,m=p.isTypingIndicatorEnabled,g=p.isMessageReceiptStatusEnabled,_=h.userId,v=g&&!(null===(t=i.lastMessage)||void 0===t?void 0:t.isAdminMessage())&&(null===(r=null===(n=i.lastMessage)||void 0===n?void 0:n.sender)||void 0===r?void 0:r.userId)===_;return a.a.createElement(WF,{channel:i,tabIndex:d,channelName:lD(i,_,f),isTyping:m&&o,isSelected:s,isMessageStatusEnabled:v,onClick:c,onLeaveChannel:u,renderChannelAction:l})},QF=function(e){return null==e};function XF(e,t){return!QF(e)&&!QF(t)&&e.toString()===t.toString()}var ZF=function(e){void 0===e&&(e=0);var t=e;if(!(t>10))try{var n=document.querySelector(".sendbird-thread-ui--scroll");n&&(n.scrollTop=n.scrollHeight)}catch(e){setTimeout((function(){ZF(t+1)}),500*t)}},JF=function(e,t){var n=e.currentChannel,r=e.onBeforeSendMultipleFilesMessage,a=e.publishingModules,s=t.logger,o=t.pubSub,l=t.scrollRef;return[Object(i.useCallback)((function(e,t){return new Promise((function(i,u){n||(s.warning("Channel: Sending MFm failed, because currentChannel is null.",{currentChannel:n}),u()),e.length<=1&&(s.warning("Channel: Sending MFM failed, because there are no multiple files.",{files:e}),u());var c={fileInfoList:e.map((function(e){return{file:e,fileName:e.name,fileSize:e.size,mimeType:e.type}}))};t&&(c.isReplyToChannel=!0,c.parentMessageId=t.messageId),"function"==typeof r&&(c=r(e,t)),s.info("Channel: Start sending MFM",{messageParams:c});try{null==n||n.sendMultipleFilesMessage(c).onFileUploaded((function(e,t,r,i){s.info("Channel: onFileUploaded during sending MFM",{requestId:e,index:t,error:i,uploadableFileInfo:r}),o.publish(yO.ON_FILE_INFO_UPLOADED,{response:{channelUrl:n.url,requestId:e,index:t,uploadableFileInfo:r,error:i},publishingModules:a})})).onPending((function(e){s.info("Channel: in progress of sending MFM",{pendingMessage:e,fileInfoList:c.fileInfoList}),o.publish(yO.SEND_MESSAGE_START,{message:e,channel:n,publishingModules:a}),setTimeout((function(){var e;l&&(e=a,EO(uO.CHANNEL,e))&&uF(0,l),function(e){return EO(uO.THREAD,e)}(a)&&ZF(0)}),100)})).onFailed((function(e,t){s.error("Channel: Sending MFM failed.",{error:e,failedMessage:t}),o.publish(yO.SEND_MESSAGE_FAILED,{channel:n,message:t,publishingModules:a}),u(e)})).onSucceeded((function(e){s.info("Channel: Sending voice message success!",{succeededMessage:e}),o.publish(yO.SEND_FILE_MESSAGE,{channel:n,message:e,publishingModules:a}),i(e)}))}catch(e){s.error("Channel: Sending MFM failed.",{error:e}),u(e)}}))}),[n,r,a])]};a.a.createContext(null),a.a.createContext(null),Object(i.createContext)(null),Object(i.createContext)(void 0);var $F,eB,tB,nB,rB,iB,aB,sB,oB=function(){},lB={checked:null,defaultChecked:!1,disabled:!1,onChange:oB,onFocus:oB,onBlur:oB};a.a.createContext(lB),(eB=$F||($F={})).SCORE="score",eB.TIMESTAMP="ts",Object(i.createContext)(null),(nB=tB||(tB={})).NIL="NIL",nB.LOADING="LOADING",nB.INVALID="INVALID",nB.INITIALIZED="INITIALIZED",(iB=rB||(rB={})).NIL="NIL",iB.LOADING="LOADING",iB.INVALID="INVALID",iB.INITIALIZED="INITIALIZED",(sB=aB||(aB={})).NIL="NIL",sB.LOADING="LOADING",sB.INVALID="INVALID",sB.INITIALIZED="INITIALIZED";function uB(e,t){var n=e.isMentionEnabled,r=e.currentChannel,a=e.onBeforeSendUserMessage,s=e.sendMessageStart,o=e.sendMessageFailure,l=t.logger,u=t.pubSub;return Object(i.useCallback)((function(e){var t,i=e.message,c=e.quoteMessage,d=e.mentionTemplate,h=e.mentionedUsers,f=null!==(t=null==a?void 0:a(i,c))&&void 0!==t?t:function(){var e={};e.message=i;var t=(null==h?void 0:h.length)||0;return n&&t&&(e.mentionedUsers=h),n&&d&&t&&(e.mentionedMessageTemplate=d),c&&(e.isReplyToChannel=!0,e.parentMessageId=c.messageId),e}();l.info("Thread | useSendUserMessageCallback: Sending user message start.",f),(null==r?void 0:r.sendUserMessage)&&(null==r||r.sendUserMessage(f).onPending((function(e){s(e)})).onFailed((function(e,t){l.info("Thread | useSendUserMessageCallback: Sending user message failed.",{message:t,error:e}),o(t)})).onSucceeded((function(e){l.info("Thread | useSendUserMessageCallback: Sending user message succeeded.",e),u.publish(yO.SEND_USER_MESSAGE,{channel:r,message:e,publishingModules:[uO.THREAD]})})))}),[n,r])}function cB(e,t){var n=e.currentChannel,r=e.onBeforeSendFileMessage,a=e.sendMessageStart,s=e.sendMessageFailure,o=t.logger,l=t.pubSub;return Object(i.useCallback)((function(e,t){return new Promise((function(i,u){var c,d,h=null!==(c=null==r?void 0:r(e,t))&&void 0!==c?c:((d={}).file=e,t&&(d.isReplyToChannel=!0,d.parentMessageId=t.messageId),d);o.info("Thread | useSendFileMessageCallback: Sending file message start.",h),null==n?(o.warning("Thread | useSendFileMessageCallback: currentChannel is null. Skipping file message send."),i(null)):n.sendFileMessage(h).onPending((function(t){a(m(m({},t),{url:URL.createObjectURL(e),sendingStatus:_e.PENDING,isUserMessage:t.isUserMessage,isFileMessage:t.isFileMessage,isAdminMessage:t.isAdminMessage,isMultipleFilesMessage:t.isMultipleFilesMessage})),setTimeout((function(){return ZF()}),100)})).onFailed((function(t,n){n.localUrl=URL.createObjectURL(e),n.file=e,o.info("Thread | useSendFileMessageCallback: Sending file message failed.",{message:n,error:t}),s(n),u(t)})).onSucceeded((function(e){o.info("Thread | useSendFileMessageCallback: Sending file message succeeded.",e),l.publish(yO.SEND_FILE_MESSAGE,{channel:n,message:e,publishingModules:[uO.THREAD]}),i(e)}))}))}),[n])}var dB=function(e,t){var n=e.currentChannel,r=e.onBeforeSendVoiceMessage,a=e.sendMessageStart,s=e.sendMessageFailure,o=t.logger,l=t.pubSub;return Object(i.useCallback)((function(e,t,i){var u=r&&"function"==typeof r?r(e,i):{file:e,fileName:"Voice_message.mp3",mimeType:"audio/mp3;sbu_type=voice",metaArrays:[new vo({key:"KEY_VOICE_MESSAGE_DURATION",value:["".concat(t)]}),new vo({key:"KEY_INTERNAL_MESSAGE_TYPE",value:["voice/mp3"]})]};i&&(u.isReplyToChannel=!0,u.parentMessageId=i.messageId),o.info("Thread | useSendVoiceMessageCallback:  Start sending voice message",u),null==n||n.sendFileMessage(u).onPending((function(t){a(m(m({},t),{url:URL.createObjectURL(e),sendingStatus:_e.PENDING,isUserMessage:t.isUserMessage,isFileMessage:t.isFileMessage,isAdminMessage:t.isAdminMessage,isMultipleFilesMessage:t.isMultipleFilesMessage})),setTimeout((function(){return ZF()}),100)})).onFailed((function(t,n){n.localUrl=URL.createObjectURL(e),n.file=e,o.info("Thread | useSendVoiceMessageCallback: Sending voice message failed.",{message:n,error:t}),s(n)})).onSucceeded((function(e){o.info("Thread | useSendVoiceMessageCallback: Sending voice message succeeded.",e),l.publish(yO.SEND_FILE_MESSAGE,{channel:n,message:e,publishingModules:[uO.THREAD]})}))}),[n,r])};function hB(e,t){var n=e.currentChannel,r=e.resendMessageStart,a=e.sendMessageSuccess,s=e.sendMessageFailure,o=t.logger,l=t.pubSub;return Object(i.useCallback)((function(e){var t,i,u,c,d;if(null==e?void 0:e.isResendable)if(o.info("Thread | useResendMessageCallback: Resending failedMessage start.",e),(null===(t=null==e?void 0:e.isUserMessage)||void 0===t?void 0:t.call(e))||(null==e?void 0:e.messageType)===de.USER)try{null==n||n.resendMessage(e).onPending((function(e){o.info("Thread | useResendMessageCallback: Resending user message started.",e),r(e)})).onSucceeded((function(e){o.info("Thread | useResendMessageCallback: Resending user message succeeded.",e),a(e),l.publish(yO.SEND_USER_MESSAGE,{channel:n,message:e,publishingModules:[uO.THREAD]})})).onFailed((function(t){o.warning("Thread | useResendMessageCallback: Resending user message failed.",t),e.sendingStatus=_e.FAILED,s(e)}))}catch(t){o.warning("Thread | useResendMessageCallback: Resending user message failed.",t),e.sendingStatus=_e.FAILED,s(e)}else if(null===(i=null==e?void 0:e.isFileMessage)||void 0===i?void 0:i.call(e))try{null===(u=null==n?void 0:n.resendMessage)||void 0===u||u.call(n,e).onPending((function(e){o.info("Thread | useResendMessageCallback: Resending file message started.",e),r(e)})).onSucceeded((function(t){o.info("Thread | useResendMessageCallback: Resending file message succeeded.",t),a(t),l.publish(yO.SEND_FILE_MESSAGE,{channel:n,message:e,publishingModules:[uO.THREAD]})})).onFailed((function(t){o.warning("Thread | useResendMessageCallback: Resending file message failed.",t),e.sendingStatus=_e.FAILED,s(e)}))}catch(t){o.warning("Thread | useResendMessageCallback: Resending file message failed.",t),e.sendingStatus=_e.FAILED,s(e)}else if(null===(c=null==e?void 0:e.isMultipleFilesMessage)||void 0===c?void 0:c.call(e))try{null===(d=null==n?void 0:n.resendMessage)||void 0===d||d.call(n,e).onPending((function(e){o.info("Thread | useResendMessageCallback: Resending multiple files message started.",e),r(e)})).onFileUploaded((function(e,t,r,i){o.info("Thread | useResendMessageCallback: onFileUploaded during resending multiple files message.",{requestId:e,index:t,error:i,uploadableFileInfo:r}),l.publish(yO.ON_FILE_INFO_UPLOADED,{response:{channelUrl:n.url,requestId:e,index:t,uploadableFileInfo:r,error:i},publishingModules:[uO.THREAD]})})).onSucceeded((function(e){o.info("Thread | useResendMessageCallback: Resending MFM succeeded.",e),a(e),l.publish(yO.SEND_FILE_MESSAGE,{channel:n,message:e,publishingModules:[uO.THREAD]})})).onFailed((function(e,t){o.warning("Thread | useResendMessageCallback: Resending MFM failed.",e),s(t)}))}catch(t){o.warning("Thread | useResendMessageCallback: Resending MFM failed.",t),s(e)}else o.warning("Thread | useResendMessageCallback: Message is not resendable.",e),e.sendingStatus=_e.FAILED,s(e);else o.warning("Thread | useResendMessageCallback: Message is not resendable.",e)}),[n])}function fB(e,t){var n=e.currentChannel,r=e.isMentionEnabled,a=e.onMessageUpdated,s=t.logger,o=t.pubSub;return Object(i.useCallback)((function(e){var t,i,l=e.messageId,u=e.message,c=e.mentionedUsers,d=e.mentionTemplate,h=((i={}).message=u,r&&c&&(null==c?void 0:c.length)>0&&(i.mentionedUsers=c),i.mentionedMessageTemplate=r&&d?d:u,i);s.info("Thread | useUpdateMessageCallback: Message update start.",h),null!=n?null===(t=n.updateUserMessage)||void 0===t||t.call(n,l,h).then((function(e){s.info("Thread | useUpdateMessageCallback: Message update succeeded.",e),a(n,e),o.publish(yO.UPDATE_USER_MESSAGE,{fromSelector:!0,channel:n,message:e,publishingModules:[uO.THREAD]})})):s.warning("Thread | useUpdateMessageCallback: currentChannel is null.")}),[n,r])}function pB(e,t){var n=e.currentChannel,r=e.onMessageDeletedByReqId,a=e.onMessageDeleted,s=t.logger;return Object(i.useCallback)((function(e){s.info("Thread | useDeleteMessageCallback: Deleting message.",e);var t=e.sendingStatus;return new Promise((function(i,o){var l;s.info("Thread | useDeleteMessageCallback: Deleting message requestState:",t),"failed"!==t&&"pending"!==t||(s.info("Thread | useDeleteMessageCallback: Deleted message from local:",e),r(e.reqId),i()),null==n&&(s.info("Thread | useDeleteMessageCallback: No current channel"),i()),s.info("Thread | useDeleteMessageCallback: Deleting message from remote:",t),null===(l=n.deleteMessage)||void 0===l||l.call(n,e).then((function(){s.info("Thread | useDeleteMessageCallback: Deleting message success!",e),a(n,e.messageId),i()})).catch((function(e){s.warning("Thread | useDeleteMessageCallback: Deleting message failed!",e),o(e)}))}))}),[n])}function mB(e){return m({prevResultSize:30,nextResultSize:30,includeMetaArray:!0},e)}var gB=function(){var e,t,n=Object(i.useContext)(_B);if(!n)throw new Error("useThread must be used within a ThreadProvider");var r=IC().state,a=r.stores,s=r.config,o=s.logger,l=s.pubSub,u=s.groupChannel.enableMention,c=s.groupChannel.enableReactions,d=J_.useSyncExternalStore(n.subscribe,n.getState),h=d.message,f=d.parentMessage,p=d.currentChannel,g=d.threadListState,y=d.allThreadMessages,b=d.onBeforeSendUserMessage,C=d.onBeforeSendFileMessage,N=d.onBeforeSendVoiceMessage,T=d.onBeforeSendMultipleFilesMessage,I={sendMessageStart:function(e){return n.setState((function(t){return m(m({},t),{localThreadMessages:E(E([],t.localThreadMessages,!0),[e],!1)})}))},sendMessageSuccess:function(e){return n.setState((function(t){return m(m({},t),{allThreadMessages:E(E([],t.allThreadMessages.filter((function(t){return!XF(null==t?void 0:t.reqId,null==e?void 0:e.reqId)})),!0),[e],!1),localThreadMessages:t.localThreadMessages.filter((function(t){return!XF(null==t?void 0:t.reqId,null==e?void 0:e.reqId)}))})}))},sendMessageFailure:function(e){return n.setState((function(t){return m(m({},t),{localThreadMessages:t.localThreadMessages.map((function(t){return XF(null==t?void 0:t.reqId,null==e?void 0:e.reqId)?e:t}))})}))},resendMessageStart:function(e){return n.setState((function(t){return m(m({},t),{localThreadMessages:t.localThreadMessages.map((function(t){return XF(null==t?void 0:t.reqId,null==e?void 0:e.reqId)?e:t}))})}))}},S=function(e,t){var n=e.currentChannel,r=t.logger;return Object(i.useCallback)((function(e,t,i){var a,s;i?null===(a=null==n?void 0:n.deleteReaction)||void 0===a||a.call(n,e,t).then((function(e){r.info("Thread | useToggleReactionsCallback: Delete reaction succeeded.",e)})).catch((function(e){r.warning("Thread | useToggleReactionsCallback: Delete reaction failed.",e)})):null===(s=null==n?void 0:n.addReaction)||void 0===s||s.call(n,e,t).then((function(e){r.info("Thread | useToggleReactionsCallback: Add reaction succeeded.",e)})).catch((function(e){r.warning("Thread | useToggleReactionsCallback: Add reaction failed.",e)}))}),[n])}({currentChannel:p},{logger:o}),w={sendMessage:uB({isMentionEnabled:u,currentChannel:p,onBeforeSendUserMessage:b,sendMessageStart:I.sendMessageStart,sendMessageFailure:I.sendMessageFailure},{logger:o,pubSub:l}),sendFileMessage:cB({currentChannel:p,onBeforeSendFileMessage:C,sendMessageStart:I.sendMessageStart,sendMessageFailure:I.sendMessageFailure},{logger:o,pubSub:l}),sendVoiceMessage:dB({currentChannel:p,onBeforeSendVoiceMessage:N,sendMessageStart:I.sendMessageStart,sendMessageFailure:I.sendMessageFailure},{logger:o,pubSub:l}),sendMultipleFilesMessage:JF({currentChannel:p,onBeforeSendMultipleFilesMessage:T,publishingModules:[uO.THREAD]},{logger:o,pubSub:l})[0],resendMessage:hB({resendMessageStart:I.resendMessageStart,sendMessageSuccess:I.sendMessageSuccess,sendMessageFailure:I.sendMessageFailure,currentChannel:p},{logger:o,pubSub:l})},A={onMessageUpdated:function(e,t){return n.setState((function(n){var r,i,a;return(null===(r=n.currentChannel)||void 0===r?void 0:r.url)!==(null==e?void 0:e.url)?n:m(m({},n),{parentMessage:(null===(i=n.parentMessage)||void 0===i?void 0:i.messageId)===(null==t?void 0:t.messageId)?t:n.parentMessage,allThreadMessages:null===(a=n.allThreadMessages)||void 0===a?void 0:a.map((function(e){return(null==e?void 0:e.messageId)===(null==t?void 0:t.messageId)?t:e}))})}))},onMessageDeleted:function(e,t){return n.setState((function(n){var r,i,a,s;return(null===(r=n.currentChannel)||void 0===r?void 0:r.url)!==(null==e?void 0:e.url)?n:(null===(i=null==n?void 0:n.parentMessage)||void 0===i?void 0:i.messageId)===t?m(m({},n),{parentMessage:null,parentMessageState:rB.NIL,allThreadMessages:[]}):m(m({},n),{allThreadMessages:null===(a=n.allThreadMessages)||void 0===a?void 0:a.filter((function(e){return(null==e?void 0:e.messageId)!==t})),localThreadMessages:null===(s=n.localThreadMessages)||void 0===s?void 0:s.filter((function(e){return(null==e?void 0:e.messageId)!==t}))})}))},onMessageDeletedByReqId:function(e){return n.setState((function(t){return m(m({},t),{localThreadMessages:t.localThreadMessages.filter((function(t){return!XF(t.reqId,e)}))})}))}},M={updateMessage:fB({currentChannel:p,isMentionEnabled:u,onMessageUpdated:A.onMessageUpdated},{logger:o,pubSub:l}),deleteMessage:pB({currentChannel:p,onMessageDeleted:A.onMessageDeleted,onMessageDeletedByReqId:A.onMessageDeletedByReqId},{logger:o})},O={initializeThreadListStart:function(){return n.setState((function(e){return m(m({},e),{threadListState:aB.LOADING,allThreadMessages:[]})}))},initializeThreadListSuccess:function(e,t,r){return n.setState((function(n){var i=(null==t?void 0:t.messageId)?null==t?void 0:t.createdAt:null==e?void 0:e.createdAt,a=r.findIndex((function(e){return(null==e?void 0:e.createdAt)>i})),s=a>-1?r.slice(0,a):r,o=(null==t?void 0:t.messageId)?[t]:[],l=a>-1?r.slice(a):[];return m(m({},n),{threadListState:aB.INITIALIZED,hasMorePrev:-1===a||30===a,hasMoreNext:r.length-a==30,allThreadMessages:[s,o,l].flat()})}))},initializeThreadListFailure:function(){return n.setState((function(e){return m(m({},e),{threadListState:aB.LOADING,allThreadMessages:[]})}))},getPrevMessagesStart:function(){return n.setState((function(e){return m({},e)}))},getPrevMessagesSuccess:function(e){return n.setState((function(t){return m(m({},t),{hasMorePrev:30===e.length,allThreadMessages:E(E([],e,!0),t.allThreadMessages,!0)})}))},getPrevMessagesFailure:function(){return n.setState((function(e){return m(m({},e),{hasMorePrev:!1})}))},getNextMessagesStart:function(){return n.setState((function(e){return m({},e)}))},getNextMessagesSuccess:function(e){return n.setState((function(t){return m(m({},t),{hasMoreNext:30===e.length,allThreadMessages:E(E([],t.allThreadMessages,!0),e,!0)})}))},getNextMessagesFailure:function(){return n.setState((function(e){return m(m({},e),{hasMoreNext:!1})}))}},R=function(e){var t=e.isReactionEnabled,n=e.anchorMessage,r=e.parentMessage,a=e.logger,s=e.oldestMessageTimeStamp,o=e.latestMessageTimeStamp,l=e.threadListState,u=e.initializeThreadListStart,c=e.initializeThreadListSuccess,d=e.initializeThreadListFailure,h=e.getPrevMessagesStart,f=e.getPrevMessagesSuccess,p=e.getPrevMessagesFailure,m=e.getNextMessagesStart,g=e.getNextMessagesSuccess,E=e.getNextMessagesFailure,y=IC().state.stores,b=(null==n?void 0:n.createdAt)||0;return{initializeThreadFetcher:Object(i.useCallback)((function(e){return _(void 0,void 0,void 0,(function(){var i,s,o,l,h;return v(this,(function(f){switch(f.label){case 0:if(!y.sdkStore.initialized||!r)return[2];u(),f.label=1;case 1:return f.trys.push([1,3,,4]),i=mB({includeReactions:t}),a.info("Thread | useGetThreadList: Initialize thread list start.",{timestamp:b,params:i}),[4,r.getThreadedMessagesByTimestamp(b,i)];case 2:return s=f.sent(),o=s.threadedMessages,l=s.parentMessage,a.info("Thread | useGetThreadList: Initialize thread list succeeded.",{staleParentMessage:r,threadedMessages:o}),c(l,n,o),setTimeout((function(){return null==e?void 0:e(o)})),[3,4];case 3:return h=f.sent(),a.info("Thread | useGetThreadList: Initialize thread list failed.",h),d(),[3,4];case 4:return[2]}}))}))}),[y.sdkStore.initialized,r,n,t]),fetchPrevThreads:Object(i.useCallback)((function(e){return _(void 0,void 0,void 0,(function(){var n,i,o,u,c;return v(this,(function(d){switch(d.label){case 0:if(l!==aB.INITIALIZED||0===s||!r)return[2];h(),d.label=1;case 1:return d.trys.push([1,3,,4]),n=mB({nextResultSize:0,includeReactions:t}),[4,r.getThreadedMessagesByTimestamp(s,n)];case 2:return i=d.sent(),o=i.threadedMessages,u=i.parentMessage,a.info("Thread | useGetPrevThreadsCallback: Fetch prev threads succeeded.",{parentMessage:u,threadedMessages:o}),f(o),setTimeout((function(){return null==e?void 0:e(o)})),[3,4];case 3:return c=d.sent(),a.info("Thread | useGetPrevThreadsCallback: Fetch prev threads failed.",c),p(),[3,4];case 4:return[2]}}))}))}),[l,s,t,r]),fetchNextThreads:Object(i.useCallback)((function(e){return _(void 0,void 0,void 0,(function(){var n,i,s,u,c;return v(this,(function(d){switch(d.label){case 0:if(l!==aB.INITIALIZED||0===o||!r)return[2];m(),d.label=1;case 1:return d.trys.push([1,3,,4]),n=mB({prevResultSize:0,includeReactions:t}),[4,r.getThreadedMessagesByTimestamp(o,n)];case 2:return i=d.sent(),s=i.threadedMessages,u=i.parentMessage,a.info("Thread | useGetNextThreadsCallback: Fetch next threads succeeded.",{parentMessage:u,threadedMessages:s}),g(s),setTimeout((function(){return null==e?void 0:e(s)})),[3,4];case 3:return c=d.sent(),a.info("Thread | useGetNextThreadsCallback: Fetch next threads failed.",c),E(),[3,4];case 4:return[2]}}))}))}),[l,o,t,r])}}({parentMessage:f,anchorMessage:(null==h?void 0:h.messageId)!==(null==f?void 0:f.messageId)&&h||void 0,logger:o,isReactionEnabled:c,threadListState:g,oldestMessageTimeStamp:(null===(e=y[0])||void 0===e?void 0:e.createdAt)||0,latestMessageTimeStamp:(null===(t=y[y.length-1])||void 0===t?void 0:t.createdAt)||0,initializeThreadListStart:O.initializeThreadListStart,initializeThreadListSuccess:O.initializeThreadListSuccess,initializeThreadListFailure:O.initializeThreadListFailure,getPrevMessagesStart:O.getPrevMessagesStart,getPrevMessagesSuccess:O.getPrevMessagesSuccess,getPrevMessagesFailure:O.getPrevMessagesFailure,getNextMessagesStart:O.getNextMessagesStart,getNextMessagesSuccess:O.getNextMessagesSuccess,getNextMessagesFailure:O.getNextMessagesFailure}),k=R.initializeThreadFetcher,x=R.fetchPrevThreads,D=R.fetchNextThreads;return{state:d,actions:Object(i.useMemo)((function(){return m(m(m(m(m(m({setCurrentUserId:function(e){return n.setState((function(t){return m(m({},t),{currentUserId:e})}))},getChannelStart:function(){return n.setState((function(e){return m(m({},e),{channelState:tB.LOADING,currentChannel:null})}))},getChannelSuccess:function(e){return n.setState((function(t){var n,r;return m(m({},t),{channelState:tB.INITIALIZED,currentChannel:e,isMuted:(null===(r=null===(n=null==e?void 0:e.members)||void 0===n?void 0:n.find((function(e){return(null==e?void 0:e.userId)===t.currentUserId})))||void 0===r?void 0:r.isMuted)||!1,isChannelFrozen:(null==e?void 0:e.isFrozen)||!1})}))},getChannelFailure:function(){return n.setState((function(e){return m(m({},e),{channelState:tB.INVALID,currentChannel:null})}))},getParentMessageStart:function(){return n.setState((function(e){return m(m({},e),{parentMessageState:rB.LOADING,parentMessage:null})}))},getParentMessageSuccess:function(e){return n.setState((function(t){return m(m({},t),{parentMessageState:rB.INITIALIZED,parentMessage:e})}))},getParentMessageFailure:function(){return n.setState((function(e){return m(m({},e),{parentMessageState:rB.INVALID,parentMessage:null})}))},setEmojiContainer:function(e){return n.setState((function(t){return m(m({},t),{emojiContainer:e})}))},onMessageReceived:function(e,t){return n.setState((function(n){var r,i,a,s;if((null===(r=n.currentChannel)||void 0===r?void 0:r.url)!==(null==e?void 0:e.url)||n.hasMoreNext||(null===(i=null==t?void 0:t.parentMessage)||void 0===i?void 0:i.messageId)!==(null===(a=null==n?void 0:n.parentMessage)||void 0===a?void 0:a.messageId))return n;var o=n.allThreadMessages.findIndex((function(e){return e.messageId===t.messageId}))>-1;return m(m({},n),{parentMessage:(null===(s=n.parentMessage)||void 0===s?void 0:s.messageId)===(null==t?void 0:t.messageId)?t:n.parentMessage,allThreadMessages:o?n.allThreadMessages.map((function(e){return e.messageId===t.messageId?t:e})):E(E([],n.allThreadMessages.filter((function(e){return(null==e?void 0:e.reqId)!==(null==t?void 0:t.reqId)})),!0),[t],!1)})}))},onReactionUpdated:function(e){return n.setState((function(t){var n,r,i;return(null===(n=null==t?void 0:t.parentMessage)||void 0===n?void 0:n.messageId)===(null==e?void 0:e.messageId)&&(null===(i=null===(r=t.parentMessage)||void 0===r?void 0:r.applyReactionEvent)||void 0===i||i.call(r,e)),m(m({},t),{allThreadMessages:t.allThreadMessages.map((function(t){var n;return(null==e?void 0:e.messageId)===(null==t?void 0:t.messageId)?(null===(n=null==t?void 0:t.applyReactionEvent)||void 0===n||n.call(t,e),t):t}))})}))},onUserMuted:function(e,t){return n.setState((function(n){var r;return(null===(r=n.currentChannel)||void 0===r?void 0:r.url)!==(null==e?void 0:e.url)||n.currentUserId!==(null==t?void 0:t.userId)?n:m(m({},n),{isMuted:!0})}))},onUserUnmuted:function(e,t){return n.setState((function(n){var r;return(null===(r=n.currentChannel)||void 0===r?void 0:r.url)!==(null==e?void 0:e.url)||n.currentUserId!==(null==t?void 0:t.userId)?n:m(m({},n),{isMuted:!1})}))},onUserBanned:function(){return n.setState((function(e){return m(m({},e),{channelState:tB.NIL,threadListState:aB.NIL,parentMessageState:rB.NIL,currentChannel:null,parentMessage:null,allThreadMessages:[],hasMorePrev:!1,hasMoreNext:!1})}))},onUserUnbanned:function(){return n.setState((function(e){return m({},e)}))},onUserLeft:function(){return n.setState((function(e){return m(m({},e),{channelState:tB.NIL,threadListState:aB.NIL,parentMessageState:rB.NIL,currentChannel:null,parentMessage:null,allThreadMessages:[],hasMorePrev:!1,hasMoreNext:!1})}))},onChannelFrozen:function(){return n.setState((function(e){return m(m({},e),{isChannelFrozen:!0})}))},onChannelUnfrozen:function(){return n.setState((function(e){return m(m({},e),{isChannelFrozen:!1})}))},onOperatorUpdated:function(e){return n.setState((function(t){var n;return(null==e?void 0:e.url)===(null===(n=t.currentChannel)||void 0===n?void 0:n.url)?m(m({},t),{currentChannel:e}):t}))},onTypingStatusUpdated:function(e,t){return n.setState((function(n){var r;return XF(e.url,null===(r=n.currentChannel)||void 0===r?void 0:r.url)?m(m({},n),{typingMembers:t}):n}))},onFileInfoUpdated:function(e){var t=e.channelUrl,r=e.requestId,i=e.index,a=e.uploadableFileInfo,s=e.error;return n.setState((function(e){var n,o;if(!XF(t,null===(n=e.currentChannel)||void 0===n?void 0:n.url))return e;if(s)return e;var l=e.localThreadMessages,u=null===(o=l.find((function(e){return XF(function(e){return"reqId"in e}(e)&&e.reqId,r)})).messageParams)||void 0===o?void 0:o.fileInfoList;return Array.isArray(u)&&(u[i]=a),m(m({},e),{localThreadMessages:l})}))},toggleReaction:S},I),w),A),M),O),{initializeThreadFetcher:k,fetchPrevThreads:x,fetchNextThreads:D})}),[n,p,a.sdkStore.initialized,f])}};tB.NIL,rB.NIL,aB.NIL;var _B=a.a.createContext(null),vB=function(e){var t=gB().state.currentChannel;return a.a.createElement(VP,m({},e,{currentChannel:t}))},EB="operator";a.a.forwardRef((function(e,t){var n,r=e.className,s=e.renderFileUploadIcon,o=e.renderVoiceMessageIcon,l=e.renderSendMessageIcon,u=e.acceptableMimeTypes,c=IC().state.config,d=oN().isMobile,h=JC().stringSet,f=c.isOnline,p=c.userMention,m=c.logger,g=c.groupChannel,y=gB(),b=y.state,C=b.currentChannel,N=b.parentMessage,T=b.isMuted,I=b.isChannelFrozen,S=b.allThreadMessages,w=y.actions,A=w.sendMessage,M=w.sendFileMessage,O=w.sendVoiceMessage,R=w.sendMultipleFilesMessage,k=Object(i.useRef)(),x=g.enableMention,D=g.enableVoiceMessage,U=null!==(n=y.state.isMultipleFilesMessageEnabled)&&void 0!==n?n:c.isMultipleFilesMessageEnabled,L=e.disabled||!f||T||!((null==C?void 0:C.myRole)===EB)&&I||null===N,P=function(e,t){var n=e.sendFileMessage,r=e.sendMultipleFilesMessage,s=e.quoteMessage,o=t.logger,l=JC().stringSet,u=IC().state.config,c=u.imageCompression,d=null==u?void 0:u.uikitUploadSizeLimit,h=null==u?void 0:u.uikitMultipleFilesMessageLimit,f=_w().openModal;return Object(i.useCallback)((function(e){return _(void 0,void 0,void 0,(function(){var t,i,u,p,m;return v(this,(function(g){switch(g.label){case 0:return n&&r?0===e.length?(o.warning("Channel|useHandleUploadFiles: given file list is empty.",{files:e}),[2]):e.length>h?(o.info("Channel|useHandleUploadFiles: Cannot upload files more than ".concat(h)),f({modalProps:{titleText:l.FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT.replace("%d","".concat(h)),hideFooter:!0},childElement:function(e){var t=e.closeModal;return a.a.createElement(nw,{type:fN.PRIMARY,submitText:l.BUTTON__OK,hideCancelButton:!0,onCancel:t,onSubmit:t})}}),[2]):e.some((function(e){return e.size>d}))?(o.info("Channel|useHandleUploadFiles: Cannot upload file size exceeding ".concat(d)),f({modalProps:{titleText:l.FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT.replace("%d","".concat(Math.floor(d/1048576))),hideFooter:!0},childElement:function(e){var t=e.closeModal;return a.a.createElement(nw,{type:fN.PRIMARY,submitText:l.BUTTON__OK,hideCancelButton:!0,onCancel:t,onSubmit:t})}}),[2]):[4,OF({files:e,imageCompression:c,logger:o})]:(o.warning("Channel|useHandleUploadFiles: required functions are undefined",{sendFileMessage:n,sendMultipleFilesMessage:r}),[2]);case 1:if(t=g.sent().compressedFiles,1===(i=t).length)o.info("Channel|useHandleUploadFiles: sending one file."),u=i[0],n(u,s);else if(i.length>1)return o.info("Channel|useHandleUploadFiles: sending multiple files."),p=[],m=[],i.forEach((function(e){bA(e.type)?p.push(e):m.push(e)})),[2,m.reduce((function(e,t){return e.then((function(){return n(t,s)}))}),0===p.length?Promise.resolve():1===p.length?n(p[0],s):r(p,s))];return[2]}}))}))}),[n,r,s])}({sendFileMessage:M,sendMultipleFilesMessage:R,quoteMessage:N},{logger:m}),F=Object(i.useState)(""),B=F[0],j=F[1],H=Object(i.useState)([]),G=H[0],z=H[1],V=Object(i.useState)([]),q=V[0],K=V[1],W=Object(i.useState)(null),Y=W[0],Q=W[1],X=Object(i.useState)([]),Z=X[0],J=X[1],$=Object(i.useState)(null),ee=$[0],te=$[1],ne=Object(i.useState)(!1),re=ne[0],ie=ne[1],ae=f&&x&&B.length>0&&!function(e){return(null==e?void 0:e.isFrozen)&&!function(e){return"operator"===(null==e?void 0:e.myRole)}(e)}(C)&&!function(e){return"muted"===(null==e?void 0:e.myMutedState)}(C)&&!(null==C?void 0:C.isBroadcast);Object(i.useEffect)((function(){ie(!1)}),[null==C?void 0:C.url]);var se=ck({ref:t||k},{logger:m}),oe=(null==se?void 0:se.length)<(null==p?void 0:p.maxMentionCount);return Object(i.useEffect)((function(){z(G.filter((function(e){var t=e.userId,n=q.indexOf(t);return!(n<0)&&(q.splice(n,1),!0)})))}),[q]),(null==C?void 0:C.isBroadcast)&&(null==C?void 0:C.myRole)!==EB?a.a.createElement(a.a.Fragment,null):a.a.createElement("div",{className:nN(re?"sendbird-thread-message-input--voice-message":"sendbird-thread-message-input",r)},ae&&a.a.createElement(vB,{targetNickname:B,inputEvent:null!=ee?ee:void 0,onUserItemClick:function(e){e&&z(E(E([],G,!0),[e],!1)),j(""),Q(e),te(null)},onFocusItemChange:function(){te(null)},onFetchUsers:function(e){J(e)},ableAddMention:oe,maxMentionCount:null==p?void 0:p.maxMentionCount,maxSuggestionCount:null==p?void 0:p.maxSuggestionCount}),re?a.a.createElement(RF,{channel:C,onSubmitClick:function(e,t){O(e,t,N),ie(!1)},onCancelClick:function(){ie(!1)}}):a.a.createElement(eD,{className:"sendbird-thread-message-input__message-input",messageFieldId:"sendbird-message-input-text-field--thread",channel:C,channelUrl:null==C?void 0:C.url,isMobile:d,disabled:L,acceptableMimeTypes:u,setMentionedUsers:z,mentionSelectedUser:Y,isMentionEnabled:x,isVoiceMessageEnabled:D,isSelectingMultipleFilesEnabled:U,onVoiceMessageIconClick:function(){ie(!0)},renderFileUploadIcon:s,renderVoiceMessageIcon:o,renderSendMessageIcon:l,ref:t||k,placeholder:(null==C?void 0:C.isFrozen)&&!((null==C?void 0:C.myRole)===EB)&&h.MESSAGE_INPUT__PLACE_HOLDER__DISABLED||(null==C?void 0:C.myMutedState)===ce.MUTED&&h.MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT||(S.length>0?h.THREAD__INPUT__REPLY_TO_THREAD:h.THREAD__INPUT__REPLY_IN_THREAD),onStartTyping:function(){var e;null===(e=null==C?void 0:C.startTyping)||void 0===e||e.call(C)},onSendMessage:function(e){var t,n=e.message,r=e.mentionTemplate;A({message:n,mentionedUsers:G,mentionTemplate:r,quoteMessage:N}),j(""),z([]),null===(t=null==C?void 0:C.endTyping)||void 0===t||t.call(C)},onFileUpload:P,onUserMentioned:function(e){(null==Y?void 0:Y.userId)===(null==e?void 0:e.userId)&&(Q(null),j(""))},onMentionStringChange:function(e){j(e)},onMentionedUserIdsUpdated:function(e){K(e)},onKeyDown:function(e){return!!(ae&&(null==Z?void 0:Z.length)>0&&(e.key===hk&&oe||e.key===fk||e.key===pk))&&(te(e),!0)}}))}));var yB=a.a.createContext(null),bB=function(){var e=a.a.useContext(yB);if(!e)throw new Error("OpenChannelContext not found. Use within the OpenChannel module");return e};a.a.forwardRef((function(e,t){var n=bB(),r=n.currentOpenChannel,s=n.disabled,o=n.handleSendMessage,l=n.handleFileUpload,u=n.amIMuted,c=r,d=Object(i.useContext)(XC).stringSet,h=e.value;return c?a.a.createElement("div",{className:"sendbird-openchannel-footer"},a.a.createElement(eD,{channel:r,ref:t,value:h,disabled:s,isVoiceMessageEnabled:!1,onSendMessage:o,onFileUpload:l,placeholder:u?d.MESSAGE_INPUT__PLACE_HOLDER__MUTED:s?d.MESSAGE_INPUT__PLACE_HOLDER__DISABLED:""})):null}));var CB=function(e){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return!1}finally{document.body.removeChild(t)}}return!1},NB="pending",TB="failed",IB="succeeded",SB=function(e){return e.sender||e._sender},wB=function(e){return e===IB},AB=function(e){return e===NB},MB=function(e){return e===TB},OB=function(e,t){return SB(e).userId===t},RB=function(e){var t,n=e.message;return"user"===(null==n?void 0:n.messageType)&&(null===(t=null==n?void 0:n.message)||void 0===t?void 0:t.length)>0},kB=function(e){var t=e.message,n=e.status,r=e.userId;return OB(t,r)&&MB(n)&&(null==t?void 0:t.isResendable)},xB=function(e){var t,n=e.message,r=e.status,i=e.userId;return OB(n,i)&&wB(r)&&(null===(t=null==n?void 0:n.isUserMessage)||void 0===t?void 0:t.call(n))},DB=function(e){var t=e.message,n=e.userId;return OB(t,n)},UB=function(e){var t=e.message,n=e.status,r=e.userId;return"user"===t.messageType?DB({message:t,userId:r})||xB({message:t,status:n,userId:r})||RB({message:t})||kB({message:t,status:n,userId:r}):DB({message:t,userId:r})||kB({message:t,status:n,userId:r})},LB=function(e){var t=e.message,n=e.parentRef,r=e.resendMessage,i=e.showEdit,s=e.showRemove,o=e.copyToClipboard,l=e.hideMenu,u=e.isEphemeral,c=void 0!==u&&u,d=t,h=null==t?void 0:t.sendingStatus,f=JC().stringSet,p=IC().state.config.userId,m=t;return a.a.createElement(SM,{isOpen:!0,menuItems:function(){return a.a.createElement(EM,{className:"sendbird-openchannel__mobile-menu",parentRef:n,parentContainRef:n,closeDropdown:l},RB({message:d})&&a.a.createElement(bM,{className:"sendbird-openchannel-og-message__top__context-menu__copy",onClick:function(){null==o||o()},testID:"open_channel_mobile_context_menu_copy"},a.a.createElement(a.a.Fragment,null,f.CONTEXT_MENU_DROPDOWN__COPY)),!c&&xB({message:t,userId:p,status:h})&&a.a.createElement(bM,{className:"sendbird-openchannel-og-message__top__context-menu__edit",onClick:function(){null==i||i()},testID:"open_channel_mobile_context_menu_edit"},a.a.createElement(a.a.Fragment,null,f.CONTEXT_MENU_DROPDOWN__EDIT)),kB({message:t,userId:p,status:h})&&a.a.createElement(bM,{onClick:function(){null==r||r()},testID:"open_channel_mobile_context_menu_resend"},a.a.createElement(a.a.Fragment,null,f.CONTEXT_MENU_DROPDOWN__RESEND)),!c&&DB({message:t,userId:p})&&a.a.createElement(bM,{onClick:function(){null==s||s()},testID:"open_channel_mobile_context_menu_delete"},a.a.createElement(a.a.Fragment,null,f.CONTEXT_MENU_DROPDOWN__DELETE)),function(e){var t,n=e.message,r=e.status;return!(!(null===(t=null==n?void 0:n.isFileMessage)||void 0===t?void 0:t.call(n))||!wB(r))}({message:t,status:h})&&a.a.createElement(bM,{onClick:function(){l()},testID:"open_channel_mobile_context_menu_download_file"},a.a.createElement("a",{className:"sendbird-openchannel__mobile-menu-hyperlink",rel:"noopener noreferrer",href:null==m?void 0:m.url,target:"_blank"},f.CONTEXT_MENU_DROPDOWN__SAVE)))}})};function PB(e){var t=e.className,n=e.message,r=e.isOperator,s=e.isEphemeral,o=void 0!==s&&s,l=e.userId,u=e.resendMessage,c=e.disabled,d=e.showEdit,h=e.showRemove,f=e.chainTop,p=JC(),g=p.stringSet,_=p.dateLocale,v=QM(),y=v.disableUserProfile,b=v.renderUserProfile,C=Object(i.useRef)(),N=Object(i.useRef)(),T=Object(i.useRef)(),I=Object(i.useRef)(),S=Object(i.useState)({}),w=S[0],A=S[1],M=Object(i.useState)(!1),O=M[0],R=M[1],k=null==n?void 0:n.sendingStatus,x=AB(k),D=MB(k),U=SB(n);Object(i.useEffect)((function(){var e;(null===(e=null==C?void 0:C.current)||void 0===e?void 0:e.clientHeight)&&C.current.clientHeight>36?A({top:"8px "}):A({top:"2px"})}),[window.innerWidth]);var L=wD({onLongPress:function(){R(!0)}}),P=oN().isMobile;return n&&"user"===n.messageType?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:E(E([],Array.isArray(t)?t:[t],!0),["sendbird-openchannel-user-message"],!1).join(" "),ref:C},a.a.createElement("div",{className:"sendbird-openchannel-user-message__left"},!f&&a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(iR,{className:"sendbird-openchannel-user-message__left__avatar",src:U.profileUrl||"",ref:N,width:"28px",height:"28px",onClick:function(){y||e()}})},menuItems:function(e){return b?b({user:U,close:e,currentUserId:l,avatarRef:N}):a.a.createElement(EM,{parentRef:N,parentContainRef:N,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{user:U,onSuccess:e,disableMessaging:!0}))}})),a.a.createElement("div",{className:"sendbird-openchannel-user-message__right"},!f&&a.a.createElement("div",{className:"sendbird-openchannel-user-message__right__top"},a.a.createElement(_N,{className:"sendbird-openchannel-user-message__right__top__sender-name",type:vN.CAPTION_2,color:r?EN.SECONDARY_3:EN.ONBACKGROUND_2},U&&(U.friendName||U.nickname||U.userId)),a.a.createElement(_N,{className:"sendbird-openchannel-user-message__right__top__sent-at",type:vN.CAPTION_3,color:EN.ONBACKGROUND_3},(null==n?void 0:n.createdAt)&&ok(null==n?void 0:n.createdAt,g.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:_}))),a.a.createElement("div",m({},P?m({},L):{},{className:"sendbird-openchannel-user-message__right__bottom",ref:I}),a.a.createElement(_N,{className:"sendbird-openchannel-user-message__right__bottom__message",type:vN.BODY_1,color:EN.ONBACKGROUND_1},null==n?void 0:n.message,QA(n)&&a.a.createElement(_N,{key:ZS(),type:vN.BODY_1,color:EN.ONBACKGROUND_2,className:"sendbird-openchannel-user-message-word"}," ".concat(g.MESSAGE_EDITED," ")))),(x||D)&&a.a.createElement("div",{className:"sendbird-openchannel-user-message__right__tail"},x&&a.a.createElement(FO,{width:"16px",height:"16px"},a.a.createElement(YS,{className:"sendbird-openchannel-user-message__right__tail__pending",type:QS.SPINNER,fillColor:XS.PRIMARY,width:"16px",height:"16px"})),D&&a.a.createElement(YS,{className:"sendbird-openchannel-user-message__right__tail__failed",type:QS.ERROR,fillColor:XS.ERROR,width:"16px",height:"16px"}))),!P&&a.a.createElement("div",{className:"sendbird-openchannel-user-message__context-menu",ref:T,style:w},a.a.createElement(SM,{menuTrigger:function(e){return UB({message:n,userId:l,status:k})&&a.a.createElement(lN,{className:"sendbird-openchannel-user-message__context-menu--icon",width:"32px",height:"32px",onClick:function(){e()}},a.a.createElement(YS,{type:QS.MORE,fillColor:XS.CONTENT_INVERSE,width:"24px",height:"24px"}))},menuItems:function(e){return a.a.createElement(EM,{parentRef:T,parentContainRef:T,closeDropdown:e,openLeft:!0},RB({message:n})&&a.a.createElement(bM,{className:"sendbird-openchannel-user-message__context-menu__copy",onClick:function(){CB(n.message),e()},testID:"open_channel_user_message_menu_copy"},g.CONTEXT_MENU_DROPDOWN__COPY),!o&&xB({message:n,userId:l,status:k})&&a.a.createElement(bM,{className:"sendbird-openchannel-user-message__context-menu__edit",onClick:function(){c||(d(!0),e())},testID:"open_channel_user_message_menu_edit"},g.CONTEXT_MENU_DROPDOWN__EDIT),kB({message:n,userId:l,status:k})&&a.a.createElement(bM,{className:"sendbird-openchannel-user-message__context-menu__resend",onClick:function(){u(n),e()},testID:"open_channel_user_message_menu_resend"},g.CONTEXT_MENU_DROPDOWN__RESEND),!o&&DB({message:n,userId:l})&&a.a.createElement(bM,{className:"sendbird-openchannel-user-message__context-menu__delete",onClick:function(){c||(h(!0),e())},testID:"open_channel_user_message_menu_delete"},g.CONTEXT_MENU_DROPDOWN__DELETE))}}))),O&&a.a.createElement(LB,{message:n,parentRef:I,hideMenu:function(){R(!1)},showRemove:function(){R(!1),h(!0)},showEdit:function(){R(!1),d(!0)},copyToClipboard:function(){R(!1),CB(null==n?void 0:n.message)},resendMessage:function(){R(!1),u(n)}})):a.a.createElement(a.a.Fragment,null)}function FB(e){var t=e.className,n=e.message;return a.a.createElement("div",{className:E(E([],Array.isArray(t)?t:[t],!0),["sendbird-openchannel-admin-message"],!1).join(" ")},a.a.createElement(_N,{className:"sendbird-openchannel-admin-message__text",type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},n.message||""))}function BB(e){var t,n,r,s=e.message,o=e.isOperator,l=e.isEphemeral,u=void 0!==l&&l,c=e.className,d=e.disabled,h=e.showEdit,f=e.showRemove,p=e.resendMessage,g=e.chainTop,_=e.userId,v=null==s?void 0:s.sendingStatus,y=null!==(t=s.ogMetaData)&&void 0!==t?t:null,b=null==y?void 0:y.defaultImage,C=JC(),N=C.stringSet,T=C.dateLocale,I=oN().isMobile,S=QM(),w=S.disableUserProfile,A=S.renderUserProfile,M=Object(i.useState)({}),O=M[0],R=M[1],k=Object(i.useState)(!1),x=k[0],D=k[1],U=function(){return tN(null==y?void 0:y.url)},L=wD({onLongPress:function(){return D(!0)},onClick:U},{delay:300}),P=Object(i.useRef)(),F=Object(i.useRef)(),B=Object(i.useRef)(),j=Object(i.useRef)(),H=AB(v),G=MB(v),z=SB(s),V=Object(i.useMemo)((function(){return Yx({messageText:s.message})}),[null==s?void 0:s.updatedAt,null==s?void 0:s.message]);return Object(i.useEffect)((function(){var e,t;(null===(e=null==P?void 0:P.current)||void 0===e?void 0:e.clientHeight)&&(null===(t=null==P?void 0:P.current)||void 0===t?void 0:t.clientHeight)>36?R({top:"8px "}):R({top:"2px"})}),[window.innerWidth]),s&&"user"===s.messageType?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",m({className:E(E([],Array.isArray(c)?c:[c],!0),["sendbird-openchannel-og-message"],!1).join(" "),ref:P},I?m({},L):{}),a.a.createElement("div",{className:"sendbird-openchannel-og-message__top"},a.a.createElement("div",{className:"sendbird-openchannel-og-message__top__left"},!g&&a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(iR,{className:"sendbird-openchannel-og-message__top__left__avatar",src:z.profileUrl||"",ref:j,width:"28px",height:"28px",onClick:function(){w||e()}})},menuItems:function(e){return A?A({user:z,close:e,currentUserId:_,avatarRef:j}):a.a.createElement(EM,{parentRef:j,parentContainRef:j,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{user:z,onSuccess:e,disableMessaging:!0}))}})),a.a.createElement("div",{className:"sendbird-openchannel-og-message__top__right"},!g&&a.a.createElement("div",{className:"sendbird-openchannel-og-message__top__right__title"},a.a.createElement(_N,{className:"sendbird-openchannel-og-message__top__right__title__sender-name",type:vN.CAPTION_2,color:o?EN.SECONDARY_3:EN.ONBACKGROUND_2},z&&(z.friendName||z.nickname||z.userId)),a.a.createElement(_N,{className:"sendbird-openchannel-og-message__top__right__title__sent-at",type:vN.CAPTION_3,color:EN.ONBACKGROUND_3},(null==s?void 0:s.createdAt)&&ok(null==s?void 0:s.createdAt,N.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:T}))),a.a.createElement("div",{className:"sendbird-openchannel-og-message__top__right__description"},a.a.createElement(_N,{className:"sendbird-openchannel-og-message__top__right__description__message",type:vN.BODY_1,color:EN.ONBACKGROUND_1},a.a.createElement(TU,{tokens:V}),(null!==(n=null==s?void 0:s.updatedAt)&&void 0!==n?n:0)>0&&a.a.createElement(_N,{key:ZS(),className:"sendbird-openchannel-og-message--word",type:vN.BODY_1,color:EN.ONBACKGROUND_2},N.MESSAGE_EDITED)))),!I&&a.a.createElement("div",{className:"sendbird-openchannel-og-message__top__context-menu",ref:F,style:O},a.a.createElement(SM,{menuTrigger:function(e){return UB({message:s,userId:_,status:v})&&a.a.createElement(lN,{className:"sendbird-openchannel-og-message__top__context-menu--icon",width:"32px",height:"32px",onClick:function(){e()}},a.a.createElement(YS,{type:QS.MORE,fillColor:XS.CONTENT_INVERSE,width:"24px",height:"24px"}))},menuItems:function(e){return a.a.createElement(EM,{parentRef:F,parentContainRef:F,closeDropdown:e,openLeft:!0},RB({message:s})&&a.a.createElement(bM,{className:"sendbird-openchannel-og-message__top__context-menu__copy",onClick:function(){CB(s.message),e()},testID:"open_channel_og_message_menu_copy"},N.CONTEXT_MENU_DROPDOWN__COPY),!u&&xB({message:s,userId:_,status:v})&&a.a.createElement(bM,{className:"sendbird-openchannel-og-message__top__context-menu__edit",onClick:function(){d||(h(!0),e())},testID:"open_channel_og_message_menu_edit"},N.CONTEXT_MENU_DROPDOWN__EDIT),kB({message:s,userId:_,status:v})&&a.a.createElement(bM,{className:"sendbird-openchannel-og-message__top__context-menu__resend",onClick:function(){p(s),e()},testID:"open_channel_og_message_menu_resend"},N.CONTEXT_MENU_DROPDOWN__RESEND),!u&&DB({message:s,userId:_})&&a.a.createElement(bM,{className:"sendbird-openchannel-og-message__top__context-menu__delete",onClick:function(){d||(f(!0),e())},testID:"open_channel_og_message_menu_delete"},N.CONTEXT_MENU_DROPDOWN__DELETE))}}))),a.a.createElement("div",{className:"sendbird-openchannel-og-message__bottom"},a.a.createElement("div",{className:"sendbird-openchannel-og-message__bottom__og-tag",ref:B},(null==y?void 0:y.url)&&a.a.createElement(_N,{className:"sendbird-openchannel-og-message__bottom__og-tag__url",type:vN.CAPTION_3,color:EN.ONBACKGROUND_2},y.url),(null==y?void 0:y.title)&&a.a.createElement(bU,{className:"sendbird-openchannel-og-message__bottom__og-tag__title",src:null!==(r=y.url)&&void 0!==r?r:"",type:vN.SUBTITLE_2,color:EN.PRIMARY},y.title),(null==y?void 0:y.description)&&a.a.createElement(_N,{className:"sendbird-openchannel-og-message__bottom__og-tag__description",type:vN.BODY_2,color:EN.ONBACKGROUND_1},y.description),(null==y?void 0:y.url)&&a.a.createElement("div",{className:"sendbird-openchannel-og-message__bottom__og-tag__thumbnail",role:"button",onClick:U,onKeyDown:U,tabIndex:0},b&&a.a.createElement($O,{className:"sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image",url:b.url||"",alt:b.alt||"",width:"334px",height:"189px",defaultComponent:a.a.createElement("div",{className:"sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image--placeholder"},a.a.createElement(YS,{type:QS.THUMBNAIL_NONE,width:"56px",height:"56px"}))}))),(H||G)&&a.a.createElement("div",{className:"sendbird-openchannel-og-message__top__right__tail"},H&&a.a.createElement(FO,{width:"16px",height:"16px"},a.a.createElement(YS,{className:"sendbird-openchannel-og-message__top__right__tail__pending",type:QS.SPINNER,fillColor:XS.PRIMARY,width:"16px",height:"16px"})),G&&a.a.createElement(YS,{className:"sendbird-openchannel-og-message__top__right__tail__failed",type:QS.ERROR,fillColor:XS.ERROR,width:"16px",height:"16px"})))),x&&a.a.createElement(LB,{message:s,parentRef:B,hideMenu:function(){D(!1)},showRemove:function(){D(!1),f(!0)},showEdit:function(){D(!1),h(!0)},copyToClipboard:function(){D(!1),CB(null==s?void 0:s.message)},resendMessage:function(){D(!1),p(s)}})):a.a.createElement(a.a.Fragment,null)}var jB="IMAGE",HB="VIDEO",GB="UNSUPPORTED",zB={IMAGE:["image/jpeg","image/jpg","image/png","image/gif","image/webp"],VIDEO:["video/mpeg","video/ogg","video/webm","video/mp4"]};function VB(e){var t,n=e.className,r=e.message,s=e.isOperator,o=e.isEphemeral,l=void 0!==o&&o,u=e.disabled,c=e.userId,d=e.chainTop,h=e.onClick,f=e.showRemove,p=e.resendMessage,g=r.type,_=r.url,v=r.thumbnails,y=r.localUrl,b=null==r?void 0:r.sendingStatus,C=v&&v.length>0&&v[0].url||null,N=JC(),T=N.stringSet,I=N.dateLocale,S=QM(),w=S.disableUserProfile,A=S.renderUserProfile,M=Object(i.useState)(360),O=M[0],R=M[1],k=Object(i.useState)(!1),x=k[0],D=k[1],U=Object(i.useRef)(null),L=Object(i.useRef)(null),P=Object(i.useRef)(null),F=Object(i.useRef)(null),B=wD({onLongPress:function(){D(!0)},onClick:function(){h(!0)}}),j=oN().isMobile,H=Object(i.useMemo)((function(){return function(e){return function(t){var n=t.style;return a.a.createElement("div",{style:n},a.a.createElement(YS,{type:e,fillColor:XS.ON_BACKGROUND_2,width:"56px",height:"56px"}))}}}),[]),G=wB(b),z=AB(b),V=MB(b),q=SB(r);return Object(i.useEffect)((function(){var e,t,n=(null!==(t=null===(e=null==U?void 0:U.current)||void 0===e?void 0:e.clientWidth)&&void 0!==t?t:0)-80;R(n>360?360:n)}),[]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:E(E([],Array.isArray(n)?n:[n],!0),["sendbird-openchannel-thumbnail-message"],!1).join(" "),ref:U},a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__left"},!d&&a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(iR,{className:"sendbird-openchannel-thumbnail-message__left__avatar",src:q.profileUrl||"",ref:F,width:"28px",height:"28px",onClick:function(){w||e()}})},menuItems:function(e){return A?A({user:q,close:e,currentUserId:c,avatarRef:F}):a.a.createElement(EM,{parentRef:F,parentContainRef:F,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{user:q,onSuccess:e,disableMessaging:!0}))}})),a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__right"},!d&&a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__right__title"},a.a.createElement(_N,{className:"sendbird-openchannel-thumbnail-message__right__title__sender-name",type:vN.CAPTION_2,color:s?EN.SECONDARY_3:EN.ONBACKGROUND_2},q&&(q.friendName||q.nickname||q.userId)),a.a.createElement(_N,{className:"sendbird-openchannel-thumbnail-message__right__title__sent-at",type:vN.CAPTION_3,color:EN.ONBACKGROUND_3},(null==r?void 0:r.createdAt)&&ok(r.createdAt,T.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:I}))),a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__right__body",ref:L},a.a.createElement("div",m({className:"sendbird-openchannel-thumbnail-message__right__body__wrap",role:"button",onClick:function(){G&&h(!0)},onKeyDown:function(){G&&h(!0)},tabIndex:0},j?m({},B):{}),a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__overlay"}),(t={},t[HB]=_||y?a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__video"},C?a.a.createElement($O,{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__video",url:C,width:O,height:"270px",alt:"image",placeHolder:H(QS.PLAY)}):a.a.createElement("video",{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__video__video"},a.a.createElement("source",{src:_||y,type:g})),a.a.createElement(YS,{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__video__icon",type:QS.PLAY,fillColor:XS.ON_BACKGROUND_2,width:"56px",height:"56px"})):a.a.createElement(YS,{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__video--icon",type:QS.PHOTO,fillColor:XS.ON_BACKGROUND_2,width:"56px",height:"56px"}),t[jB]=_||y?a.a.createElement($O,{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__image",url:C||_||y||"",alt:"image",width:O,height:"270px",placeHolder:H(QS.PHOTO)}):a.a.createElement(YS,{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__image--icon",type:QS.PHOTO,fillColor:XS.ON_BACKGROUND_2,width:"56px",height:"56px"}),t[GB]=a.a.createElement(YS,{className:"sendbird-openchannel-thumbnail-message__right__body__wrap__unknown",type:QS.PHOTO,fillColor:XS.ON_BACKGROUND_2,width:"56px",height:"56px"}),t)[function(e){return zB.IMAGE.indexOf(e)>=0?jB:zB.VIDEO.indexOf(e)>=0?HB:GB}(g)])),(z||V)&&a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__right__tail"},z&&a.a.createElement(FO,{width:"16px",height:"16px"},a.a.createElement(YS,{className:"sendbird-openchannel-thumbnail-message__right__tail__pending",type:QS.SPINNER,fillColor:XS.PRIMARY,width:"16px",height:"16px"})),V&&a.a.createElement(YS,{className:"sendbird-openchannel-thumbnail-message__right__tail__failed",type:QS.ERROR,fillColor:XS.ERROR,width:"16px",height:"16px"}))),!j&&a.a.createElement("div",{className:"sendbird-openchannel-thumbnail-message__context-menu",ref:P},(kB({message:r,userId:c,status:b})||!l)&&a.a.createElement(SM,{menuTrigger:function(e){return UB({message:r,userId:c,status:b})&&a.a.createElement(lN,{className:"sendbird-openchannel-thumbnail-message__context-menu--icon",width:"32px",height:"32px",onClick:e},a.a.createElement(YS,{type:QS.MORE,fillColor:XS.CONTENT_INVERSE,width:"24px",height:"24px"}))},menuItems:function(e){return a.a.createElement(EM,{parentRef:P,parentContainRef:P,closeDropdown:e,openLeft:!0},kB({message:r,userId:c,status:b})&&a.a.createElement(bM,{onClick:function(){p(r),e()},testID:"open_channel_thumbnail_message_menu_resend"},T.CONTEXT_MENU_DROPDOWN__RESEND),!l&&DB({message:r,userId:c})&&a.a.createElement(bM,{onClick:function(){u||(f(!0),e())},testID:"open_channel_thumbnail_message_menu_delete"},T.CONTEXT_MENU_DROPDOWN__DELETE))}}))),x&&a.a.createElement(LB,{message:r,parentRef:L,hideMenu:function(){D(!1)},showRemove:function(){D(!1),f(!0)},resendMessage:function(){D(!1),p(r)}}))}var qB=function(e){return/(\.mp3)$/i.test(e)?QS.FILE_AUDIO:/(\.gif)$/i.test(e)?QS.GIF:QS.FILE_DOCUMENT};function KB(e){var t=e.className,n=e.message,r=e.isOperator,s=e.isEphemeral,o=void 0!==s&&s,l=e.userId,u=e.disabled,c=e.chainTop,d=e.showRemove,h=e.resendMessage,f=null==n?void 0:n.sendingStatus,p=JC(),g=p.dateLocale,_=p.stringSet,v=Object(i.useRef)(null),y=Object(i.useRef)(null),b=Object(i.useRef)(null),C=QM(),N=C.disableUserProfile,T=C.renderUserProfile,I=oN().isMobile,S=function(){return tN(n.url)},w=AB(f),A=MB(f),M=SB(n),O=Object(i.useState)(!1),R=O[0],k=O[1],x=wD({onLongPress:function(){I&&k(!0)},onClick:S},{delay:300});return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:E(E([],Array.isArray(t)?t:[t],!0),["sendbird-openchannel-file-message"],!1).join(" "),ref:y},a.a.createElement("div",{className:"sendbird-openchannel-file-message__left"},!c&&a.a.createElement(SM,{menuTrigger:function(e){return a.a.createElement(iR,{className:"sendbird-openchannel-file-message__left__avatar",src:M.profileUrl||"",ref:b,width:"28px",height:"28px",onClick:function(){N||e()}})},menuItems:function(e){return T?T({user:M,close:e,currentUserId:l,avatarRef:b}):a.a.createElement(EM,{parentRef:b,parentContainRef:b,closeDropdown:e,style:{paddingTop:"0px",paddingBottom:"0px"}},a.a.createElement(LD,{user:M,onSuccess:e,disableMessaging:!0}))}})),a.a.createElement("div",{className:"sendbird-openchannel-file-message__right"},!c&&a.a.createElement("div",{className:"sendbird-openchannel-file-message__right__title"},a.a.createElement(_N,{className:"sendbird-openchannel-file-message__right__title__sender-name",type:vN.CAPTION_2,color:r?EN.SECONDARY_3:EN.ONBACKGROUND_2},M&&(M.friendName||M.nickname||M.userId)),a.a.createElement(_N,{className:"sendbird-openchannel-file-message__right__title__sent-at",type:vN.CAPTION_3,color:EN.ONBACKGROUND_3},(null==n?void 0:n.createdAt)&&ok(n.createdAt,_.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:g}))),a.a.createElement("div",m({className:"sendbird-openchannel-file-message__right__body"},I?m({},x):{}),qB(n.url)&&a.a.createElement(YS,{className:"sendbird-openchannel-file-message__right__body__icon",type:qB(n.url),fillColor:XS.PRIMARY,width:"48px",height:"48px"}),a.a.createElement(cR,{className:"sendbird-openchannel-file-message__right__body__file-name",onClick:S},a.a.createElement(_N,{className:"sendbird-openchannel-file-message__right__body__file-name__label",type:vN.BODY_1,color:EN.ONBACKGROUND_1},function(e,t){if(null==e)return"";if(e.length<=t)return e;var n=t-"...".length,r=Math.ceil(n/2),i=Math.floor(n/2);return e.substr(0,r)+"..."+e.substr(e.length-i)}(n.name||n.url,40)))),(w||A)&&a.a.createElement("div",{className:"sendbird-openchannel-file-message__right__tail"},w&&a.a.createElement(FO,{width:"16px",height:"16px"},a.a.createElement(YS,{className:"sendbird-openchannel-file-message__right__tail__pending",type:QS.SPINNER,fillColor:XS.PRIMARY,width:"16px",height:"16px"})),A&&a.a.createElement(YS,{className:"sendbird-openchannel-file-message__right__tail__failed",type:QS.ERROR,fillColor:XS.ERROR,width:"16px",height:"16px"}))),!I&&a.a.createElement("div",{className:"sendbird-openchannel-file-message__context-menu",ref:v},(kB({message:n,userId:l,status:f})||!o)&&a.a.createElement(SM,{menuTrigger:function(e){return UB({message:n,userId:l,status:f})&&a.a.createElement(lN,{className:"sendbird-openchannel-file-message__context-menu__icon",width:"32px",height:"32px",onClick:e},a.a.createElement(YS,{type:QS.MORE,width:"24px",height:"24px"}))},menuItems:function(e){return a.a.createElement(EM,{parentRef:v,parentContainRef:v,closeDropdown:e,openLeft:!0},kB({message:n,userId:l,status:f})&&a.a.createElement(bM,{onClick:function(){u||(h(n),e())},testID:"open_channel_file_message_context_menu_resend"},_.CONTEXT_MENU_DROPDOWN__RESEND),!o&&DB({message:n,userId:l})&&a.a.createElement(bM,{onClick:function(){u||(d(!0),e())},testID:"open_channel_file_message_context_menu_delete"},_.CONTEXT_MENU_DROPDOWN__DELETE))}}))),R&&a.a.createElement(LB,{message:n,hideMenu:function(){k(!1)},parentRef:y,showRemove:function(){k(!1),d(!0)}}))}function WB(e){var t=e.message,n=e.onCloseModal,r=e.onDeleteMessage,s=Object(i.useContext)(XC).stringSet;return a.a.createElement(rw,{onCancel:n,onSubmit:r,submitText:s.MESSAGE_MENU__DELETE,titleText:XP(s,t)})}var YB="ADMIN",QB="USER",XB="FILE",ZB="THUMBNAIL",JB="OG",$B="UNKNOWN",ej="failed",tj="pending";function nj(e){var t,n,r,s=e.message,o=e.chainTop,l=e.chainBottom,u=e.hasSeparator,c=e.renderMessage,d=bB(),h=d.currentOpenChannel,f=d.deleteMessage,p=d.updateMessage,m=d.resendMessage,g=JC(),_=g.dateLocale,v=g.stringSet,E=null==h?void 0:h.isFrozen,y=IC().state,b=null===(n=null==y?void 0:y.config)||void 0===n?void 0:n.userId,C=y.config.openChannel.enableOgtag;"admin"!==(null==s?void 0:s.messageType)&&(r=null==s?void 0:s.sender);var N=Object(i.useState)(!1),T=N[0],I=N[1],S=Object(i.useState)(!1),w=S[0],A=S[1],M=Object(i.useState)(!1),O=M[0],R=M[1],k=Object(i.useRef)(null),x=!1;return r&&"admin"!==(null==s?void 0:s.messageType)&&(x=b===r.userId||(null==s?void 0:s.sendingStatus)===tj||(null==s?void 0:s.sendingStatus)===ej),c?a.a.createElement("div",{className:"sendbird-open-channel-msg-hoc sendbird-msg--scroll-ref","data-testid":"sendbird-message-hoc"},c({message:s,chainTop:o,chainBottom:l})):"user"===(null==s?void 0:s.messageType)&&T?a.a.createElement(eD,{isEdit:!0,channel:h,disabled:E,ref:k,message:s,onUpdateMessage:function(e){var t=e.messageId,n=e.message;p(t,n),I(!1)},onCancelEdit:function(){I(!1)}}):a.a.createElement("div",{className:"sendbird-open-channel-msg-hoc sendbird-msg--scroll-ref","data-testid":"sendbird-message-hoc"},a.a.createElement(a.a.Fragment,null,u&&(null==s?void 0:s.createdAt)&&a.a.createElement(dk,null,a.a.createElement(_N,{type:vN.CAPTION_2,color:EN.ONBACKGROUND_2},ok(null==s?void 0:s.createdAt,v.DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR,{locale:_}))),(t={},t[YB]=function(){if("admin"===(null==s?void 0:s.messageType))return a.a.createElement(FB,{message:s})}(),t[XB]=function(){var e;if("file"===(null==s?void 0:s.messageType))return a.a.createElement(KB,{message:s,isOperator:null==h?void 0:h.isOperator(null===(e=null==s?void 0:s.sender)||void 0===e?void 0:e.userId),isEphemeral:null==h?void 0:h.isEphemeral,disabled:E,userId:b,showRemove:A,resendMessage:m,chainTop:o,chainBottom:l})}(),t[JB]=function(){var e;if("user"===(null==s?void 0:s.messageType)&&C)return a.a.createElement(BB,{message:s,isOperator:null==h?void 0:h.isOperator(null===(e=null==s?void 0:s.sender)||void 0===e?void 0:e.userId),isEphemeral:null==h?void 0:h.isEphemeral,userId:b,showEdit:I,disabled:E,showRemove:A,resendMessage:m,chainTop:o,chainBottom:l})}(),t[ZB]=function(){var e;if("file"===(null==s?void 0:s.messageType))return a.a.createElement(VB,{message:s,isOperator:null==h?void 0:h.isOperator(null===(e=null==s?void 0:s.sender)||void 0===e?void 0:e.userId),isEphemeral:null==h?void 0:h.isEphemeral,disabled:E,userId:b,showRemove:A,resendMessage:m,onClick:R,chainTop:o,chainBottom:l})}(),t[QB]=function(){var e;if("user"===(null==s?void 0:s.messageType))return a.a.createElement(PB,{message:s,isOperator:null==h?void 0:h.isOperator(null===(e=null==s?void 0:s.sender)||void 0===e?void 0:e.userId),isEphemeral:null==h?void 0:h.isEphemeral,userId:b,disabled:E,showEdit:I,showRemove:A,resendMessage:m,chainTop:o,chainBottom:l})}(),t[$B]=void 0,t)[function(e,t){var n,r,i=null==t?void 0:t.isOgMessageEnabledInOpenChannel;return(null===(n=null==e?void 0:e.isUserMessage)||void 0===n?void 0:n.call(e))||"user"===(null==e?void 0:e.messageType)?(null==e?void 0:e.ogMetaData)&&i?JB:QB:(null===(r=null==e?void 0:e.isAdminMessage)||void 0===r?void 0:r.call(e))?YB:"file"===(null==e?void 0:e.messageType)?bA(e.type)||CA(e.type)?ZB:XB:$B}(s,{isOgMessageEnabledInOpenChannel:C})],w&&a.a.createElement(WB,{message:s,onCloseModal:function(){return A(!1)},onDeleteMessage:function(){"admin"!==(null==s?void 0:s.messageType)&&f(s)}}),O&&"file"===(null==s?void 0:s.messageType)&&a.a.createElement(UU,{onClose:function(){return R(!1)},message:s,onDelete:function(){return f(s)},isByMe:x})))}a.a.forwardRef((function(e,t){var n=bB(),r=n.isMessageGroupingEnabled,s=void 0===r||r,o=n.allMessages,l=n.hasMore,u=n.onScroll,c=IC().state,d=JC().stringSet,h=c.config.userId,f=Object(i.useRef)(null),p=t||f,m=Object(i.useState)(!1),g=m[0],_=m[1],v=function(){p&&"current"in p&&p.current&&(p.current.scrollTo(0,p.current.scrollHeight),_(!1))},E=function(e){var t=e.hasMore,n=e.hasNext,r=e.onScroll,i=e.scrollRef,a=e.setShowScrollDownButton;return GF(Gm((function(){var e=null==i?void 0:i.current;if(null!=e){var s=e.scrollTop,o=e.scrollHeight,l=e.clientHeight,u=function(e,t){return e-t}(o,s);"function"==typeof a&&a(o>s+l+1),t&&cF(s,0,10)&&r((function(){e.scrollHeight>o&&(e.scrollTop=e.scrollHeight-u)})),n&&cF(l+s,o,10)&&r((function(){e.scrollHeight>o&&(e.scrollTop=s)}))}})),100,{trailing:!0})}({setShowScrollDownButton:_,hasMore:l,onScroll:u,scrollRef:p}),y=Object(i.useMemo)((function(){var t;return o.length>0?o.map((function(t,n){var r,i=o[n-1],l=o[n-1],u=i&&i.createdAt,c=null==t?void 0:t.createdAt,f=!(u&&nD(c,u)),p=s?sF(i,t,l,d):[!1,!1],m=p[0],g=p[1],_=(null===(r=null==t?void 0:t.sender)||void 0===r?void 0:r.userId)===h,v=(null==t?void 0:t.messageId)||(null==t?void 0:t.reqId);return a.a.createElement(HD,{message:t,isByMe:_,key:v},a.a.createElement(nj,{message:t,chainTop:m,chainBottom:g,hasSeparator:f,renderMessage:null==e?void 0:e.renderMessage}))})):(null===(t=null==e?void 0:e.renderPlaceHolderEmptyList)||void 0===t?void 0:t.call(e))||a.a.createElement(KO,{className:"sendbird-openchannel-conversation-scroll__container__place-holder",type:HO})}),[o]);return a.a.createElement("div",{className:"sendbird-openchannel-conversation-scroll"},a.a.createElement("div",{className:"sendbird-openchannel-conversation-scroll__container"},a.a.createElement("div",{className:"sendbird-openchannel-conversation-scroll__container__padding"}),a.a.createElement("div",{className:["sendbird-openchannel-conversation-scroll__container__item-container",o.length>0?"":"no-messages"].join(" "),onScroll:E,ref:p},y)),g&&a.a.createElement("div",{className:"sendbird-openchannel-conversation-scroll__container__scroll-bottom-button",onClick:v,onKeyDown:v,tabIndex:0,role:"button"},a.a.createElement(YS,{width:"24px",height:"24px",type:QS.CHEVRON_DOWN,fillColor:XS.CONTENT})))})),a.a.createContext(null),Object(i.createContext)({openedListKeys:[],addOpenedListKey:$C,removeOpenedListKey:$C,clearOpenedListKeys:$C,allowMultipleOpen:!1});var rj,ij,aj=function(e){var t=e.renderHeader,n=e.renderPlaceHolderError,r=e.renderPlaceHolderLoading,s=e.renderPlaceHolderEmptyList,o=e.onChangeTheme,l=e.onUserProfileUpdated,u=e.allowProfileEdit,c=e.channels,d=e.onLoadMore,h=e.initialized,f=e.renderChannel,p=e.renderAddChannel,m=e.scrollRef,g=Object(i.useState)(!1),_=g[0],v=g[1],E=IC().state.stores,y={addChannel:p,channel:f,placeholder:{loading:function(){return h?null:r?r():a.a.createElement(KO,{type:BO})},empty:function(){return h?s?s():a.a.createElement(KO,{type:jO}):null},error:function(){return h&&E.sdkStore.error?n?n():a.a.createElement(KO,{type:GO}):null}}};return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"sendbird-channel-list__header"},(null==t?void 0:t())||a.a.createElement(LF,{onEdit:function(){return u&&v(!0)},allowProfileEdit:u,renderIconButton:function(){return y.addChannel()}})),_&&a.a.createElement(HF,{onThemeChange:o,onCancel:function(){return v(!1)},onEditProfile:function(e){v(!1),l(e)}}),a.a.createElement(sj,{data:c,renderItem:y.channel,onLoadMore:d,placeholderLoading:y.placeholder.loading(),placeholderEmpty:y.placeholder.empty(),placeholderError:y.placeholder.error(),scrollRef:m}))},sj=function(e){var t,n,r,i,s=e.data,o=e.renderItem,l=e.onLoadMore,u=e.placeholderLoading,c=e.placeholderError,d=e.placeholderEmpty,h=e.scrollRef,f=(n=(t={onReachedBottom:function(){return null==l?void 0:l()}}).onReachedTop,r=t.onReachedBottom,i=t.onInBetween,GF(Gm((function(e){if(null==e?void 0:e.target){var t=e.target,a=t.scrollTop,s=t.scrollHeight,o=t.clientHeight,l={distanceFromBottom:s-a-o};n&&cF(a,0,10)?n(l):r&&cF(s,o+a,10)?r(l):i&&i(l)}})),100,{trailing:!0}));return a.a.createElement("div",{className:"sendbird-channel-list__body",onScroll:f,ref:h},c,a.a.createElement("div",null,s.map((function(e,t){return o({item:e,index:t})}))),u,0===s.length&&d)},oj=function(e,t){return"broadcast"===t&&(e.isBroadcast=!0),"supergroup"===t&&(e.isSuper=!0),e};(ij=rj||(rj={})).GROUP="group",ij.SUPERGROUP="supergroup",ij.BROADCAST="broadcast";var lj,uj,cj=a.a.createContext(null),dj={sdk:void 0,userListQuery:void 0,onCreateChannelClick:void 0,onChannelCreated:void 0,onBeforeCreateChannel:void 0,pageStep:0,type:rj.GROUP,onCreateChannel:void 0,overrideInviteUser:void 0},hj=function(e){var t=e.onCreateChannelClick,n=e.onBeforeCreateChannel,r=e.onChannelCreated,a=e.userListQuery,s=e.onCreateChannel,o=e.overrideInviteUser,l=mj().updateState,u=IC().state.config,c=null!=a?a:null==u?void 0:u.userListQuery;return Object(i.useEffect)((function(){l({onCreateChannelClick:t,onBeforeCreateChannel:n,onChannelCreated:r,userListQuery:c,onCreateChannel:s,overrideInviteUser:o})}),[t,n,r,a,s,o,c]),null},fj=function(e){var t=e.children;return a.a.createElement(pj,m({},e),a.a.createElement(hj,m({},e)),t)},pj=function(e){var t=e.children,n=eN({userListQuery:null==e?void 0:e.userListQuery,onCreateChannelClick:null==e?void 0:e.onCreateChannelClick,onChannelCreated:null==e?void 0:e.onChannelCreated,onBeforeCreateChannel:null==e?void 0:e.onBeforeCreateChannel,onCreateChannel:null==e?void 0:e.onCreateChannel,overrideInviteUser:null==e?void 0:e.overrideInviteUser}),r=Object(i.useRef)(function(e){return Yb(m(m({},dj),e))}(n));return a.a.createElement(cj.Provider,{value:r.current},t)},mj=function(){return Xb(cj,(function(e){return e}),dj)},gj=function(){var e=Object(i.useContext)(cj),t=function(){var e=IC(),t=e.state,n=e.actions;return m(m({},t),n)}();if(!e)throw new Error("useCreateChannel must be used within a CreateChannelProvider");return{state:J_.useSyncExternalStore(e.subscribe,e.getState),actions:Object(i.useMemo)((function(){return{setPageStep:function(t){return e.setState((function(e){return m(m({},e),{pageStep:t})}))},setType:function(t){return e.setState((function(e){return m(m({},e),{type:t})}))},createChannel:UD(t)}}),[e])}},_j=function(e){var t=e.onCancel,n=e.userListQuery,r=gj(),s=r.state,o=s.onCreateChannelClick,l=s.onBeforeCreateChannel,u=s.onChannelCreated,c=s.onCreateChannel,d=s.overrideInviteUser,h=s.type,f=r.actions.createChannel,p=IC().state,g=p.config.userId,_=p.stores.sdkStore.sdk,v=[g],y=Object(i.useState)([]),b=y[0],C=y[1],N=Object(i.useState)({}),T=N[0],I=N[1],S=Object(i.useContext)(XC).stringSet,w=Object(i.useState)(null),A=w[0],M=w[1],O=Object.keys(T).length,R=S.MODAL__CREATE_CHANNEL__TITLE,k=S.BUTTON__CREATE,x=oN().isMobile,D=Object(i.useState)(window.innerHeight),U=D[0],L=D[1];return Object(i.useEffect)((function(){var e=n?n():function(e){var t=e.sdk,n=e.userFilledApplicationUserListQuery,r=t.createApplicationUserListQuery();return n&&Object.keys(n).forEach((function(e){r[e]=n[e]})),r}({sdk:_});M(e),(null==e?void 0:e.isLoading)||e.next().then((function(e){C(e)}))}),[]),Object(i.useEffect)((function(){var e=function(){L(window.innerHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),a.a.createElement(rw,{isFullScreenOnMobile:!0,titleText:R,submitText:k,type:fN.PRIMARY,disabled:b.length>1&&0===Object.keys(T).length,onCancel:t,onSubmit:function(){var e=Object.keys(T).length>0?Object.keys(T):[g],n=null!=u?u:c,r=null!=o?o:d;if("function"!=typeof r){if(l){var i=l(e);oj(i,h),f(i).then((function(e){return null==n?void 0:n(e)}))}else{(i={}).invitedUserIds=e,i.isDistinct=!1,g&&(i.operatorUserIds=[g]),oj(i,h),f(i).then((function(e){return null==n?void 0:n(e)}))}null==t||t()}else r({users:e,onClose:null!=t?t:$C,channelType:h})}},a.a.createElement("div",null,a.a.createElement(_N,{color:O>0?EN.PRIMARY:EN.ONBACKGROUND_3,type:vN.CAPTION_1},"".concat(O," ").concat(S.MODAL__INVITE_MEMBER__SELECTED)),a.a.createElement("div",{className:"sendbird-create-channel--scroll",style:x?{height:"calc(".concat(U,"px - 200px)")}:{},onScroll:function(e){if(A){var t=e.target,n=A.hasNext,r=A.isLoading,i=t.clientHeight+t.scrollTop+50>t.scrollHeight;n&&i&&!r&&A.next().then((function(e){C(E(E([],b,!0),e,!0))}))}}},b.map((function(e){return!function(e){return function(t){return null==e?void 0:e.includes(t)}}(v)(e.userId)&&a.a.createElement(PD,{key:e.userId,user:e,checkBox:!0,checked:T[e.userId],onChange:function(e){var t,n=m(m({},T),((t={})[e.target.id]=e.target.checked,t));e.target.checked||delete n[e.target.id],I(n)}})})))))},vj=function(e){var t=e.onCancel,n=IC().state,r=DD(n),s=gj().actions,o=s.setPageStep,l=s.setType,u=Object(i.useContext)(XC).stringSet,c=function(e){var t,n=null===(t=null==e?void 0:e.appInfo)||void 0===t?void 0:t.applicationAttributes;return!!Array.isArray(n)&&n.includes("allow_broadcast_channel")}(r),d=function(e){var t,n=null===(t=null==e?void 0:e.appInfo)||void 0===t?void 0:t.applicationAttributes;return!!Array.isArray(n)&&n.includes("allow_super_group_channel")}(r);return a.a.createElement(rw,{titleText:null==u?void 0:u.MODAL__CREATE_CHANNEL__TITLE,hideFooter:!0,onCancel:function(){null==t||t()},className:"sendbird-add-channel__modal"},a.a.createElement("div",{className:"sendbird-add-channel__rectangle-wrap"},a.a.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){l(rj.GROUP),o(1)},role:"button",tabIndex:0,onKeyDown:function(){l(rj.GROUP),o(1)}},a.a.createElement(YS,{className:"sendbird-add-channel__rectangle__chat-icon",type:QS.CHAT,fillColor:XS.PRIMARY,width:"28px",height:"28px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__GROUP)),d&&a.a.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){l(rj.SUPERGROUP),o(1)},role:"button",tabIndex:0,onKeyDown:function(){l(rj.SUPERGROUP),o(1)}},a.a.createElement(YS,{className:"sendbird-add-channel__rectangle__supergroup-icon",type:QS.SUPERGROUP,fillColor:XS.PRIMARY,width:"28px",height:"28px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__SUPER)),c&&a.a.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){l(rj.BROADCAST),o(1)},role:"button",tabIndex:0,onKeyDown:function(){l(rj.BROADCAST),o(1)}},a.a.createElement(YS,{className:"sendbird-add-channel__rectangle__broadcast-icon",type:QS.BROADCAST,fillColor:XS.PRIMARY,width:"28px",height:"28px"}),a.a.createElement(_N,{type:vN.SUBTITLE_1,color:EN.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__BROADCAST))))},Ej=function(e){var t=e.onCancel,n=e.renderStepOne,r=gj(),i=r.state,s=i.pageStep,o=i.userListQuery,l=r.actions.setPageStep;return a.a.createElement(a.a.Fragment,null,0===s&&((null==n?void 0:n())||a.a.createElement(vj,{onCancel:t})),1===s&&a.a.createElement(_j,{userListQuery:o,onCancel:function(){l(0),null==t||t()}}))},yj=function(e){return a.a.createElement(fj,m({},e),a.a.createElement(Ej,m({},e)))},bj=function(e){var t=e.createChannelVisible,n=e.onChangeCreateChannelVisible,r=e.onBeforeCreateChannel,i=e.onCreateChannelClick,s=e.onChannelCreated,o=IC().state.config;return a.a.createElement(a.a.Fragment,null,a.a.createElement(lN,{height:"32px",width:"32px",disabled:!o.isOnline,onClick:function(){return n(!0)}},a.a.createElement(YS,{type:QS.CREATE,fillColor:XS.PRIMARY,width:"24px",height:"24px"})),t&&a.a.createElement(yj,{onCancel:function(){return n(!1)},onChannelCreated:function(e){null==s||s(e),n(!1)},onBeforeCreateChannel:r,onCreateChannelClick:i}))},Cj=function(){var e=Object(i.useState)(!1),t=e[0],n=e[1],r=ZM().state,s=r.onChannelCreated,o=r.onBeforeCreateChannel,l=r.onCreateChannelClick;return a.a.createElement(bj,{createChannelVisible:t,onChangeCreateChannelVisible:n,onCreateChannelClick:l,onBeforeCreateChannel:o,onChannelCreated:s})},Nj=function(e){var t=e.renderHeader,n=e.renderChannelPreview,r=e.renderPlaceHolderError,i=e.renderPlaceHolderLoading,s=e.renderPlaceHolderEmptyList,o=ZM().state,l=o.onChannelSelect,u=o.onThemeChange,c=o.allowProfileEdit,d=o.typingChannelUrls,h=o.groupChannels,f=o.initialized,p=o.selectedChannelUrl,g=o.loadMore,E=o.onUserProfileUpdated,y=o.scrollRef,b=IC().state,C=b.stores,N=b.config,T=N.logger,I=N.isOnline,S=C.sdkStore.sdk;return a.a.createElement(aj,{renderHeader:t,renderChannel:function(e){var t=e.item,r=e.index,i={channel:t,tabIndex:r,isSelected:t.url===p,isTyping:d.includes(t.url),renderChannelAction:function(e){return a.a.createElement(VF,m({},e))},onClick:function(){I||(null==S?void 0:S.isCacheEnabled)?(T.info("ChannelList: Clicked on channel:",t),l(t)):T.warning("ChannelList: Inactivated clicking channel item during offline.")},onLeaveChannel:function(){return _(this,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return T.info("ChannelList: Leaving channel",t),[4,t.leave()];case 1:return e.sent(),T.info("ChannelList: Leaving channel success"),[2]}}))}))}};return n?a.a.createElement("div",{key:t.url,onClick:i.onClick},n(i)):a.a.createElement(YF,m({key:t.url},i))},renderPlaceHolderError:r,renderPlaceHolderLoading:i,renderPlaceHolderEmptyList:s,onChangeTheme:null!=u?u:$C,allowProfileEdit:c,onUserProfileUpdated:null!=E?E:$C,channels:h,onLoadMore:g,initialized:f,renderAddChannel:function(){return a.a.createElement(Cj,null)},scrollRef:y})},Tj=function(e){return a.a.createElement(nO,m({},e),a.a.createElement(Nj,m({},e)))};(uj=lj||(lj={})).CHANNEL_LIST="CHANNEL_LIST",uj.CHANNEL="CHANNEL",uj.CHANNEL_SETTINGS="CHANNEL_SETTINGS",uj.MESSAGE_SEARCH="MESSAGE_SEARCH",uj.THREAD="THREAD";const Ij=({channel:e})=>{const{lastMessage:t}=e,n=(null==t?void 0:t.message)||"",r=(null==t?void 0:t.createdAt)?(e=>{const t=new Date,n=new Date(e),r=t.getTime()-n.getTime(),i=Math.floor(r/1e3),a=Math.floor(i/60),s=Math.floor(a/60);if(a<1)return"Just now";if(a<60)return a+" min ago";if(s<24&&t.toDateString()===n.toDateString())return`${s} hour${s>1?"s":""} ago`;const o=new Date;if(o.setDate(t.getDate()-1),n.toDateString()===o.toDateString())return"Yesterday";const l=t.getDay(),u=new Date(t);return u.setDate(t.getDate()-l),n>=u?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n.getDay()]:(t.getFullYear(),n.getFullYear(),n.toLocaleString("default",{month:"short",year:"numeric"}))})(t.createdAt):"Just now";return h.jsxs("div",{className:WM.customChatHistory,children:[h.jsx("div",{className:WM.messageText,children:n}),h.jsx("div",{className:WM.messageTime,children:r})]})},Sj=({setShowChatHistory:e})=>h.jsxs("div",{className:WM.customGroupChannelHeader,children:[h.jsx("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAcCAYAAACZOmSXAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFZSURBVHgBxZYxTsMwFIaf8yLECFIlysZcqVFVLgC3YM0JUE5AegNuQI/AygRcoLKqqnM2WnXAY4YmxkkFSqid1G7sflIkx37S91uOXkzAgCC4feScx2LIOM/DxYJ+gAEeaBIE4ychfhbDC/HcEOK9gCFa8p0Y4vosB1MOlsvFpTwCQ/xDilTiLINwuaSvYAhpK2gWz6ZwBORU4ka5bbFS7kIslbsS78ldimtylVjMTbbbsyl0SJqmLEkoI01imxACUSkfDsffsOvVLmHaP5bu4Kxsr1mW3yN67yDdPU+gY8QRM9/n4d8HNxiMRrIA4mzi+Xw2AQvg72CzWa16vas3zyMP4vW8UnPX71/Dev31CR2D1RfXAfD/hMsAKJt0FQBVCy4CYNOi7QDYVmAzQKvcZoDWO1wVVSNCzC8ppQw00ert4qZKi1Yshtqio+X1AEXP5yzPITLZdcEP+7znr5ZGTGAAAAAASUVORK5CYII=",className:WM.backIcon,alt:"back-icon",onClick:()=>e(!1)}),h.jsx("p",{children:"Past Conversations"})]}),wj=({selectedChannelUrl:e,onChannelSelect:t,setShowChatHistory:n})=>h.jsx(Tj,{className:WM.customGroupChannelList,selectedChannelUrl:e,onChannelCreated:()=>null,onChannelSelect:t,renderChannelPreview:({channel:e})=>h.jsx(Ij,{channel:e}),renderHeader:()=>h.jsx(Sj,{setShowChatHistory:n})}),Aj=({width:e=26,height:t=26,color:n="#B4B4BE"})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,viewBox:"0 0 26 26",fill:"none",children:[h.jsx("g",{clipPath:"url(#clip0_8040_135368)",children:h.jsx("path",{d:"M21.2959 14.7941L10.5021 19.3473C8.93209 20.0137 7.47499 18.1856 8.47599 16.8019L10.7639 13.6316C10.7852 13.6316 10.7958 13.6315 10.817 13.6316L14.3625 13.637C14.7765 13.6377 15.1104 13.3038 15.1097 12.8899C15.1144 12.4706 14.7795 12.1357 14.3602 12.1403L10.8201 12.1295C10.7989 12.1295 10.7776 12.1294 10.7617 12.1347L8.34155 8.79261C7.34693 7.41643 8.76665 5.60346 10.344 6.23748L21.2524 10.6381C23.1165 11.3894 23.1471 14.0168 21.2959 14.7941Z",fill:n})}),h.jsx("defs",{children:h.jsx("clipPath",{id:"clip0_8040_135368",children:h.jsx("rect",{width:"18",height:"18",fill:"white",transform:"translate(13) rotate(45)"})})})]}),Mj="card_type",Oj="Message Status",Rj="Account ID",kj="Channel ID",xj="Source",Dj="Viewed",Uj="Interacted",Lj="Failed",Pj="Care AI chat screen",Fj="Care AI card";function Bj(e){let t=null;if(!e)return null;const{object:n="",objectContext:r={},action:i="",actionContext:a={},actor:s="",actorContext:o={}}=e;return t=()=>{console.log("Event: ",{object:n,objectContext:r,action:i,actionContext:a,actor:s,actorContext:o})},"undefined"!=typeof window&&("undefined"==typeof Tracker||window.pelTracker||(window.pelTracker=new Tracker),t=()=>{if(window.pelTracker){window.pelTracker.createEvent({object:n,action:i,actor:s,objectContext:r,actionContext:a,actorContext:o,platform:"mweb"}).logEvent()}}),t}const jj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsCAMAAAC4uKf/AAAAclBMVEXj6/cAAADU3/Dc5fTp8fvy+P3F0uofFBrSm4kNBwvdrJ7ChnYqICi1w+BDLTQyKzZAN0ZMRFWsdGZnRETowruSXlXd6PPe5/Te5/Sus8x1ibVrXG+cm7NYaJQuS5CWpMcTHmfg6fXg6fSCeY20wd+kqsb/F7czAAAAJnRSTlP/AP//////////////////////////F63X/////v////+BUf+QQEOKnCoAAA0HSURBVHicrZoLX6s4EMVjEgK0hEcRlUKtld3v/xX3nAm01ELx7m6u+quPy78zc+aRgHr5g/X2fXl///hQsj4+3t8v329/8v/VH3DU4voD4q9gb2ugK/B3vG3YJmni/XfY2+UJwNx99/G+Zd5z2NuaUWb8h1dz4gbuGWwdZcbPn8Zt4NZhaw6cXd6AeLMsvDCXfwH7/lgxy9pIPvAqsoZrBE2fH6tSWYGt6sJGyrdtP3QDPnodcKNDJ+euGrcMe1sxy0a674qsyOI4zrIsLgc3WTe6NNA+liO3CPte9WBfglJkYRWAFoONbsbJp2AXjVuCrbrQdiAVEws08iodaGLcaJ1ZduUjbFXwka7EGDgweLHgKouRNi41vVhIggfYWrhU5Iu4yNI0FdDoR9LKytg72Mh7DNxP2BrLRK6IYVFKWhpfaSVYRWfVkm0PNPU7lrKmJIuwmOalwayR1i868oGmfsdSUZeK4sWNqdCAQcRK0ko/c+Rs/aDdw1abSdRmwXXxmGEjjbyyqsphZtrcpe/rsPV2YrugizwXv9V1nmdpUZVhgdZGD2Y9ZoD6FSvymYgir7G6w+HQNHUdp/Bf4FVltwIz38uwt1WWigbYFYPVNIfDPkmS/aGp8zgGrCLwiWnmbRG2Kg5IsWK0ivqw3wO1S3a7JGlqFKtA+xm1NZHcYE/6P+TBwlE3YtVOVnKo8ywTqyr54pYFOQ/bFbZWfIMXM8Qsrw8z2C5pclZGgZHXr5l2C9sVtu5ErKpA1agZr/0Ee93tayb21bROqRXY1ZET7IkTjfUFYNnImmCvOzGtnEyrVhLbGH25hz1RIspiXxRpmjdzL75iHeoyFOJSTOtXYZMiR9jTOTQaWO1rKnF3QymV1KxXoWBhDYtu1PzyPoc9M+washpBSyZWMmDl7GZFqFgIml6gaS0fbzPYU8OsLxmyMocVFXGvu6SDNXVXA1WFagw/dotB07Leb7DnhkV9BlgOdaBs1KThBcK3e93XgFXBk6CtBE1ob1fY850DsgywmgWRVXFPy1CvgNs3rB6TSsqloBFER16usKc5hjEngxibBm7McgATqB6YrCjreoKJSpaCNsKCaWqjeACmKyg/bup4KNFVAqwpBwDiPBR9GQ+Ksmp/+FEbsUpglxH23IvWlTlg0lXqrqkPzGd8h7A1dejUmIREJfdB01d5TBJRm7qPPGFZCBkZED41ggQHjSbBxNBWfwbt6sPRj2rLiyj5OXK6gCJkNXtm9CubDHoNy6MMk2gARdk59RN2s+0isI1dLIsV0kzKoohwhElu7/OYA3KBBiRBUzMn6jvD6Ee15UUWqxEGawKMeR1q1muTcvxBB8ryMmfFCld+cKL4UW158QpjpSIsGZ0YYEksC6YBBvGbK+qqw2l9A/Zsh85lu6tlYO33I2SfBHfmcZjuZLJD0AIsiP7OMARNbYVshMWMGZ1IywgK1N2uIepqWqsmxB1nDJp62WKZirCUs47IUYTCVDuwbgmMfkQqgiZBexRHWC9qSx9WlwJr9vsmwEZPkoa1H/1I+ed5N+l96i7z9aa29CEwjNv1XtIaWR2aaJKwJiOOuWw4kGx0ZOVV0IVZ8OO32tSHK4scsBziaDhgBT9i3EG9EliacQ9VSK7lvR39Z8wD7aI29eFyzPW4EB3Y5MOrMTZS6jU57GTSAiyW2Zx+vAXNLNDefwErAYO0G5iG7tkEBAS5k+FnT7PiETYL2sJ6V097mcSsQo1FR4sJu8XsdZx9Gtmx0Y0lgjbClmkfv4DVHA9HiYx6TKaSRS+mo2llRtiKVQG2tW6wdCJNI5bM4PIbqSFoa3kuclxbv4LJMUtKQd5ogbXHLyfTSrS1/wVWyK693o97pt3Y0ti+xbL/C2a6PJy1hDKyT8buIi3gQFgsgsQAhH5dtf8dxppE25pksktQKJc1j0fSmMdYmBDy7j/CBqSZFECeEDRSP1irGrqUME6VsAuwKo+fw7b1iJFeyh9pWROqsWyfwsjDdwI5lrINBWxd+9t5RlgunhphTaj8wULCihEWYxLPytY9gW0f2hMmIqDs7lkCC7+G+bAsy/v1pN6ujTdYyqDV9zCoscgLOUooA6x7BttqMQpqzANrDktusFLOO4sKsAq7/HWFXDabp0JST24ErZ7bJTAMA3AhLAMPSYfquEb73h4LWlxrOorjNm0BVrIHAUbtZ3X/2DbDetseeAapiyFmqEfNHMYGB8MIo/YDtW5XaJujXNSWwYepSC7AJrsgxqavhCGJlrHNFgibVgst9H1rSI10F/I5rCqv72CHpvUnVGAZCWKepFXs6/nQOlzd+3t9PB2/bRS5rg7nmSKQ8ixHSnJWFgxz1p/zXLY59AAKcYdVwZdD3wpxpo8nGwvj2n6o63I6W0+xo1XD7fwKrL2OlHdDFkLG95MDNQznfqi6wdt7P7492TJp13YMeImdILYqcXE6HX2bT80TrIS3YpzqURw57kgTHdrWe4ONuG6H+2IiW6aVoMGHbYeCcOriVE6Hj8fj6djyyFHGgmS/M15HzkU95BFYoHXeOyf3gKzt72jf69tcOLHLy6E/Dnk4xf80x+On76+HSsn+NXJeO4Od6dgSYuRjdyaLF1B4t62Ze3F1A2/g9d77lizeVvo6RjDN+SYZD7AwpFrozVnr6hFWDVVaIsksrLLwjLUziYwb+CU/Wt2f4Y++Yh3CzPQF2PkILZMl4wf2Tgowa5XuJA3T7Hwu094aCQGXioyfe1Fgj35EeFuwBh5/QSXDSWAeyyVXGEYbrwGzfSbn8PHQVW3EezEA8d4hmHoy7eN6wvNgmuFl22Fo/bED7vj19fUZeYcf6jYJu1wYZpzmDUnfVzJf5fmgeXtSkyUoGOdmXlw+KLOOq4WEPUJXEvX59Xk0zjvlJxgNY3Ci9jggNxC1Ek4FC4YpG1xp7Uwey0eACDxhqG2Q5ADKJ2EgIozWjfrYGxhGC4ztjxULdVy1/NYwWFZFd7DZEeC9adbQXayj3vU9QSfvzifiztigB9jeG+fkpi7M7zDppFl/djTMRga5HiQS2TFo88PNO9OgDiSQsHyLcH2eWo0feKjkhGkmZFmCXyM4vHGmVV+eirSC83kATrsmVhQZdzNs6UCaMIdrMGwtDOtbKiNyZ7zGm5At7t7BsMBCfNrhmKVdgAE1Y9kAuz+QngsSOmj5F5BD20Pz8grBgmmfnpaxEOOPFK8FlmmPvk/jPhIYImbsDWad1j+P2me36fAGtQx/QAznry9HE702AaYCDD8MToQZsNt3cXGOICkYZm4svsDVPl5+wG5tzXhnPIua0317/joZsjzeAmEhZkk7qgMVFwO88+ey/ITtgEXYTM9ZTOvH2yOTI6F7iOOMqzo/2BO86Gij9SbAHOVBwcAuS5ZVSJDi66ToMRVJngknpJpxl5dH2ORI2A2fEdY7e/w8k4pQQeqEKeRZwlpiA4z33F3fIQctq4WNqH0+6TCyInV14uPNOiRGyAxjWEHanunNXHbaH08nvA24kTHEZfDX4ve+r76OXkpTJEkd3ViRWr5ZF8LmxjREp8a77lGPibdeYwDo8RWVmIYpK41EhN/3UI5Hicff6WCYnVjR5WUZhrBJxDSTAwqBqnvPloS60dK1vcebOcBYT+/xkgbC9/Dv0WgWOcXOTZWqaIH189axdQLTTGrNruaYBQ6aCkE0yjVIOu4hrRRCRrdFxOAvzd7ip0QLhfjJrWOIROqvMcwripowphSrrnbQKKqFY+OXJ12s2BcdIRwioEPrJxZh9ulNcaHh7SJ1BObPaDQIO8THWglf2vYMOK828mDe5+dRElyED4lM8vjJWniQwcnhNb2J/G7Z1TSaNC5BmLKcnuRKJkgkis5iWIDheyNJscRaekSDRSdkm8DgV+tYAzW4jJEUKr55XhOiFcNCTY7kZ8Kyj6zFh09udxu8FHwRAviEsUCL1qx04/Z8Ph9PLUcOHulH4tmgj988fIJ1mU7JA0yz3gGGV0osi5hezLCoP8tfIaOjMOncWJeFCy8+MHQZE9tAf0yecOPSSzSdlGCZQ217VGwJ6DEqwBhIcWa0+OzVyqNQPhStESY3PZDubMT4gVQqqv54NjIa6aMPMCa5IesPHoXC+isMKj2LcICxNUpndcLiwewDjC0HobysPDC3+vja3x8Uf+9Zc3kN7cLRE6uyDTDdsjCD5Y4mGp8tQxn548fXuC6A+Z4XNzKRhAfvmNJiGfGnE+ewIBAbNGzWzHoOQxJohdnHBy+KJIU6dnRcuK9O2G4c2+gK+5ePHAYcDTCcC7wLj1TNYVoPPca4UFGwz1x6sOv3MOKYXu7cokzy+jxQmYYVXB2Z3nvpJ0jqJw78HQzr775vNSqFF9O0duZKU+P+AXa9b6J++Wjv33/91YKlTdBFgMkcN8J+Q/ot7CU8tCwKCTBpMAH2fz+0PCe+f3xwfFP2XzyO/Q88/xK6UD47rgAAAABJRU5ErkJggg==",Hj=({channelUrl:e,waitingForResponseMap:t,setWaitingForResponseMap:n,eventInfoData:r})=>{const a=Object(i.useRef)(null),[s,o]=Object(i.useState)(!1),l=t[e]||!1,u=Object(i.useRef)(!1),{actions:{sendUserMessage:c}}=CO(),d=async()=>{const i=a.current;if(!i||l)return;const s=i.value.trim();if(s){try{i.value="";const a=await c({message:s});let o,l;a&&a.sendingStatus&&(clearTimeout(o),clearTimeout(l),o=setTimeout(()=>{n({...t,[e]:!0}),l=setTimeout(()=>{if(n({...t,[e]:!1}),u.current){u.current=!1;Bj({object:Pj,action:Lj,objectContext:{...r,[Oj]:"Message received"}})()}},12e4)},500),setTimeout(()=>{const e=document.getElementsByClassName("sendbird-conversation__messages-padding")[0];e&&(e.scrollTop=e.scrollHeight)},600))}catch(e){console.error(e)}i&&(i.style.height="auto"),o(!1)}};return h.jsxs(h.Fragment,{children:[l&&h.jsxs("div",{className:WM.chatBotTypingIndicator,children:[h.jsx("div",{className:WM.typingIndicatorAvatar,children:h.jsx("img",{src:jj,alt:"care-ai-avatar",width:"20",height:"20"})}),h.jsx("p",{className:WM.typingIndicatorText,children:"Care AI is typing..."})]}),h.jsxs("div",{className:WM.customInputWrapper,children:[h.jsx("textarea",{ref:a,className:WM.customTextarea,rows:1,onChange:()=>{const e=a.current,t=null==e?void 0:e.value.trim();o(!!t),e&&(e.style.height="auto",e.style.height=e.scrollHeight+2+"px",e.scrollHeight>44?e.classList.add(WM.customTextareaExpanded):e.classList.remove(WM.customTextareaExpanded))},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())}}),h.jsx("button",{className:`${WM.sendBtn} ${s&&!l?WM.sendBtnActive:""}`,onClick:d,disabled:l,children:h.jsx(Aj,{width:26,height:26,color:s&&!l?"white":"#B4B4BE"})})]}),h.jsx("p",{className:WM.careAIDisclaimerText,children:"AI generated, not a substitute to professional medical advice"})]})};const Gj=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,zj=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Vj={};function qj(e,t){return(Vj.jsx?zj:Gj).test(e)}const Kj=/[ \t\n\f\r]/g;function Wj(e){return""===e.replace(Kj,"")}class Yj{constructor(e,t,n){this.normal=t,this.property=e,n&&(this.space=n)}}function Qj(e,t){const n={},r={};for(const t of e)Object.assign(n,t.property),Object.assign(r,t.normal);return new Yj(n,r,t)}function Xj(e){return e.toLowerCase()}Yj.prototype.normal={},Yj.prototype.property={},Yj.prototype.space=void 0;class Zj{constructor(e,t){this.attribute=t,this.property=e}}Zj.prototype.attribute="",Zj.prototype.booleanish=!1,Zj.prototype.boolean=!1,Zj.prototype.commaOrSpaceSeparated=!1,Zj.prototype.commaSeparated=!1,Zj.prototype.defined=!1,Zj.prototype.mustUseProperty=!1,Zj.prototype.number=!1,Zj.prototype.overloadedBoolean=!1,Zj.prototype.property="",Zj.prototype.spaceSeparated=!1,Zj.prototype.space=void 0;let Jj=0;const $j=sH(),eH=sH(),tH=sH(),nH=sH(),rH=sH(),iH=sH(),aH=sH();function sH(){return 2**++Jj}const oH=Object.freeze(Object.defineProperty({__proto__:null,boolean:$j,booleanish:eH,commaOrSpaceSeparated:aH,commaSeparated:iH,number:nH,overloadedBoolean:tH,spaceSeparated:rH},Symbol.toStringTag,{value:"Module"})),lH=Object.keys(oH);class uH extends Zj{constructor(e,t,n,r){let i=-1;if(super(e,t),cH(this,"space",r),"number"==typeof n)for(;++i<lH.length;){const e=lH[i];cH(this,lH[i],(n&oH[e])===oH[e])}}}function cH(e,t,n){n&&(e[t]=n)}function dH(e){const t={},n={};for(const[r,i]of Object.entries(e.properties)){const a=new uH(r,e.transform(e.attributes||{},r),i,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(a.mustUseProperty=!0),t[r]=a,n[Xj(r)]=r,n[Xj(a.attribute)]=r}return new Yj(t,n,e.space)}uH.prototype.defined=!0;const hH=dH({properties:{ariaActiveDescendant:null,ariaAtomic:eH,ariaAutoComplete:null,ariaBusy:eH,ariaChecked:eH,ariaColCount:nH,ariaColIndex:nH,ariaColSpan:nH,ariaControls:rH,ariaCurrent:null,ariaDescribedBy:rH,ariaDetails:null,ariaDisabled:eH,ariaDropEffect:rH,ariaErrorMessage:null,ariaExpanded:eH,ariaFlowTo:rH,ariaGrabbed:eH,ariaHasPopup:null,ariaHidden:eH,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:rH,ariaLevel:nH,ariaLive:null,ariaModal:eH,ariaMultiLine:eH,ariaMultiSelectable:eH,ariaOrientation:null,ariaOwns:rH,ariaPlaceholder:null,ariaPosInSet:nH,ariaPressed:eH,ariaReadOnly:eH,ariaRelevant:null,ariaRequired:eH,ariaRoleDescription:rH,ariaRowCount:nH,ariaRowIndex:nH,ariaRowSpan:nH,ariaSelected:eH,ariaSetSize:nH,ariaSort:null,ariaValueMax:nH,ariaValueMin:nH,ariaValueNow:nH,ariaValueText:null,role:null},transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase()});function fH(e,t){return t in e?e[t]:t}function pH(e,t){return fH(e,t.toLowerCase())}const mH=dH({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:iH,acceptCharset:rH,accessKey:rH,action:null,allow:null,allowFullScreen:$j,allowPaymentRequest:$j,allowUserMedia:$j,alt:null,as:null,async:$j,autoCapitalize:null,autoComplete:rH,autoFocus:$j,autoPlay:$j,blocking:rH,capture:null,charSet:null,checked:$j,cite:null,className:rH,cols:nH,colSpan:null,content:null,contentEditable:eH,controls:$j,controlsList:rH,coords:nH|iH,crossOrigin:null,data:null,dateTime:null,decoding:null,default:$j,defer:$j,dir:null,dirName:null,disabled:$j,download:tH,draggable:eH,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:$j,formTarget:null,headers:rH,height:nH,hidden:$j,high:nH,href:null,hrefLang:null,htmlFor:rH,httpEquiv:rH,id:null,imageSizes:null,imageSrcSet:null,inert:$j,inputMode:null,integrity:null,is:null,isMap:$j,itemId:null,itemProp:rH,itemRef:rH,itemScope:$j,itemType:rH,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:$j,low:nH,manifest:null,max:null,maxLength:nH,media:null,method:null,min:null,minLength:nH,multiple:$j,muted:$j,name:null,nonce:null,noModule:$j,noValidate:$j,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:$j,optimum:nH,pattern:null,ping:rH,placeholder:null,playsInline:$j,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:$j,referrerPolicy:null,rel:rH,required:$j,reversed:$j,rows:nH,rowSpan:nH,sandbox:rH,scope:null,scoped:$j,seamless:$j,selected:$j,shadowRootClonable:$j,shadowRootDelegatesFocus:$j,shadowRootMode:null,shape:null,size:nH,sizes:null,slot:null,span:nH,spellCheck:eH,src:null,srcDoc:null,srcLang:null,srcSet:null,start:nH,step:null,style:null,tabIndex:nH,target:null,title:null,translate:null,type:null,typeMustMatch:$j,useMap:null,value:eH,width:nH,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:rH,axis:null,background:null,bgColor:null,border:nH,borderColor:null,bottomMargin:nH,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:$j,declare:$j,event:null,face:null,frame:null,frameBorder:null,hSpace:nH,leftMargin:nH,link:null,longDesc:null,lowSrc:null,marginHeight:nH,marginWidth:nH,noResize:$j,noHref:$j,noShade:$j,noWrap:$j,object:null,profile:null,prompt:null,rev:null,rightMargin:nH,rules:null,scheme:null,scrolling:eH,standby:null,summary:null,text:null,topMargin:nH,valueType:null,version:null,vAlign:null,vLink:null,vSpace:nH,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:$j,disableRemotePlayback:$j,prefix:null,property:null,results:nH,security:null,unselectable:null},space:"html",transform:pH}),gH=dH({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:aH,accentHeight:nH,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:nH,amplitude:nH,arabicForm:null,ascent:nH,attributeName:null,attributeType:null,azimuth:nH,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:nH,by:null,calcMode:null,capHeight:nH,className:rH,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:nH,diffuseConstant:nH,direction:null,display:null,dur:null,divisor:nH,dominantBaseline:null,download:$j,dx:null,dy:null,edgeMode:null,editable:null,elevation:nH,enableBackground:null,end:null,event:null,exponent:nH,externalResourcesRequired:null,fill:null,fillOpacity:nH,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:iH,g2:iH,glyphName:iH,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:nH,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:nH,horizOriginX:nH,horizOriginY:nH,id:null,ideographic:nH,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:nH,k:nH,k1:nH,k2:nH,k3:nH,k4:nH,kernelMatrix:aH,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:nH,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:nH,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:nH,overlineThickness:nH,paintOrder:null,panose1:null,path:null,pathLength:nH,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:rH,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:nH,pointsAtY:nH,pointsAtZ:nH,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:aH,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:aH,rev:aH,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:aH,requiredFeatures:aH,requiredFonts:aH,requiredFormats:aH,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:nH,specularExponent:nH,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:nH,strikethroughThickness:nH,string:null,stroke:null,strokeDashArray:aH,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:nH,strokeOpacity:nH,strokeWidth:null,style:null,surfaceScale:nH,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:aH,tabIndex:nH,tableValues:null,target:null,targetX:nH,targetY:nH,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:aH,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:nH,underlineThickness:nH,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:nH,values:null,vAlphabetic:nH,vMathematical:nH,vectorEffect:null,vHanging:nH,vIdeographic:nH,version:null,vertAdvY:nH,vertOriginX:nH,vertOriginY:nH,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:nH,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:fH}),_H=dH({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase()}),vH=dH({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:pH}),EH=dH({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase()}),yH={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},bH=/[A-Z]/g,CH=/-[a-z]/g,NH=/^data[-\w.:]+$/i;function TH(e){return"-"+e.toLowerCase()}function IH(e){return e.charAt(1).toUpperCase()}const SH=Qj([hH,mH,_H,vH,EH],"html"),wH=Qj([hH,gH,_H,vH,EH],"svg");var AH={},MH=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,OH=/\n/g,RH=/^\s*/,kH=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,xH=/^:\s*/,DH=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,UH=/^[;\s]*/,LH=/^\s+|\s+$/g;function PH(e){return e?e.replace(LH,""):""}var FH=o&&o.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(AH,"__esModule",{value:!0}),AH.default=function(e,t){var n=null;if(!e||"string"!=typeof e)return n;var r=(0,BH.default)(e),i="function"==typeof t;return r.forEach((function(e){if("declaration"===e.type){var r=e.property,a=e.value;i?t(r,a,e):a&&((n=n||{})[r]=a)}})),n};var BH=FH((function(e,t){if("string"!=typeof e)throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function i(e){var t=e.match(OH);t&&(n+=t.length);var i=e.lastIndexOf("\n");r=~i?e.length-i:r+e.length}function a(){var e={line:n,column:r};return function(t){return t.position=new s(e),u(),t}}function s(e){this.start=e,this.end={line:n,column:r},this.source=t.source}function o(i){var a=new Error(t.source+":"+n+":"+r+": "+i);if(a.reason=i,a.filename=t.source,a.line=n,a.column=r,a.source=e,!t.silent)throw a}function l(t){var n=t.exec(e);if(n){var r=n[0];return i(r),e=e.slice(r.length),n}}function u(){l(RH)}function c(e){var t;for(e=e||[];t=d();)!1!==t&&e.push(t);return e}function d(){var t=a();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;""!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,""===e.charAt(n-1))return o("End of comment missing");var s=e.slice(2,n-2);return r+=2,i(s),e=e.slice(n),r+=2,t({type:"comment",comment:s})}}function h(){var e=a(),t=l(kH);if(t){if(d(),!l(xH))return o("property missing ':'");var n=l(DH),r=e({type:"declaration",property:PH(t[0].replace(MH,"")),value:n?PH(n[0].replace(MH,"")):""});return l(UH),r}}return s.prototype.content=e,u(),function(){var e,t=[];for(c(t);e=h();)!1!==e&&(t.push(e),c(t));return t}()}));var jH={};Object.defineProperty(jH,"__esModule",{value:!0}),jH.camelCase=void 0;var HH=/^--[a-zA-Z0-9_-]+$/,GH=/-([a-z])/g,zH=/^[^-]+$/,VH=/^-(webkit|moz|ms|o|khtml)-/,qH=/^-(ms)-/,KH=function(e,t){return t.toUpperCase()},WH=function(e,t){return"".concat(t,"-")};jH.camelCase=function(e,t){return void 0===t&&(t={}),function(e){return!e||zH.test(e)||HH.test(e)}(e)?e:(e=e.toLowerCase(),(e=t.reactCompat?e.replace(qH,WH):e.replace(VH,WH)).replace(GH,KH))};var YH=(o&&o.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(AH),QH=jH;function XH(e,t){var n={};return e&&"string"==typeof e?((0,YH.default)(e,(function(e,r){e&&r&&(n[(0,QH.camelCase)(e,t)]=r)})),n):n}XH.default=XH;const ZH=l(XH),JH=eG("end"),$H=eG("start");function eG(e){return function(t){const n=t&&t.position&&t.position[e]||{};if("number"==typeof n.line&&n.line>0&&"number"==typeof n.column&&n.column>0)return{line:n.line,column:n.column,offset:"number"==typeof n.offset&&n.offset>-1?n.offset:void 0}}}function tG(e){return e&&"object"==typeof e?"position"in e||"type"in e?rG(e.position):"start"in e||"end"in e?rG(e):"line"in e||"column"in e?nG(e):"":""}function nG(e){return iG(e&&e.line)+":"+iG(e&&e.column)}function rG(e){return nG(e&&e.start)+"-"+nG(e&&e.end)}function iG(e){return e&&"number"==typeof e?e:1}class aG extends Error{constructor(e,t,n){super(),"string"==typeof t&&(n=t,t=void 0);let r="",i={},a=!1;if(t&&(i="line"in t&&"column"in t||"start"in t&&"end"in t?{place:t}:"type"in t?{ancestors:[t],place:t.position}:{...t}),"string"==typeof e?r=e:!i.cause&&e&&(a=!0,r=e.message,i.cause=e),!i.ruleId&&!i.source&&"string"==typeof n){const e=n.indexOf(":");-1===e?i.ruleId=n:(i.source=n.slice(0,e),i.ruleId=n.slice(e+1))}if(!i.place&&i.ancestors&&i.ancestors){const e=i.ancestors[i.ancestors.length-1];e&&(i.place=e.position)}const s=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=s?s.line:void 0,this.name=tG(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=a&&i.cause&&"string"==typeof i.cause.stack?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}aG.prototype.file="",aG.prototype.name="",aG.prototype.reason="",aG.prototype.message="",aG.prototype.stack="",aG.prototype.column=void 0,aG.prototype.line=void 0,aG.prototype.ancestors=void 0,aG.prototype.cause=void 0,aG.prototype.fatal=void 0,aG.prototype.place=void 0,aG.prototype.ruleId=void 0,aG.prototype.source=void 0;const sG={}.hasOwnProperty,oG=new Map,lG=/[A-Z]/g,uG=new Set(["table","tbody","thead","tfoot","tr"]),cG=new Set(["td","th"]),dG="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function hG(e,t){if(!t||void 0===t.Fragment)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if("function"!=typeof t.jsxDEV)throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=function(e,t){return function(n,r,i,a){const s=Array.isArray(i.children),o=$H(n);return t(r,i,a,s,{columnNumber:o?o.column-1:void 0,fileName:e,lineNumber:o?o.line:void 0},void 0)}}(n,t.jsxDEV)}else{if("function"!=typeof t.jsx)throw new TypeError("Expected `jsx` in production options");if("function"!=typeof t.jsxs)throw new TypeError("Expected `jsxs` in production options");i=t.jsx,a=t.jsxs,r=function(e,t,n,r){const s=Array.isArray(n.children)?a:i;return r?s(t,n,r):s(t,n)}}var i,a;const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:!1!==t.passKeys,passNode:t.passNode||!1,schema:"svg"===t.space?wH:SH,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:!1!==t.tableCellAlignToStyle},o=fG(s,e,void 0);return o&&"string"!=typeof o?o:s.create(e,s.Fragment,{children:o||void 0},void 0)}function fG(e,t,n){return"element"===t.type?function(e,t,n){const r=e.schema;let i=r;"svg"===t.tagName.toLowerCase()&&"html"===r.space&&(i=wH,e.schema=i);e.ancestors.push(t);const a=vG(e,t.tagName,!1),s=function(e,t){const n={};let r,i;for(i in t.properties)if("children"!==i&&sG.call(t.properties,i)){const a=_G(e,i,t.properties[i]);if(a){const[i,s]=a;e.tableCellAlignToStyle&&"align"===i&&"string"==typeof s&&cG.has(t.tagName)?r=s:n[i]=s}}if(r){(n.style||(n.style={}))["css"===e.stylePropertyNameCase?"text-align":"textAlign"]=r}return n}(e,t);let o=gG(e,t);uG.has(t.tagName)&&(o=o.filter((function(e){return"string"!=typeof e||!("object"==typeof(t=e)?"text"===t.type&&Wj(t.value):Wj(t));var t})));return pG(e,s,a,t),mG(s,o),e.ancestors.pop(),e.schema=r,e.create(t,a,s,n)}(e,t,n):"mdxFlowExpression"===t.type||"mdxTextExpression"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}EG(e,t.position)}(e,t):"mdxJsxFlowElement"===t.type||"mdxJsxTextElement"===t.type?function(e,t,n){const r=e.schema;let i=r;"svg"===t.name&&"html"===r.space&&(i=wH,e.schema=i);e.ancestors.push(t);const a=null===t.name?e.Fragment:vG(e,t.name,!0),s=function(e,t){const n={};for(const r of t.attributes)if("mdxJsxExpressionAttribute"===r.type)if(r.data&&r.data.estree&&e.evaluater){const t=r.data.estree.body[0];t.type;const i=t.expression;i.type;const a=i.properties[0];a.type,Object.assign(n,e.evaluater.evaluateExpression(a.argument))}else EG(e,t.position);else{const i=r.name;let a;if(r.value&&"object"==typeof r.value)if(r.value.data&&r.value.data.estree&&e.evaluater){const t=r.value.data.estree.body[0];t.type,a=e.evaluater.evaluateExpression(t.expression)}else EG(e,t.position);else a=null===r.value||r.value;n[i]=a}return n}(e,t),o=gG(e,t);return pG(e,s,a,t),mG(s,o),e.ancestors.pop(),e.schema=r,e.create(t,a,s,n)}(e,t,n):"mdxjsEsm"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);EG(e,t.position)}(e,t):"root"===t.type?function(e,t,n){const r={};return mG(r,gG(e,t)),e.create(t,e.Fragment,r,n)}(e,t,n):"text"===t.type?function(e,t){return t.value}(0,t):void 0}function pG(e,t,n,r){"string"!=typeof n&&n!==e.Fragment&&e.passNode&&(t.node=r)}function mG(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function gG(e,t){const n=[];let r=-1;const i=e.passKeys?new Map:oG;for(;++r<t.children.length;){const a=t.children[r];let s;if(e.passKeys){const e="element"===a.type?a.tagName:"mdxJsxFlowElement"===a.type||"mdxJsxTextElement"===a.type?a.name:void 0;if(e){const t=i.get(e)||0;s=e+"-"+t,i.set(e,t+1)}}const o=fG(e,a,s);void 0!==o&&n.push(o)}return n}function _G(e,t,n){const r=function(e,t){const n=Xj(t);let r=t,i=Zj;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&NH.test(t)){if("-"===t.charAt(4)){const e=t.slice(5).replace(CH,IH);r="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{const e=t.slice(4);if(!CH.test(e)){let n=e.replace(bH,TH);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}i=uH}return new i(r,t)}(e.schema,t);if(!(null==n||"number"==typeof n&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?function(e,t){const n={};return(""===e[e.length-1]?[...e,""]:e).join((n.padRight?" ":"")+","+(!1===n.padLeft?"":" ")).trim()}(n):n.join(" ").trim()),"style"===r.property){let t="object"==typeof n?n:function(e,t){try{return ZH(t,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const n=t,r=new aG("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=dG+"#cannot-parse-style-attribute",r}}(e,String(n));return"css"===e.stylePropertyNameCase&&(t=function(e){const t={};let n;for(n in e)sG.call(e,n)&&(t[yG(n)]=e[n]);return t}(t)),["style",t]}return["react"===e.elementAttributeNameCase&&r.space?yH[r.property]||r.property:r.attribute,n]}}function vG(e,t,n){let r;if(n)if(t.includes(".")){const e=t.split(".");let n,i=-1;for(;++i<e.length;){const t=qj(e[i])?{type:"Identifier",name:e[i]}:{type:"Literal",value:e[i]};n=n?{type:"MemberExpression",object:n,property:t,computed:Boolean(i&&"Literal"===t.type),optional:!1}:t}r=n}else r=qj(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};else r={type:"Literal",value:t};if("Literal"===r.type){const t=r.value;return sG.call(e.components,t)?e.components[t]:t}if(e.evaluater)return e.evaluater.evaluateExpression(r);EG(e)}function EG(e,t){const n=new aG("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=dG+"#cannot-handle-mdx-estrees-without-createevaluater",n}function yG(e){let t=e.replace(lG,bG);return"ms-"===t.slice(0,3)&&(t="-"+t),t}function bG(e){return"-"+e.toLowerCase()}const CG={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},NG={};function TG(e,t,n){if(function(e){return Boolean(e&&"object"==typeof e)}(e)){if("value"in e)return"html"!==e.type||n?e.value:"";if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return IG(e.children,t,n)}return Array.isArray(e)?IG(e,t,n):""}function IG(e,t,n){const r=[];let i=-1;for(;++i<e.length;)r[i]=TG(e[i],t,n);return r.join("")}const SG=document.createElement("i");function wG(e){const t="&"+e+";";SG.innerHTML=t;const n=SG.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}function AG(e,t,n,r){const i=e.length;let a,s=0;if(t=t<0?-t>i?0:i+t:t>i?i:t,n=n>0?n:0,r.length<1e4)a=Array.from(r),a.unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);s<r.length;)a=r.slice(s,s+1e4),a.unshift(t,0),e.splice(...a),s+=1e4,t+=1e4}function MG(e,t){return e.length>0?(AG(e,e.length,0,t),e):t}const OG={}.hasOwnProperty;function RG(e,t){let n;for(n in t){const r=(OG.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let a;if(i)for(a in i){OG.call(r,a)||(r[a]=[]);const e=i[a];kG(r[a],Array.isArray(e)?e:e?[e]:[])}}}function kG(e,t){let n=-1;const r=[];for(;++n<t.length;)("after"===t[n].add?e:r).push(t[n]);AG(e,0,0,r)}function xG(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"":String.fromCodePoint(n)}function DG(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const UG=WG(/[A-Za-z]/),LG=WG(/[\dA-Za-z]/),PG=WG(/[#-'*+\--9=?A-Z^-~]/);function FG(e){return null!==e&&(e<32||127===e)}const BG=WG(/\d/),jG=WG(/[\dA-Fa-f]/),HG=WG(/[!-/:-@[-`{-~]/);function GG(e){return null!==e&&e<-2}function zG(e){return null!==e&&(e<0||32===e)}function VG(e){return-2===e||-1===e||32===e}const qG=WG(new RegExp("\\p{P}|\\p{S}","u")),KG=WG(/\s/);function WG(e){return function(t){return null!==t&&t>-1&&e.test(String.fromCharCode(t))}}function YG(e){const t=[];let n=-1,r=0,i=0;for(;++n<e.length;){const a=e.charCodeAt(n);let s="";if(37===a&&LG(e.charCodeAt(n+1))&&LG(e.charCodeAt(n+2)))i=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(s=String.fromCharCode(a));else if(a>55295&&a<57344){const t=e.charCodeAt(n+1);a<56320&&t>56319&&t<57344?(s=String.fromCharCode(a,t),i=1):s=""}else s=String.fromCharCode(a);s&&(t.push(e.slice(r,n),encodeURIComponent(s)),r=n+i+1,s=""),i&&(n+=i,i=0)}return t.join("")+e.slice(r)}function QG(e,t,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let a=0;return function(r){if(VG(r))return e.enter(n),s(r);return t(r)};function s(r){return VG(r)&&a++<i?(e.consume(r),s):(e.exit(n),t(r))}}const XG={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,(function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),QG(e,t,"linePrefix")}),(function(t){return e.enter("paragraph"),r(t)}));let n;return t;function r(t){const r=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=r),n=r,i(t)}function i(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):GG(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),i)}}};const ZG={tokenize:function(e){const t=this,n=[];let r,i,a,s=0;return o;function o(r){if(s<n.length){const i=n[s];return t.containerState=i[1],e.attempt(i[0].continuation,l,u)(r)}return u(r)}function l(e){if(s++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&v();const n=t.events.length;let i,a=n;for(;a--;)if("exit"===t.events[a][0]&&"chunkFlow"===t.events[a][1].type){i=t.events[a][1].end;break}_(s);let o=n;for(;o<t.events.length;)t.events[o][1].end={...i},o++;return AG(t.events,a+1,0,t.events.slice(n)),t.events.length=o,u(e)}return o(e)}function u(i){if(s===n.length){if(!r)return h(i);if(r.currentConstruct&&r.currentConstruct.concrete)return p(i);t.interrupt=Boolean(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(JG,c,d)(i)}function c(e){return r&&v(),_(s),h(e)}function d(e){return t.parser.lazy[t.now().line]=s!==n.length,a=t.now().offset,p(e)}function h(n){return t.containerState={},e.attempt(JG,f,p)(n)}function f(e){return s++,n.push([t.currentConstruct,t.containerState]),h(e)}function p(n){return null===n?(r&&v(),_(0),void e.consume(n)):(r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:r,contentType:"flow",previous:i}),m(n))}function m(n){return null===n?(g(e.exit("chunkFlow"),!0),_(0),void e.consume(n)):GG(n)?(e.consume(n),g(e.exit("chunkFlow")),s=0,t.interrupt=void 0,o):(e.consume(n),m)}function g(e,n){const o=t.sliceStream(e);if(n&&o.push(null),e.previous=i,i&&(i.next=e),i=e,r.defineSkip(e.start),r.write(o),t.parser.lazy[e.start.line]){let e=r.events.length;for(;e--;)if(r.events[e][1].start.offset<a&&(!r.events[e][1].end||r.events[e][1].end.offset>a))return;const n=t.events.length;let i,o,l=n;for(;l--;)if("exit"===t.events[l][0]&&"chunkFlow"===t.events[l][1].type){if(i){o=t.events[l][1].end;break}i=!0}for(_(s),e=n;e<t.events.length;)t.events[e][1].end={...o},e++;AG(t.events,l+1,0,t.events.slice(n)),t.events.length=e}}function _(r){let i=n.length;for(;i-- >r;){const r=n[i];t.containerState=r[1],r[0].exit.call(t,e)}n.length=r}function v(){r.write([null]),i=void 0,r=void 0,t.containerState._closeFlow=void 0}}},JG={tokenize:function(e,t,n){return QG(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};function $G(e){return null===e||zG(e)||KG(e)?1:qG(e)?2:void 0}function ez(e,t,n){const r=[];let i=-1;for(;++i<e.length;){const a=e[i].resolveAll;a&&!r.includes(a)&&(t=a(t,n),r.push(a))}return t}const tz={name:"attention",resolveAll:function(e,t){let n,r,i,a,s,o,l,u,c=-1;for(;++c<e.length;)if("enter"===e[c][0]&&"attentionSequence"===e[c][1].type&&e[c][1]._close)for(n=c;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[c][1]).charCodeAt(0)){if((e[n][1]._close||e[c][1]._open)&&(e[c][1].end.offset-e[c][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[c][1].end.offset-e[c][1].start.offset)%3))continue;o=e[n][1].end.offset-e[n][1].start.offset>1&&e[c][1].end.offset-e[c][1].start.offset>1?2:1;const d={...e[n][1].end},h={...e[c][1].start};nz(d,-o),nz(h,o),a={type:o>1?"strongSequence":"emphasisSequence",start:d,end:{...e[n][1].end}},s={type:o>1?"strongSequence":"emphasisSequence",start:{...e[c][1].start},end:h},i={type:o>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[c][1].start}},r={type:o>1?"strong":"emphasis",start:{...a.start},end:{...s.end}},e[n][1].end={...a.start},e[c][1].start={...s.end},l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=MG(l,[["enter",e[n][1],t],["exit",e[n][1],t]])),l=MG(l,[["enter",r,t],["enter",a,t],["exit",a,t],["enter",i,t]]),l=MG(l,ez(t.parser.constructs.insideSpan.null,e.slice(n+1,c),t)),l=MG(l,[["exit",i,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[c][1].end.offset-e[c][1].start.offset?(u=2,l=MG(l,[["enter",e[c][1],t],["exit",e[c][1],t]])):u=0,AG(e,n-1,c-n+3,l),c=n+l.length-u-2;break}c=-1;for(;++c<e.length;)"attentionSequence"===e[c][1].type&&(e[c][1].type="data");return e},tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=$G(r);let a;return function(t){return a=t,e.enter("attentionSequence"),s(t)};function s(o){if(o===a)return e.consume(o),s;const l=e.exit("attentionSequence"),u=$G(o),c=!u||2===u&&i||n.includes(o),d=!i||2===i&&u||n.includes(r);return l._open=Boolean(42===a?c:c&&(i||!d)),l._close=Boolean(42===a?d:d&&(u||!c)),t(o)}}};function nz(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const rz={name:"autolink",tokenize:function(e,t,n){let r=0;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i};function i(t){return UG(t)?(e.consume(t),a):64===t?n(t):l(t)}function a(e){return 43===e||45===e||46===e||LG(e)?(r=1,s(e)):l(e)}function s(t){return 58===t?(e.consume(t),r=0,o):(43===t||45===t||46===t||LG(t))&&r++<32?(e.consume(t),s):(r=0,l(t))}function o(r){return 62===r?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(r),e.exit("autolinkMarker"),e.exit("autolink"),t):null===r||32===r||60===r||FG(r)?n(r):(e.consume(r),o)}function l(t){return 64===t?(e.consume(t),u):PG(t)?(e.consume(t),l):n(t)}function u(e){return LG(e)?c(e):n(e)}function c(n){return 46===n?(e.consume(n),r=0,u):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):d(n)}function d(t){if((45===t||LG(t))&&r++<63){const n=45===t?d:c;return e.consume(t),n}return n(t)}}};const iz={partial:!0,tokenize:function(e,t,n){return function(t){return VG(t)?QG(e,r,"linePrefix")(t):r(t)};function r(e){return null===e||GG(e)?t(e):n(e)}}};const az={continuation:{tokenize:function(e,t,n){const r=this;return function(t){if(VG(t))return QG(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t);return i(t)};function i(r){return e.attempt(az,t,n)(r)}}},exit:function(e){e.exit("blockQuote")},name:"blockQuote",tokenize:function(e,t,n){const r=this;return function(t){if(62===t){const n=r.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),i}return n(t)};function i(n){return VG(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}};const sz={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return HG(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(r)}}};const oz={name:"characterReference",tokenize:function(e,t,n){const r=this;let i,a,s=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),o};function o(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),l):(e.enter("characterReferenceValue"),i=31,a=LG,u(t))}function l(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,a=jG,u):(e.enter("characterReferenceValue"),i=7,a=BG,u(t))}function u(o){if(59===o&&s){const i=e.exit("characterReferenceValue");return a!==LG||wG(r.sliceSerialize(i))?(e.enter("characterReferenceMarker"),e.consume(o),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(o)}return a(o)&&s++<i?(e.consume(o),u):n(o)}}};const lz={partial:!0,tokenize:function(e,t,n){const r=this;return function(t){if(null===t)return n(t);return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i};function i(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}},uz={concrete:!0,name:"codeFenced",tokenize:function(e,t,n){const r=this,i={partial:!0,tokenize:function(e,t,n){let i=0;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s};function s(t){return e.enter("codeFencedFence"),VG(t)?QG(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):l(t)}function l(t){return t===a?(e.enter("codeFencedFenceSequence"),u(t)):n(t)}function u(t){return t===a?(i++,e.consume(t),u):i>=o?(e.exit("codeFencedFenceSequence"),VG(t)?QG(e,c,"whitespace")(t):c(t)):n(t)}function c(r){return null===r||GG(r)?(e.exit("codeFencedFence"),t(r)):n(r)}}};let a,s=0,o=0;return function(t){return function(t){const n=r.events[r.events.length-1];return s=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,a=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),l(t)}(t)};function l(t){return t===a?(o++,e.consume(t),l):o<3?n(t):(e.exit("codeFencedFenceSequence"),VG(t)?QG(e,u,"whitespace")(t):u(t))}function u(n){return null===n||GG(n)?(e.exit("codeFencedFence"),r.interrupt?t(n):e.check(lz,f,v)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),c(n))}function c(t){return null===t||GG(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),u(t)):VG(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),QG(e,d,"whitespace")(t)):96===t&&t===a?n(t):(e.consume(t),c)}function d(t){return null===t||GG(t)?u(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),h(t))}function h(t){return null===t||GG(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),u(t)):96===t&&t===a?n(t):(e.consume(t),h)}function f(t){return e.attempt(i,v,p)(t)}function p(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),m}function m(t){return s>0&&VG(t)?QG(e,g,"linePrefix",s+1)(t):g(t)}function g(t){return null===t||GG(t)?e.check(lz,f,v)(t):(e.enter("codeFlowValue"),_(t))}function _(t){return null===t||GG(t)?(e.exit("codeFlowValue"),g(t)):(e.consume(t),_)}function v(n){return e.exit("codeFenced"),t(n)}}};const cz={name:"codeIndented",tokenize:function(e,t,n){const r=this;return function(t){return e.enter("codeIndented"),QG(e,i,"linePrefix",5)(t)};function i(e){const t=r.events[r.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?a(e):n(e)}function a(t){return null===t?o(t):GG(t)?e.attempt(dz,a,o)(t):(e.enter("codeFlowValue"),s(t))}function s(t){return null===t||GG(t)?(e.exit("codeFlowValue"),a(t)):(e.consume(t),s)}function o(n){return e.exit("codeIndented"),t(n)}}},dz={partial:!0,tokenize:function(e,t,n){const r=this;return i;function i(t){return r.parser.lazy[r.now().line]?n(t):GG(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i):QG(e,a,"linePrefix",5)(t)}function a(e){const a=r.events[r.events.length-1];return a&&"linePrefix"===a[1].type&&a[2].sliceSerialize(a[1],!0).length>=4?t(e):GG(e)?i(e):n(e)}}};const hz={name:"codeText",previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type},resolve:function(e){let t,n,r=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[r][1].type&&"space"!==e[r][1].type))for(t=i;++t<r;)if("codeTextData"===e[t][1].type){e[i][1].type="codeTextPadding",e[r][1].type="codeTextPadding",i+=2,r-=2;break}t=i-1,r++;for(;++t<=r;)void 0===n?t!==r&&"lineEnding"!==e[t][1].type&&(n=t):t!==r&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),r-=t-n-2,t=n+2),n=void 0);return e},tokenize:function(e,t,n){let r,i,a=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),a++,s):(e.exit("codeTextSequence"),o(t))}function o(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),o):96===t?(i=e.enter("codeTextSequence"),r=0,u(t)):GG(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):(e.enter("codeTextData"),l(t))}function l(t){return null===t||32===t||96===t||GG(t)?(e.exit("codeTextData"),o(t)):(e.consume(t),l)}function u(n){return 96===n?(e.consume(n),r++,u):r===a?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(i.type="codeTextData",l(n))}}};class fz{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const n=null==t?Number.POSITIVE_INFINITY:t;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,t,n){const r=t||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return n&&pz(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),pz(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),pz(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&0===this.right.length||e<0&&0===this.left.length))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);pz(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);pz(this.left,t.reverse())}}}function pz(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function mz(e){const t={};let n,r,i,a,s,o,l,u=-1;const c=new fz(e);for(;++u<c.length;){for(;u in t;)u=t[u];if(n=c.get(u),u&&"chunkFlow"===n[1].type&&"listItemPrefix"===c.get(u-1)[1].type&&(o=n[1]._tokenizer.events,i=0,i<o.length&&"lineEndingBlank"===o[i][1].type&&(i+=2),i<o.length&&"content"===o[i][1].type))for(;++i<o.length&&"content"!==o[i][1].type;)"chunkText"===o[i][1].type&&(o[i][1]._isInFirstContentOfListItem=!0,i++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,gz(c,u)),u=t[u],l=!0);else if(n[1]._container){for(i=u,r=void 0;i--;)if(a=c.get(i),"lineEnding"===a[1].type||"lineEndingBlank"===a[1].type)"enter"===a[0]&&(r&&(c.get(r)[1].type="lineEndingBlank"),a[1].type="lineEnding",r=i);else if("linePrefix"!==a[1].type&&"listItemIndent"!==a[1].type)break;r&&(n[1].end={...c.get(r)[1].start},s=c.slice(r,u),s.unshift(n),c.splice(r,u-r+1,s))}}return AG(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!l}function gz(e,t){const n=e.get(t)[1],r=e.get(t)[2];let i=t-1;const a=[];let s=n._tokenizer;s||(s=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(s._contentTypeTextTrailing=!0));const o=s.events,l=[],u={};let c,d,h=-1,f=n,p=0,m=0;const g=[m];for(;f;){for(;e.get(++i)[1]!==f;);a.push(i),f._tokenizer||(c=r.sliceStream(f),f.next||c.push(null),d&&s.defineSkip(f.start),f._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(c),f._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),d=f,f=f.next}for(f=n;++h<o.length;)"exit"===o[h][0]&&"enter"===o[h-1][0]&&o[h][1].type===o[h-1][1].type&&o[h][1].start.line!==o[h][1].end.line&&(m=h+1,g.push(m),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(s.events=[],f?(f._tokenizer=void 0,f.previous=void 0):g.pop(),h=g.length;h--;){const t=o.slice(g[h],g[h+1]),n=a.pop();l.push([n,n+t.length-1]),e.splice(n,2,t)}for(l.reverse(),h=-1;++h<l.length;)u[p+l[h][0]]=p+l[h][1],p+=l[h][1]-l[h][0]-1;return u}const _z={resolve:function(e){return mz(e),e},tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?i(t):GG(t)?e.check(vz,a,i)(t):(e.consume(t),r)}function i(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function a(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}},vz={partial:!0,tokenize:function(e,t,n){const r=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),QG(e,i,"linePrefix")};function i(i){if(null===i||GG(i))return n(i);const a=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&a&&"linePrefix"===a[1].type&&a[2].sliceSerialize(a[1],!0).length>=4?t(i):e.interrupt(r.parser.constructs.flow,n,t)(i)}}};function Ez(e,t,n,r,i,a,s,o,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return function(t){if(60===t)return e.enter(r),e.enter(i),e.enter(a),e.consume(t),e.exit(a),d;if(null===t||32===t||41===t||FG(t))return n(t);return e.enter(r),e.enter(s),e.enter(o),e.enter("chunkString",{contentType:"string"}),p(t)};function d(n){return 62===n?(e.enter(a),e.consume(n),e.exit(a),e.exit(i),e.exit(r),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),h(n))}function h(t){return 62===t?(e.exit("chunkString"),e.exit(o),d(t)):null===t||60===t||GG(t)?n(t):(e.consume(t),92===t?f:h)}function f(t){return 60===t||62===t||92===t?(e.consume(t),h):h(t)}function p(i){return c||null!==i&&41!==i&&!zG(i)?c<u&&40===i?(e.consume(i),c++,p):41===i?(e.consume(i),c--,p):null===i||32===i||40===i||FG(i)?n(i):(e.consume(i),92===i?m:p):(e.exit("chunkString"),e.exit(o),e.exit(s),e.exit(r),t(i))}function m(t){return 40===t||41===t||92===t?(e.consume(t),p):p(t)}}function yz(e,t,n,r,i,a){const s=this;let o,l=0;return function(t){return e.enter(r),e.enter(i),e.consume(t),e.exit(i),e.enter(a),u};function u(d){return l>999||null===d||91===d||93===d&&!o||94===d&&!l&&"_hiddenFootnoteSupport"in s.parser.constructs?n(d):93===d?(e.exit(a),e.enter(i),e.consume(d),e.exit(i),e.exit(r),t):GG(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),c(d))}function c(t){return null===t||91===t||93===t||GG(t)||l++>999?(e.exit("chunkString"),u(t)):(e.consume(t),o||(o=!VG(t)),92===t?d:c)}function d(t){return 91===t||92===t||93===t?(e.consume(t),l++,c):c(t)}}function bz(e,t,n,r,i,a){let s;return function(t){if(34===t||39===t||40===t)return e.enter(r),e.enter(i),e.consume(t),e.exit(i),s=40===t?41:t,o;return n(t)};function o(n){return n===s?(e.enter(i),e.consume(n),e.exit(i),e.exit(r),t):(e.enter(a),l(n))}function l(t){return t===s?(e.exit(a),o(s)):null===t?n(t):GG(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),QG(e,l,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(t))}function u(t){return t===s||null===t||GG(t)?(e.exit("chunkString"),l(t)):(e.consume(t),92===t?c:u)}function c(t){return t===s||92===t?(e.consume(t),u):u(t)}}function Cz(e,t){let n;return function r(i){if(GG(i))return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),n=!0,r;if(VG(i))return QG(e,r,n?"linePrefix":"lineSuffix")(i);return t(i)}}const Nz={name:"definition",tokenize:function(e,t,n){const r=this;let i;return function(t){return e.enter("definition"),function(t){return yz.call(r,e,a,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}(t)};function a(t){return i=DG(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),s):n(t)}function s(t){return zG(t)?Cz(e,o)(t):o(t)}function o(t){return Ez(e,l,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function l(t){return e.attempt(Tz,u,u)(t)}function u(t){return VG(t)?QG(e,c,"whitespace")(t):c(t)}function c(a){return null===a||GG(a)?(e.exit("definition"),r.parser.defined.push(i),t(a)):n(a)}}},Tz={partial:!0,tokenize:function(e,t,n){return function(t){return zG(t)?Cz(e,r)(t):n(t)};function r(t){return bz(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function i(t){return VG(t)?QG(e,a,"whitespace")(t):a(t)}function a(e){return null===e||GG(e)?t(e):n(e)}}};const Iz={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.consume(t),r};function r(r){return GG(r)?(e.exit("hardBreakEscape"),t(r)):n(r)}}};const Sz={name:"headingAtx",resolve:function(e,t){let n,r,i=e.length-2,a=3;"whitespace"===e[a][1].type&&(a+=2);i-2>a&&"whitespace"===e[i][1].type&&(i-=2);"atxHeadingSequence"===e[i][1].type&&(a===i-1||i-4>a&&"whitespace"===e[i-2][1].type)&&(i-=a+1===i?2:4);i>a&&(n={type:"atxHeadingText",start:e[a][1].start,end:e[i][1].end},r={type:"chunkText",start:e[a][1].start,end:e[i][1].end,contentType:"text"},AG(e,a,i-a+1,[["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]]));return e},tokenize:function(e,t,n){let r=0;return function(t){return e.enter("atxHeading"),function(t){return e.enter("atxHeadingSequence"),i(t)}(t)};function i(t){return 35===t&&r++<6?(e.consume(t),i):null===t||zG(t)?(e.exit("atxHeadingSequence"),a(t)):n(t)}function a(n){return 35===n?(e.enter("atxHeadingSequence"),s(n)):null===n||GG(n)?(e.exit("atxHeading"),t(n)):VG(n)?QG(e,a,"whitespace")(n):(e.enter("atxHeadingText"),o(n))}function s(t){return 35===t?(e.consume(t),s):(e.exit("atxHeadingSequence"),a(t))}function o(t){return null===t||35===t||zG(t)?(e.exit("atxHeadingText"),a(t)):(e.consume(t),o)}}};const wz=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Az=["pre","script","style","textarea"],Mz={concrete:!0,name:"htmlFlow",resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},tokenize:function(e,t,n){const r=this;let i,a,s,o,l;return function(t){return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),u}(t)};function u(o){return 33===o?(e.consume(o),c):47===o?(e.consume(o),a=!0,f):63===o?(e.consume(o),i=3,r.interrupt?t:D):UG(o)?(e.consume(o),s=String.fromCharCode(o),p):n(o)}function c(a){return 45===a?(e.consume(a),i=2,d):91===a?(e.consume(a),i=5,o=0,h):UG(a)?(e.consume(a),i=4,r.interrupt?t:D):n(a)}function d(i){return 45===i?(e.consume(i),r.interrupt?t:D):n(i)}function h(i){return i==="CDATA[".charCodeAt(o++)?(e.consume(i),o==="CDATA[".length?r.interrupt?t:S:h):n(i)}function f(t){return UG(t)?(e.consume(t),s=String.fromCharCode(t),p):n(t)}function p(o){if(null===o||47===o||62===o||zG(o)){const l=47===o,u=s.toLowerCase();return l||a||!Az.includes(u)?wz.includes(s.toLowerCase())?(i=6,l?(e.consume(o),m):r.interrupt?t(o):S(o)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(o):a?g(o):_(o)):(i=1,r.interrupt?t(o):S(o))}return 45===o||LG(o)?(e.consume(o),s+=String.fromCharCode(o),p):n(o)}function m(i){return 62===i?(e.consume(i),r.interrupt?t:S):n(i)}function g(t){return VG(t)?(e.consume(t),g):T(t)}function _(t){return 47===t?(e.consume(t),T):58===t||95===t||UG(t)?(e.consume(t),v):VG(t)?(e.consume(t),_):T(t)}function v(t){return 45===t||46===t||58===t||95===t||LG(t)?(e.consume(t),v):E(t)}function E(t){return 61===t?(e.consume(t),y):VG(t)?(e.consume(t),E):_(t)}function y(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,b):VG(t)?(e.consume(t),y):C(t)}function b(t){return t===l?(e.consume(t),l=null,N):null===t||GG(t)?n(t):(e.consume(t),b)}function C(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||zG(t)?E(t):(e.consume(t),C)}function N(e){return 47===e||62===e||VG(e)?_(e):n(e)}function T(t){return 62===t?(e.consume(t),I):n(t)}function I(t){return null===t||GG(t)?S(t):VG(t)?(e.consume(t),I):n(t)}function S(t){return 45===t&&2===i?(e.consume(t),O):60===t&&1===i?(e.consume(t),R):62===t&&4===i?(e.consume(t),U):63===t&&3===i?(e.consume(t),D):93===t&&5===i?(e.consume(t),x):!GG(t)||6!==i&&7!==i?null===t||GG(t)?(e.exit("htmlFlowData"),w(t)):(e.consume(t),S):(e.exit("htmlFlowData"),e.check(Oz,L,w)(t))}function w(t){return e.check(Rz,A,L)(t)}function A(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),M}function M(t){return null===t||GG(t)?w(t):(e.enter("htmlFlowData"),S(t))}function O(t){return 45===t?(e.consume(t),D):S(t)}function R(t){return 47===t?(e.consume(t),s="",k):S(t)}function k(t){if(62===t){const n=s.toLowerCase();return Az.includes(n)?(e.consume(t),U):S(t)}return UG(t)&&s.length<8?(e.consume(t),s+=String.fromCharCode(t),k):S(t)}function x(t){return 93===t?(e.consume(t),D):S(t)}function D(t){return 62===t?(e.consume(t),U):45===t&&2===i?(e.consume(t),D):S(t)}function U(t){return null===t||GG(t)?(e.exit("htmlFlowData"),L(t)):(e.consume(t),U)}function L(n){return e.exit("htmlFlow"),t(n)}}},Oz={partial:!0,tokenize:function(e,t,n){return function(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(iz,t,n)}}},Rz={partial:!0,tokenize:function(e,t,n){const r=this;return function(t){if(GG(t))return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i;return n(t)};function i(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}};const kz={name:"htmlText",tokenize:function(e,t,n){const r=this;let i,a,s;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),o};function o(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),y):63===t?(e.consume(t),v):UG(t)?(e.consume(t),N):n(t)}function l(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),a=0,f):UG(t)?(e.consume(t),_):n(t)}function u(t){return 45===t?(e.consume(t),h):n(t)}function c(t){return null===t?n(t):45===t?(e.consume(t),d):GG(t)?(s=c,k(t)):(e.consume(t),c)}function d(t){return 45===t?(e.consume(t),h):c(t)}function h(e){return 62===e?R(e):45===e?d(e):c(e)}function f(t){return t==="CDATA[".charCodeAt(a++)?(e.consume(t),a==="CDATA[".length?p:f):n(t)}function p(t){return null===t?n(t):93===t?(e.consume(t),m):GG(t)?(s=p,k(t)):(e.consume(t),p)}function m(t){return 93===t?(e.consume(t),g):p(t)}function g(t){return 62===t?R(t):93===t?(e.consume(t),g):p(t)}function _(t){return null===t||62===t?R(t):GG(t)?(s=_,k(t)):(e.consume(t),_)}function v(t){return null===t?n(t):63===t?(e.consume(t),E):GG(t)?(s=v,k(t)):(e.consume(t),v)}function E(e){return 62===e?R(e):v(e)}function y(t){return UG(t)?(e.consume(t),b):n(t)}function b(t){return 45===t||LG(t)?(e.consume(t),b):C(t)}function C(t){return GG(t)?(s=C,k(t)):VG(t)?(e.consume(t),C):R(t)}function N(t){return 45===t||LG(t)?(e.consume(t),N):47===t||62===t||zG(t)?T(t):n(t)}function T(t){return 47===t?(e.consume(t),R):58===t||95===t||UG(t)?(e.consume(t),I):GG(t)?(s=T,k(t)):VG(t)?(e.consume(t),T):R(t)}function I(t){return 45===t||46===t||58===t||95===t||LG(t)?(e.consume(t),I):S(t)}function S(t){return 61===t?(e.consume(t),w):GG(t)?(s=S,k(t)):VG(t)?(e.consume(t),S):T(t)}function w(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),i=t,A):GG(t)?(s=w,k(t)):VG(t)?(e.consume(t),w):(e.consume(t),M)}function A(t){return t===i?(e.consume(t),i=void 0,O):null===t?n(t):GG(t)?(s=A,k(t)):(e.consume(t),A)}function M(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||zG(t)?T(t):(e.consume(t),M)}function O(e){return 47===e||62===e||zG(e)?T(e):n(e)}function R(r){return 62===r?(e.consume(r),e.exit("htmlTextData"),e.exit("htmlText"),t):n(r)}function k(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),x}function x(t){return VG(t)?QG(e,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):D(t)}function D(t){return e.enter("htmlTextData"),s(t)}}};const xz={name:"labelEnd",resolveAll:function(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),"labelImage"===r.type||"labelLink"===r.type||"labelEnd"===r.type){const e="labelImage"===r.type?4:2;r.type="data",t+=e}}e.length!==n.length&&AG(e,0,e.length,n);return e},resolveTo:function(e,t){let n,r,i,a,s=e.length,o=0;for(;s--;)if(n=e[s][1],r){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[s][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(i){if("enter"===e[s][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(r=s,"labelLink"!==n.type)){o=2;break}}else"labelEnd"===n.type&&(i=s);const l={type:"labelLink"===e[r][1].type?"link":"image",start:{...e[r][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[r][1].start},end:{...e[i][1].end}},c={type:"labelText",start:{...e[r+o+2][1].end},end:{...e[i-2][1].start}};return a=[["enter",l,t],["enter",u,t]],a=MG(a,e.slice(r+1,r+o+3)),a=MG(a,[["enter",c,t]]),a=MG(a,ez(t.parser.constructs.insideSpan.null,e.slice(r+o+4,i-3),t)),a=MG(a,[["exit",c,t],e[i-2],e[i-1],["exit",u,t]]),a=MG(a,e.slice(i+1)),a=MG(a,[["exit",l,t]]),AG(e,r,e.length,a),e},tokenize:function(e,t,n){const r=this;let i,a,s=r.events.length;for(;s--;)if(("labelImage"===r.events[s][1].type||"labelLink"===r.events[s][1].type)&&!r.events[s][1]._balanced){i=r.events[s][1];break}return function(t){if(!i)return n(t);if(i._inactive)return c(t);return a=r.parser.defined.includes(DG(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),o};function o(t){return 40===t?e.attempt(Dz,u,a?u:c)(t):91===t?e.attempt(Uz,u,a?l:c)(t):a?u(t):c(t)}function l(t){return e.attempt(Lz,u,c)(t)}function u(e){return t(e)}function c(e){return i._balanced=!0,n(e)}}},Dz={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),r};function r(t){return zG(t)?Cz(e,i)(t):i(t)}function i(t){return 41===t?u(t):Ez(e,a,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function a(t){return zG(t)?Cz(e,o)(t):u(t)}function s(e){return n(e)}function o(t){return 34===t||39===t||40===t?bz(e,l,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):u(t)}function l(t){return zG(t)?Cz(e,u)(t):u(t)}function u(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):n(r)}}},Uz={tokenize:function(e,t,n){const r=this;return function(t){return yz.call(r,e,i,a,"reference","referenceMarker","referenceString")(t)};function i(e){return r.parser.defined.includes(DG(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function a(e){return n(e)}}},Lz={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),r};function r(r){return 93===r?(e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),e.exit("reference"),t):n(r)}}};const Pz={name:"labelStartImage",resolveAll:xz.resolveAll,tokenize:function(e,t,n){const r=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),a):n(t)}function a(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}}};const Fz={name:"labelStartLink",resolveAll:xz.resolveAll,tokenize:function(e,t,n){const r=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}}};const Bz={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),QG(e,t,"linePrefix")}}};const jz={name:"thematicBreak",tokenize:function(e,t,n){let r,i=0;return function(t){return e.enter("thematicBreak"),function(e){return r=e,a(e)}(t)};function a(a){return a===r?(e.enter("thematicBreakSequence"),s(a)):i>=3&&(null===a||GG(a))?(e.exit("thematicBreak"),t(a)):n(a)}function s(t){return t===r?(e.consume(t),i++,s):(e.exit("thematicBreakSequence"),VG(t)?QG(e,a,"whitespace")(t):a(t))}}};const Hz={continuation:{tokenize:function(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(iz,(function(n){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,QG(e,t,"listItemIndent",r.containerState.size+1)(n)}),(function(n){if(r.containerState.furtherBlankLines||!VG(n))return r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,i(n);return r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(zz,t,i)(n)}));function i(i){return r.containerState._closeFlow=!0,r.interrupt=void 0,QG(e,e.attempt(Hz,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)},name:"list",tokenize:function(e,t,n){const r=this,i=r.events[r.events.length-1];let a=i&&"linePrefix"===i[1].type?i[2].sliceSerialize(i[1],!0).length:0,s=0;return function(t){const i=r.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!r.containerState.marker||t===r.containerState.marker:BG(t)){if(r.containerState.type||(r.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(jz,n,l)(t):l(t);if(!r.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),o(t)}return n(t)};function o(t){return BG(t)&&++s<10?(e.consume(t),o):(!r.interrupt||s<2)&&(r.containerState.marker?t===r.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),l(t)):n(t)}function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||t,e.check(iz,r.interrupt?n:u,e.attempt(Gz,d,c))}function u(e){return r.containerState.initialBlankLine=!0,a++,d(e)}function c(t){return VG(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),d):n(t)}function d(n){return r.containerState.size=a+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}},Gz={partial:!0,tokenize:function(e,t,n){const r=this;return QG(e,(function(e){const i=r.events[r.events.length-1];return!VG(e)&&i&&"listItemPrefixWhitespace"===i[1].type?t(e):n(e)}),"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5)}},zz={partial:!0,tokenize:function(e,t,n){const r=this;return QG(e,(function(e){const i=r.events[r.events.length-1];return i&&"listItemIndent"===i[1].type&&i[2].sliceSerialize(i[1],!0).length===r.containerState.size?t(e):n(e)}),"listItemIndent",r.containerState.size+1)}};const Vz={name:"setextUnderline",resolveTo:function(e,t){let n,r,i,a=e.length;for(;a--;)if("enter"===e[a][0]){if("content"===e[a][1].type){n=a;break}"paragraph"===e[a][1].type&&(r=a)}else"content"===e[a][1].type&&e.splice(a,1),i||"definition"!==e[a][1].type||(i=a);const s={type:"setextHeading",start:{...e[n][1].start},end:{...e[e.length-1][1].end}};e[r][1].type="setextHeadingText",i?(e.splice(r,0,["enter",s,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end={...e[i][1].end}):e[n][1]=s;return e.push(["exit",s,t]),e},tokenize:function(e,t,n){const r=this;let i;return function(t){let s,o=r.events.length;for(;o--;)if("lineEnding"!==r.events[o][1].type&&"linePrefix"!==r.events[o][1].type&&"content"!==r.events[o][1].type){s="paragraph"===r.events[o][1].type;break}if(!r.parser.lazy[r.now().line]&&(r.interrupt||s))return e.enter("setextHeadingLine"),i=t,function(t){return e.enter("setextHeadingLineSequence"),a(t)}(t);return n(t)};function a(t){return t===i?(e.consume(t),a):(e.exit("setextHeadingLineSequence"),VG(t)?QG(e,s,"lineSuffix")(t):s(t))}function s(r){return null===r||GG(r)?(e.exit("setextHeadingLine"),t(r)):n(r)}}};const qz={tokenize:function(e){const t=this,n=e.attempt(iz,(function(r){if(null===r)return void e.consume(r);return e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,r,QG(e,e.attempt(this.parser.constructs.flow,r,e.attempt(_z,r)),"linePrefix")));return n;function r(r){if(null!==r)return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(r)}}};const Kz={resolveAll:Xz()},Wz=Qz("string"),Yz=Qz("text");function Qz(e){return{resolveAll:Xz("text"===e?Zz:void 0),tokenize:function(t){const n=this,r=this.parser.constructs[e],i=t.attempt(r,a,s);return a;function a(e){return l(e)?i(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),o)}function l(e){if(null===e)return!0;const t=r[e];let i=-1;if(t)for(;++i<t.length;){const e=t[i];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}}function Xz(e){return function(t,n){let r,i=-1;for(;++i<=t.length;)void 0===r?t[i]&&"data"===t[i][1].type&&(r=i,i++):t[i]&&"data"===t[i][1].type||(i!==r+2&&(t[r][1].end=t[i-1][1].end,t.splice(r+2,i-r-2),i=r+2),r=void 0);return e?e(t,n):t}}function Zz(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const r=e[n-1][1],i=t.sliceStream(r);let a,s=i.length,o=-1,l=0;for(;s--;){const e=i[s];if("string"==typeof e){for(o=e.length;32===e.charCodeAt(o-1);)l++,o--;if(o)break;o=-1}else if(-2===e)a=!0,l++;else if(-1!==e){s++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(l=0),l){const i={type:n===e.length||a||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:r.start._bufferIndex+o,_index:r.start._index+s,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...i.start},r.start.offset===r.end.offset?Object.assign(r,i):(e.splice(n,0,["enter",i,t],["exit",i,t]),n+=2)}n++}return e}const Jz={42:Hz,43:Hz,45:Hz,48:Hz,49:Hz,50:Hz,51:Hz,52:Hz,53:Hz,54:Hz,55:Hz,56:Hz,57:Hz,62:az},$z={91:Nz},eV={[-2]:cz,[-1]:cz,32:cz},tV={35:Sz,42:jz,45:[Vz,jz],60:Mz,61:Vz,95:jz,96:uz,126:uz},nV={38:oz,92:sz},rV={[-5]:Bz,[-4]:Bz,[-3]:Bz,33:Pz,38:oz,42:tz,60:[rz,kz],91:Fz,92:[Iz,sz],93:xz,95:tz,96:hz},iV={null:[tz,Kz]},aV=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:{null:[42,95]},contentInitial:$z,disable:{null:[]},document:Jz,flow:tV,flowInitial:eV,insideSpan:iV,string:nV,text:rV},Symbol.toStringTag,{value:"Module"}));function sV(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},a=[];let s=[],o=[];const l={attempt:g((function(e,t){_(e,t.from)})),check:g(m),consume:function(e){GG(e)?(r.line++,r.column=1,r.offset+=-3===e?2:1,v()):-1!==e&&(r.column++,r.offset++);r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++));u.previous=e},enter:function(e,t){const n=t||{};return n.type=e,n.start=h(),u.events.push(["enter",n,u]),o.push(n),n},exit:function(e){const t=o.pop();return t.end=h(),u.events.push(["exit",t,u]),t},interrupt:g(m,{interrupt:!0})},u={code:null,containerState:{},defineSkip:function(e){i[e.line]=e.column,v()},events:[],now:h,parser:e,previous:null,sliceSerialize:function(e,t){return function(e,t){let n=-1;const r=[];let i;for(;++n<e.length;){const a=e[n];let s;if("string"==typeof a)s=a;else switch(a){case-5:s="\r";break;case-4:s="\n";break;case-3:s="\r\n";break;case-2:s=t?" ":"\t";break;case-1:if(!t&&i)continue;s=" ";break;default:s=String.fromCharCode(a)}i=-2===a,r.push(s)}return r.join("")}(d(e),t)},sliceStream:d,write:function(e){if(s=MG(s,e),f(),null!==s[s.length-1])return[];return _(t,0),u.events=ez(a,u.events,u),u.events}};let c=t.tokenize.call(u,l);return t.resolveAll&&a.push(t),u;function d(e){return function(e,t){const n=t.start._index,r=t.start._bufferIndex,i=t.end._index,a=t.end._bufferIndex;let s;if(n===i)s=[e[n].slice(r,a)];else{if(s=e.slice(n,i),r>-1){const e=s[0];"string"==typeof e?s[0]=e.slice(r):s.shift()}a>0&&s.push(e[i].slice(0,a))}return s}(s,e)}function h(){const{_bufferIndex:e,_index:t,line:n,column:i,offset:a}=r;return{_bufferIndex:e,_index:t,line:n,column:i,offset:a}}function f(){let e;for(;r._index<s.length;){const t=s[r._index];if("string"==typeof t)for(e=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===e&&r._bufferIndex<t.length;)p(t.charCodeAt(r._bufferIndex));else p(t)}}function p(e){c=c(e)}function m(e,t){t.restore()}function g(e,t){return function(n,i,a){let s,c,d,f;return Array.isArray(n)?m(n):"tokenize"in n?m([n]):(p=n,function(e){const t=null!==e&&p[e],n=null!==e&&p.null;return m([...Array.isArray(t)?t:t?[t]:[],...Array.isArray(n)?n:n?[n]:[]])(e)});var p;function m(e){return s=e,c=0,0===e.length?a:g(e[c])}function g(e){return function(n){f=function(){const e=h(),t=u.previous,n=u.currentConstruct,i=u.events.length,a=Array.from(o);return{from:i,restore:function(){r=e,u.previous=t,u.currentConstruct=n,u.events.length=i,o=a,v()}}}(),d=e,e.partial||(u.currentConstruct=e);if(e.name&&u.parser.constructs.disable.null.includes(e.name))return E();return e.tokenize.call(t?Object.assign(Object.create(u),t):u,l,_,E)(n)}}function _(t){return e(d,f),i}function E(e){return f.restore(),++c<s.length?g(s[c]):a}}}function _(e,t){e.resolveAll&&!a.includes(e)&&a.push(e),e.resolve&&AG(u.events,t,u.events.length-t,e.resolve(u.events.slice(t),u)),e.resolveTo&&(u.events=e.resolveTo(u.events,u))}function v(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function oV(e){const t={constructs:function(e){const t={};let n=-1;for(;++n<e.length;)RG(t,e[n]);return t}([aV,...(e||{}).extensions||[]]),content:n(XG),defined:[],document:n(ZG),flow:n(qz),lazy:{},string:n(Wz),text:n(Yz)};return t;function n(e){return function(n){return sV(t,e,n)}}}const lV=/[\0\t\n\r]/g;const uV=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function cV(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){const e=n.charCodeAt(1),t=120===e||88===e;return xG(n.slice(t?2:1),t?16:10)}return wG(n)||e}const dV={}.hasOwnProperty;function hV(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(v),autolinkProtocol:c,autolinkEmail:c,atxHeading:i(m),blockQuote:i((function(){return{type:"blockquote",children:[]}})),characterEscape:c,characterReference:c,codeFenced:i(p),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:i(p,a),codeText:i((function(){return{type:"inlineCode",value:""}}),a),codeTextData:c,data:c,codeFlowValue:c,definition:i((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:i((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:i(g),hardBreakTrailing:i(g),htmlFlow:i(_,a),htmlFlowData:c,htmlText:i(_,a),htmlTextData:c,image:i((function(){return{type:"image",title:null,url:"",alt:null}})),label:a,link:i(v),listItem:i((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){if(this.data.expectingFirstListItemValue){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0}},listOrdered:i(E,(function(){this.data.expectingFirstListItemValue=!0})),listUnordered:i(E),paragraph:i((function(){return{type:"paragraph",children:[]}})),reference:function(){this.data.referenceType="collapsed"},referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:i(m),strong:i((function(){return{type:"strong",children:[]}})),thematicBreak:i((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:o(),atxHeadingSequence:function(e){const t=this.stack[this.stack.length-1];if(!t.depth){const n=this.sliceSerialize(e).length;t.depth=n}},autolink:o(),autolinkEmail:function(e){d.call(this,e);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){d.call(this,e);this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:o(),characterEscapeValue:d,characterReferenceMarkerHexadecimal:f,characterReferenceMarkerNumeric:f,characterReferenceValue:function(e){const t=this.sliceSerialize(e),n=this.data.characterReferenceType;let r;if(n)r=xG(t,"characterReferenceMarkerNumeric"===n?10:16),this.data.characterReferenceType=void 0;else{const e=wG(t);r=e}this.stack[this.stack.length-1].value+=r},characterReference:function(e){this.stack.pop().position.end=fV(e.end)},codeFenced:o((function(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0})),codeFencedFence:function(){if(this.data.flowCodeInside)return;this.buffer(),this.data.flowCodeInside=!0},codeFencedFenceInfo:function(){const e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){const e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:d,codeIndented:o((function(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")})),codeText:o((function(){const e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:d,data:d,definition:o(),definitionDestinationString:function(){const e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=DG(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){const e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:o(),hardBreakEscape:o(h),hardBreakTrailing:o(h),htmlFlow:o((function(){const e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:d,htmlText:o((function(){const e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:d,image:o((function(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0})),label:function(){const e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];if(this.data.inReference=!0,"link"===n.type){const t=e.children;n.children=t}else n.alt=t},labelText:function(e){const t=this.sliceSerialize(e),n=this.stack[this.stack.length-2];n.label=function(e){return e.replace(uV,cV)}(t),n.identifier=DG(t).toLowerCase()},lineEnding:function(e){const n=this.stack[this.stack.length-1];if(this.data.atHardBreak){return n.children[n.children.length-1].position.end=fV(e.end),void(this.data.atHardBreak=void 0)}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(n.type)&&(c.call(this,e),d.call(this,e))},link:o((function(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0})),listItem:o(),listOrdered:o(),listUnordered:o(),paragraph:o(),referenceString:function(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=DG(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"},resourceDestinationString:function(){const e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){const e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){this.data.inReference=void 0},setextHeading:o((function(){this.data.setextHeadingSlurpLineEnding=void 0})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).codePointAt(0)?1:2},setextHeadingText:function(){this.data.setextHeadingSlurpLineEnding=!0},strong:o(),thematicBreak:o()}};!function e(t,n){let r=-1;for(;++r<n.length;){const i=n[r];Array.isArray(i)?e(t,i):pV(t,i)}}(t,(e||{}).mdastExtensions||[]);const n={};return function(e){let i={type:"root",children:[]};const o={stack:[i],tokenStack:[],config:t,enter:s,exit:l,buffer:a,resume:u,data:n},c=[];let d=-1;for(;++d<e.length;)if("listOrdered"===e[d][1].type||"listUnordered"===e[d][1].type)if("enter"===e[d][0])c.push(d);else{const t=c.pop();d=r(e,t,d)}d=-1;for(;++d<e.length;){const n=t[e[d][0]];dV.call(n,e[d][1].type)&&n[e[d][1].type].call(Object.assign({sliceSerialize:e[d][2].sliceSerialize},o),e[d][1])}if(o.tokenStack.length>0){const e=o.tokenStack[o.tokenStack.length-1];(e[1]||mV).call(o,void 0,e[0])}i.position={start:fV(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:fV(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},d=-1;for(;++d<t.transforms.length;)i=t.transforms[d](i)||i;return i};function r(e,t,n){let r,i,a,s,o=t-1,l=-1,u=!1;for(;++o<=n;){const t=e[o];switch(t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===t[0]?l++:l--,s=void 0;break;case"lineEndingBlank":"enter"===t[0]&&(!r||s||l||a||(a=o),s=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:s=void 0}if(!l&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===l&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(r){let s=o;for(i=void 0;s--;){const t=e[s];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;i&&(e[i][1].type="lineEndingBlank",u=!0),t[1].type="lineEnding",i=s}else if("linePrefix"!==t[1].type&&"blockQuotePrefix"!==t[1].type&&"blockQuotePrefixWhitespace"!==t[1].type&&"blockQuoteMarker"!==t[1].type&&"listItemIndent"!==t[1].type)break}a&&(!i||a<i)&&(r._spread=!0),r.end=Object.assign({},i?e[i][1].start:t[1].end),e.splice(i||o,0,["exit",r,t[2]]),o++,n++}if("listItemPrefix"===t[1].type){const i={type:"listItem",_spread:!1,start:Object.assign({},t[1].start),end:void 0};r=i,e.splice(o,0,["enter",i,t[2]]),o++,n++,a=void 0,s=!0}}}return e[t][1]._spread=u,n}function i(e,t){return function(n){s.call(this,e(n),n),t&&t.call(this,n)}}function a(){this.stack.push({type:"fragment",children:[]})}function s(e,t,n){this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n||void 0]),e.position={start:fV(t.start),end:void 0}}function o(e){return function(t){e&&e.call(this,t);l.call(this,t)}}function l(e,t){const n=this.stack.pop(),r=this.tokenStack.pop();if(!r)throw new Error("Cannot close `"+e.type+"` ("+tG({start:e.start,end:e.end})+"): its not open");if(r[0].type!==e.type)if(t)t.call(this,e,r[0]);else{(r[1]||mV).call(this,e,r[0])}n.position.end=fV(e.end)}function u(){return TG(this.stack.pop(),"boolean"!=typeof NG.includeImageAlt||NG.includeImageAlt,"boolean"!=typeof NG.includeHtml||NG.includeHtml)}function c(e){const t=this.stack[this.stack.length-1].children;let n=t[t.length-1];n&&"text"===n.type||(n={type:"text",value:""},n.position={start:fV(e.start),end:void 0},t.push(n)),this.stack.push(n)}function d(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=fV(e.end)}function h(){this.data.atHardBreak=!0}function f(e){this.data.characterReferenceType=e.type}function p(){return{type:"code",lang:null,meta:null,value:""}}function m(){return{type:"heading",depth:0,children:[]}}function g(){return{type:"break"}}function _(){return{type:"html",value:""}}function v(){return{type:"link",title:null,url:"",children:[]}}function E(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(n)(function(e){for(;!mz(e););return e}(oV(n).document().write(function(){let e,t=1,n="",r=!0;return function(i,a,s){const o=[];let l,u,c,d,h;i=n+("string"==typeof i?i.toString():new TextDecoder(a||void 0).decode(i)),c=0,n="",r&&(65279===i.charCodeAt(0)&&c++,r=void 0);for(;c<i.length;){if(lV.lastIndex=c,l=lV.exec(i),d=l&&void 0!==l.index?l.index:i.length,h=i.charCodeAt(d),!l){n=i.slice(c);break}if(10===h&&c===d&&e)o.push(-3),e=void 0;else switch(e&&(o.push(-5),e=void 0),c<d&&(o.push(i.slice(c,d)),t+=d-c),h){case 0:o.push(65533),t++;break;case 9:for(u=4*Math.ceil(t/4),o.push(-2);t++<u;)o.push(-1);break;case 10:o.push(-4),t=1;break;default:e=!0,t=1}c=d+1}s&&(e&&o.push(-5),n&&o.push(n),o.push(null));return o}}()(e,t,!0))))}function fV(e){return{line:e.line,column:e.column,offset:e.offset}}function pV(e,t){let n;for(n in t)if(dV.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function mV(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+tG({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+tG({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+tG({start:t.start,end:t.end})+") is still open")}function gV(e){const t=this;t.parser=function(n){return hV(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function _V(e,t){const n=t.referenceType;let r="]";if("collapsed"===n?r+="[]":"full"===n&&(r+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return[{type:"text",value:"!["+t.alt+r}];const i=e.all(t),a=i[0];a&&"text"===a.type?a.value="["+a.value:i.unshift({type:"text",value:"["});const s=i[i.length-1];return s&&"text"===s.type?s.value+=r:i.push({type:"text",value:r}),i}function vV(e){const t=e.spread;return null==t?e.children.length>1:t}function EV(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),i=0;const a=[];for(;r;)a.push(yV(t.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(t);return a.push(yV(t.slice(i),i>0,!1)),a.join("")}function yV(e,t,n){let r=0,i=e.length;if(t){let t=e.codePointAt(r);for(;9===t||32===t;)r++,t=e.codePointAt(r)}if(n){let t=e.codePointAt(i-1);for(;9===t||32===t;)i--,t=e.codePointAt(i-1)}return i>r?e.slice(r,i):""}const bV={blockquote:function(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)},break:function(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:"\n"}]},code:function(e,t){const n=t.value?t.value+"\n":"",r={};t.lang&&(r.className=["language-"+t.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i},delete:function(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},emphasis:function(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},footnoteReference:function(e,t){const n="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),i=YG(r.toLowerCase()),a=e.footnoteOrder.indexOf(r);let s,o=e.footnoteCounts.get(r);void 0===o?(o=0,e.footnoteOrder.push(r),s=e.footnoteOrder.length):s=a+1,o+=1,e.footnoteCounts.set(r,o);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(s)}]};e.patch(t,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,u),e.applyData(t,u)},heading:function(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},html:function(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}},imageReference:function(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return _V(e,t);const i={src:YG(r.url||""),alt:t.alt};null!==r.title&&void 0!==r.title&&(i.title=r.title);const a={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,a),e.applyData(t,a)},image:function(e,t){const n={src:YG(t.url)};null!==t.alt&&void 0!==t.alt&&(n.alt=t.alt),null!==t.title&&void 0!==t.title&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)},inlineCode:function(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)},linkReference:function(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return _V(e,t);const i={href:YG(r.url||"")};null!==r.title&&void 0!==r.title&&(i.title=r.title);const a={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)},link:function(e,t){const n={href:YG(t.url)};null!==t.title&&void 0!==t.title&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)},listItem:function(e,t,n){const r=e.all(t),i=n?function(e){let t=!1;if("list"===e.type){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=vV(n[r])}return t}(n):vV(t),a={},s=[];if("boolean"==typeof t.checked){const e=r[0];let n;e&&"element"===e.type&&"p"===e.tagName?n=e:(n={type:"element",tagName:"p",properties:{},children:[]},r.unshift(n)),n.children.length>0&&n.children.unshift({type:"text",value:" "}),n.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let o=-1;for(;++o<r.length;){const e=r[o];(i||0!==o||"element"!==e.type||"p"!==e.tagName)&&s.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||i?s.push(e):s.push(...e.children)}const l=r[r.length-1];l&&(i||"element"!==l.type||"p"!==l.tagName)&&s.push({type:"text",value:"\n"});const u={type:"element",tagName:"li",properties:a,children:s};return e.patch(t,u),e.applyData(t,u)},list:function(e,t){const n={},r=e.all(t);let i=-1;for("number"==typeof t.start&&1!==t.start&&(n.start=t.start);++i<r.length;){const e=r[i];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const a={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,a),e.applyData(t,a)},paragraph:function(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},root:function(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)},strong:function(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},table:function(e,t){const n=e.all(t),r=n.shift(),i=[];if(r){const n={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],n),i.push(n)}if(n.length>0){const r={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},a=$H(t.children[1]),s=JH(t.children[t.children.length-1]);a&&s&&(r.position={start:a,end:s}),i.push(r)}const a={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,a),e.applyData(t,a)},tableCell:function(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},tableRow:function(e,t,n){const r=n?n.children:void 0,i=0===(r?r.indexOf(t):1)?"th":"td",a=n&&"table"===n.type?n.align:void 0,s=a?a.length:t.children.length;let o=-1;const l=[];for(;++o<s;){const n=t.children[o],r={},s=a?a[o]:void 0;s&&(r.align=s);let u={type:"element",tagName:i,properties:r,children:[]};n&&(u.children=e.all(n),e.patch(n,u),u=e.applyData(n,u)),l.push(u)}const u={type:"element",tagName:"tr",properties:{},children:e.wrap(l,!0)};return e.patch(t,u),e.applyData(t,u)},text:function(e,t){const n={type:"text",value:EV(String(t.value))};return e.patch(t,n),e.applyData(t,n)},thematicBreak:function(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)},toml:CV,yaml:CV,definition:CV,footnoteDefinition:CV};function CV(){}const NV="object"==typeof self?self:globalThis,TV=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),r=i=>{if(e.has(i))return e.get(i);const[a,s]=t[i];switch(a){case 0:case-1:return n(s,i);case 1:{const e=n([],i);for(const t of s)e.push(r(t));return e}case 2:{const e=n({},i);for(const[t,n]of s)e[r(t)]=r(n);return e}case 3:return n(new Date(s),i);case 4:{const{source:e,flags:t}=s;return n(new RegExp(e,t),i)}case 5:{const e=n(new Map,i);for(const[t,n]of s)e.set(r(t),r(n));return e}case 6:{const e=n(new Set,i);for(const t of s)e.add(r(t));return e}case 7:{const{name:e,message:t}=s;return n(new NV[e](t),i)}case 8:return n(BigInt(s),i);case"BigInt":return n(Object(BigInt(s)),i);case"ArrayBuffer":return n(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:e}=new Uint8Array(s);return n(new DataView(e),s)}}return n(new NV[a](s),i)};return r})(new Map,e)(0),{toString:IV}={},{keys:SV}=Object,wV=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=IV.call(e).slice(8,-1);switch(n){case"Array":return[1,""];case"Object":return[2,""];case"Date":return[3,""];case"RegExp":return[4,""];case"Map":return[5,""];case"Set":return[6,""];case"DataView":return[1,n]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},AV=([e,t])=>0===e&&("function"===t||"symbol"===t),MV=(e,{json:t,lossy:n}={})=>{const r=[];return((e,t,n,r)=>{const i=(e,t)=>{const i=r.push(e)-1;return n.set(t,i),i},a=r=>{if(n.has(r))return n.get(r);let[s,o]=wV(r);switch(s){case 0:{let t=r;switch(o){case"bigint":s=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+o);t=null;break;case"undefined":return i([-1],r)}return i([s,t],r)}case 1:{if(o){let e=r;return"DataView"===o?e=new Uint8Array(r.buffer):"ArrayBuffer"===o&&(e=new Uint8Array(r)),i([o,[...e]],r)}const e=[],t=i([s,e],r);for(const t of r)e.push(a(t));return t}case 2:{if(o)switch(o){case"BigInt":return i([o,r.toString()],r);case"Boolean":case"Number":case"String":return i([o,r.valueOf()],r)}if(t&&"toJSON"in r)return a(r.toJSON());const n=[],l=i([s,n],r);for(const t of SV(r))!e&&AV(wV(r[t]))||n.push([a(t),a(r[t])]);return l}case 3:return i([s,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return i([s,{source:e,flags:t}],r)}case 5:{const t=[],n=i([s,t],r);for(const[n,i]of r)(e||!AV(wV(n))&&!AV(wV(i)))&&t.push([a(n),a(i)]);return n}case 6:{const t=[],n=i([s,t],r);for(const n of r)!e&&AV(wV(n))||t.push(a(n));return n}}const{message:l}=r;return i([s,{name:o,message:l}],r)};return a})(!(t||n),!!t,new Map,r)(e),r},OV="function"==typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?TV(MV(e,t)):structuredClone(e):(e,t)=>TV(MV(e,t));function RV(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function kV(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}const xV=function(e){if(null==e)return UV;if("function"==typeof e)return DV(e);if("object"==typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=xV(e[n]);return DV((function(...e){let n=-1;for(;++n<t.length;)if(t[n].apply(this,e))return!0;return!1}))}(e):function(e){const t=e;return DV((function(n){const r=n;let i;for(i in e)if(r[i]!==t[i])return!1;return!0}))}(e);if("string"==typeof e)return t=e,DV((function(e){return e&&e.type===t}));var t;throw new Error("Expected function, string, or object as test")};function DV(e){return function(t,n,r){return Boolean(function(e){return null!==e&&"object"==typeof e&&"type"in e}(t)&&e.call(this,t,"number"==typeof n?n:void 0,r||void 0))}}function UV(){return!0}const LV=[];function PV(e,t,n,r){let i;"function"==typeof t&&"function"!=typeof n?(r=n,n=t):i=t;const a=xV(i),s=r?-1:1;!function e(i,o,l){const u=i&&"object"==typeof i?i:{};if("string"==typeof u.type){const e="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0;Object.defineProperty(c,"name",{value:"node ("+i.type+(e?"<"+e+">":"")+")"})}return c;function c(){let u,c,d,h=LV;if((!t||a(i,o,l[l.length-1]||void 0))&&(h=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[!0,e];return null==e?LV:[e]}(n(i,l)),!1===h[0]))return h;if("children"in i&&i.children){const t=i;if(t.children&&"skip"!==h[0])for(c=(r?t.children.length:-1)+s,d=l.concat(t);c>-1&&c<t.children.length;){const n=t.children[c];if(u=e(n,c,d)(),!1===u[0])return u;c="number"==typeof u[1]?u[1]:c+s}}return h}}(e,void 0,[])()}const FV={}.hasOwnProperty,BV={};function jV(e,t){const n=t||BV,r=new Map,i=new Map,a=new Map,s={...bV,...n.handlers},o={all:function(e){const t=[];if("children"in e){const n=e.children;let r=-1;for(;++r<n.length;){const i=o.one(n[r],e);if(i){if(r&&"break"===n[r-1].type&&(Array.isArray(i)||"text"!==i.type||(i.value=qV(i.value)),!Array.isArray(i)&&"element"===i.type)){const e=i.children[0];e&&"text"===e.type&&(e.value=qV(e.value))}Array.isArray(i)?t.push(...i):t.push(i)}}}return t},applyData:GV,definitionById:r,footnoteById:i,footnoteCounts:a,footnoteOrder:[],handlers:s,one:function(e,t){const n=e.type,r=o.handlers[n];if(FV.call(o.handlers,n)&&r)return r(o,e,t);if(o.options.passThrough&&o.options.passThrough.includes(n)){if("children"in e){const{children:t,...n}=e,r=OV(n);return r.children=o.all(e),r}return OV(e)}return(o.options.unknownHandler||zV)(o,e,t)},options:n,patch:HV,wrap:VV};return function(e,t,n,r){let i,a,s;"function"==typeof t?(a=void 0,s=t,i=n):(a=t,s=n,i=r),PV(e,a,(function(e,t){const n=t[t.length-1],r=n?n.children.indexOf(e):void 0;return s(e,r,n)}),i)}(e,(function(e){if("definition"===e.type||"footnoteDefinition"===e.type){const t="definition"===e.type?r:i,n=String(e.identifier).toUpperCase();t.has(n)||t.set(n,e)}})),o}function HV(e,t){e.position&&(t.position=function(e){const t=$H(e),n=JH(e);if(t&&n)return{start:t,end:n}}(e))}function GV(e,t){let n=t;if(e&&e.data){const t=e.data.hName,r=e.data.hChildren,i=e.data.hProperties;if("string"==typeof t)if("element"===n.type)n.tagName=t;else{n={type:"element",tagName:t,properties:{},children:"children"in n?n.children:[n]}}"element"===n.type&&i&&Object.assign(n.properties,OV(i)),"children"in n&&n.children&&null!=r&&(n.children=r)}return n}function zV(e,t){const n=t.data||{},r=!("value"in t)||FV.call(n,"hProperties")||FV.call(n,"hChildren")?{type:"element",tagName:"div",properties:{},children:e.all(t)}:{type:"text",value:t.value};return e.patch(t,r),e.applyData(t,r)}function VV(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:"\n"});++r<e.length;)r&&n.push({type:"text",value:"\n"}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:"\n"}),n}function qV(e){let t=0,n=e.charCodeAt(t);for(;9===n||32===n;)t++,n=e.charCodeAt(t);return e.slice(t)}function KV(e,t){const n=jV(e,t),r=n.one(e,void 0),i=function(e){const t="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||RV,r=e.options.footnoteBackLabel||kV,i=e.options.footnoteLabel||"Footnotes",a=e.options.footnoteLabelTagName||"h2",s=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<e.footnoteOrder.length;){const i=e.footnoteById.get(e.footnoteOrder[l]);if(!i)continue;const a=e.all(i),s=String(i.identifier).toUpperCase(),u=YG(s.toLowerCase());let c=0;const d=[],h=e.footnoteCounts.get(s);for(;void 0!==h&&++c<=h;){d.length>0&&d.push({type:"text",value:" "});let e="string"==typeof n?n:n(l,c);"string"==typeof e&&(e={type:"text",value:e}),d.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+u+(c>1?"-"+c:""),dataFootnoteBackref:"",ariaLabel:"string"==typeof r?r:r(l,c),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}const f=a[a.length-1];if(f&&"element"===f.type&&"p"===f.tagName){const e=f.children[f.children.length-1];e&&"text"===e.type?e.value+=" ":f.children.push({type:"text",value:" "}),f.children.push(...d)}else a.push(...d);const p={type:"element",tagName:"li",properties:{id:t+"fn-"+u},children:e.wrap(a,!0)};e.patch(i,p),o.push(p)}if(0!==o.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:{...OV(s),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:"\n"}]}}(n),a=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&a.children.push({type:"text",value:"\n"},i),a}function WV(e,t){return e&&"run"in e?async function(n,r){const i=KV(n,{file:r,...t});await e.run(i,r)}:function(n,r){return KV(n,{file:r,...e||t})}}function YV(e){if(e)throw e}var QV=Object.prototype.hasOwnProperty,XV=Object.prototype.toString,ZV=Object.defineProperty,JV=Object.getOwnPropertyDescriptor,$V=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===XV.call(e)},eq=function(e){if(!e||"[object Object]"!==XV.call(e))return!1;var t,n=QV.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&QV.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||QV.call(e,t)},tq=function(e,t){ZV&&"__proto__"===t.name?ZV(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},nq=function(e,t){if("__proto__"===t){if(!QV.call(e,t))return;if(JV)return JV(e,t).value}return e[t]};const rq=l((function e(){var t,n,r,i,a,s,o=arguments[0],l=1,u=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[1]||{},l=2),(null==o||"object"!=typeof o&&"function"!=typeof o)&&(o={});l<u;++l)if(null!=(t=arguments[l]))for(n in t)r=nq(o,n),o!==(i=nq(t,n))&&(c&&i&&(eq(i)||(a=$V(i)))?(a?(a=!1,s=r&&$V(r)?r:[]):s=r&&eq(r)?r:{},tq(o,{name:n,newValue:e(c,s,i)})):void 0!==i&&tq(o,{name:n,newValue:i}));return o}));function iq(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}function aq(){const e=[],t={run:function(...t){let n=-1;const r=t.pop();if("function"!=typeof r)throw new TypeError("Expected function as last argument, not "+r);!function i(a,...s){const o=e[++n];let l=-1;if(a)r(a);else{for(;++l<t.length;)null!==s[l]&&void 0!==s[l]||(s[l]=t[l]);t=s,o?function(e,t){let n;return function(...t){const a=e.length>t.length;let s;a&&t.push(r);try{s=e.apply(this,t)}catch(e){const t=e;if(a&&n)throw t;return r(t)}a||(s&&s.then&&"function"==typeof s.then?s.then(i,r):s instanceof Error?r(s):i(s))};function r(e,...r){n||(n=!0,t(e,...r))}function i(e){r(null,e)}}(o,i)(...s):r(null,...s)}}(null,...t)},use:function(n){if("function"!=typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}const sq={basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');oq(e);let n,r=0,i=-1,a=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;a--;)if(47===e.codePointAt(a)){if(n){r=a+1;break}}else i<0&&(n=!0,i=a+1);return i<0?"":e.slice(r,i)}if(t===e)return"";let s=-1,o=t.length-1;for(;a--;)if(47===e.codePointAt(a)){if(n){r=a+1;break}}else s<0&&(n=!0,s=a+1),o>-1&&(e.codePointAt(a)===t.codePointAt(o--)?o<0&&(i=a):(o=-1,i=s));r===i?i=s:i<0&&(i=e.length);return e.slice(r,i)},dirname:function(e){if(oq(e),0===e.length)return".";let t,n=-1,r=e.length;for(;--r;)if(47===e.codePointAt(r)){if(t){n=r;break}}else t||(t=!0);return n<0?47===e.codePointAt(0)?"/":".":1===n&&47===e.codePointAt(0)?"//":e.slice(0,n)},extname:function(e){oq(e);let t,n=e.length,r=-1,i=0,a=-1,s=0;for(;n--;){const o=e.codePointAt(n);if(47!==o)r<0&&(t=!0,r=n+1),46===o?a<0?a=n:1!==s&&(s=1):a>-1&&(s=-1);else if(t){i=n+1;break}}if(a<0||r<0||0===s||1===s&&a===r-1&&a===i+1)return"";return e.slice(a,r)},join:function(...e){let t,n=-1;for(;++n<e.length;)oq(e[n]),e[n]&&(t=void 0===t?e[n]:t+"/"+e[n]);return void 0===t?".":function(e){oq(e);const t=47===e.codePointAt(0);let n=function(e,t){let n,r,i="",a=0,s=-1,o=0,l=-1;for(;++l<=e.length;){if(l<e.length)n=e.codePointAt(l);else{if(47===n)break;n=47}if(47===n){if(s===l-1||1===o);else if(s!==l-1&&2===o){if(i.length<2||2!==a||46!==i.codePointAt(i.length-1)||46!==i.codePointAt(i.length-2))if(i.length>2){if(r=i.lastIndexOf("/"),r!==i.length-1){r<0?(i="",a=0):(i=i.slice(0,r),a=i.length-1-i.lastIndexOf("/")),s=l,o=0;continue}}else if(i.length>0){i="",a=0,s=l,o=0;continue}t&&(i=i.length>0?i+"/..":"..",a=2)}else i.length>0?i+="/"+e.slice(s+1,l):i=e.slice(s+1,l),a=l-s-1;s=l,o=0}else 46===n&&o>-1?o++:o=-1}return i}(e,!t);0!==n.length||t||(n=".");n.length>0&&47===e.codePointAt(e.length-1)&&(n+="/");return t?"/"+n:n}(t)},sep:"/"};function oq(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const lq={cwd:function(){return"/"}};function uq(e){return Boolean(null!==e&&"object"==typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}function cq(e){if("string"==typeof e)e=new URL(e);else if(!uq(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){const e=new TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}const t=e.pathname;let n=-1;for(;++n<t.length;)if(37===t.codePointAt(n)&&50===t.codePointAt(n+1)){const e=t.codePointAt(n+2);if(70===e||102===e){const e=new TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}const dq=["history","path","basename","stem","extname","dirname"];class hq{constructor(e){let t;t=e?uq(e)?{path:e}:"string"==typeof e||function(e){return Boolean(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}(e)?{value:e}:e:{},this.cwd="cwd"in t?"":lq.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n,r=-1;for(;++r<dq.length;){const e=dq[r];e in t&&void 0!==t[e]&&null!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)dq.includes(n)||(this[n]=t[n])}get basename(){return"string"==typeof this.path?sq.basename(this.path):void 0}set basename(e){pq(e,"basename"),fq(e,"basename"),this.path=sq.join(this.dirname||"",e)}get dirname(){return"string"==typeof this.path?sq.dirname(this.path):void 0}set dirname(e){mq(this.basename,"dirname"),this.path=sq.join(e||"",this.basename)}get extname(){return"string"==typeof this.path?sq.extname(this.path):void 0}set extname(e){if(fq(e,"extname"),mq(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=sq.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){uq(e)&&(e=cq(e)),pq(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"==typeof this.path?sq.basename(this.path,this.extname):void 0}set stem(e){pq(e,"stem"),fq(e,"stem"),this.path=sq.join(this.dirname||"",e+(this.extname||""))}fail(e,t,n){const r=this.message(e,t,n);throw r.fatal=!0,r}info(e,t,n){const r=this.message(e,t,n);return r.fatal=void 0,r}message(e,t,n){const r=new aG(e,t,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){if(void 0===this.value)return"";if("string"==typeof this.value)return this.value;return new TextDecoder(e||void 0).decode(this.value)}}function fq(e,t){if(e&&e.includes(sq.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+sq.sep+"`")}function pq(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function mq(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}const gq=function(e){const t=this.constructor.prototype,n=t[e],r=function(){return n.apply(r,arguments)};return Object.setPrototypeOf(r,t),r},_q={}.hasOwnProperty;class vq extends gq{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=aq()}copy(){const e=new vq;let t=-1;for(;++t<this.attachers.length;){const n=this.attachers[t];e.use(...n)}return e.data(rq(!0,{},this.namespace)),e}data(e,t){return"string"==typeof e?2===arguments.length?(Cq("data",this.frozen),this.namespace[e]=t,this):_q.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Cq("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...n]=this.attachers[this.freezeIndex];if(!1===n[0])continue;!0===n[0]&&(n[0]=void 0);const r=t.call(e,...n);"function"==typeof r&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=Iq(e),n=this.parser||this.Parser;return yq("parse",n),n(String(t),t)}process(e,t){const n=this;return this.freeze(),yq("process",this.parser||this.Parser),bq("process",this.compiler||this.Compiler),t?r(void 0,t):new Promise(r);function r(r,i){const a=Iq(e),s=n.parse(a);function o(e,n){e||!n?i(e):r?r(n):t(void 0,n)}n.run(s,a,(function(e,t,r){if(e||!t||!r)return o(e);const i=t,a=n.stringify(i,r);var s;"string"==typeof(s=a)||function(e){return Boolean(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}(s)?r.value=a:r.result=a,o(e,r)}))}}processSync(e){let t,n=!1;return this.freeze(),yq("processSync",this.parser||this.Parser),bq("processSync",this.compiler||this.Compiler),this.process(e,(function(e,r){n=!0,YV(e),t=r})),Tq("processSync","process",n),t}run(e,t,n){Nq(e),this.freeze();const r=this.transformers;return n||"function"!=typeof t||(n=t,t=void 0),n?i(void 0,n):new Promise(i);function i(i,a){const s=Iq(t);r.run(e,s,(function(t,r,s){const o=r||e;t?a(t):i?i(o):n(void 0,o,s)}))}}runSync(e,t){let n,r=!1;return this.run(e,t,(function(e,t){YV(e),n=t,r=!0})),Tq("runSync","run",r),n}stringify(e,t){this.freeze();const n=Iq(t),r=this.compiler||this.Compiler;return bq("stringify",r),Nq(e),r(e,n)}use(e,...t){const n=this.attachers,r=this.namespace;if(Cq("use",this.frozen),null==e);else if("function"==typeof e)o(e,t);else{if("object"!=typeof e)throw new TypeError("Expected usable value, not `"+e+"`");Array.isArray(e)?s(e):a(e)}return this;function i(e){if("function"==typeof e)o(e,[]);else{if("object"!=typeof e)throw new TypeError("Expected usable value, not `"+e+"`");if(Array.isArray(e)){const[t,...n]=e;o(t,n)}else a(e)}}function a(e){if(!("plugins"in e)&&!("settings"in e))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(e.plugins),e.settings&&(r.settings=rq(!0,r.settings,e.settings))}function s(e){let t=-1;if(null==e);else{if(!Array.isArray(e))throw new TypeError("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;){i(e[t])}}}function o(e,t){let r=-1,i=-1;for(;++r<n.length;)if(n[r][0]===e){i=r;break}if(-1===i)n.push([e,...t]);else if(t.length>0){let[r,...a]=t;const s=n[i][1];iq(s)&&iq(r)&&(r=rq(!0,s,r)),n[i]=[e,r,...a]}}}}const Eq=(new vq).freeze();function yq(e,t){if("function"!=typeof t)throw new TypeError("Cannot `"+e+"` without `parser`")}function bq(e,t){if("function"!=typeof t)throw new TypeError("Cannot `"+e+"` without `compiler`")}function Cq(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Nq(e){if(!iq(e)||"string"!=typeof e.type)throw new TypeError("Expected node, got `"+e+"`")}function Tq(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Iq(e){return function(e){return Boolean(e&&"object"==typeof e&&"message"in e&&"messages"in e)}(e)?e:new hq(e)}const Sq=function(e){if(null==e)return Aq;if("function"==typeof e)return wq(e);if("object"==typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Sq(e[n]);return wq((function(...e){let n=-1;for(;++n<t.length;)if(t[n].apply(this,e))return!0;return!1}))}(e):function(e){const t=e;return wq((function(n){const r=n;let i;for(i in e)if(r[i]!==t[i])return!1;return!0}))}(e);if("string"==typeof e)return t=e,wq((function(e){return e&&e.type===t}));var t;throw new Error("Expected function, string, or object as test")};function wq(e){return function(t,n,r){return Boolean(function(e){return null!==e&&"object"==typeof e&&"type"in e}(t)&&e.call(this,t,"number"==typeof n?n:void 0,r||void 0))}}function Aq(){return!0}const Mq=[];function Oq(e,t,n,r){let i;"function"==typeof t&&"function"!=typeof n?(r=n,n=t):i=t;const a=Sq(i),s=r?-1:1;!function e(i,o,l){const u=i&&"object"==typeof i?i:{};if("string"==typeof u.type){const e="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0;Object.defineProperty(c,"name",{value:"node ("+i.type+(e?"<"+e+">":"")+")"})}return c;function c(){let u,c,d,h=Mq;if((!t||a(i,o,l[l.length-1]||void 0))&&(h=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[!0,e];return null==e?Mq:[e]}(n(i,l)),!1===h[0]))return h;if("children"in i&&i.children){const t=i;if(t.children&&"skip"!==h[0])for(c=(r?t.children.length:-1)+s,d=l.concat(t);c>-1&&c<t.children.length;){const n=t.children[c];if(u=e(n,c,d)(),!1===u[0])return u;c="number"==typeof u[1]?u[1]:c+s}}return h}}(e,void 0,[])()}const Rq=[],kq={allowDangerousHtml:!0},xq=/^(https?|ircs?|mailto|xmpp)$/i,Dq=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Uq(e){const t=function(e){const t=e.rehypePlugins||Rq,n=e.remarkPlugins||Rq,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...kq}:kq;return Eq().use(gV).use(n).use(WV,r).use(t)}(e),n=function(e){const t=e.children||"",n=new hq;"string"==typeof t&&(n.value=t);return n}(e);return function(e,t){const n=t.allowedElements,r=t.allowElement,i=t.components,a=t.disallowedElements,s=t.skipHtml,o=t.unwrapDisallowed,l=t.urlTransform||Lq;for(const e of Dq)Object.hasOwn(t,e.from)&&(e.from,e.to&&e.to,e.id);return function(e,t,n,r){let i,a,s;"function"==typeof t?(a=void 0,s=t,i=n):(a=t,s=n,i=r),Oq(e,a,(function(e,t){const n=t[t.length-1],r=n?n.children.indexOf(e):void 0;return s(e,r,n)}),i)}(e,(function(e,t,i){if("raw"===e.type&&i&&"number"==typeof t)return s?i.children.splice(t,1):i.children[t]={type:"text",value:e.value},t;if("element"===e.type){let t;for(t in CG)if(Object.hasOwn(CG,t)&&Object.hasOwn(e.properties,t)){const n=e.properties[t],r=CG[t];(null===r||r.includes(e.tagName))&&(e.properties[t]=l(String(n||""),t,e))}}if("element"===e.type){let s=n?!n.includes(e.tagName):!!a&&a.includes(e.tagName);if(!s&&r&&"number"==typeof t&&(s=!r(e,t,i)),s&&i&&"number"==typeof t)return o&&e.children?i.children.splice(t,1,...e.children):i.children.splice(t,1),t}})),hG(e,{Fragment:h.Fragment,components:i,ignoreInvalidStyle:!0,jsx:h.jsx,jsxs:h.jsxs,passKeys:!0,passNode:!0})}(t.runSync(t.parse(n),n),e)}function Lq(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),i=e.indexOf("/");return-1===t||-1!==i&&t>i||-1!==n&&t>n||-1!==r&&t>r||xq.test(e.slice(0,t))?e:""}const Pq={support:"Support card",consult:"Consult card",listing:"Listing card",doctor_profile:"Doctor profile card"},Fq=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),Bq=({replies:e,setIsSuggestedReplyMsgSent:t,setWaitingForResponseMap:n,channelUrl:r,accountId:a})=>{const{actions:{sendUserMessage:s}}=CO(),o=Object(i.useRef)(!1);return h.jsx("div",{className:WM.suggestedRepliesWrapper,children:e.map((e,i)=>h.jsx("button",{onClick:()=>(async e=>{t(!0);const i=await s({message:e});let l,u;i&&i.sendingStatus&&(clearTimeout(l),clearTimeout(u),l=setTimeout(()=>{n(e=>({...e,[r]:!0})),u=setTimeout(()=>{if(n(e=>({...e,[r]:!1})),o.current){o.current=!1;Bj({object:Pj,action:Lj,objectContext:{[Oj]:"No message received",[Rj]:a,[kj]:r}})()}},12e4)},500),setTimeout(()=>{const e=document.getElementsByClassName("sendbird-conversation__messages-padding")[0];e&&(e.scrollTop=e.scrollHeight)},600))})(e),className:WM.suggestedReplyBtn,children:e},i))})},jq=({isBot:e,messageText:t,createdAt:n})=>h.jsxs("div",{className:`${WM.customMessage} ${e?WM.customMessageBot:WM.customMessageUser}`,children:[e&&h.jsx("div",{className:WM.customMessageAvatar,children:h.jsx("img",{src:jj,alt:"care-ai-avatar",width:"28",height:"28"})}),h.jsxs("div",{className:WM.customMessageContent,children:[h.jsx("div",{className:`${WM.customMessageBubble} ${e?WM.customMessageBubbleBot:WM.customMessageBubbleUser}`,children:h.jsx(Uq,{children:t})}),h.jsx("span",{className:WM.customMessageTime,children:Fq(n)})]})]}),Hq=({isBot:e,title:t,imageUrl:n,content:r,ctaText:a,metaData:s,createdAt:o,type:l,currentLocation:u,channelUrl:c,accountId:d,eventInfoData:f})=>{const p=Object(i.useRef)(null),m=Pq[l];Object(i.useEffect)(()=>{const e=new IntersectionObserver(([e])=>{if(m&&e.isIntersecting){Bj({object:Fj,action:Dj,objectContext:{[Mj]:m,[Rj]:d,[kj]:c}})()}},{threshold:.25});return p.current&&e.observe(p.current),()=>{p.current&&e.unobserve(p.current)}},[m]);const g=async(e,t,n)=>{if(m){Bj({object:Fj,action:Uj,objectContext:{[Mj]:m,[Rj]:d,[kj]:c}})()}let r="";switch(e){case"support":r="https://practo.onelink.me/1025359428?utm_source=Dweb_homepage&utm_medium=Web2App";break;case"consult":r=`${window.location.origin}/consult/direct/new_consultation?id=${n.problemAreaId}`;break;case"listing":const e=(i=n.queryValue)?i.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]/g,""):"";r=`${window.location.origin}/${t}/${e}`;break;case"doctor_profile":const a=await(async e=>{var t,n;try{const r="/marketplace-api/mobile/provider/profile?provider_id="+e,i=await fetch(r);return null==(n=null==(t=(await i.json()).data)?void 0:t.providerProfile)?void 0:n.profile_url}catch(e){return console.error("Error fetching doctor URL:",e),null}})(n.referenceId);a&&(r=a);break;default:r=""}var i;r&&window.open(r,"_blank")};return h.jsxs("div",{ref:p,className:`${WM.customMessage} ${e?WM.customMessageBot:WM.customMessageUser}`,children:[e&&h.jsx("div",{className:WM.customMessageAvatar,children:h.jsx("img",{src:jj,alt:"care-ai-avatar",width:"28",height:"28"})}),h.jsxs("div",{className:WM.customMessageContent,children:[h.jsxs("div",{className:WM.customCardBubble,children:[n&&h.jsx("img",{src:n,alt:t,className:WM.chatCardImage}),h.jsxs("div",{className:WM.chatCardContent,children:[t&&h.jsx("h3",{className:WM.chatCardTitle,children:t}),h.jsx("p",{className:WM.chatCardDescription,children:r}),a&&h.jsx("button",{className:`${WM.chatCardButton} ${WM["chatCardButton"+(l.charAt(0).toUpperCase()+l.slice(1))]}`,onClick:()=>g(l,u,s),children:a})]})]}),h.jsx("span",{className:WM.customMessageTime,children:Fq(o)})]})]})},Gq=({message:e,currentLocation:t,channelUrl:n,accountId:r,waitingForResponseMap:a,setWaitingForResponseMap:s,eventInfoData:o})=>{var l,u;const[c,d]=Object(i.useState)(!1),{message:f,data:p,createdAt:m,customType:g}=e;let _=!1,v=null;if(p)try{v=JSON.parse(p),_=null==v?void 0:v.botMessage}catch(e){console.error("Error parsing message data:",e)}const{state:{currentChannel:E}}=CO(),y=null==(l=null==E?void 0:E.lastMessage)?void 0:l.createdAt;let b=!1;if(y&&m>y&&(b=!0,a[n]&&s(e=>({...e,[n]:!1}))),Object(i.useEffect)(()=>{_&&setTimeout(()=>{const e=document.getElementsByClassName(WM.sendbirdConversationMessagesPadding)[0];e&&(e.scrollTop=e.scrollHeight)},100)},[_]),"card"===g&&v){const{title:e,imageUrl:i,content:a,ctaText:s}=v.card||{},l=(null==(u=v.card)?void 0:u.platformMessageCardMetadataDto)||{};switch(v.messageSubType){case"listing":case"support":case"consult":case"doctor_profile":return h.jsxs(h.Fragment,{children:[h.jsx(jq,{isBot:_,messageText:f,createdAt:m}),h.jsx(Hq,{isBot:_,title:e,imageUrl:i,content:a,ctaText:s,metaData:l,createdAt:m,type:v.messageSubType,currentLocation:t,channelUrl:n,accountId:r,eventInfoData:o})]});default:return h.jsx(jq,{isBot:_,messageText:"This card type is not supported yet.",createdAt:m})}}else if("markdown"===g&&v){const{suggestedReplies:e}=v,t=!c&&(null==e?void 0:e.length)&&b;return h.jsxs(h.Fragment,{children:[h.jsx(jq,{isBot:_,messageText:f,createdAt:m}),t?h.jsx("div",{className:`${WM.customMessage} ${WM.suggestedReplies}`,children:h.jsx(Bq,{replies:e,setIsSuggestedReplyMsgSent:d,setWaitingForResponseMap:s,channelUrl:n,accountId:r})}):null]})}return h.jsx(h.Fragment,{children:h.jsx(jq,{isBot:_,messageText:f,createdAt:m})})},zq=({channelUrl:e,waitingForResponseMap:t,setWaitingForResponseMap:n,accountId:r,currentLocation:i,setIsUserFirstMessageReceived:a,eventInfoData:s})=>h.jsx(UF,{channelUrl:e,renderMessageInput:()=>h.jsx(Hj,{channelUrl:e,waitingForResponseMap:t,setWaitingForResponseMap:n,eventInfoData:s}),renderMessageContent:o=>(a(!0),h.jsx(Gq,{message:o.message,channelUrl:e,accountId:r,waitingForResponseMap:t,setWaitingForResponseMap:n,currentLocation:i,eventInfoData:s})),renderChannelHeader:()=>h.jsx(h.Fragment,{})}),Vq=e=>{e&&window.scrollTo(0,0)},qq=(e=150)=>{const t=/iPad|iPhone|iPod/.test(navigator.userAgent),[n,r]=Object(i.useState)(0),[a,s]=Object(i.useState)(!1),o=Object(i.useRef)(t?document.documentElement.clientHeight:window.innerHeight);return Object(i.useEffect)(()=>{const n=()=>{var n;const i=t&&(null==(n=window.visualViewport)?void 0:n.height)||window.innerHeight,a=o.current-i;if(a>e){if(r(a),s(!0),t){const e=document.querySelector(".care-ai-modal-header");if(e){e.getBoundingClientRect().top<0&&window.scrollTo(0,0)}}}else r(0),s(!1)};return t&&window.visualViewport?(window.visualViewport.addEventListener("resize",n),window.visualViewport.addEventListener("scroll",n)):window.addEventListener("resize",n),()=>{t&&window.visualViewport?(window.visualViewport.addEventListener("resize",n),window.visualViewport.addEventListener("scroll",n)):window.removeEventListener("resize",n)}},[]),{isKeyboardOpen:a,keyboardHeight:n}},Kq=({showChatHistory:e,setShowChatHistory:t,appId:n,accountId:r,accessToken:a,currentChannelUrl:s,currentLocation:o,eventInfoData:l})=>{const[u,c]=Object(i.useState)(s),[d,f]=Object(i.useState)({}),{isKeyboardOpen:p,keyboardHeight:m}=qq(),[g,_]=Object(i.useState)(!1);Object(i.useEffect)(()=>{((e,t)=>{const n=document.querySelector(".sendbird-conversation__messages-padding");n&&e&&setTimeout(()=>{n.scrollTop=n.scrollHeight},50);if(/iPad|iPhone|iPod/.test(navigator.userAgent)){const n=document.querySelector(".sendbird-conversation");e?(n&&(n.style.paddingBottom=t+"px"),document.documentElement.style.position="fixed",document.body.style.position="fixed"):(n&&(n.style.paddingBottom="0"),document.documentElement.style.position="",document.body.style.position=""),setTimeout(()=>{Vq(e)},50),document.addEventListener("touchend",()=>Vq(e))}})(p,m)},[p,m]),Object(i.useEffect)(()=>{Bj({object:Pj,action:Dj,objectContext:{...l,[xj]:"listing page"}})()},[]),Object(i.useEffect)(()=>{const e=setTimeout(()=>{if(!g){Bj({object:Pj,action:Dj,objectContext:{...l,[Oj]:"No message received"}})()}},1e4);return()=>{clearTimeout(e)}},[g]);return h.jsx("div",{className:WM.careAIChatInterface,children:h.jsxs(KM,{appId:n,userId:r,nickname:"User",profileUrl:"",accessToken:a,children:[e&&h.jsx(wj,{selectedChannelUrl:u,onChannelSelect:e=>{e&&c(e.url),t(!1)},setShowChatHistory:t}),!e&&h.jsx(zq,{channelUrl:u,waitingForResponseMap:d,setWaitingForResponseMap:f,accountId:r,currentLocation:o,setIsUserFirstMessageReceived:_,eventInfoData:l})]})})};function Wq({width:e=16,height:t=16,color:n="black"}){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,color:n,viewBox:"0 0 16 16",fill:"none",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.1657 1.83441C13.8533 1.52199 13.3467 1.52199 13.0343 1.83441L8.00001 6.86873L2.96569 1.83441C2.65327 1.52199 2.14674 1.52199 1.83432 1.83441C1.5219 2.14683 1.5219 2.65336 1.83432 2.96578L6.86864 8.0001L1.83432 13.0344C1.5219 13.3468 1.5219 13.8534 1.83432 14.1658C2.14674 14.4782 2.65327 14.4782 2.96569 14.1658L8.00001 9.13147L13.0343 14.1658C13.3467 14.4782 13.8533 14.4782 14.1657 14.1658C14.4781 13.8534 14.4781 13.3468 14.1657 13.0344L9.13138 8.0001L14.1657 2.96578C14.4781 2.65336 14.4781 2.14683 14.1657 1.83441Z",fill:"#2D2D32"})})}const Yq="LoginModal-module__bottomLoginModalWrapper__oKEIO",Qq="LoginModal-module__fullScreen__TkLX2",Xq="LoginModal-module__screenOverlay__vCPXo",Zq="LoginModal-module__bottomLoginModal__O72DH",Jq="LoginModal-module__bottomModalContent__K9HgH",$q="LoginModal-module__loginModalMobileNumText__I5Z4z",eK="LoginModal-module__phoneInputContainer__x9sSA",tK="LoginModal-module__phoneInputContainerError__oqpCo",nK="LoginModal-module__countryCodeDropdown__5Jo23",rK="LoginModal-module__phoneInput__XQBLP",iK="LoginModal-module__phoneInputActive__nZlKG",aK="LoginModal-module__errorText__yVA8B",sK="LoginModal-module__flexGrowSpacer__XJA-T",oK="LoginModal-module__continueButton__4HMlk",lK="LoginModal-module__continueButtonEnabled__Ml3G1",uK="LoginModal-module__continueButtonDisabled__S6tRx",cK="LoginModal-module__infoTextContainer__ERzop",dK="LoginModal-module__infoTextSecondary__yYhvC",hK=e=>/^[0-9]{10}$/.test(e),fK=({setCurrentScreen:e,phoneNumber:t,setPhoneNumber:n,onClose:r})=>{const[a,s]=Object(i.useState)(!1),{isKeyboardOpen:o,keyboardHeight:l}=qq(),u=()=>{r()};return Object(i.useEffect)(()=>{((e,t)=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)){const n=document.getElementById("careai-login-modal");e?(n&&(n.style.paddingBottom=t+30+"px"),document.documentElement.style.position="fixed",document.body.style.position="fixed"):(n&&(n.style.paddingBottom="0"),document.documentElement.style.position="",document.body.style.position=""),setTimeout(()=>{Vq(e)},50),document.addEventListener("touchend",()=>Vq(e))}})(o,l)},[o]),h.jsxs("div",{className:""+Yq,onClick:u,children:[h.jsx("div",{className:Xq}),h.jsx("div",{id:"careai-login-modal",className:Zq,onClick:e=>e.stopPropagation(),children:h.jsxs("div",{className:Jq,children:[h.jsx("div",{onClick:u,children:h.jsx(Wq,{})}),h.jsx("h2",{className:$q,children:"Enter your mobile number"}),h.jsxs("div",{className:`${eK} ${a?tK:""}`,children:[h.jsx("div",{className:nK,children:"+91"}),h.jsx("input",{type:"tel",placeholder:"Mobile Number",value:t,onChange:e=>{n(e.target.value),a&&s(!1)},className:`${rK} ${t.length>0?iK:""}`,maxLength:10})]}),a?h.jsx("div",{className:aK,children:"Please enter a valid 10-digit mobile number"}):null,h.jsxs("div",{className:cK,children:["By continuing, you agree to our",h.jsx("a",{href:"https://www.practo.com/company/terms",target:"_blank",className:dK,children:"Terms & Conditions"})]}),h.jsx("div",{className:sK}),h.jsx("button",{onClick:()=>{hK(t)?e("embeddedOtpLogin"):s(!0)},className:`${oK} ${hK(t)?lK:uK}`,children:"Continue"})]})})]})},pK={careAIToggleButton:"CareAI-module__careAIToggleButton__Cl14f",careAiHeaderHistory:"CareAI-module__careAIHeaderHistory__YiyaO",careAIModalHeader:"CareAI-module__careAIModalHeader__rLHR-",careAIModalProfile:"CareAI-module__careAIModalProfile__Z0wWX",careAIModalUserInfo:"CareAI-module__careAIModalUserInfo__0cduP",careAIHeaderUserName:"CareAI-module__careAIHeaderUserName__9EAVB",careAIHeaderUserStatus:"CareAI-module__careAIHeaderUserStatus__nbh3w",careAIHistory:"CareAI-module__careAIHistory__W4ygD"},mK={cInlineLoaderContainer:"PageLoader-module__cInlineLoaderContainer__dmea8",cInlineLoaderContainerChatInterface:"PageLoader-module__cInlineLoaderContainerChatInterface__wDMD7",cInlineLoader:"PageLoader-module__cInlineLoader__gBi6B",cInlineLoaderSmall:"PageLoader-module__cInlineLoaderSmall__aEVLN",cInlineLoaderCircular:"PageLoader-module__cInlineLoaderCircular__vvAb6",cInlineLoaderCircularPath:"PageLoader-module__cInlineLoaderCircularPath__oBhaN"},gK=({className:e,isSmall:t,isChatInterface:n})=>{const r=[mK.cInlineLoaderContainer,n?mK.cInlineLoaderContainerChatInterface:"",e].filter(Boolean).join(" "),i=[mK.cInlineLoader,t?mK.cInlineLoaderSmall:""].filter(Boolean).join(" ");return h.jsx("div",{className:r,children:h.jsx("div",{className:i,children:h.jsx("svg",{className:mK.cInlineLoaderCircular,viewBox:"25 25 50 50",children:h.jsx("circle",{className:mK.cInlineLoaderCircularPath,cx:"50",cy:"50",r:"20",fill:"none"})})})})},_K=({showChatHistory:e,setShowChatHistory:t,currentLocation:n,eventInfoData:r})=>{const[a,s]=Object(i.useState)(!0),[o,l]=Object(i.useState)(""),[u,c]=Object(i.useState)(""),[d,f]=Object(i.useState)("");return Object(i.useEffect)(()=>{if("undefined"!=typeof document){const e='<link rel="stylesheet" href="https://www.practostatic.com/scripts/thirdparty/sendbird_styles.css">';document.head.insertAdjacentHTML("beforeend",e)}},[]),Object(i.useEffect)(()=>{(async()=>{try{const e=await fetch("/marketplace-api/mweb/care-ai/channels"),t=await e.json();f(t.channelId);const n=await fetch("/marketplace-api/mweb/care-ai/access-token"),r=await n.json();l(r.userPlatformId),c(r.accessToken)}catch(e){console.error(e)}finally{s(!1)}})()},[]),!a&&o&&d&&u?h.jsx(Kq,{showChatHistory:e,setShowChatHistory:t,appId:"C3CE3A01-9F8E-49C6-BAF7-B86C9D38DE5D",accountId:o,accessToken:u,currentChannelUrl:d,currentLocation:n,eventInfoData:r}):h.jsx(gK,{className:WM.chatInterfacePageLoader})},vK="BottomModal-module__genericBottomModal__Vc4OE",EK="BottomModal-module__genericBottomModalOpen__qfylY",yK="BottomModal-module__genericBottomModalClose__UfCM7",bK="BottomModal-module__content__aSRRa",CK="BottomModal-module__contentOpen__9x91Y",NK="BottomModal-module__contentClose__-GoaT",TK=({contentClassName:e="",hideClassName:t="",isOpen:n=!1,content_class:r="",closeModal:a,handleModalContentClick:s,isDefaultEventAction:o=!1,is_other_modal_open:l=!1,children:u})=>{Object(i.useEffect)(()=>(document.body.style.overflow=n?"hidden":"",()=>{document.body.style.overflow=""}),[n]);return h.jsx("div",{className:`${vK} ${t} ${n?EK:yK}`,onClick:e=>{a&&a(e)},children:h.jsx("div",{className:`${bK}  ${n?CK:NK} ${e}`,onClick:e=>{s?s(e):(o||e.preventDefault(),e.stopPropagation())},children:u})})},IK=({currentLocation:e,eventInfoData:t,onClose:n})=>{const[r,a]=Object(i.useState)(!1),s=()=>{n()};return h.jsxs(TK,{isOpen:!0,closeModal:()=>n(),children:[r?null:h.jsxs("div",{className:pK.careAIModalHeader,children:[h.jsxs("div",{className:pK.careAIModalProfile,children:[h.jsx("button",{onClick:s,className:pK.careAIToggleButton,children:h.jsx("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAYCAYAAACMcW/9AAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF9SURBVHgBxdc9UsJAFMDxt0nLMLEiUOUAwGQYD4A34AZS2lpaETqvYKWcQD0BwwEMmST0dIaOC5D4HiNOVPKxH1n+BbOzbOCXLXYSBli/fz1mLLvFocUYvIXhxwIulOO4VrttzLIMpt9TL1Hk37PBYEQTz/nFiPXC0J+D5gjZahlL/H83P4/oudnpdF9xbP25ZmzbXdjtPlegqSIkRXMGrTl3Id6FNxyOZqChMuQp3FF7jGan4PvGd7YOEjftyez17BUOJoi1QDO2DhKZizhe35lJkuwR+64bWxcZRespjUz60I3lRf5AdWJFkL+gOrCiyH/QJrEyyLPQJrCyyEKoSqwKZClUBVYVshIqg1WJrAUVwapGUgw4cl3XORzYsuTZ4PiImKYwUYk8/i5wVgdbHj+S4oZS4lgxJCUEpfix4kjKAMGCINiaZnaDgG3VWnqVkEFSwjt6qmpnCRnHvgeSSUOpIqwqJFXrHK0qd85eIRaPpWyfpuxhs/EfQVFf6r8x6vq0TDAAAAAASUVORK5CYII=",alt:"ic_down_cheveron",width:"14",height:"8"})}),h.jsx("div",{className:pK.careAIModalAvata,children:h.jsx("img",{src:jj,alt:"care-ai-avatar",width:"36",height:"36"})}),h.jsxs("div",{className:pK.careAIModalUserInfo,children:[h.jsx("span",{className:pK.careAIHeaderUserName,children:"Care AI"}),h.jsx("span",{className:pK.careAIHeaderUserStatus,children:"Active"})]})]}),h.jsxs("div",{className:pK.careAiHeaderHistory,onClick:()=>a(!0),children:[h.jsx("img",{src:"data:image/svg+xml,%3csvg%20width='18'%20height='20'%20viewBox='0%200%2018%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17.4242%206.98531L15.3769%2010.8106C15.355%2010.8585%2015.3259%2010.8984%2015.2967%2010.9384C15.1801%2011.114%2015.0417%2011.2578%2014.8814%2011.3616C14.8377%2011.3936%2014.7867%2011.4255%2014.7357%2011.4415C14.5463%2011.5453%2014.3277%2011.5932%2014.1164%2011.5932C14.0508%2011.5932%2013.9925%2011.5932%2013.927%2011.5772C13.8832%2011.5772%2013.8395%2011.5692%2013.7958%2011.5533C13.7448%2011.5453%2013.6938%2011.5293%2013.6428%2011.5054C13.5918%2011.4894%2013.5408%2011.4654%2013.4898%2011.4415L9.69379%209.44498C8.96519%209.06964%208.65918%208.11133%209.0089%207.31273C9.35863%206.52213%2010.2257%206.18672%2010.9543%206.57004L11.7776%207.00128C10.9251%205.70756%209.54078%204.86105%207.97429%204.86105C5.39505%204.86105%203.2894%207.16899%203.2894%209.99601C3.2894%2012.823%205.39505%2015.139%207.97429%2015.139C8.78304%2015.139%209.43149%2015.8497%209.43149%2016.7361C9.43149%2017.6226%208.78304%2018.3333%207.97429%2018.3333C3.78485%2018.3333%200.375%2014.5959%200.375%209.99601C0.375%205.39611%203.78485%201.66667%207.97429%201.66667C10.8158%201.66667%2013.3004%203.39164%2014.6045%205.93915L14.9106%205.36416C15.3113%204.6055%2016.2075%204.34995%2016.8996%204.79716C17.5991%205.24437%2017.8322%206.21866%2017.4242%206.98531Z'%20fill='%23787887'/%3e%3c/svg%3e",alt:"reload",width:"20",height:"20"}),h.jsx("span",{className:pK.careAIHistory,children:"History"})]})]}),h.jsx("div",{style:{height:"82vh"},children:h.jsx(_K,{showChatHistory:r,setShowChatHistory:a,currentLocation:e,eventInfoData:t})})]})};var SK={
/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
parse:function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");var n={},r=t||{},i=e.split(/; */),a=r.decode||wK;return i.forEach((function(e){var t=e.indexOf("=");if(!(t<0)){var r=e.substr(0,t).trim(),i=e.substr(++t,e.length).trim();'"'==i[0]&&(i=i.slice(1,-1)),null==n[r]&&(n[r]=function(e,t){try{return t(e)}catch(t){return e}}(i,a))}})),n},serialize:function(e,t,n){var r=n||{},i=r.encode||AK;if(!MK.test(e))throw new TypeError("argument name is invalid");var a=i(t);if(a&&!MK.test(a))throw new TypeError("argument val is invalid");var s=[e+"="+a];if(null!=r.maxAge){var o=r.maxAge-0;if(isNaN(o))throw new Error("maxAge should be a Number");s.push("Max-Age="+o)}if(r.domain){if(!MK.test(r.domain))throw new TypeError("option domain is invalid");s.push("Domain="+r.domain)}if(r.path){if(!MK.test(r.path))throw new TypeError("option path is invalid");s.push("Path="+r.path)}r.expires&&s.push("Expires="+r.expires.toUTCString());r.httpOnly&&s.push("HttpOnly");r.secure&&s.push("Secure");return s.join("; ")}},wK=decodeURIComponent,AK=encodeURIComponent,MK=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;var OK=SK;"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e});var RK={},kK=void 0;function xK(){return!!kK&&!0!==kK.headersSent}function DK(e){RK=e?OK.parse(e):{}}var UK={load:function(e,t){var n="undefined"==typeof document?RK:OK.parse(document.cookie),r=n&&n[e];if(!t)try{r=JSON.parse(r)}catch(e){}return r},select:function(e){var t="undefined"==typeof document?RK:OK.parse(document.cookie);return t?e?Object.keys(t).reduce((function(n,r){if(!e.test(r))return n;var i={};return i[r]=t[r],Object.assign({},n,i)}),{}):t:{}},save:function(e,t,n){RK[e]=t,"object"==typeof t&&(RK[e]=JSON.stringify(t)),"undefined"!=typeof document&&(document.cookie=OK.serialize(e,RK[e],n)),xK()&&kK.cookie&&kK.cookie(e,t,n)},remove:function(e,t){delete RK[e],void 0===t?t={}:"string"==typeof t&&(t={path:t}),"undefined"!=typeof document&&(t.expires=new Date(1970,1,1,0,0,1),document.cookie=OK.serialize(e,"",t)),xK()&&kK.clearCookie&&kK.clearCookie(e,t)},setRawCookie:DK,plugToRequest:function(e,t){return e.cookie?RK=e.cookie:e.cookies?RK=e.cookies:e.headers&&e.headers.cookie?DK(e.headers.cookie):RK={},kK=t,function(){kK=null,RK={}}}};"undefined"!=typeof window&&(window.reactCookie=UK);const LK=l(UK),PK={full:{width:"100%",height:"100%"}},FK=({phoneNumber:e,setCurrentScreen:t})=>{const[n,r]=Object(i.useState)(!0),a=`${window.location.origin.replace("www","accounts")}/login_signup_otp?mobile=${encodeURIComponent(e)}&view_type=modal&name=User`;return h.jsxs("div",{className:""+Yq,children:[h.jsx("div",{className:Xq}),h.jsx("div",{id:"careai-login-modal",className:Zq,children:h.jsxs("div",{className:Qq,children:[n&&h.jsx(gK,{}),h.jsx("iframe",{style:PK.full,src:a,onLoad:()=>{LK.load("modal_login")?(t("redirectIframe"),r(!0)):n&&r(!1)}})]})})]})},BK={hidden:{display:"none"}},jK=({setCurrentScreen:e})=>{const[t,n]=Object(i.useState)(!0),[r,a]=Object(i.useState)(!1),s="undefined"!=typeof window&&window.document?`/client-auth/login?redirectToPath=${window.location.protocol}//${window.location.host}`:"";return h.jsxs("div",{className:""+Yq,children:[h.jsx("div",{className:Xq}),h.jsx("div",{id:"careai-login-modal",className:Zq,children:h.jsxs("div",{children:[t&&h.jsx(gK,{}),h.jsx("iframe",{style:BK.hidden,src:s,onLoad:async()=>{if(!r){const t=window.location.origin+"/client-auth/user_details";await fetch(t),a(!0);setTimeout(()=>{n(!1),e("careAiModal")},2e3)}}})]})})]})},HK=({isCareAIPage:e=!1,currentLocation:t="",isUserLoggedIn:n=!1,onClose:r=(()=>{}),eventInfoData:a={}})=>{const[s,o]=Object(i.useState)(n?"redirectIframe":"loginModal"),[l,u]=Object(i.useState)("");switch(Object(i.useEffect)(()=>{o(n?"redirectIframe":"loginModal")},[n]),s){case"loginModal":return h.jsx(fK,{phoneNumber:l,setPhoneNumber:u,setCurrentScreen:o,onClose:r});case"embeddedOtpLogin":return h.jsx(FK,{phoneNumber:l,setCurrentScreen:o});case"redirectIframe":return h.jsx(jK,{setCurrentScreen:o});case"careAiModal":return h.jsx(IK,{currentLocation:t,eventInfoData:a,onClose:r})}}}).call(this,n(14),n(29).Buffer)},14:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},28:function(e,t,n){"use strict";n.r(t);var r=n(10);n.d(t,"CareAIPage",(function(){return r.h})),n.d(t,"CareAiChat",(function(){return r.a})),n.d(t,"LoginModal",(function(){return r.b}))},29:function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(30),i=n(31),a=n(32);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=o(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=o(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?o(e,0):h(e,t);if("Buffer"===t.type&&a(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(c(t),e=o(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return j(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return w(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var a,s=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(a=n;a<o;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*s}else-1!==c&&(a-=a-c),c=-1}else for(n+l>o&&(n=o-l),a=n;a>=0;a--){for(var d=!0,h=0;h<l;h++)if(u(e,a+h)!==u(t,h)){d=!1;break}if(d)return a}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[n+s]=o}return s}function y(e,t,n,r){return G(j(t,e.length-n),e,n,r)}function b(e,t,n,r){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function C(e,t,n,r){return b(e,t,n,r)}function N(e,t,n,r){return G(H(t),e,n,r)}function T(e,t,n,r){return G(function(e,t){for(var n,r,i,a=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,s,o,l,u=e[i],c=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[i+1]))&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:a=e[i+1],s=e[i+2],128==(192&a)&&128==(192&s)&&(l=(15&u)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[i+1],s=e[i+2],o=e[i+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return u(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),o=Math.min(a,s),u=this.slice(r,i),c=e.slice(t,n),d=0;d<o;++d)if(u[d]!==c[d]){a=u[d],s=c[d];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return N(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function w(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=B(e[a]);return i}function O(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function x(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function U(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,a){return a||U(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function P(e,t,n,r,a){return a||U(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var a=0,s=1,o=0;for(this[t]=255&e;++a<n&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var a=n-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return P(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return P(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=l.isBuffer(e)?e:j(new l(e,r).toString()),o=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%o]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(14))},30:function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),s=r[0],o=r[1],l=new a(function(e,t,n){return 3*(t+n)/4-n}(0,s,o)),c=0,d=o>0?s-4:s;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===o&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,l[c++]=255&t);1===o&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=0,o=n-i;s<o;s+=16383)a.push(c(e,s,s+16383>o?o:s+16383));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)r[o]=s[o],i[s.charCodeAt(o)]=o;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},31:function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,i){var a,s,o=8*i-r-1,l=(1<<o)-1,u=l>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=o;c>0;a=256*a+e[t+d],d+=h,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=r;c>0;s=256*s+e[t+d],d+=h,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),a-=u}return(f?-1:1)*s*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var s,o,l,u=8*a-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=c?(o=0,s=c):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&o,f+=p,o/=256,i-=8);for(s=s<<i|o,u+=i;u>0;e[n+f]=255&s,f+=p,s/=256,u-=8);e[n+f-p]|=128*m}},32:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}}}]);